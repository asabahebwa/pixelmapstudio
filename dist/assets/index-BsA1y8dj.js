(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function kl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var op={exports:{}},ka={},ap={exports:{}},Oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xv;function xR(){if(Xv)return Oe;Xv=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function g(D){return D===null||typeof D!="object"?null:(D=p&&D[p]||D["@@iterator"],typeof D=="function"?D:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,w={};function x(D,Z,ge){this.props=D,this.context=Z,this.refs=w,this.updater=ge||_}x.prototype.isReactComponent={},x.prototype.setState=function(D,Z){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,Z,"setState")},x.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function T(){}T.prototype=x.prototype;function A(D,Z,ge){this.props=D,this.context=Z,this.refs=w,this.updater=ge||_}var E=A.prototype=new T;E.constructor=A,v(E,x.prototype),E.isPureReactComponent=!0;var R=Array.isArray,k=Object.prototype.hasOwnProperty,M={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function W(D,Z,ge){var Y,Re={},pe=null,Se=null;if(Z!=null)for(Y in Z.ref!==void 0&&(Se=Z.ref),Z.key!==void 0&&(pe=""+Z.key),Z)k.call(Z,Y)&&!L.hasOwnProperty(Y)&&(Re[Y]=Z[Y]);var ke=arguments.length-2;if(ke===1)Re.children=ge;else if(1<ke){for(var Me=Array(ke),Ne=0;Ne<ke;Ne++)Me[Ne]=arguments[Ne+2];Re.children=Me}if(D&&D.defaultProps)for(Y in ke=D.defaultProps,ke)Re[Y]===void 0&&(Re[Y]=ke[Y]);return{$$typeof:t,type:D,key:pe,ref:Se,props:Re,_owner:M.current}}function H(D,Z){return{$$typeof:t,type:D.type,key:Z,ref:D.ref,props:D.props,_owner:D._owner}}function X(D){return typeof D=="object"&&D!==null&&D.$$typeof===t}function B(D){var Z={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(ge){return Z[ge]})}var te=/\/+/g;function ie(D,Z){return typeof D=="object"&&D!==null&&D.key!=null?B(""+D.key):Z.toString(36)}function se(D,Z,ge,Y,Re){var pe=typeof D;(pe==="undefined"||pe==="boolean")&&(D=null);var Se=!1;if(D===null)Se=!0;else switch(pe){case"string":case"number":Se=!0;break;case"object":switch(D.$$typeof){case t:case e:Se=!0}}if(Se)return Se=D,Re=Re(Se),D=Y===""?"."+ie(Se,0):Y,R(Re)?(ge="",D!=null&&(ge=D.replace(te,"$&/")+"/"),se(Re,Z,ge,"",function(Ne){return Ne})):Re!=null&&(X(Re)&&(Re=H(Re,ge+(!Re.key||Se&&Se.key===Re.key?"":(""+Re.key).replace(te,"$&/")+"/")+D)),Z.push(Re)),1;if(Se=0,Y=Y===""?".":Y+":",R(D))for(var ke=0;ke<D.length;ke++){pe=D[ke];var Me=Y+ie(pe,ke);Se+=se(pe,Z,ge,Me,Re)}else if(Me=g(D),typeof Me=="function")for(D=Me.call(D),ke=0;!(pe=D.next()).done;)pe=pe.value,Me=Y+ie(pe,ke++),Se+=se(pe,Z,ge,Me,Re);else if(pe==="object")throw Z=String(D),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.");return Se}function G(D,Z,ge){if(D==null)return D;var Y=[],Re=0;return se(D,Y,"","",function(pe){return Z.call(ge,pe,Re++)}),Y}function ce(D){if(D._status===-1){var Z=D._result;Z=Z(),Z.then(function(ge){(D._status===0||D._status===-1)&&(D._status=1,D._result=ge)},function(ge){(D._status===0||D._status===-1)&&(D._status=2,D._result=ge)}),D._status===-1&&(D._status=0,D._result=Z)}if(D._status===1)return D._result.default;throw D._result}var xe={current:null},oe={transition:null},ne={ReactCurrentDispatcher:xe,ReactCurrentBatchConfig:oe,ReactCurrentOwner:M};function ee(){throw Error("act(...) is not supported in production builds of React.")}return Oe.Children={map:G,forEach:function(D,Z,ge){G(D,function(){Z.apply(this,arguments)},ge)},count:function(D){var Z=0;return G(D,function(){Z++}),Z},toArray:function(D){return G(D,function(Z){return Z})||[]},only:function(D){if(!X(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},Oe.Component=x,Oe.Fragment=n,Oe.Profiler=i,Oe.PureComponent=A,Oe.StrictMode=r,Oe.Suspense=u,Oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,Oe.act=ee,Oe.cloneElement=function(D,Z,ge){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var Y=v({},D.props),Re=D.key,pe=D.ref,Se=D._owner;if(Z!=null){if(Z.ref!==void 0&&(pe=Z.ref,Se=M.current),Z.key!==void 0&&(Re=""+Z.key),D.type&&D.type.defaultProps)var ke=D.type.defaultProps;for(Me in Z)k.call(Z,Me)&&!L.hasOwnProperty(Me)&&(Y[Me]=Z[Me]===void 0&&ke!==void 0?ke[Me]:Z[Me])}var Me=arguments.length-2;if(Me===1)Y.children=ge;else if(1<Me){ke=Array(Me);for(var Ne=0;Ne<Me;Ne++)ke[Ne]=arguments[Ne+2];Y.children=ke}return{$$typeof:t,type:D.type,key:Re,ref:pe,props:Y,_owner:Se}},Oe.createContext=function(D){return D={$$typeof:o,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:s,_context:D},D.Consumer=D},Oe.createElement=W,Oe.createFactory=function(D){var Z=W.bind(null,D);return Z.type=D,Z},Oe.createRef=function(){return{current:null}},Oe.forwardRef=function(D){return{$$typeof:a,render:D}},Oe.isValidElement=X,Oe.lazy=function(D){return{$$typeof:h,_payload:{_status:-1,_result:D},_init:ce}},Oe.memo=function(D,Z){return{$$typeof:f,type:D,compare:Z===void 0?null:Z}},Oe.startTransition=function(D){var Z=oe.transition;oe.transition={};try{D()}finally{oe.transition=Z}},Oe.unstable_act=ee,Oe.useCallback=function(D,Z){return xe.current.useCallback(D,Z)},Oe.useContext=function(D){return xe.current.useContext(D)},Oe.useDebugValue=function(){},Oe.useDeferredValue=function(D){return xe.current.useDeferredValue(D)},Oe.useEffect=function(D,Z){return xe.current.useEffect(D,Z)},Oe.useId=function(){return xe.current.useId()},Oe.useImperativeHandle=function(D,Z,ge){return xe.current.useImperativeHandle(D,Z,ge)},Oe.useInsertionEffect=function(D,Z){return xe.current.useInsertionEffect(D,Z)},Oe.useLayoutEffect=function(D,Z){return xe.current.useLayoutEffect(D,Z)},Oe.useMemo=function(D,Z){return xe.current.useMemo(D,Z)},Oe.useReducer=function(D,Z,ge){return xe.current.useReducer(D,Z,ge)},Oe.useRef=function(D){return xe.current.useRef(D)},Oe.useState=function(D){return xe.current.useState(D)},Oe.useSyncExternalStore=function(D,Z,ge){return xe.current.useSyncExternalStore(D,Z,ge)},Oe.useTransition=function(){return xe.current.useTransition()},Oe.version="18.3.1",Oe}var Yv;function $f(){return Yv||(Yv=1,ap.exports=xR()),ap.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qv;function TR(){if(qv)return ka;qv=1;var t=$f(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,u,f){var h,p={},g=null,_=null;f!==void 0&&(g=""+f),u.key!==void 0&&(g=""+u.key),u.ref!==void 0&&(_=u.ref);for(h in u)r.call(u,h)&&!s.hasOwnProperty(h)&&(p[h]=u[h]);if(a&&a.defaultProps)for(h in u=a.defaultProps,u)p[h]===void 0&&(p[h]=u[h]);return{$$typeof:e,type:a,key:g,ref:_,props:p,_owner:i.current}}return ka.Fragment=n,ka.jsx=o,ka.jsxs=o,ka}var Kv;function SR(){return Kv||(Kv=1,op.exports=TR()),op.exports}var C=SR(),P=$f();const ht=kl(P);var eu={},lp={exports:{}},Yt={},cp={exports:{}},up={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zv;function ER(){return Zv||(Zv=1,function(t){function e(oe,ne){var ee=oe.length;oe.push(ne);e:for(;0<ee;){var D=ee-1>>>1,Z=oe[D];if(0<i(Z,ne))oe[D]=ne,oe[ee]=Z,ee=D;else break e}}function n(oe){return oe.length===0?null:oe[0]}function r(oe){if(oe.length===0)return null;var ne=oe[0],ee=oe.pop();if(ee!==ne){oe[0]=ee;e:for(var D=0,Z=oe.length,ge=Z>>>1;D<ge;){var Y=2*(D+1)-1,Re=oe[Y],pe=Y+1,Se=oe[pe];if(0>i(Re,ee))pe<Z&&0>i(Se,Re)?(oe[D]=Se,oe[pe]=ee,D=pe):(oe[D]=Re,oe[Y]=ee,D=Y);else if(pe<Z&&0>i(Se,ee))oe[D]=Se,oe[pe]=ee,D=pe;else break e}}return ne}function i(oe,ne){var ee=oe.sortIndex-ne.sortIndex;return ee!==0?ee:oe.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var u=[],f=[],h=1,p=null,g=3,_=!1,v=!1,w=!1,x=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(oe){for(var ne=n(f);ne!==null;){if(ne.callback===null)r(f);else if(ne.startTime<=oe)r(f),ne.sortIndex=ne.expirationTime,e(u,ne);else break;ne=n(f)}}function R(oe){if(w=!1,E(oe),!v)if(n(u)!==null)v=!0,ce(k);else{var ne=n(f);ne!==null&&xe(R,ne.startTime-oe)}}function k(oe,ne){v=!1,w&&(w=!1,T(W),W=-1),_=!0;var ee=g;try{for(E(ne),p=n(u);p!==null&&(!(p.expirationTime>ne)||oe&&!B());){var D=p.callback;if(typeof D=="function"){p.callback=null,g=p.priorityLevel;var Z=D(p.expirationTime<=ne);ne=t.unstable_now(),typeof Z=="function"?p.callback=Z:p===n(u)&&r(u),E(ne)}else r(u);p=n(u)}if(p!==null)var ge=!0;else{var Y=n(f);Y!==null&&xe(R,Y.startTime-ne),ge=!1}return ge}finally{p=null,g=ee,_=!1}}var M=!1,L=null,W=-1,H=5,X=-1;function B(){return!(t.unstable_now()-X<H)}function te(){if(L!==null){var oe=t.unstable_now();X=oe;var ne=!0;try{ne=L(!0,oe)}finally{ne?ie():(M=!1,L=null)}}else M=!1}var ie;if(typeof A=="function")ie=function(){A(te)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,G=se.port2;se.port1.onmessage=te,ie=function(){G.postMessage(null)}}else ie=function(){x(te,0)};function ce(oe){L=oe,M||(M=!0,ie())}function xe(oe,ne){W=x(function(){oe(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(oe){oe.callback=null},t.unstable_continueExecution=function(){v||_||(v=!0,ce(k))},t.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<oe?Math.floor(1e3/oe):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(oe){switch(g){case 1:case 2:case 3:var ne=3;break;default:ne=g}var ee=g;g=ne;try{return oe()}finally{g=ee}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(oe,ne){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var ee=g;g=oe;try{return ne()}finally{g=ee}},t.unstable_scheduleCallback=function(oe,ne,ee){var D=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?D+ee:D):ee=D,oe){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=ee+Z,oe={id:h++,callback:ne,priorityLevel:oe,startTime:ee,expirationTime:Z,sortIndex:-1},ee>D?(oe.sortIndex=ee,e(f,oe),n(u)===null&&oe===n(f)&&(w?(T(W),W=-1):w=!0,xe(R,ee-D))):(oe.sortIndex=Z,e(u,oe),v||_||(v=!0,ce(k))),oe},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(oe){var ne=g;return function(){var ee=g;g=ne;try{return oe.apply(this,arguments)}finally{g=ee}}}}(up)),up}var Qv;function AR(){return Qv||(Qv=1,cp.exports=ER()),cp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jv;function CR(){if(Jv)return Yt;Jv=1;var t=$f(),e=AR();function n(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(l,c){o(l,c),o(l+"Capture",c)}function o(l,c){for(i[l]=c,l=0;l<c.length;l++)r.add(c[l])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function g(l){return u.call(p,l)?!0:u.call(h,l)?!1:f.test(l)?p[l]=!0:(h[l]=!0,!1)}function _(l,c,d,m){if(d!==null&&d.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return m?!1:d!==null?!d.acceptsBooleans:(l=l.toLowerCase().slice(0,5),l!=="data-"&&l!=="aria-");default:return!1}}function v(l,c,d,m){if(c===null||typeof c>"u"||_(l,c,d,m))return!0;if(m)return!1;if(d!==null)switch(d.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function w(l,c,d,m,y,b,S){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=m,this.attributeNamespace=y,this.mustUseProperty=d,this.propertyName=l,this.type=c,this.sanitizeURL=b,this.removeEmptyString=S}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(l){x[l]=new w(l,0,!1,l,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(l){var c=l[0];x[c]=new w(c,1,!1,l[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(l){x[l]=new w(l,2,!1,l.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(l){x[l]=new w(l,2,!1,l,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(l){x[l]=new w(l,3,!1,l.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(l){x[l]=new w(l,3,!0,l,null,!1,!1)}),["capture","download"].forEach(function(l){x[l]=new w(l,4,!1,l,null,!1,!1)}),["cols","rows","size","span"].forEach(function(l){x[l]=new w(l,6,!1,l,null,!1,!1)}),["rowSpan","start"].forEach(function(l){x[l]=new w(l,5,!1,l.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function A(l){return l[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(l){var c=l.replace(T,A);x[c]=new w(c,1,!1,l,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(l){var c=l.replace(T,A);x[c]=new w(c,1,!1,l,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(l){var c=l.replace(T,A);x[c]=new w(c,1,!1,l,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(l){x[l]=new w(l,1,!1,l.toLowerCase(),null,!1,!1)}),x.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(l){x[l]=new w(l,1,!1,l.toLowerCase(),null,!0,!0)});function E(l,c,d,m){var y=x.hasOwnProperty(c)?x[c]:null;(y!==null?y.type!==0:m||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(v(c,d,y,m)&&(d=null),m||y===null?g(c)&&(d===null?l.removeAttribute(c):l.setAttribute(c,""+d)):y.mustUseProperty?l[y.propertyName]=d===null?y.type===3?!1:"":d:(c=y.attributeName,m=y.attributeNamespace,d===null?l.removeAttribute(c):(y=y.type,d=y===3||y===4&&d===!0?"":""+d,m?l.setAttributeNS(m,c,d):l.setAttribute(c,d))))}var R=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),M=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),X=Symbol.for("react.provider"),B=Symbol.for("react.context"),te=Symbol.for("react.forward_ref"),ie=Symbol.for("react.suspense"),se=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),ce=Symbol.for("react.lazy"),xe=Symbol.for("react.offscreen"),oe=Symbol.iterator;function ne(l){return l===null||typeof l!="object"?null:(l=oe&&l[oe]||l["@@iterator"],typeof l=="function"?l:null)}var ee=Object.assign,D;function Z(l){if(D===void 0)try{throw Error()}catch(d){var c=d.stack.trim().match(/\n( *(at )?)/);D=c&&c[1]||""}return`
`+D+l}var ge=!1;function Y(l,c){if(!l||ge)return"";ge=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(J){var m=J}Reflect.construct(l,[],c)}else{try{c.call()}catch(J){m=J}l.call(c.prototype)}else{try{throw Error()}catch(J){m=J}l()}}catch(J){if(J&&m&&typeof J.stack=="string"){for(var y=J.stack.split(`
`),b=m.stack.split(`
`),S=y.length-1,O=b.length-1;1<=S&&0<=O&&y[S]!==b[O];)O--;for(;1<=S&&0<=O;S--,O--)if(y[S]!==b[O]){if(S!==1||O!==1)do if(S--,O--,0>O||y[S]!==b[O]){var F=`
`+y[S].replace(" at new "," at ");return l.displayName&&F.includes("<anonymous>")&&(F=F.replace("<anonymous>",l.displayName)),F}while(1<=S&&0<=O);break}}}finally{ge=!1,Error.prepareStackTrace=d}return(l=l?l.displayName||l.name:"")?Z(l):""}function Re(l){switch(l.tag){case 5:return Z(l.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return l=Y(l.type,!1),l;case 11:return l=Y(l.type.render,!1),l;case 1:return l=Y(l.type,!0),l;default:return""}}function pe(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case L:return"Fragment";case M:return"Portal";case H:return"Profiler";case W:return"StrictMode";case ie:return"Suspense";case se:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case B:return(l.displayName||"Context")+".Consumer";case X:return(l._context.displayName||"Context")+".Provider";case te:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case G:return c=l.displayName||null,c!==null?c:pe(l.type)||"Memo";case ce:c=l._payload,l=l._init;try{return pe(l(c))}catch{}}return null}function Se(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(c);case 8:return c===W?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function ke(l){switch(typeof l){case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Me(l){var c=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function Ne(l){var c=Me(l)?"checked":"value",d=Object.getOwnPropertyDescriptor(l.constructor.prototype,c),m=""+l[c];if(!l.hasOwnProperty(c)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var y=d.get,b=d.set;return Object.defineProperty(l,c,{configurable:!0,get:function(){return y.call(this)},set:function(S){m=""+S,b.call(this,S)}}),Object.defineProperty(l,c,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(S){m=""+S},stopTracking:function(){l._valueTracker=null,delete l[c]}}}}function At(l){l._valueTracker||(l._valueTracker=Ne(l))}function hr(l){if(!l)return!1;var c=l._valueTracker;if(!c)return!0;var d=c.getValue(),m="";return l&&(m=Me(l)?l.checked?"true":"false":l.value),l=m,l!==d?(c.setValue(l),!0):!1}function Vn(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}function dr(l,c){var d=c.checked;return ee({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??l._wrapperState.initialChecked})}function Wo(l,c){var d=c.defaultValue==null?"":c.defaultValue,m=c.checked!=null?c.checked:c.defaultChecked;d=ke(c.value!=null?c.value:d),l._wrapperState={initialChecked:m,initialValue:d,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function Vr(l,c){c=c.checked,c!=null&&E(l,"checked",c,!1)}function Ho(l,c){Vr(l,c);var d=ke(c.value),m=c.type;if(d!=null)m==="number"?(d===0&&l.value===""||l.value!=d)&&(l.value=""+d):l.value!==""+d&&(l.value=""+d);else if(m==="submit"||m==="reset"){l.removeAttribute("value");return}c.hasOwnProperty("value")?Yo(l,c.type,d):c.hasOwnProperty("defaultValue")&&Yo(l,c.type,ke(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(l.defaultChecked=!!c.defaultChecked)}function Xo(l,c,d){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var m=c.type;if(!(m!=="submit"&&m!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+l._wrapperState.initialValue,d||c===l.value||(l.value=c),l.defaultValue=c}d=l.name,d!==""&&(l.name=""),l.defaultChecked=!!l._wrapperState.initialChecked,d!==""&&(l.name=d)}function Yo(l,c,d){(c!=="number"||Vn(l.ownerDocument)!==l)&&(d==null?l.defaultValue=""+l._wrapperState.initialValue:l.defaultValue!==""+d&&(l.defaultValue=""+d))}var Ci=Array.isArray;function pr(l,c,d,m){if(l=l.options,c){c={};for(var y=0;y<d.length;y++)c["$"+d[y]]=!0;for(d=0;d<l.length;d++)y=c.hasOwnProperty("$"+l[d].value),l[d].selected!==y&&(l[d].selected=y),y&&m&&(l[d].defaultSelected=!0)}else{for(d=""+ke(d),c=null,y=0;y<l.length;y++){if(l[y].value===d){l[y].selected=!0,m&&(l[y].defaultSelected=!0);return}c!==null||l[y].disabled||(c=l[y])}c!==null&&(c.selected=!0)}}function Ri(l,c){if(c.dangerouslySetInnerHTML!=null)throw Error(n(91));return ee({},c,{value:void 0,defaultValue:void 0,children:""+l._wrapperState.initialValue})}function ys(l,c){var d=c.value;if(d==null){if(d=c.children,c=c.defaultValue,d!=null){if(c!=null)throw Error(n(92));if(Ci(d)){if(1<d.length)throw Error(n(93));d=d[0]}c=d}c==null&&(c=""),d=c}l._wrapperState={initialValue:ke(d)}}function Wl(l,c){var d=ke(c.value),m=ke(c.defaultValue);d!=null&&(d=""+d,d!==l.value&&(l.value=d),c.defaultValue==null&&l.defaultValue!==d&&(l.defaultValue=d)),m!=null&&(l.defaultValue=""+m)}function vs(l){var c=l.textContent;c===l._wrapperState.initialValue&&c!==""&&c!==null&&(l.value=c)}function Ii(l){switch(l){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bs(l,c){return l==null||l==="http://www.w3.org/1999/xhtml"?Ii(c):l==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":l}var ws,Hl=function(l){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,d,m,y){MSApp.execUnsafeLocalFunction(function(){return l(c,d,m,y)})}:l}(function(l,c){if(l.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in l)l.innerHTML=c;else{for(ws=ws||document.createElement("div"),ws.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=ws.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;c.firstChild;)l.appendChild(c.firstChild)}});function gr(l,c){if(c){var d=l.firstChild;if(d&&d===l.lastChild&&d.nodeType===3){d.nodeValue=c;return}}l.textContent=c}var ki={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xs=["Webkit","ms","Moz","O"];Object.keys(ki).forEach(function(l){xs.forEach(function(c){c=c+l.charAt(0).toUpperCase()+l.substring(1),ki[c]=ki[l]})});function Xl(l,c,d){return c==null||typeof c=="boolean"||c===""?"":d||typeof c!="number"||c===0||ki.hasOwnProperty(l)&&ki[l]?(""+c).trim():c+"px"}function ly(l,c){l=l.style;for(var d in c)if(c.hasOwnProperty(d)){var m=d.indexOf("--")===0,y=Xl(d,c[d],m);d==="float"&&(d="cssFloat"),m?l.setProperty(d,y):l[d]=y}}var CA=ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yh(l,c){if(c){if(CA[l]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(n(137,l));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(n(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(n(61))}if(c.style!=null&&typeof c.style!="object")throw Error(n(62))}}function vh(l,c){if(l.indexOf("-")===-1)return typeof c.is=="string";switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bh=null;function wh(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var xh=null,Ts=null,Ss=null;function cy(l){if(l=ga(l)){if(typeof xh!="function")throw Error(n(280));var c=l.stateNode;c&&(c=gc(c),xh(l.stateNode,l.type,c))}}function uy(l){Ts?Ss?Ss.push(l):Ss=[l]:Ts=l}function fy(){if(Ts){var l=Ts,c=Ss;if(Ss=Ts=null,cy(l),c)for(l=0;l<c.length;l++)cy(c[l])}}function hy(l,c){return l(c)}function dy(){}var Th=!1;function py(l,c,d){if(Th)return l(c,d);Th=!0;try{return hy(l,c,d)}finally{Th=!1,(Ts!==null||Ss!==null)&&(dy(),fy())}}function qo(l,c){var d=l.stateNode;if(d===null)return null;var m=gc(d);if(m===null)return null;d=m[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(l=l.type,m=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!m;break e;default:l=!1}if(l)return null;if(d&&typeof d!="function")throw Error(n(231,c,typeof d));return d}var Sh=!1;if(a)try{var Ko={};Object.defineProperty(Ko,"passive",{get:function(){Sh=!0}}),window.addEventListener("test",Ko,Ko),window.removeEventListener("test",Ko,Ko)}catch{Sh=!1}function RA(l,c,d,m,y,b,S,O,F){var J=Array.prototype.slice.call(arguments,3);try{c.apply(d,J)}catch(le){this.onError(le)}}var Zo=!1,Yl=null,ql=!1,Eh=null,IA={onError:function(l){Zo=!0,Yl=l}};function kA(l,c,d,m,y,b,S,O,F){Zo=!1,Yl=null,RA.apply(IA,arguments)}function PA(l,c,d,m,y,b,S,O,F){if(kA.apply(this,arguments),Zo){if(Zo){var J=Yl;Zo=!1,Yl=null}else throw Error(n(198));ql||(ql=!0,Eh=J)}}function Pi(l){var c=l,d=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,(c.flags&4098)!==0&&(d=c.return),l=c.return;while(l)}return c.tag===3?d:null}function gy(l){if(l.tag===13){var c=l.memoizedState;if(c===null&&(l=l.alternate,l!==null&&(c=l.memoizedState)),c!==null)return c.dehydrated}return null}function my(l){if(Pi(l)!==l)throw Error(n(188))}function MA(l){var c=l.alternate;if(!c){if(c=Pi(l),c===null)throw Error(n(188));return c!==l?null:l}for(var d=l,m=c;;){var y=d.return;if(y===null)break;var b=y.alternate;if(b===null){if(m=y.return,m!==null){d=m;continue}break}if(y.child===b.child){for(b=y.child;b;){if(b===d)return my(y),l;if(b===m)return my(y),c;b=b.sibling}throw Error(n(188))}if(d.return!==m.return)d=y,m=b;else{for(var S=!1,O=y.child;O;){if(O===d){S=!0,d=y,m=b;break}if(O===m){S=!0,m=y,d=b;break}O=O.sibling}if(!S){for(O=b.child;O;){if(O===d){S=!0,d=b,m=y;break}if(O===m){S=!0,m=b,d=y;break}O=O.sibling}if(!S)throw Error(n(189))}}if(d.alternate!==m)throw Error(n(190))}if(d.tag!==3)throw Error(n(188));return d.stateNode.current===d?l:c}function _y(l){return l=MA(l),l!==null?yy(l):null}function yy(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=yy(l);if(c!==null)return c;l=l.sibling}return null}var vy=e.unstable_scheduleCallback,by=e.unstable_cancelCallback,NA=e.unstable_shouldYield,OA=e.unstable_requestPaint,ut=e.unstable_now,DA=e.unstable_getCurrentPriorityLevel,Ah=e.unstable_ImmediatePriority,wy=e.unstable_UserBlockingPriority,Kl=e.unstable_NormalPriority,FA=e.unstable_LowPriority,xy=e.unstable_IdlePriority,Zl=null,$n=null;function LA(l){if($n&&typeof $n.onCommitFiberRoot=="function")try{$n.onCommitFiberRoot(Zl,l,void 0,(l.current.flags&128)===128)}catch{}}var Cn=Math.clz32?Math.clz32:jA,BA=Math.log,UA=Math.LN2;function jA(l){return l>>>=0,l===0?32:31-(BA(l)/UA|0)|0}var Ql=64,Jl=4194304;function Qo(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Gl(l,c){var d=l.pendingLanes;if(d===0)return 0;var m=0,y=l.suspendedLanes,b=l.pingedLanes,S=d&268435455;if(S!==0){var O=S&~y;O!==0?m=Qo(O):(b&=S,b!==0&&(m=Qo(b)))}else S=d&~y,S!==0?m=Qo(S):b!==0&&(m=Qo(b));if(m===0)return 0;if(c!==0&&c!==m&&(c&y)===0&&(y=m&-m,b=c&-c,y>=b||y===16&&(b&4194240)!==0))return c;if((m&4)!==0&&(m|=d&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=m;0<c;)d=31-Cn(c),y=1<<d,m|=l[d],c&=~y;return m}function zA(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VA(l,c){for(var d=l.suspendedLanes,m=l.pingedLanes,y=l.expirationTimes,b=l.pendingLanes;0<b;){var S=31-Cn(b),O=1<<S,F=y[S];F===-1?((O&d)===0||(O&m)!==0)&&(y[S]=zA(O,c)):F<=c&&(l.expiredLanes|=O),b&=~O}}function Ch(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function Ty(){var l=Ql;return Ql<<=1,(Ql&4194240)===0&&(Ql=64),l}function Rh(l){for(var c=[],d=0;31>d;d++)c.push(l);return c}function Jo(l,c,d){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-Cn(c),l[c]=d}function $A(l,c){var d=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var m=l.eventTimes;for(l=l.expirationTimes;0<d;){var y=31-Cn(d),b=1<<y;c[y]=0,m[y]=-1,l[y]=-1,d&=~b}}function Ih(l,c){var d=l.entangledLanes|=c;for(l=l.entanglements;d;){var m=31-Cn(d),y=1<<m;y&c|l[m]&c&&(l[m]|=c),d&=~y}}var $e=0;function Sy(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var Ey,kh,Ay,Cy,Ry,Ph=!1,ec=[],$r=null,Wr=null,Hr=null,Go=new Map,ea=new Map,Xr=[],WA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Iy(l,c){switch(l){case"focusin":case"focusout":$r=null;break;case"dragenter":case"dragleave":Wr=null;break;case"mouseover":case"mouseout":Hr=null;break;case"pointerover":case"pointerout":Go.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":ea.delete(c.pointerId)}}function ta(l,c,d,m,y,b){return l===null||l.nativeEvent!==b?(l={blockedOn:c,domEventName:d,eventSystemFlags:m,nativeEvent:b,targetContainers:[y]},c!==null&&(c=ga(c),c!==null&&kh(c)),l):(l.eventSystemFlags|=m,c=l.targetContainers,y!==null&&c.indexOf(y)===-1&&c.push(y),l)}function HA(l,c,d,m,y){switch(c){case"focusin":return $r=ta($r,l,c,d,m,y),!0;case"dragenter":return Wr=ta(Wr,l,c,d,m,y),!0;case"mouseover":return Hr=ta(Hr,l,c,d,m,y),!0;case"pointerover":var b=y.pointerId;return Go.set(b,ta(Go.get(b)||null,l,c,d,m,y)),!0;case"gotpointercapture":return b=y.pointerId,ea.set(b,ta(ea.get(b)||null,l,c,d,m,y)),!0}return!1}function ky(l){var c=Mi(l.target);if(c!==null){var d=Pi(c);if(d!==null){if(c=d.tag,c===13){if(c=gy(d),c!==null){l.blockedOn=c,Ry(l.priority,function(){Ay(d)});return}}else if(c===3&&d.stateNode.current.memoizedState.isDehydrated){l.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}l.blockedOn=null}function tc(l){if(l.blockedOn!==null)return!1;for(var c=l.targetContainers;0<c.length;){var d=Nh(l.domEventName,l.eventSystemFlags,c[0],l.nativeEvent);if(d===null){d=l.nativeEvent;var m=new d.constructor(d.type,d);bh=m,d.target.dispatchEvent(m),bh=null}else return c=ga(d),c!==null&&kh(c),l.blockedOn=d,!1;c.shift()}return!0}function Py(l,c,d){tc(l)&&d.delete(c)}function XA(){Ph=!1,$r!==null&&tc($r)&&($r=null),Wr!==null&&tc(Wr)&&(Wr=null),Hr!==null&&tc(Hr)&&(Hr=null),Go.forEach(Py),ea.forEach(Py)}function na(l,c){l.blockedOn===c&&(l.blockedOn=null,Ph||(Ph=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,XA)))}function ra(l){function c(y){return na(y,l)}if(0<ec.length){na(ec[0],l);for(var d=1;d<ec.length;d++){var m=ec[d];m.blockedOn===l&&(m.blockedOn=null)}}for($r!==null&&na($r,l),Wr!==null&&na(Wr,l),Hr!==null&&na(Hr,l),Go.forEach(c),ea.forEach(c),d=0;d<Xr.length;d++)m=Xr[d],m.blockedOn===l&&(m.blockedOn=null);for(;0<Xr.length&&(d=Xr[0],d.blockedOn===null);)ky(d),d.blockedOn===null&&Xr.shift()}var Es=R.ReactCurrentBatchConfig,nc=!0;function YA(l,c,d,m){var y=$e,b=Es.transition;Es.transition=null;try{$e=1,Mh(l,c,d,m)}finally{$e=y,Es.transition=b}}function qA(l,c,d,m){var y=$e,b=Es.transition;Es.transition=null;try{$e=4,Mh(l,c,d,m)}finally{$e=y,Es.transition=b}}function Mh(l,c,d,m){if(nc){var y=Nh(l,c,d,m);if(y===null)Zh(l,c,m,rc,d),Iy(l,m);else if(HA(y,l,c,d,m))m.stopPropagation();else if(Iy(l,m),c&4&&-1<WA.indexOf(l)){for(;y!==null;){var b=ga(y);if(b!==null&&Ey(b),b=Nh(l,c,d,m),b===null&&Zh(l,c,m,rc,d),b===y)break;y=b}y!==null&&m.stopPropagation()}else Zh(l,c,m,null,d)}}var rc=null;function Nh(l,c,d,m){if(rc=null,l=wh(m),l=Mi(l),l!==null)if(c=Pi(l),c===null)l=null;else if(d=c.tag,d===13){if(l=gy(c),l!==null)return l;l=null}else if(d===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;l=null}else c!==l&&(l=null);return rc=l,null}function My(l){switch(l){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(DA()){case Ah:return 1;case wy:return 4;case Kl:case FA:return 16;case xy:return 536870912;default:return 16}default:return 16}}var Yr=null,Oh=null,ic=null;function Ny(){if(ic)return ic;var l,c=Oh,d=c.length,m,y="value"in Yr?Yr.value:Yr.textContent,b=y.length;for(l=0;l<d&&c[l]===y[l];l++);var S=d-l;for(m=1;m<=S&&c[d-m]===y[b-m];m++);return ic=y.slice(l,1<m?1-m:void 0)}function sc(l){var c=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&c===13&&(l=13)):l=c,l===10&&(l=13),32<=l||l===13?l:0}function oc(){return!0}function Oy(){return!1}function Zt(l){function c(d,m,y,b,S){this._reactName=d,this._targetInst=y,this.type=m,this.nativeEvent=b,this.target=S,this.currentTarget=null;for(var O in l)l.hasOwnProperty(O)&&(d=l[O],this[O]=d?d(b):b[O]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?oc:Oy,this.isPropagationStopped=Oy,this}return ee(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=oc)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=oc)},persist:function(){},isPersistent:oc}),c}var As={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dh=Zt(As),ia=ee({},As,{view:0,detail:0}),KA=Zt(ia),Fh,Lh,sa,ac=ee({},ia,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uh,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==sa&&(sa&&l.type==="mousemove"?(Fh=l.screenX-sa.screenX,Lh=l.screenY-sa.screenY):Lh=Fh=0,sa=l),Fh)},movementY:function(l){return"movementY"in l?l.movementY:Lh}}),Dy=Zt(ac),ZA=ee({},ac,{dataTransfer:0}),QA=Zt(ZA),JA=ee({},ia,{relatedTarget:0}),Bh=Zt(JA),GA=ee({},As,{animationName:0,elapsedTime:0,pseudoElement:0}),eC=Zt(GA),tC=ee({},As,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),nC=Zt(tC),rC=ee({},As,{data:0}),Fy=Zt(rC),iC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aC(l){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(l):(l=oC[l])?!!c[l]:!1}function Uh(){return aC}var lC=ee({},ia,{key:function(l){if(l.key){var c=iC[l.key]||l.key;if(c!=="Unidentified")return c}return l.type==="keypress"?(l=sc(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?sC[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uh,charCode:function(l){return l.type==="keypress"?sc(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?sc(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),cC=Zt(lC),uC=ee({},ac,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ly=Zt(uC),fC=ee({},ia,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uh}),hC=Zt(fC),dC=ee({},As,{propertyName:0,elapsedTime:0,pseudoElement:0}),pC=Zt(dC),gC=ee({},ac,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),mC=Zt(gC),_C=[9,13,27,32],jh=a&&"CompositionEvent"in window,oa=null;a&&"documentMode"in document&&(oa=document.documentMode);var yC=a&&"TextEvent"in window&&!oa,By=a&&(!jh||oa&&8<oa&&11>=oa),Uy=" ",jy=!1;function zy(l,c){switch(l){case"keyup":return _C.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vy(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Cs=!1;function vC(l,c){switch(l){case"compositionend":return Vy(c);case"keypress":return c.which!==32?null:(jy=!0,Uy);case"textInput":return l=c.data,l===Uy&&jy?null:l;default:return null}}function bC(l,c){if(Cs)return l==="compositionend"||!jh&&zy(l,c)?(l=Ny(),ic=Oh=Yr=null,Cs=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return By&&c.locale!=="ko"?null:c.data;default:return null}}var wC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $y(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c==="input"?!!wC[l.type]:c==="textarea"}function Wy(l,c,d,m){uy(m),c=hc(c,"onChange"),0<c.length&&(d=new Dh("onChange","change",null,d,m),l.push({event:d,listeners:c}))}var aa=null,la=null;function xC(l){l0(l,0)}function lc(l){var c=Ms(l);if(hr(c))return l}function TC(l,c){if(l==="change")return c}var Hy=!1;if(a){var zh;if(a){var Vh="oninput"in document;if(!Vh){var Xy=document.createElement("div");Xy.setAttribute("oninput","return;"),Vh=typeof Xy.oninput=="function"}zh=Vh}else zh=!1;Hy=zh&&(!document.documentMode||9<document.documentMode)}function Yy(){aa&&(aa.detachEvent("onpropertychange",qy),la=aa=null)}function qy(l){if(l.propertyName==="value"&&lc(la)){var c=[];Wy(c,la,l,wh(l)),py(xC,c)}}function SC(l,c,d){l==="focusin"?(Yy(),aa=c,la=d,aa.attachEvent("onpropertychange",qy)):l==="focusout"&&Yy()}function EC(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return lc(la)}function AC(l,c){if(l==="click")return lc(c)}function CC(l,c){if(l==="input"||l==="change")return lc(c)}function RC(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var Rn=typeof Object.is=="function"?Object.is:RC;function ca(l,c){if(Rn(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var d=Object.keys(l),m=Object.keys(c);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var y=d[m];if(!u.call(c,y)||!Rn(l[y],c[y]))return!1}return!0}function Ky(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function Zy(l,c){var d=Ky(l);l=0;for(var m;d;){if(d.nodeType===3){if(m=l+d.textContent.length,l<=c&&m>=c)return{node:d,offset:c-l};l=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Ky(d)}}function Qy(l,c){return l&&c?l===c?!0:l&&l.nodeType===3?!1:c&&c.nodeType===3?Qy(l,c.parentNode):"contains"in l?l.contains(c):l.compareDocumentPosition?!!(l.compareDocumentPosition(c)&16):!1:!1}function Jy(){for(var l=window,c=Vn();c instanceof l.HTMLIFrameElement;){try{var d=typeof c.contentWindow.location.href=="string"}catch{d=!1}if(d)l=c.contentWindow;else break;c=Vn(l.document)}return c}function $h(l){var c=l&&l.nodeName&&l.nodeName.toLowerCase();return c&&(c==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||c==="textarea"||l.contentEditable==="true")}function IC(l){var c=Jy(),d=l.focusedElem,m=l.selectionRange;if(c!==d&&d&&d.ownerDocument&&Qy(d.ownerDocument.documentElement,d)){if(m!==null&&$h(d)){if(c=m.start,l=m.end,l===void 0&&(l=c),"selectionStart"in d)d.selectionStart=c,d.selectionEnd=Math.min(l,d.value.length);else if(l=(c=d.ownerDocument||document)&&c.defaultView||window,l.getSelection){l=l.getSelection();var y=d.textContent.length,b=Math.min(m.start,y);m=m.end===void 0?b:Math.min(m.end,y),!l.extend&&b>m&&(y=m,m=b,b=y),y=Zy(d,b);var S=Zy(d,m);y&&S&&(l.rangeCount!==1||l.anchorNode!==y.node||l.anchorOffset!==y.offset||l.focusNode!==S.node||l.focusOffset!==S.offset)&&(c=c.createRange(),c.setStart(y.node,y.offset),l.removeAllRanges(),b>m?(l.addRange(c),l.extend(S.node,S.offset)):(c.setEnd(S.node,S.offset),l.addRange(c)))}}for(c=[],l=d;l=l.parentNode;)l.nodeType===1&&c.push({element:l,left:l.scrollLeft,top:l.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<c.length;d++)l=c[d],l.element.scrollLeft=l.left,l.element.scrollTop=l.top}}var kC=a&&"documentMode"in document&&11>=document.documentMode,Rs=null,Wh=null,ua=null,Hh=!1;function Gy(l,c,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Hh||Rs==null||Rs!==Vn(m)||(m=Rs,"selectionStart"in m&&$h(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),ua&&ca(ua,m)||(ua=m,m=hc(Wh,"onSelect"),0<m.length&&(c=new Dh("onSelect","select",null,c,d),l.push({event:c,listeners:m}),c.target=Rs)))}function cc(l,c){var d={};return d[l.toLowerCase()]=c.toLowerCase(),d["Webkit"+l]="webkit"+c,d["Moz"+l]="moz"+c,d}var Is={animationend:cc("Animation","AnimationEnd"),animationiteration:cc("Animation","AnimationIteration"),animationstart:cc("Animation","AnimationStart"),transitionend:cc("Transition","TransitionEnd")},Xh={},e0={};a&&(e0=document.createElement("div").style,"AnimationEvent"in window||(delete Is.animationend.animation,delete Is.animationiteration.animation,delete Is.animationstart.animation),"TransitionEvent"in window||delete Is.transitionend.transition);function uc(l){if(Xh[l])return Xh[l];if(!Is[l])return l;var c=Is[l],d;for(d in c)if(c.hasOwnProperty(d)&&d in e0)return Xh[l]=c[d];return l}var t0=uc("animationend"),n0=uc("animationiteration"),r0=uc("animationstart"),i0=uc("transitionend"),s0=new Map,o0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qr(l,c){s0.set(l,c),s(c,[l])}for(var Yh=0;Yh<o0.length;Yh++){var qh=o0[Yh],PC=qh.toLowerCase(),MC=qh[0].toUpperCase()+qh.slice(1);qr(PC,"on"+MC)}qr(t0,"onAnimationEnd"),qr(n0,"onAnimationIteration"),qr(r0,"onAnimationStart"),qr("dblclick","onDoubleClick"),qr("focusin","onFocus"),qr("focusout","onBlur"),qr(i0,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NC=new Set("cancel close invalid load scroll toggle".split(" ").concat(fa));function a0(l,c,d){var m=l.type||"unknown-event";l.currentTarget=d,PA(m,c,void 0,l),l.currentTarget=null}function l0(l,c){c=(c&4)!==0;for(var d=0;d<l.length;d++){var m=l[d],y=m.event;m=m.listeners;e:{var b=void 0;if(c)for(var S=m.length-1;0<=S;S--){var O=m[S],F=O.instance,J=O.currentTarget;if(O=O.listener,F!==b&&y.isPropagationStopped())break e;a0(y,O,J),b=F}else for(S=0;S<m.length;S++){if(O=m[S],F=O.instance,J=O.currentTarget,O=O.listener,F!==b&&y.isPropagationStopped())break e;a0(y,O,J),b=F}}}if(ql)throw l=Eh,ql=!1,Eh=null,l}function Ze(l,c){var d=c[nd];d===void 0&&(d=c[nd]=new Set);var m=l+"__bubble";d.has(m)||(c0(c,l,2,!1),d.add(m))}function Kh(l,c,d){var m=0;c&&(m|=4),c0(d,l,m,c)}var fc="_reactListening"+Math.random().toString(36).slice(2);function ha(l){if(!l[fc]){l[fc]=!0,r.forEach(function(d){d!=="selectionchange"&&(NC.has(d)||Kh(d,!1,l),Kh(d,!0,l))});var c=l.nodeType===9?l:l.ownerDocument;c===null||c[fc]||(c[fc]=!0,Kh("selectionchange",!1,c))}}function c0(l,c,d,m){switch(My(c)){case 1:var y=YA;break;case 4:y=qA;break;default:y=Mh}d=y.bind(null,c,d,l),y=void 0,!Sh||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(y=!0),m?y!==void 0?l.addEventListener(c,d,{capture:!0,passive:y}):l.addEventListener(c,d,!0):y!==void 0?l.addEventListener(c,d,{passive:y}):l.addEventListener(c,d,!1)}function Zh(l,c,d,m,y){var b=m;if((c&1)===0&&(c&2)===0&&m!==null)e:for(;;){if(m===null)return;var S=m.tag;if(S===3||S===4){var O=m.stateNode.containerInfo;if(O===y||O.nodeType===8&&O.parentNode===y)break;if(S===4)for(S=m.return;S!==null;){var F=S.tag;if((F===3||F===4)&&(F=S.stateNode.containerInfo,F===y||F.nodeType===8&&F.parentNode===y))return;S=S.return}for(;O!==null;){if(S=Mi(O),S===null)return;if(F=S.tag,F===5||F===6){m=b=S;continue e}O=O.parentNode}}m=m.return}py(function(){var J=b,le=wh(d),ue=[];e:{var ae=s0.get(l);if(ae!==void 0){var _e=Dh,ve=l;switch(l){case"keypress":if(sc(d)===0)break e;case"keydown":case"keyup":_e=cC;break;case"focusin":ve="focus",_e=Bh;break;case"focusout":ve="blur",_e=Bh;break;case"beforeblur":case"afterblur":_e=Bh;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=Dy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=QA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=hC;break;case t0:case n0:case r0:_e=eC;break;case i0:_e=pC;break;case"scroll":_e=KA;break;case"wheel":_e=mC;break;case"copy":case"cut":case"paste":_e=nC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=Ly}var be=(c&4)!==0,ft=!be&&l==="scroll",K=be?ae!==null?ae+"Capture":null:ae;be=[];for(var U=J,Q;U!==null;){Q=U;var de=Q.stateNode;if(Q.tag===5&&de!==null&&(Q=de,K!==null&&(de=qo(U,K),de!=null&&be.push(da(U,de,Q)))),ft)break;U=U.return}0<be.length&&(ae=new _e(ae,ve,null,d,le),ue.push({event:ae,listeners:be}))}}if((c&7)===0){e:{if(ae=l==="mouseover"||l==="pointerover",_e=l==="mouseout"||l==="pointerout",ae&&d!==bh&&(ve=d.relatedTarget||d.fromElement)&&(Mi(ve)||ve[mr]))break e;if((_e||ae)&&(ae=le.window===le?le:(ae=le.ownerDocument)?ae.defaultView||ae.parentWindow:window,_e?(ve=d.relatedTarget||d.toElement,_e=J,ve=ve?Mi(ve):null,ve!==null&&(ft=Pi(ve),ve!==ft||ve.tag!==5&&ve.tag!==6)&&(ve=null)):(_e=null,ve=J),_e!==ve)){if(be=Dy,de="onMouseLeave",K="onMouseEnter",U="mouse",(l==="pointerout"||l==="pointerover")&&(be=Ly,de="onPointerLeave",K="onPointerEnter",U="pointer"),ft=_e==null?ae:Ms(_e),Q=ve==null?ae:Ms(ve),ae=new be(de,U+"leave",_e,d,le),ae.target=ft,ae.relatedTarget=Q,de=null,Mi(le)===J&&(be=new be(K,U+"enter",ve,d,le),be.target=Q,be.relatedTarget=ft,de=be),ft=de,_e&&ve)t:{for(be=_e,K=ve,U=0,Q=be;Q;Q=ks(Q))U++;for(Q=0,de=K;de;de=ks(de))Q++;for(;0<U-Q;)be=ks(be),U--;for(;0<Q-U;)K=ks(K),Q--;for(;U--;){if(be===K||K!==null&&be===K.alternate)break t;be=ks(be),K=ks(K)}be=null}else be=null;_e!==null&&u0(ue,ae,_e,be,!1),ve!==null&&ft!==null&&u0(ue,ft,ve,be,!0)}}e:{if(ae=J?Ms(J):window,_e=ae.nodeName&&ae.nodeName.toLowerCase(),_e==="select"||_e==="input"&&ae.type==="file")var we=TC;else if($y(ae))if(Hy)we=CC;else{we=EC;var Ee=SC}else(_e=ae.nodeName)&&_e.toLowerCase()==="input"&&(ae.type==="checkbox"||ae.type==="radio")&&(we=AC);if(we&&(we=we(l,J))){Wy(ue,we,d,le);break e}Ee&&Ee(l,ae,J),l==="focusout"&&(Ee=ae._wrapperState)&&Ee.controlled&&ae.type==="number"&&Yo(ae,"number",ae.value)}switch(Ee=J?Ms(J):window,l){case"focusin":($y(Ee)||Ee.contentEditable==="true")&&(Rs=Ee,Wh=J,ua=null);break;case"focusout":ua=Wh=Rs=null;break;case"mousedown":Hh=!0;break;case"contextmenu":case"mouseup":case"dragend":Hh=!1,Gy(ue,d,le);break;case"selectionchange":if(kC)break;case"keydown":case"keyup":Gy(ue,d,le)}var Ae;if(jh)e:{switch(l){case"compositionstart":var Ie="onCompositionStart";break e;case"compositionend":Ie="onCompositionEnd";break e;case"compositionupdate":Ie="onCompositionUpdate";break e}Ie=void 0}else Cs?zy(l,d)&&(Ie="onCompositionEnd"):l==="keydown"&&d.keyCode===229&&(Ie="onCompositionStart");Ie&&(By&&d.locale!=="ko"&&(Cs||Ie!=="onCompositionStart"?Ie==="onCompositionEnd"&&Cs&&(Ae=Ny()):(Yr=le,Oh="value"in Yr?Yr.value:Yr.textContent,Cs=!0)),Ee=hc(J,Ie),0<Ee.length&&(Ie=new Fy(Ie,l,null,d,le),ue.push({event:Ie,listeners:Ee}),Ae?Ie.data=Ae:(Ae=Vy(d),Ae!==null&&(Ie.data=Ae)))),(Ae=yC?vC(l,d):bC(l,d))&&(J=hc(J,"onBeforeInput"),0<J.length&&(le=new Fy("onBeforeInput","beforeinput",null,d,le),ue.push({event:le,listeners:J}),le.data=Ae))}l0(ue,c)})}function da(l,c,d){return{instance:l,listener:c,currentTarget:d}}function hc(l,c){for(var d=c+"Capture",m=[];l!==null;){var y=l,b=y.stateNode;y.tag===5&&b!==null&&(y=b,b=qo(l,d),b!=null&&m.unshift(da(l,b,y)),b=qo(l,c),b!=null&&m.push(da(l,b,y))),l=l.return}return m}function ks(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5);return l||null}function u0(l,c,d,m,y){for(var b=c._reactName,S=[];d!==null&&d!==m;){var O=d,F=O.alternate,J=O.stateNode;if(F!==null&&F===m)break;O.tag===5&&J!==null&&(O=J,y?(F=qo(d,b),F!=null&&S.unshift(da(d,F,O))):y||(F=qo(d,b),F!=null&&S.push(da(d,F,O)))),d=d.return}S.length!==0&&l.push({event:c,listeners:S})}var OC=/\r\n?/g,DC=/\u0000|\uFFFD/g;function f0(l){return(typeof l=="string"?l:""+l).replace(OC,`
`).replace(DC,"")}function dc(l,c,d){if(c=f0(c),f0(l)!==c&&d)throw Error(n(425))}function pc(){}var Qh=null,Jh=null;function Gh(l,c){return l==="textarea"||l==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var ed=typeof setTimeout=="function"?setTimeout:void 0,FC=typeof clearTimeout=="function"?clearTimeout:void 0,h0=typeof Promise=="function"?Promise:void 0,LC=typeof queueMicrotask=="function"?queueMicrotask:typeof h0<"u"?function(l){return h0.resolve(null).then(l).catch(BC)}:ed;function BC(l){setTimeout(function(){throw l})}function td(l,c){var d=c,m=0;do{var y=d.nextSibling;if(l.removeChild(d),y&&y.nodeType===8)if(d=y.data,d==="/$"){if(m===0){l.removeChild(y),ra(c);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=y}while(d);ra(c)}function Kr(l){for(;l!=null;l=l.nextSibling){var c=l.nodeType;if(c===1||c===3)break;if(c===8){if(c=l.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return l}function d0(l){l=l.previousSibling;for(var c=0;l;){if(l.nodeType===8){var d=l.data;if(d==="$"||d==="$!"||d==="$?"){if(c===0)return l;c--}else d==="/$"&&c++}l=l.previousSibling}return null}var Ps=Math.random().toString(36).slice(2),Wn="__reactFiber$"+Ps,pa="__reactProps$"+Ps,mr="__reactContainer$"+Ps,nd="__reactEvents$"+Ps,UC="__reactListeners$"+Ps,jC="__reactHandles$"+Ps;function Mi(l){var c=l[Wn];if(c)return c;for(var d=l.parentNode;d;){if(c=d[mr]||d[Wn]){if(d=c.alternate,c.child!==null||d!==null&&d.child!==null)for(l=d0(l);l!==null;){if(d=l[Wn])return d;l=d0(l)}return c}l=d,d=l.parentNode}return null}function ga(l){return l=l[Wn]||l[mr],!l||l.tag!==5&&l.tag!==6&&l.tag!==13&&l.tag!==3?null:l}function Ms(l){if(l.tag===5||l.tag===6)return l.stateNode;throw Error(n(33))}function gc(l){return l[pa]||null}var rd=[],Ns=-1;function Zr(l){return{current:l}}function Qe(l){0>Ns||(l.current=rd[Ns],rd[Ns]=null,Ns--)}function Ye(l,c){Ns++,rd[Ns]=l.current,l.current=c}var Qr={},It=Zr(Qr),Vt=Zr(!1),Ni=Qr;function Os(l,c){var d=l.type.contextTypes;if(!d)return Qr;var m=l.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===c)return m.__reactInternalMemoizedMaskedChildContext;var y={},b;for(b in d)y[b]=c[b];return m&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=y),y}function $t(l){return l=l.childContextTypes,l!=null}function mc(){Qe(Vt),Qe(It)}function p0(l,c,d){if(It.current!==Qr)throw Error(n(168));Ye(It,c),Ye(Vt,d)}function g0(l,c,d){var m=l.stateNode;if(c=c.childContextTypes,typeof m.getChildContext!="function")return d;m=m.getChildContext();for(var y in m)if(!(y in c))throw Error(n(108,Se(l)||"Unknown",y));return ee({},d,m)}function _c(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Qr,Ni=It.current,Ye(It,l),Ye(Vt,Vt.current),!0}function m0(l,c,d){var m=l.stateNode;if(!m)throw Error(n(169));d?(l=g0(l,c,Ni),m.__reactInternalMemoizedMergedChildContext=l,Qe(Vt),Qe(It),Ye(It,l)):Qe(Vt),Ye(Vt,d)}var _r=null,yc=!1,id=!1;function _0(l){_r===null?_r=[l]:_r.push(l)}function zC(l){yc=!0,_0(l)}function Jr(){if(!id&&_r!==null){id=!0;var l=0,c=$e;try{var d=_r;for($e=1;l<d.length;l++){var m=d[l];do m=m(!0);while(m!==null)}_r=null,yc=!1}catch(y){throw _r!==null&&(_r=_r.slice(l+1)),vy(Ah,Jr),y}finally{$e=c,id=!1}}return null}var Ds=[],Fs=0,vc=null,bc=0,ln=[],cn=0,Oi=null,yr=1,vr="";function Di(l,c){Ds[Fs++]=bc,Ds[Fs++]=vc,vc=l,bc=c}function y0(l,c,d){ln[cn++]=yr,ln[cn++]=vr,ln[cn++]=Oi,Oi=l;var m=yr;l=vr;var y=32-Cn(m)-1;m&=~(1<<y),d+=1;var b=32-Cn(c)+y;if(30<b){var S=y-y%5;b=(m&(1<<S)-1).toString(32),m>>=S,y-=S,yr=1<<32-Cn(c)+y|d<<y|m,vr=b+l}else yr=1<<b|d<<y|m,vr=l}function sd(l){l.return!==null&&(Di(l,1),y0(l,1,0))}function od(l){for(;l===vc;)vc=Ds[--Fs],Ds[Fs]=null,bc=Ds[--Fs],Ds[Fs]=null;for(;l===Oi;)Oi=ln[--cn],ln[cn]=null,vr=ln[--cn],ln[cn]=null,yr=ln[--cn],ln[cn]=null}var Qt=null,Jt=null,Ge=!1,In=null;function v0(l,c){var d=dn(5,null,null,0);d.elementType="DELETED",d.stateNode=c,d.return=l,c=l.deletions,c===null?(l.deletions=[d],l.flags|=16):c.push(d)}function b0(l,c){switch(l.tag){case 5:var d=l.type;return c=c.nodeType!==1||d.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(l.stateNode=c,Qt=l,Jt=Kr(c.firstChild),!0):!1;case 6:return c=l.pendingProps===""||c.nodeType!==3?null:c,c!==null?(l.stateNode=c,Qt=l,Jt=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(d=Oi!==null?{id:yr,overflow:vr}:null,l.memoizedState={dehydrated:c,treeContext:d,retryLane:1073741824},d=dn(18,null,null,0),d.stateNode=c,d.return=l,l.child=d,Qt=l,Jt=null,!0):!1;default:return!1}}function ad(l){return(l.mode&1)!==0&&(l.flags&128)===0}function ld(l){if(Ge){var c=Jt;if(c){var d=c;if(!b0(l,c)){if(ad(l))throw Error(n(418));c=Kr(d.nextSibling);var m=Qt;c&&b0(l,c)?v0(m,d):(l.flags=l.flags&-4097|2,Ge=!1,Qt=l)}}else{if(ad(l))throw Error(n(418));l.flags=l.flags&-4097|2,Ge=!1,Qt=l}}}function w0(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Qt=l}function wc(l){if(l!==Qt)return!1;if(!Ge)return w0(l),Ge=!0,!1;var c;if((c=l.tag!==3)&&!(c=l.tag!==5)&&(c=l.type,c=c!=="head"&&c!=="body"&&!Gh(l.type,l.memoizedProps)),c&&(c=Jt)){if(ad(l))throw x0(),Error(n(418));for(;c;)v0(l,c),c=Kr(c.nextSibling)}if(w0(l),l.tag===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));e:{for(l=l.nextSibling,c=0;l;){if(l.nodeType===8){var d=l.data;if(d==="/$"){if(c===0){Jt=Kr(l.nextSibling);break e}c--}else d!=="$"&&d!=="$!"&&d!=="$?"||c++}l=l.nextSibling}Jt=null}}else Jt=Qt?Kr(l.stateNode.nextSibling):null;return!0}function x0(){for(var l=Jt;l;)l=Kr(l.nextSibling)}function Ls(){Jt=Qt=null,Ge=!1}function cd(l){In===null?In=[l]:In.push(l)}var VC=R.ReactCurrentBatchConfig;function ma(l,c,d){if(l=d.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(n(309));var m=d.stateNode}if(!m)throw Error(n(147,l));var y=m,b=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===b?c.ref:(c=function(S){var O=y.refs;S===null?delete O[b]:O[b]=S},c._stringRef=b,c)}if(typeof l!="string")throw Error(n(284));if(!d._owner)throw Error(n(290,l))}return l}function xc(l,c){throw l=Object.prototype.toString.call(c),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function T0(l){var c=l._init;return c(l._payload)}function S0(l){function c(K,U){if(l){var Q=K.deletions;Q===null?(K.deletions=[U],K.flags|=16):Q.push(U)}}function d(K,U){if(!l)return null;for(;U!==null;)c(K,U),U=U.sibling;return null}function m(K,U){for(K=new Map;U!==null;)U.key!==null?K.set(U.key,U):K.set(U.index,U),U=U.sibling;return K}function y(K,U){return K=oi(K,U),K.index=0,K.sibling=null,K}function b(K,U,Q){return K.index=Q,l?(Q=K.alternate,Q!==null?(Q=Q.index,Q<U?(K.flags|=2,U):Q):(K.flags|=2,U)):(K.flags|=1048576,U)}function S(K){return l&&K.alternate===null&&(K.flags|=2),K}function O(K,U,Q,de){return U===null||U.tag!==6?(U=ep(Q,K.mode,de),U.return=K,U):(U=y(U,Q),U.return=K,U)}function F(K,U,Q,de){var we=Q.type;return we===L?le(K,U,Q.props.children,de,Q.key):U!==null&&(U.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===ce&&T0(we)===U.type)?(de=y(U,Q.props),de.ref=ma(K,U,Q),de.return=K,de):(de=Xc(Q.type,Q.key,Q.props,null,K.mode,de),de.ref=ma(K,U,Q),de.return=K,de)}function J(K,U,Q,de){return U===null||U.tag!==4||U.stateNode.containerInfo!==Q.containerInfo||U.stateNode.implementation!==Q.implementation?(U=tp(Q,K.mode,de),U.return=K,U):(U=y(U,Q.children||[]),U.return=K,U)}function le(K,U,Q,de,we){return U===null||U.tag!==7?(U=$i(Q,K.mode,de,we),U.return=K,U):(U=y(U,Q),U.return=K,U)}function ue(K,U,Q){if(typeof U=="string"&&U!==""||typeof U=="number")return U=ep(""+U,K.mode,Q),U.return=K,U;if(typeof U=="object"&&U!==null){switch(U.$$typeof){case k:return Q=Xc(U.type,U.key,U.props,null,K.mode,Q),Q.ref=ma(K,null,U),Q.return=K,Q;case M:return U=tp(U,K.mode,Q),U.return=K,U;case ce:var de=U._init;return ue(K,de(U._payload),Q)}if(Ci(U)||ne(U))return U=$i(U,K.mode,Q,null),U.return=K,U;xc(K,U)}return null}function ae(K,U,Q,de){var we=U!==null?U.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number")return we!==null?null:O(K,U,""+Q,de);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case k:return Q.key===we?F(K,U,Q,de):null;case M:return Q.key===we?J(K,U,Q,de):null;case ce:return we=Q._init,ae(K,U,we(Q._payload),de)}if(Ci(Q)||ne(Q))return we!==null?null:le(K,U,Q,de,null);xc(K,Q)}return null}function _e(K,U,Q,de,we){if(typeof de=="string"&&de!==""||typeof de=="number")return K=K.get(Q)||null,O(U,K,""+de,we);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case k:return K=K.get(de.key===null?Q:de.key)||null,F(U,K,de,we);case M:return K=K.get(de.key===null?Q:de.key)||null,J(U,K,de,we);case ce:var Ee=de._init;return _e(K,U,Q,Ee(de._payload),we)}if(Ci(de)||ne(de))return K=K.get(Q)||null,le(U,K,de,we,null);xc(U,de)}return null}function ve(K,U,Q,de){for(var we=null,Ee=null,Ae=U,Ie=U=0,Tt=null;Ae!==null&&Ie<Q.length;Ie++){Ae.index>Ie?(Tt=Ae,Ae=null):Tt=Ae.sibling;var Ue=ae(K,Ae,Q[Ie],de);if(Ue===null){Ae===null&&(Ae=Tt);break}l&&Ae&&Ue.alternate===null&&c(K,Ae),U=b(Ue,U,Ie),Ee===null?we=Ue:Ee.sibling=Ue,Ee=Ue,Ae=Tt}if(Ie===Q.length)return d(K,Ae),Ge&&Di(K,Ie),we;if(Ae===null){for(;Ie<Q.length;Ie++)Ae=ue(K,Q[Ie],de),Ae!==null&&(U=b(Ae,U,Ie),Ee===null?we=Ae:Ee.sibling=Ae,Ee=Ae);return Ge&&Di(K,Ie),we}for(Ae=m(K,Ae);Ie<Q.length;Ie++)Tt=_e(Ae,K,Ie,Q[Ie],de),Tt!==null&&(l&&Tt.alternate!==null&&Ae.delete(Tt.key===null?Ie:Tt.key),U=b(Tt,U,Ie),Ee===null?we=Tt:Ee.sibling=Tt,Ee=Tt);return l&&Ae.forEach(function(ai){return c(K,ai)}),Ge&&Di(K,Ie),we}function be(K,U,Q,de){var we=ne(Q);if(typeof we!="function")throw Error(n(150));if(Q=we.call(Q),Q==null)throw Error(n(151));for(var Ee=we=null,Ae=U,Ie=U=0,Tt=null,Ue=Q.next();Ae!==null&&!Ue.done;Ie++,Ue=Q.next()){Ae.index>Ie?(Tt=Ae,Ae=null):Tt=Ae.sibling;var ai=ae(K,Ae,Ue.value,de);if(ai===null){Ae===null&&(Ae=Tt);break}l&&Ae&&ai.alternate===null&&c(K,Ae),U=b(ai,U,Ie),Ee===null?we=ai:Ee.sibling=ai,Ee=ai,Ae=Tt}if(Ue.done)return d(K,Ae),Ge&&Di(K,Ie),we;if(Ae===null){for(;!Ue.done;Ie++,Ue=Q.next())Ue=ue(K,Ue.value,de),Ue!==null&&(U=b(Ue,U,Ie),Ee===null?we=Ue:Ee.sibling=Ue,Ee=Ue);return Ge&&Di(K,Ie),we}for(Ae=m(K,Ae);!Ue.done;Ie++,Ue=Q.next())Ue=_e(Ae,K,Ie,Ue.value,de),Ue!==null&&(l&&Ue.alternate!==null&&Ae.delete(Ue.key===null?Ie:Ue.key),U=b(Ue,U,Ie),Ee===null?we=Ue:Ee.sibling=Ue,Ee=Ue);return l&&Ae.forEach(function(wR){return c(K,wR)}),Ge&&Di(K,Ie),we}function ft(K,U,Q,de){if(typeof Q=="object"&&Q!==null&&Q.type===L&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case k:e:{for(var we=Q.key,Ee=U;Ee!==null;){if(Ee.key===we){if(we=Q.type,we===L){if(Ee.tag===7){d(K,Ee.sibling),U=y(Ee,Q.props.children),U.return=K,K=U;break e}}else if(Ee.elementType===we||typeof we=="object"&&we!==null&&we.$$typeof===ce&&T0(we)===Ee.type){d(K,Ee.sibling),U=y(Ee,Q.props),U.ref=ma(K,Ee,Q),U.return=K,K=U;break e}d(K,Ee);break}else c(K,Ee);Ee=Ee.sibling}Q.type===L?(U=$i(Q.props.children,K.mode,de,Q.key),U.return=K,K=U):(de=Xc(Q.type,Q.key,Q.props,null,K.mode,de),de.ref=ma(K,U,Q),de.return=K,K=de)}return S(K);case M:e:{for(Ee=Q.key;U!==null;){if(U.key===Ee)if(U.tag===4&&U.stateNode.containerInfo===Q.containerInfo&&U.stateNode.implementation===Q.implementation){d(K,U.sibling),U=y(U,Q.children||[]),U.return=K,K=U;break e}else{d(K,U);break}else c(K,U);U=U.sibling}U=tp(Q,K.mode,de),U.return=K,K=U}return S(K);case ce:return Ee=Q._init,ft(K,U,Ee(Q._payload),de)}if(Ci(Q))return ve(K,U,Q,de);if(ne(Q))return be(K,U,Q,de);xc(K,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"?(Q=""+Q,U!==null&&U.tag===6?(d(K,U.sibling),U=y(U,Q),U.return=K,K=U):(d(K,U),U=ep(Q,K.mode,de),U.return=K,K=U),S(K)):d(K,U)}return ft}var Bs=S0(!0),E0=S0(!1),Tc=Zr(null),Sc=null,Us=null,ud=null;function fd(){ud=Us=Sc=null}function hd(l){var c=Tc.current;Qe(Tc),l._currentValue=c}function dd(l,c,d){for(;l!==null;){var m=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,m!==null&&(m.childLanes|=c)):m!==null&&(m.childLanes&c)!==c&&(m.childLanes|=c),l===d)break;l=l.return}}function js(l,c){Sc=l,ud=Us=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&c)!==0&&(Wt=!0),l.firstContext=null)}function un(l){var c=l._currentValue;if(ud!==l)if(l={context:l,memoizedValue:c,next:null},Us===null){if(Sc===null)throw Error(n(308));Us=l,Sc.dependencies={lanes:0,firstContext:l}}else Us=Us.next=l;return c}var Fi=null;function pd(l){Fi===null?Fi=[l]:Fi.push(l)}function A0(l,c,d,m){var y=c.interleaved;return y===null?(d.next=d,pd(c)):(d.next=y.next,y.next=d),c.interleaved=d,br(l,m)}function br(l,c){l.lanes|=c;var d=l.alternate;for(d!==null&&(d.lanes|=c),d=l,l=l.return;l!==null;)l.childLanes|=c,d=l.alternate,d!==null&&(d.childLanes|=c),d=l,l=l.return;return d.tag===3?d.stateNode:null}var Gr=!1;function gd(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function C0(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function wr(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function ei(l,c,d){var m=l.updateQueue;if(m===null)return null;if(m=m.shared,(Le&2)!==0){var y=m.pending;return y===null?c.next=c:(c.next=y.next,y.next=c),m.pending=c,br(l,d)}return y=m.interleaved,y===null?(c.next=c,pd(m)):(c.next=y.next,y.next=c),m.interleaved=c,br(l,d)}function Ec(l,c,d){if(c=c.updateQueue,c!==null&&(c=c.shared,(d&4194240)!==0)){var m=c.lanes;m&=l.pendingLanes,d|=m,c.lanes=d,Ih(l,d)}}function R0(l,c){var d=l.updateQueue,m=l.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var y=null,b=null;if(d=d.firstBaseUpdate,d!==null){do{var S={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};b===null?y=b=S:b=b.next=S,d=d.next}while(d!==null);b===null?y=b=c:b=b.next=c}else y=b=c;d={baseState:m.baseState,firstBaseUpdate:y,lastBaseUpdate:b,shared:m.shared,effects:m.effects},l.updateQueue=d;return}l=d.lastBaseUpdate,l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=c}function Ac(l,c,d,m){var y=l.updateQueue;Gr=!1;var b=y.firstBaseUpdate,S=y.lastBaseUpdate,O=y.shared.pending;if(O!==null){y.shared.pending=null;var F=O,J=F.next;F.next=null,S===null?b=J:S.next=J,S=F;var le=l.alternate;le!==null&&(le=le.updateQueue,O=le.lastBaseUpdate,O!==S&&(O===null?le.firstBaseUpdate=J:O.next=J,le.lastBaseUpdate=F))}if(b!==null){var ue=y.baseState;S=0,le=J=F=null,O=b;do{var ae=O.lane,_e=O.eventTime;if((m&ae)===ae){le!==null&&(le=le.next={eventTime:_e,lane:0,tag:O.tag,payload:O.payload,callback:O.callback,next:null});e:{var ve=l,be=O;switch(ae=c,_e=d,be.tag){case 1:if(ve=be.payload,typeof ve=="function"){ue=ve.call(_e,ue,ae);break e}ue=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=be.payload,ae=typeof ve=="function"?ve.call(_e,ue,ae):ve,ae==null)break e;ue=ee({},ue,ae);break e;case 2:Gr=!0}}O.callback!==null&&O.lane!==0&&(l.flags|=64,ae=y.effects,ae===null?y.effects=[O]:ae.push(O))}else _e={eventTime:_e,lane:ae,tag:O.tag,payload:O.payload,callback:O.callback,next:null},le===null?(J=le=_e,F=ue):le=le.next=_e,S|=ae;if(O=O.next,O===null){if(O=y.shared.pending,O===null)break;ae=O,O=ae.next,ae.next=null,y.lastBaseUpdate=ae,y.shared.pending=null}}while(!0);if(le===null&&(F=ue),y.baseState=F,y.firstBaseUpdate=J,y.lastBaseUpdate=le,c=y.shared.interleaved,c!==null){y=c;do S|=y.lane,y=y.next;while(y!==c)}else b===null&&(y.shared.lanes=0);Ui|=S,l.lanes=S,l.memoizedState=ue}}function I0(l,c,d){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var m=l[c],y=m.callback;if(y!==null){if(m.callback=null,m=d,typeof y!="function")throw Error(n(191,y));y.call(m)}}}var _a={},Hn=Zr(_a),ya=Zr(_a),va=Zr(_a);function Li(l){if(l===_a)throw Error(n(174));return l}function md(l,c){switch(Ye(va,c),Ye(ya,l),Ye(Hn,_a),l=c.nodeType,l){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:bs(null,"");break;default:l=l===8?c.parentNode:c,c=l.namespaceURI||null,l=l.tagName,c=bs(c,l)}Qe(Hn),Ye(Hn,c)}function zs(){Qe(Hn),Qe(ya),Qe(va)}function k0(l){Li(va.current);var c=Li(Hn.current),d=bs(c,l.type);c!==d&&(Ye(ya,l),Ye(Hn,d))}function _d(l){ya.current===l&&(Qe(Hn),Qe(ya))}var nt=Zr(0);function Cc(l){for(var c=l;c!==null;){if(c.tag===13){var d=c.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var yd=[];function vd(){for(var l=0;l<yd.length;l++)yd[l]._workInProgressVersionPrimary=null;yd.length=0}var Rc=R.ReactCurrentDispatcher,bd=R.ReactCurrentBatchConfig,Bi=0,rt=null,_t=null,wt=null,Ic=!1,ba=!1,wa=0,$C=0;function kt(){throw Error(n(321))}function wd(l,c){if(c===null)return!1;for(var d=0;d<c.length&&d<l.length;d++)if(!Rn(l[d],c[d]))return!1;return!0}function xd(l,c,d,m,y,b){if(Bi=b,rt=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Rc.current=l===null||l.memoizedState===null?YC:qC,l=d(m,y),ba){b=0;do{if(ba=!1,wa=0,25<=b)throw Error(n(301));b+=1,wt=_t=null,c.updateQueue=null,Rc.current=KC,l=d(m,y)}while(ba)}if(Rc.current=Mc,c=_t!==null&&_t.next!==null,Bi=0,wt=_t=rt=null,Ic=!1,c)throw Error(n(300));return l}function Td(){var l=wa!==0;return wa=0,l}function Xn(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?rt.memoizedState=wt=l:wt=wt.next=l,wt}function fn(){if(_t===null){var l=rt.alternate;l=l!==null?l.memoizedState:null}else l=_t.next;var c=wt===null?rt.memoizedState:wt.next;if(c!==null)wt=c,_t=l;else{if(l===null)throw Error(n(310));_t=l,l={memoizedState:_t.memoizedState,baseState:_t.baseState,baseQueue:_t.baseQueue,queue:_t.queue,next:null},wt===null?rt.memoizedState=wt=l:wt=wt.next=l}return wt}function xa(l,c){return typeof c=="function"?c(l):c}function Sd(l){var c=fn(),d=c.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=l;var m=_t,y=m.baseQueue,b=d.pending;if(b!==null){if(y!==null){var S=y.next;y.next=b.next,b.next=S}m.baseQueue=y=b,d.pending=null}if(y!==null){b=y.next,m=m.baseState;var O=S=null,F=null,J=b;do{var le=J.lane;if((Bi&le)===le)F!==null&&(F=F.next={lane:0,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),m=J.hasEagerState?J.eagerState:l(m,J.action);else{var ue={lane:le,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null};F===null?(O=F=ue,S=m):F=F.next=ue,rt.lanes|=le,Ui|=le}J=J.next}while(J!==null&&J!==b);F===null?S=m:F.next=O,Rn(m,c.memoizedState)||(Wt=!0),c.memoizedState=m,c.baseState=S,c.baseQueue=F,d.lastRenderedState=m}if(l=d.interleaved,l!==null){y=l;do b=y.lane,rt.lanes|=b,Ui|=b,y=y.next;while(y!==l)}else y===null&&(d.lanes=0);return[c.memoizedState,d.dispatch]}function Ed(l){var c=fn(),d=c.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=l;var m=d.dispatch,y=d.pending,b=c.memoizedState;if(y!==null){d.pending=null;var S=y=y.next;do b=l(b,S.action),S=S.next;while(S!==y);Rn(b,c.memoizedState)||(Wt=!0),c.memoizedState=b,c.baseQueue===null&&(c.baseState=b),d.lastRenderedState=b}return[b,m]}function P0(){}function M0(l,c){var d=rt,m=fn(),y=c(),b=!Rn(m.memoizedState,y);if(b&&(m.memoizedState=y,Wt=!0),m=m.queue,Ad(D0.bind(null,d,m,l),[l]),m.getSnapshot!==c||b||wt!==null&&wt.memoizedState.tag&1){if(d.flags|=2048,Ta(9,O0.bind(null,d,m,y,c),void 0,null),xt===null)throw Error(n(349));(Bi&30)!==0||N0(d,c,y)}return y}function N0(l,c,d){l.flags|=16384,l={getSnapshot:c,value:d},c=rt.updateQueue,c===null?(c={lastEffect:null,stores:null},rt.updateQueue=c,c.stores=[l]):(d=c.stores,d===null?c.stores=[l]:d.push(l))}function O0(l,c,d,m){c.value=d,c.getSnapshot=m,F0(c)&&L0(l)}function D0(l,c,d){return d(function(){F0(c)&&L0(l)})}function F0(l){var c=l.getSnapshot;l=l.value;try{var d=c();return!Rn(l,d)}catch{return!0}}function L0(l){var c=br(l,1);c!==null&&Nn(c,l,1,-1)}function B0(l){var c=Xn();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:l},c.queue=l,l=l.dispatch=XC.bind(null,rt,l),[c.memoizedState,l]}function Ta(l,c,d,m){return l={tag:l,create:c,destroy:d,deps:m,next:null},c=rt.updateQueue,c===null?(c={lastEffect:null,stores:null},rt.updateQueue=c,c.lastEffect=l.next=l):(d=c.lastEffect,d===null?c.lastEffect=l.next=l:(m=d.next,d.next=l,l.next=m,c.lastEffect=l)),l}function U0(){return fn().memoizedState}function kc(l,c,d,m){var y=Xn();rt.flags|=l,y.memoizedState=Ta(1|c,d,void 0,m===void 0?null:m)}function Pc(l,c,d,m){var y=fn();m=m===void 0?null:m;var b=void 0;if(_t!==null){var S=_t.memoizedState;if(b=S.destroy,m!==null&&wd(m,S.deps)){y.memoizedState=Ta(c,d,b,m);return}}rt.flags|=l,y.memoizedState=Ta(1|c,d,b,m)}function j0(l,c){return kc(8390656,8,l,c)}function Ad(l,c){return Pc(2048,8,l,c)}function z0(l,c){return Pc(4,2,l,c)}function V0(l,c){return Pc(4,4,l,c)}function $0(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function W0(l,c,d){return d=d!=null?d.concat([l]):null,Pc(4,4,$0.bind(null,c,l),d)}function Cd(){}function H0(l,c){var d=fn();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&wd(c,m[1])?m[0]:(d.memoizedState=[l,c],l)}function X0(l,c){var d=fn();c=c===void 0?null:c;var m=d.memoizedState;return m!==null&&c!==null&&wd(c,m[1])?m[0]:(l=l(),d.memoizedState=[l,c],l)}function Y0(l,c,d){return(Bi&21)===0?(l.baseState&&(l.baseState=!1,Wt=!0),l.memoizedState=d):(Rn(d,c)||(d=Ty(),rt.lanes|=d,Ui|=d,l.baseState=!0),c)}function WC(l,c){var d=$e;$e=d!==0&&4>d?d:4,l(!0);var m=bd.transition;bd.transition={};try{l(!1),c()}finally{$e=d,bd.transition=m}}function q0(){return fn().memoizedState}function HC(l,c,d){var m=ii(l);if(d={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null},K0(l))Z0(c,d);else if(d=A0(l,c,d,m),d!==null){var y=jt();Nn(d,l,m,y),Q0(d,c,m)}}function XC(l,c,d){var m=ii(l),y={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null};if(K0(l))Z0(c,y);else{var b=l.alternate;if(l.lanes===0&&(b===null||b.lanes===0)&&(b=c.lastRenderedReducer,b!==null))try{var S=c.lastRenderedState,O=b(S,d);if(y.hasEagerState=!0,y.eagerState=O,Rn(O,S)){var F=c.interleaved;F===null?(y.next=y,pd(c)):(y.next=F.next,F.next=y),c.interleaved=y;return}}catch{}finally{}d=A0(l,c,y,m),d!==null&&(y=jt(),Nn(d,l,m,y),Q0(d,c,m))}}function K0(l){var c=l.alternate;return l===rt||c!==null&&c===rt}function Z0(l,c){ba=Ic=!0;var d=l.pending;d===null?c.next=c:(c.next=d.next,d.next=c),l.pending=c}function Q0(l,c,d){if((d&4194240)!==0){var m=c.lanes;m&=l.pendingLanes,d|=m,c.lanes=d,Ih(l,d)}}var Mc={readContext:un,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},YC={readContext:un,useCallback:function(l,c){return Xn().memoizedState=[l,c===void 0?null:c],l},useContext:un,useEffect:j0,useImperativeHandle:function(l,c,d){return d=d!=null?d.concat([l]):null,kc(4194308,4,$0.bind(null,c,l),d)},useLayoutEffect:function(l,c){return kc(4194308,4,l,c)},useInsertionEffect:function(l,c){return kc(4,2,l,c)},useMemo:function(l,c){var d=Xn();return c=c===void 0?null:c,l=l(),d.memoizedState=[l,c],l},useReducer:function(l,c,d){var m=Xn();return c=d!==void 0?d(c):c,m.memoizedState=m.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},m.queue=l,l=l.dispatch=HC.bind(null,rt,l),[m.memoizedState,l]},useRef:function(l){var c=Xn();return l={current:l},c.memoizedState=l},useState:B0,useDebugValue:Cd,useDeferredValue:function(l){return Xn().memoizedState=l},useTransition:function(){var l=B0(!1),c=l[0];return l=WC.bind(null,l[1]),Xn().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,d){var m=rt,y=Xn();if(Ge){if(d===void 0)throw Error(n(407));d=d()}else{if(d=c(),xt===null)throw Error(n(349));(Bi&30)!==0||N0(m,c,d)}y.memoizedState=d;var b={value:d,getSnapshot:c};return y.queue=b,j0(D0.bind(null,m,b,l),[l]),m.flags|=2048,Ta(9,O0.bind(null,m,b,d,c),void 0,null),d},useId:function(){var l=Xn(),c=xt.identifierPrefix;if(Ge){var d=vr,m=yr;d=(m&~(1<<32-Cn(m)-1)).toString(32)+d,c=":"+c+"R"+d,d=wa++,0<d&&(c+="H"+d.toString(32)),c+=":"}else d=$C++,c=":"+c+"r"+d.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},qC={readContext:un,useCallback:H0,useContext:un,useEffect:Ad,useImperativeHandle:W0,useInsertionEffect:z0,useLayoutEffect:V0,useMemo:X0,useReducer:Sd,useRef:U0,useState:function(){return Sd(xa)},useDebugValue:Cd,useDeferredValue:function(l){var c=fn();return Y0(c,_t.memoizedState,l)},useTransition:function(){var l=Sd(xa)[0],c=fn().memoizedState;return[l,c]},useMutableSource:P0,useSyncExternalStore:M0,useId:q0,unstable_isNewReconciler:!1},KC={readContext:un,useCallback:H0,useContext:un,useEffect:Ad,useImperativeHandle:W0,useInsertionEffect:z0,useLayoutEffect:V0,useMemo:X0,useReducer:Ed,useRef:U0,useState:function(){return Ed(xa)},useDebugValue:Cd,useDeferredValue:function(l){var c=fn();return _t===null?c.memoizedState=l:Y0(c,_t.memoizedState,l)},useTransition:function(){var l=Ed(xa)[0],c=fn().memoizedState;return[l,c]},useMutableSource:P0,useSyncExternalStore:M0,useId:q0,unstable_isNewReconciler:!1};function kn(l,c){if(l&&l.defaultProps){c=ee({},c),l=l.defaultProps;for(var d in l)c[d]===void 0&&(c[d]=l[d]);return c}return c}function Rd(l,c,d,m){c=l.memoizedState,d=d(m,c),d=d==null?c:ee({},c,d),l.memoizedState=d,l.lanes===0&&(l.updateQueue.baseState=d)}var Nc={isMounted:function(l){return(l=l._reactInternals)?Pi(l)===l:!1},enqueueSetState:function(l,c,d){l=l._reactInternals;var m=jt(),y=ii(l),b=wr(m,y);b.payload=c,d!=null&&(b.callback=d),c=ei(l,b,y),c!==null&&(Nn(c,l,y,m),Ec(c,l,y))},enqueueReplaceState:function(l,c,d){l=l._reactInternals;var m=jt(),y=ii(l),b=wr(m,y);b.tag=1,b.payload=c,d!=null&&(b.callback=d),c=ei(l,b,y),c!==null&&(Nn(c,l,y,m),Ec(c,l,y))},enqueueForceUpdate:function(l,c){l=l._reactInternals;var d=jt(),m=ii(l),y=wr(d,m);y.tag=2,c!=null&&(y.callback=c),c=ei(l,y,m),c!==null&&(Nn(c,l,m,d),Ec(c,l,m))}};function J0(l,c,d,m,y,b,S){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(m,b,S):c.prototype&&c.prototype.isPureReactComponent?!ca(d,m)||!ca(y,b):!0}function G0(l,c,d){var m=!1,y=Qr,b=c.contextType;return typeof b=="object"&&b!==null?b=un(b):(y=$t(c)?Ni:It.current,m=c.contextTypes,b=(m=m!=null)?Os(l,y):Qr),c=new c(d,b),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Nc,l.stateNode=c,c._reactInternals=l,m&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=y,l.__reactInternalMemoizedMaskedChildContext=b),c}function ev(l,c,d,m){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(d,m),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(d,m),c.state!==l&&Nc.enqueueReplaceState(c,c.state,null)}function Id(l,c,d,m){var y=l.stateNode;y.props=d,y.state=l.memoizedState,y.refs={},gd(l);var b=c.contextType;typeof b=="object"&&b!==null?y.context=un(b):(b=$t(c)?Ni:It.current,y.context=Os(l,b)),y.state=l.memoizedState,b=c.getDerivedStateFromProps,typeof b=="function"&&(Rd(l,c,b,d),y.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(c=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),c!==y.state&&Nc.enqueueReplaceState(y,y.state,null),Ac(l,d,y,m),y.state=l.memoizedState),typeof y.componentDidMount=="function"&&(l.flags|=4194308)}function Vs(l,c){try{var d="",m=c;do d+=Re(m),m=m.return;while(m);var y=d}catch(b){y=`
Error generating stack: `+b.message+`
`+b.stack}return{value:l,source:c,stack:y,digest:null}}function kd(l,c,d){return{value:l,source:null,stack:d??null,digest:c??null}}function Pd(l,c){try{console.error(c.value)}catch(d){setTimeout(function(){throw d})}}var ZC=typeof WeakMap=="function"?WeakMap:Map;function tv(l,c,d){d=wr(-1,d),d.tag=3,d.payload={element:null};var m=c.value;return d.callback=function(){jc||(jc=!0,Xd=m),Pd(l,c)},d}function nv(l,c,d){d=wr(-1,d),d.tag=3;var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var y=c.value;d.payload=function(){return m(y)},d.callback=function(){Pd(l,c)}}var b=l.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(d.callback=function(){Pd(l,c),typeof m!="function"&&(ni===null?ni=new Set([this]):ni.add(this));var S=c.stack;this.componentDidCatch(c.value,{componentStack:S!==null?S:""})}),d}function rv(l,c,d){var m=l.pingCache;if(m===null){m=l.pingCache=new ZC;var y=new Set;m.set(c,y)}else y=m.get(c),y===void 0&&(y=new Set,m.set(c,y));y.has(d)||(y.add(d),l=uR.bind(null,l,c,d),c.then(l,l))}function iv(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function sv(l,c,d,m,y){return(l.mode&1)===0?(l===c?l.flags|=65536:(l.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(c=wr(-1,1),c.tag=2,ei(d,c,1))),d.lanes|=1),l):(l.flags|=65536,l.lanes=y,l)}var QC=R.ReactCurrentOwner,Wt=!1;function Ut(l,c,d,m){c.child=l===null?E0(c,null,d,m):Bs(c,l.child,d,m)}function ov(l,c,d,m,y){d=d.render;var b=c.ref;return js(c,y),m=xd(l,c,d,m,b,y),d=Td(),l!==null&&!Wt?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~y,xr(l,c,y)):(Ge&&d&&sd(c),c.flags|=1,Ut(l,c,m,y),c.child)}function av(l,c,d,m,y){if(l===null){var b=d.type;return typeof b=="function"&&!Gd(b)&&b.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(c.tag=15,c.type=b,lv(l,c,b,m,y)):(l=Xc(d.type,null,m,c,c.mode,y),l.ref=c.ref,l.return=c,c.child=l)}if(b=l.child,(l.lanes&y)===0){var S=b.memoizedProps;if(d=d.compare,d=d!==null?d:ca,d(S,m)&&l.ref===c.ref)return xr(l,c,y)}return c.flags|=1,l=oi(b,m),l.ref=c.ref,l.return=c,c.child=l}function lv(l,c,d,m,y){if(l!==null){var b=l.memoizedProps;if(ca(b,m)&&l.ref===c.ref)if(Wt=!1,c.pendingProps=m=b,(l.lanes&y)!==0)(l.flags&131072)!==0&&(Wt=!0);else return c.lanes=l.lanes,xr(l,c,y)}return Md(l,c,d,m,y)}function cv(l,c,d){var m=c.pendingProps,y=m.children,b=l!==null?l.memoizedState:null;if(m.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(Ws,Gt),Gt|=d;else{if((d&1073741824)===0)return l=b!==null?b.baseLanes|d:d,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null,transitions:null},c.updateQueue=null,Ye(Ws,Gt),Gt|=l,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=b!==null?b.baseLanes:d,Ye(Ws,Gt),Gt|=m}else b!==null?(m=b.baseLanes|d,c.memoizedState=null):m=d,Ye(Ws,Gt),Gt|=m;return Ut(l,c,y,d),c.child}function uv(l,c){var d=c.ref;(l===null&&d!==null||l!==null&&l.ref!==d)&&(c.flags|=512,c.flags|=2097152)}function Md(l,c,d,m,y){var b=$t(d)?Ni:It.current;return b=Os(c,b),js(c,y),d=xd(l,c,d,m,b,y),m=Td(),l!==null&&!Wt?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~y,xr(l,c,y)):(Ge&&m&&sd(c),c.flags|=1,Ut(l,c,d,y),c.child)}function fv(l,c,d,m,y){if($t(d)){var b=!0;_c(c)}else b=!1;if(js(c,y),c.stateNode===null)Dc(l,c),G0(c,d,m),Id(c,d,m,y),m=!0;else if(l===null){var S=c.stateNode,O=c.memoizedProps;S.props=O;var F=S.context,J=d.contextType;typeof J=="object"&&J!==null?J=un(J):(J=$t(d)?Ni:It.current,J=Os(c,J));var le=d.getDerivedStateFromProps,ue=typeof le=="function"||typeof S.getSnapshotBeforeUpdate=="function";ue||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(O!==m||F!==J)&&ev(c,S,m,J),Gr=!1;var ae=c.memoizedState;S.state=ae,Ac(c,m,S,y),F=c.memoizedState,O!==m||ae!==F||Vt.current||Gr?(typeof le=="function"&&(Rd(c,d,le,m),F=c.memoizedState),(O=Gr||J0(c,d,O,m,ae,F,J))?(ue||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(c.flags|=4194308)):(typeof S.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=m,c.memoizedState=F),S.props=m,S.state=F,S.context=J,m=O):(typeof S.componentDidMount=="function"&&(c.flags|=4194308),m=!1)}else{S=c.stateNode,C0(l,c),O=c.memoizedProps,J=c.type===c.elementType?O:kn(c.type,O),S.props=J,ue=c.pendingProps,ae=S.context,F=d.contextType,typeof F=="object"&&F!==null?F=un(F):(F=$t(d)?Ni:It.current,F=Os(c,F));var _e=d.getDerivedStateFromProps;(le=typeof _e=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(O!==ue||ae!==F)&&ev(c,S,m,F),Gr=!1,ae=c.memoizedState,S.state=ae,Ac(c,m,S,y);var ve=c.memoizedState;O!==ue||ae!==ve||Vt.current||Gr?(typeof _e=="function"&&(Rd(c,d,_e,m),ve=c.memoizedState),(J=Gr||J0(c,d,J,m,ae,ve,F)||!1)?(le||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(m,ve,F),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(m,ve,F)),typeof S.componentDidUpdate=="function"&&(c.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof S.componentDidUpdate!="function"||O===l.memoizedProps&&ae===l.memoizedState||(c.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||O===l.memoizedProps&&ae===l.memoizedState||(c.flags|=1024),c.memoizedProps=m,c.memoizedState=ve),S.props=m,S.state=ve,S.context=F,m=J):(typeof S.componentDidUpdate!="function"||O===l.memoizedProps&&ae===l.memoizedState||(c.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||O===l.memoizedProps&&ae===l.memoizedState||(c.flags|=1024),m=!1)}return Nd(l,c,d,m,b,y)}function Nd(l,c,d,m,y,b){uv(l,c);var S=(c.flags&128)!==0;if(!m&&!S)return y&&m0(c,d,!1),xr(l,c,b);m=c.stateNode,QC.current=c;var O=S&&typeof d.getDerivedStateFromError!="function"?null:m.render();return c.flags|=1,l!==null&&S?(c.child=Bs(c,l.child,null,b),c.child=Bs(c,null,O,b)):Ut(l,c,O,b),c.memoizedState=m.state,y&&m0(c,d,!0),c.child}function hv(l){var c=l.stateNode;c.pendingContext?p0(l,c.pendingContext,c.pendingContext!==c.context):c.context&&p0(l,c.context,!1),md(l,c.containerInfo)}function dv(l,c,d,m,y){return Ls(),cd(y),c.flags|=256,Ut(l,c,d,m),c.child}var Od={dehydrated:null,treeContext:null,retryLane:0};function Dd(l){return{baseLanes:l,cachePool:null,transitions:null}}function pv(l,c,d){var m=c.pendingProps,y=nt.current,b=!1,S=(c.flags&128)!==0,O;if((O=S)||(O=l!==null&&l.memoizedState===null?!1:(y&2)!==0),O?(b=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(y|=1),Ye(nt,y&1),l===null)return ld(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((c.mode&1)===0?c.lanes=1:l.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(S=m.children,l=m.fallback,b?(m=c.mode,b=c.child,S={mode:"hidden",children:S},(m&1)===0&&b!==null?(b.childLanes=0,b.pendingProps=S):b=Yc(S,m,0,null),l=$i(l,m,d,null),b.return=c,l.return=c,b.sibling=l,c.child=b,c.child.memoizedState=Dd(d),c.memoizedState=Od,l):Fd(c,S));if(y=l.memoizedState,y!==null&&(O=y.dehydrated,O!==null))return JC(l,c,S,m,O,y,d);if(b){b=m.fallback,S=c.mode,y=l.child,O=y.sibling;var F={mode:"hidden",children:m.children};return(S&1)===0&&c.child!==y?(m=c.child,m.childLanes=0,m.pendingProps=F,c.deletions=null):(m=oi(y,F),m.subtreeFlags=y.subtreeFlags&14680064),O!==null?b=oi(O,b):(b=$i(b,S,d,null),b.flags|=2),b.return=c,m.return=c,m.sibling=b,c.child=m,m=b,b=c.child,S=l.child.memoizedState,S=S===null?Dd(d):{baseLanes:S.baseLanes|d,cachePool:null,transitions:S.transitions},b.memoizedState=S,b.childLanes=l.childLanes&~d,c.memoizedState=Od,m}return b=l.child,l=b.sibling,m=oi(b,{mode:"visible",children:m.children}),(c.mode&1)===0&&(m.lanes=d),m.return=c,m.sibling=null,l!==null&&(d=c.deletions,d===null?(c.deletions=[l],c.flags|=16):d.push(l)),c.child=m,c.memoizedState=null,m}function Fd(l,c){return c=Yc({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function Oc(l,c,d,m){return m!==null&&cd(m),Bs(c,l.child,null,d),l=Fd(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function JC(l,c,d,m,y,b,S){if(d)return c.flags&256?(c.flags&=-257,m=kd(Error(n(422))),Oc(l,c,S,m)):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(b=m.fallback,y=c.mode,m=Yc({mode:"visible",children:m.children},y,0,null),b=$i(b,y,S,null),b.flags|=2,m.return=c,b.return=c,m.sibling=b,c.child=m,(c.mode&1)!==0&&Bs(c,l.child,null,S),c.child.memoizedState=Dd(S),c.memoizedState=Od,b);if((c.mode&1)===0)return Oc(l,c,S,null);if(y.data==="$!"){if(m=y.nextSibling&&y.nextSibling.dataset,m)var O=m.dgst;return m=O,b=Error(n(419)),m=kd(b,m,void 0),Oc(l,c,S,m)}if(O=(S&l.childLanes)!==0,Wt||O){if(m=xt,m!==null){switch(S&-S){case 4:y=2;break;case 16:y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:y=32;break;case 536870912:y=268435456;break;default:y=0}y=(y&(m.suspendedLanes|S))!==0?0:y,y!==0&&y!==b.retryLane&&(b.retryLane=y,br(l,y),Nn(m,l,y,-1))}return Jd(),m=kd(Error(n(421))),Oc(l,c,S,m)}return y.data==="$?"?(c.flags|=128,c.child=l.child,c=fR.bind(null,l),y._reactRetry=c,null):(l=b.treeContext,Jt=Kr(y.nextSibling),Qt=c,Ge=!0,In=null,l!==null&&(ln[cn++]=yr,ln[cn++]=vr,ln[cn++]=Oi,yr=l.id,vr=l.overflow,Oi=c),c=Fd(c,m.children),c.flags|=4096,c)}function gv(l,c,d){l.lanes|=c;var m=l.alternate;m!==null&&(m.lanes|=c),dd(l.return,c,d)}function Ld(l,c,d,m,y){var b=l.memoizedState;b===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:y}:(b.isBackwards=c,b.rendering=null,b.renderingStartTime=0,b.last=m,b.tail=d,b.tailMode=y)}function mv(l,c,d){var m=c.pendingProps,y=m.revealOrder,b=m.tail;if(Ut(l,c,m.children,d),m=nt.current,(m&2)!==0)m=m&1|2,c.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&gv(l,d,c);else if(l.tag===19)gv(l,d,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}m&=1}if(Ye(nt,m),(c.mode&1)===0)c.memoizedState=null;else switch(y){case"forwards":for(d=c.child,y=null;d!==null;)l=d.alternate,l!==null&&Cc(l)===null&&(y=d),d=d.sibling;d=y,d===null?(y=c.child,c.child=null):(y=d.sibling,d.sibling=null),Ld(c,!1,y,d,b);break;case"backwards":for(d=null,y=c.child,c.child=null;y!==null;){if(l=y.alternate,l!==null&&Cc(l)===null){c.child=y;break}l=y.sibling,y.sibling=d,d=y,y=l}Ld(c,!0,d,null,b);break;case"together":Ld(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function Dc(l,c){(c.mode&1)===0&&l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2)}function xr(l,c,d){if(l!==null&&(c.dependencies=l.dependencies),Ui|=c.lanes,(d&c.childLanes)===0)return null;if(l!==null&&c.child!==l.child)throw Error(n(153));if(c.child!==null){for(l=c.child,d=oi(l,l.pendingProps),c.child=d,d.return=c;l.sibling!==null;)l=l.sibling,d=d.sibling=oi(l,l.pendingProps),d.return=c;d.sibling=null}return c.child}function GC(l,c,d){switch(c.tag){case 3:hv(c),Ls();break;case 5:k0(c);break;case 1:$t(c.type)&&_c(c);break;case 4:md(c,c.stateNode.containerInfo);break;case 10:var m=c.type._context,y=c.memoizedProps.value;Ye(Tc,m._currentValue),m._currentValue=y;break;case 13:if(m=c.memoizedState,m!==null)return m.dehydrated!==null?(Ye(nt,nt.current&1),c.flags|=128,null):(d&c.child.childLanes)!==0?pv(l,c,d):(Ye(nt,nt.current&1),l=xr(l,c,d),l!==null?l.sibling:null);Ye(nt,nt.current&1);break;case 19:if(m=(d&c.childLanes)!==0,(l.flags&128)!==0){if(m)return mv(l,c,d);c.flags|=128}if(y=c.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),Ye(nt,nt.current),m)break;return null;case 22:case 23:return c.lanes=0,cv(l,c,d)}return xr(l,c,d)}var _v,Bd,yv,vv;_v=function(l,c){for(var d=c.child;d!==null;){if(d.tag===5||d.tag===6)l.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Bd=function(){},yv=function(l,c,d,m){var y=l.memoizedProps;if(y!==m){l=c.stateNode,Li(Hn.current);var b=null;switch(d){case"input":y=dr(l,y),m=dr(l,m),b=[];break;case"select":y=ee({},y,{value:void 0}),m=ee({},m,{value:void 0}),b=[];break;case"textarea":y=Ri(l,y),m=Ri(l,m),b=[];break;default:typeof y.onClick!="function"&&typeof m.onClick=="function"&&(l.onclick=pc)}yh(d,m);var S;d=null;for(J in y)if(!m.hasOwnProperty(J)&&y.hasOwnProperty(J)&&y[J]!=null)if(J==="style"){var O=y[J];for(S in O)O.hasOwnProperty(S)&&(d||(d={}),d[S]="")}else J!=="dangerouslySetInnerHTML"&&J!=="children"&&J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&J!=="autoFocus"&&(i.hasOwnProperty(J)?b||(b=[]):(b=b||[]).push(J,null));for(J in m){var F=m[J];if(O=y?.[J],m.hasOwnProperty(J)&&F!==O&&(F!=null||O!=null))if(J==="style")if(O){for(S in O)!O.hasOwnProperty(S)||F&&F.hasOwnProperty(S)||(d||(d={}),d[S]="");for(S in F)F.hasOwnProperty(S)&&O[S]!==F[S]&&(d||(d={}),d[S]=F[S])}else d||(b||(b=[]),b.push(J,d)),d=F;else J==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,O=O?O.__html:void 0,F!=null&&O!==F&&(b=b||[]).push(J,F)):J==="children"?typeof F!="string"&&typeof F!="number"||(b=b||[]).push(J,""+F):J!=="suppressContentEditableWarning"&&J!=="suppressHydrationWarning"&&(i.hasOwnProperty(J)?(F!=null&&J==="onScroll"&&Ze("scroll",l),b||O===F||(b=[])):(b=b||[]).push(J,F))}d&&(b=b||[]).push("style",d);var J=b;(c.updateQueue=J)&&(c.flags|=4)}},vv=function(l,c,d,m){d!==m&&(c.flags|=4)};function Sa(l,c){if(!Ge)switch(l.tailMode){case"hidden":c=l.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?l.tail=null:d.sibling=null;break;case"collapsed":d=l.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:m.sibling=null}}function Pt(l){var c=l.alternate!==null&&l.alternate.child===l.child,d=0,m=0;if(c)for(var y=l.child;y!==null;)d|=y.lanes|y.childLanes,m|=y.subtreeFlags&14680064,m|=y.flags&14680064,y.return=l,y=y.sibling;else for(y=l.child;y!==null;)d|=y.lanes|y.childLanes,m|=y.subtreeFlags,m|=y.flags,y.return=l,y=y.sibling;return l.subtreeFlags|=m,l.childLanes=d,c}function eR(l,c,d){var m=c.pendingProps;switch(od(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pt(c),null;case 1:return $t(c.type)&&mc(),Pt(c),null;case 3:return m=c.stateNode,zs(),Qe(Vt),Qe(It),vd(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(l===null||l.child===null)&&(wc(c)?c.flags|=4:l===null||l.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,In!==null&&(Kd(In),In=null))),Bd(l,c),Pt(c),null;case 5:_d(c);var y=Li(va.current);if(d=c.type,l!==null&&c.stateNode!=null)yv(l,c,d,m,y),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!m){if(c.stateNode===null)throw Error(n(166));return Pt(c),null}if(l=Li(Hn.current),wc(c)){m=c.stateNode,d=c.type;var b=c.memoizedProps;switch(m[Wn]=c,m[pa]=b,l=(c.mode&1)!==0,d){case"dialog":Ze("cancel",m),Ze("close",m);break;case"iframe":case"object":case"embed":Ze("load",m);break;case"video":case"audio":for(y=0;y<fa.length;y++)Ze(fa[y],m);break;case"source":Ze("error",m);break;case"img":case"image":case"link":Ze("error",m),Ze("load",m);break;case"details":Ze("toggle",m);break;case"input":Wo(m,b),Ze("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!b.multiple},Ze("invalid",m);break;case"textarea":ys(m,b),Ze("invalid",m)}yh(d,b),y=null;for(var S in b)if(b.hasOwnProperty(S)){var O=b[S];S==="children"?typeof O=="string"?m.textContent!==O&&(b.suppressHydrationWarning!==!0&&dc(m.textContent,O,l),y=["children",O]):typeof O=="number"&&m.textContent!==""+O&&(b.suppressHydrationWarning!==!0&&dc(m.textContent,O,l),y=["children",""+O]):i.hasOwnProperty(S)&&O!=null&&S==="onScroll"&&Ze("scroll",m)}switch(d){case"input":At(m),Xo(m,b,!0);break;case"textarea":At(m),vs(m);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(m.onclick=pc)}m=y,c.updateQueue=m,m!==null&&(c.flags|=4)}else{S=y.nodeType===9?y:y.ownerDocument,l==="http://www.w3.org/1999/xhtml"&&(l=Ii(d)),l==="http://www.w3.org/1999/xhtml"?d==="script"?(l=S.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):typeof m.is=="string"?l=S.createElement(d,{is:m.is}):(l=S.createElement(d),d==="select"&&(S=l,m.multiple?S.multiple=!0:m.size&&(S.size=m.size))):l=S.createElementNS(l,d),l[Wn]=c,l[pa]=m,_v(l,c,!1,!1),c.stateNode=l;e:{switch(S=vh(d,m),d){case"dialog":Ze("cancel",l),Ze("close",l),y=m;break;case"iframe":case"object":case"embed":Ze("load",l),y=m;break;case"video":case"audio":for(y=0;y<fa.length;y++)Ze(fa[y],l);y=m;break;case"source":Ze("error",l),y=m;break;case"img":case"image":case"link":Ze("error",l),Ze("load",l),y=m;break;case"details":Ze("toggle",l),y=m;break;case"input":Wo(l,m),y=dr(l,m),Ze("invalid",l);break;case"option":y=m;break;case"select":l._wrapperState={wasMultiple:!!m.multiple},y=ee({},m,{value:void 0}),Ze("invalid",l);break;case"textarea":ys(l,m),y=Ri(l,m),Ze("invalid",l);break;default:y=m}yh(d,y),O=y;for(b in O)if(O.hasOwnProperty(b)){var F=O[b];b==="style"?ly(l,F):b==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,F!=null&&Hl(l,F)):b==="children"?typeof F=="string"?(d!=="textarea"||F!=="")&&gr(l,F):typeof F=="number"&&gr(l,""+F):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(i.hasOwnProperty(b)?F!=null&&b==="onScroll"&&Ze("scroll",l):F!=null&&E(l,b,F,S))}switch(d){case"input":At(l),Xo(l,m,!1);break;case"textarea":At(l),vs(l);break;case"option":m.value!=null&&l.setAttribute("value",""+ke(m.value));break;case"select":l.multiple=!!m.multiple,b=m.value,b!=null?pr(l,!!m.multiple,b,!1):m.defaultValue!=null&&pr(l,!!m.multiple,m.defaultValue,!0);break;default:typeof y.onClick=="function"&&(l.onclick=pc)}switch(d){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return Pt(c),null;case 6:if(l&&c.stateNode!=null)vv(l,c,l.memoizedProps,m);else{if(typeof m!="string"&&c.stateNode===null)throw Error(n(166));if(d=Li(va.current),Li(Hn.current),wc(c)){if(m=c.stateNode,d=c.memoizedProps,m[Wn]=c,(b=m.nodeValue!==d)&&(l=Qt,l!==null))switch(l.tag){case 3:dc(m.nodeValue,d,(l.mode&1)!==0);break;case 5:l.memoizedProps.suppressHydrationWarning!==!0&&dc(m.nodeValue,d,(l.mode&1)!==0)}b&&(c.flags|=4)}else m=(d.nodeType===9?d:d.ownerDocument).createTextNode(m),m[Wn]=c,c.stateNode=m}return Pt(c),null;case 13:if(Qe(nt),m=c.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Ge&&Jt!==null&&(c.mode&1)!==0&&(c.flags&128)===0)x0(),Ls(),c.flags|=98560,b=!1;else if(b=wc(c),m!==null&&m.dehydrated!==null){if(l===null){if(!b)throw Error(n(318));if(b=c.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(n(317));b[Wn]=c}else Ls(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;Pt(c),b=!1}else In!==null&&(Kd(In),In=null),b=!0;if(!b)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=d,c):(m=m!==null,m!==(l!==null&&l.memoizedState!==null)&&m&&(c.child.flags|=8192,(c.mode&1)!==0&&(l===null||(nt.current&1)!==0?yt===0&&(yt=3):Jd())),c.updateQueue!==null&&(c.flags|=4),Pt(c),null);case 4:return zs(),Bd(l,c),l===null&&ha(c.stateNode.containerInfo),Pt(c),null;case 10:return hd(c.type._context),Pt(c),null;case 17:return $t(c.type)&&mc(),Pt(c),null;case 19:if(Qe(nt),b=c.memoizedState,b===null)return Pt(c),null;if(m=(c.flags&128)!==0,S=b.rendering,S===null)if(m)Sa(b,!1);else{if(yt!==0||l!==null&&(l.flags&128)!==0)for(l=c.child;l!==null;){if(S=Cc(l),S!==null){for(c.flags|=128,Sa(b,!1),m=S.updateQueue,m!==null&&(c.updateQueue=m,c.flags|=4),c.subtreeFlags=0,m=d,d=c.child;d!==null;)b=d,l=m,b.flags&=14680066,S=b.alternate,S===null?(b.childLanes=0,b.lanes=l,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=S.childLanes,b.lanes=S.lanes,b.child=S.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=S.memoizedProps,b.memoizedState=S.memoizedState,b.updateQueue=S.updateQueue,b.type=S.type,l=S.dependencies,b.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),d=d.sibling;return Ye(nt,nt.current&1|2),c.child}l=l.sibling}b.tail!==null&&ut()>Hs&&(c.flags|=128,m=!0,Sa(b,!1),c.lanes=4194304)}else{if(!m)if(l=Cc(S),l!==null){if(c.flags|=128,m=!0,d=l.updateQueue,d!==null&&(c.updateQueue=d,c.flags|=4),Sa(b,!0),b.tail===null&&b.tailMode==="hidden"&&!S.alternate&&!Ge)return Pt(c),null}else 2*ut()-b.renderingStartTime>Hs&&d!==1073741824&&(c.flags|=128,m=!0,Sa(b,!1),c.lanes=4194304);b.isBackwards?(S.sibling=c.child,c.child=S):(d=b.last,d!==null?d.sibling=S:c.child=S,b.last=S)}return b.tail!==null?(c=b.tail,b.rendering=c,b.tail=c.sibling,b.renderingStartTime=ut(),c.sibling=null,d=nt.current,Ye(nt,m?d&1|2:d&1),c):(Pt(c),null);case 22:case 23:return Qd(),m=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==m&&(c.flags|=8192),m&&(c.mode&1)!==0?(Gt&1073741824)!==0&&(Pt(c),c.subtreeFlags&6&&(c.flags|=8192)):Pt(c),null;case 24:return null;case 25:return null}throw Error(n(156,c.tag))}function tR(l,c){switch(od(c),c.tag){case 1:return $t(c.type)&&mc(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return zs(),Qe(Vt),Qe(It),vd(),l=c.flags,(l&65536)!==0&&(l&128)===0?(c.flags=l&-65537|128,c):null;case 5:return _d(c),null;case 13:if(Qe(nt),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(n(340));Ls()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return Qe(nt),null;case 4:return zs(),null;case 10:return hd(c.type._context),null;case 22:case 23:return Qd(),null;case 24:return null;default:return null}}var Fc=!1,Mt=!1,nR=typeof WeakSet=="function"?WeakSet:Set,ye=null;function $s(l,c){var d=l.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(m){at(l,c,m)}else d.current=null}function Ud(l,c,d){try{d()}catch(m){at(l,c,m)}}var bv=!1;function rR(l,c){if(Qh=nc,l=Jy(),$h(l)){if("selectionStart"in l)var d={start:l.selectionStart,end:l.selectionEnd};else e:{d=(d=l.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var y=m.anchorOffset,b=m.focusNode;m=m.focusOffset;try{d.nodeType,b.nodeType}catch{d=null;break e}var S=0,O=-1,F=-1,J=0,le=0,ue=l,ae=null;t:for(;;){for(var _e;ue!==d||y!==0&&ue.nodeType!==3||(O=S+y),ue!==b||m!==0&&ue.nodeType!==3||(F=S+m),ue.nodeType===3&&(S+=ue.nodeValue.length),(_e=ue.firstChild)!==null;)ae=ue,ue=_e;for(;;){if(ue===l)break t;if(ae===d&&++J===y&&(O=S),ae===b&&++le===m&&(F=S),(_e=ue.nextSibling)!==null)break;ue=ae,ae=ue.parentNode}ue=_e}d=O===-1||F===-1?null:{start:O,end:F}}else d=null}d=d||{start:0,end:0}}else d=null;for(Jh={focusedElem:l,selectionRange:d},nc=!1,ye=c;ye!==null;)if(c=ye,l=c.child,(c.subtreeFlags&1028)!==0&&l!==null)l.return=c,ye=l;else for(;ye!==null;){c=ye;try{var ve=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(ve!==null){var be=ve.memoizedProps,ft=ve.memoizedState,K=c.stateNode,U=K.getSnapshotBeforeUpdate(c.elementType===c.type?be:kn(c.type,be),ft);K.__reactInternalSnapshotBeforeUpdate=U}break;case 3:var Q=c.stateNode.containerInfo;Q.nodeType===1?Q.textContent="":Q.nodeType===9&&Q.documentElement&&Q.removeChild(Q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(de){at(c,c.return,de)}if(l=c.sibling,l!==null){l.return=c.return,ye=l;break}ye=c.return}return ve=bv,bv=!1,ve}function Ea(l,c,d){var m=c.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var y=m=m.next;do{if((y.tag&l)===l){var b=y.destroy;y.destroy=void 0,b!==void 0&&Ud(c,d,b)}y=y.next}while(y!==m)}}function Lc(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&l)===l){var m=d.create;d.destroy=m()}d=d.next}while(d!==c)}}function jd(l){var c=l.ref;if(c!==null){var d=l.stateNode;switch(l.tag){case 5:l=d;break;default:l=d}typeof c=="function"?c(l):c.current=l}}function wv(l){var c=l.alternate;c!==null&&(l.alternate=null,wv(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&(delete c[Wn],delete c[pa],delete c[nd],delete c[UC],delete c[jC])),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function xv(l){return l.tag===5||l.tag===3||l.tag===4}function Tv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||xv(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function zd(l,c,d){var m=l.tag;if(m===5||m===6)l=l.stateNode,c?d.nodeType===8?d.parentNode.insertBefore(l,c):d.insertBefore(l,c):(d.nodeType===8?(c=d.parentNode,c.insertBefore(l,d)):(c=d,c.appendChild(l)),d=d._reactRootContainer,d!=null||c.onclick!==null||(c.onclick=pc));else if(m!==4&&(l=l.child,l!==null))for(zd(l,c,d),l=l.sibling;l!==null;)zd(l,c,d),l=l.sibling}function Vd(l,c,d){var m=l.tag;if(m===5||m===6)l=l.stateNode,c?d.insertBefore(l,c):d.appendChild(l);else if(m!==4&&(l=l.child,l!==null))for(Vd(l,c,d),l=l.sibling;l!==null;)Vd(l,c,d),l=l.sibling}var Ct=null,Pn=!1;function ti(l,c,d){for(d=d.child;d!==null;)Sv(l,c,d),d=d.sibling}function Sv(l,c,d){if($n&&typeof $n.onCommitFiberUnmount=="function")try{$n.onCommitFiberUnmount(Zl,d)}catch{}switch(d.tag){case 5:Mt||$s(d,c);case 6:var m=Ct,y=Pn;Ct=null,ti(l,c,d),Ct=m,Pn=y,Ct!==null&&(Pn?(l=Ct,d=d.stateNode,l.nodeType===8?l.parentNode.removeChild(d):l.removeChild(d)):Ct.removeChild(d.stateNode));break;case 18:Ct!==null&&(Pn?(l=Ct,d=d.stateNode,l.nodeType===8?td(l.parentNode,d):l.nodeType===1&&td(l,d),ra(l)):td(Ct,d.stateNode));break;case 4:m=Ct,y=Pn,Ct=d.stateNode.containerInfo,Pn=!0,ti(l,c,d),Ct=m,Pn=y;break;case 0:case 11:case 14:case 15:if(!Mt&&(m=d.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){y=m=m.next;do{var b=y,S=b.destroy;b=b.tag,S!==void 0&&((b&2)!==0||(b&4)!==0)&&Ud(d,c,S),y=y.next}while(y!==m)}ti(l,c,d);break;case 1:if(!Mt&&($s(d,c),m=d.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=d.memoizedProps,m.state=d.memoizedState,m.componentWillUnmount()}catch(O){at(d,c,O)}ti(l,c,d);break;case 21:ti(l,c,d);break;case 22:d.mode&1?(Mt=(m=Mt)||d.memoizedState!==null,ti(l,c,d),Mt=m):ti(l,c,d);break;default:ti(l,c,d)}}function Ev(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var d=l.stateNode;d===null&&(d=l.stateNode=new nR),c.forEach(function(m){var y=hR.bind(null,l,m);d.has(m)||(d.add(m),m.then(y,y))})}}function Mn(l,c){var d=c.deletions;if(d!==null)for(var m=0;m<d.length;m++){var y=d[m];try{var b=l,S=c,O=S;e:for(;O!==null;){switch(O.tag){case 5:Ct=O.stateNode,Pn=!1;break e;case 3:Ct=O.stateNode.containerInfo,Pn=!0;break e;case 4:Ct=O.stateNode.containerInfo,Pn=!0;break e}O=O.return}if(Ct===null)throw Error(n(160));Sv(b,S,y),Ct=null,Pn=!1;var F=y.alternate;F!==null&&(F.return=null),y.return=null}catch(J){at(y,c,J)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Av(c,l),c=c.sibling}function Av(l,c){var d=l.alternate,m=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Mn(c,l),Yn(l),m&4){try{Ea(3,l,l.return),Lc(3,l)}catch(be){at(l,l.return,be)}try{Ea(5,l,l.return)}catch(be){at(l,l.return,be)}}break;case 1:Mn(c,l),Yn(l),m&512&&d!==null&&$s(d,d.return);break;case 5:if(Mn(c,l),Yn(l),m&512&&d!==null&&$s(d,d.return),l.flags&32){var y=l.stateNode;try{gr(y,"")}catch(be){at(l,l.return,be)}}if(m&4&&(y=l.stateNode,y!=null)){var b=l.memoizedProps,S=d!==null?d.memoizedProps:b,O=l.type,F=l.updateQueue;if(l.updateQueue=null,F!==null)try{O==="input"&&b.type==="radio"&&b.name!=null&&Vr(y,b),vh(O,S);var J=vh(O,b);for(S=0;S<F.length;S+=2){var le=F[S],ue=F[S+1];le==="style"?ly(y,ue):le==="dangerouslySetInnerHTML"?Hl(y,ue):le==="children"?gr(y,ue):E(y,le,ue,J)}switch(O){case"input":Ho(y,b);break;case"textarea":Wl(y,b);break;case"select":var ae=y._wrapperState.wasMultiple;y._wrapperState.wasMultiple=!!b.multiple;var _e=b.value;_e!=null?pr(y,!!b.multiple,_e,!1):ae!==!!b.multiple&&(b.defaultValue!=null?pr(y,!!b.multiple,b.defaultValue,!0):pr(y,!!b.multiple,b.multiple?[]:"",!1))}y[pa]=b}catch(be){at(l,l.return,be)}}break;case 6:if(Mn(c,l),Yn(l),m&4){if(l.stateNode===null)throw Error(n(162));y=l.stateNode,b=l.memoizedProps;try{y.nodeValue=b}catch(be){at(l,l.return,be)}}break;case 3:if(Mn(c,l),Yn(l),m&4&&d!==null&&d.memoizedState.isDehydrated)try{ra(c.containerInfo)}catch(be){at(l,l.return,be)}break;case 4:Mn(c,l),Yn(l);break;case 13:Mn(c,l),Yn(l),y=l.child,y.flags&8192&&(b=y.memoizedState!==null,y.stateNode.isHidden=b,!b||y.alternate!==null&&y.alternate.memoizedState!==null||(Hd=ut())),m&4&&Ev(l);break;case 22:if(le=d!==null&&d.memoizedState!==null,l.mode&1?(Mt=(J=Mt)||le,Mn(c,l),Mt=J):Mn(c,l),Yn(l),m&8192){if(J=l.memoizedState!==null,(l.stateNode.isHidden=J)&&!le&&(l.mode&1)!==0)for(ye=l,le=l.child;le!==null;){for(ue=ye=le;ye!==null;){switch(ae=ye,_e=ae.child,ae.tag){case 0:case 11:case 14:case 15:Ea(4,ae,ae.return);break;case 1:$s(ae,ae.return);var ve=ae.stateNode;if(typeof ve.componentWillUnmount=="function"){m=ae,d=ae.return;try{c=m,ve.props=c.memoizedProps,ve.state=c.memoizedState,ve.componentWillUnmount()}catch(be){at(m,d,be)}}break;case 5:$s(ae,ae.return);break;case 22:if(ae.memoizedState!==null){Iv(ue);continue}}_e!==null?(_e.return=ae,ye=_e):Iv(ue)}le=le.sibling}e:for(le=null,ue=l;;){if(ue.tag===5){if(le===null){le=ue;try{y=ue.stateNode,J?(b=y.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(O=ue.stateNode,F=ue.memoizedProps.style,S=F!=null&&F.hasOwnProperty("display")?F.display:null,O.style.display=Xl("display",S))}catch(be){at(l,l.return,be)}}}else if(ue.tag===6){if(le===null)try{ue.stateNode.nodeValue=J?"":ue.memoizedProps}catch(be){at(l,l.return,be)}}else if((ue.tag!==22&&ue.tag!==23||ue.memoizedState===null||ue===l)&&ue.child!==null){ue.child.return=ue,ue=ue.child;continue}if(ue===l)break e;for(;ue.sibling===null;){if(ue.return===null||ue.return===l)break e;le===ue&&(le=null),ue=ue.return}le===ue&&(le=null),ue.sibling.return=ue.return,ue=ue.sibling}}break;case 19:Mn(c,l),Yn(l),m&4&&Ev(l);break;case 21:break;default:Mn(c,l),Yn(l)}}function Yn(l){var c=l.flags;if(c&2){try{e:{for(var d=l.return;d!==null;){if(xv(d)){var m=d;break e}d=d.return}throw Error(n(160))}switch(m.tag){case 5:var y=m.stateNode;m.flags&32&&(gr(y,""),m.flags&=-33);var b=Tv(l);Vd(l,b,y);break;case 3:case 4:var S=m.stateNode.containerInfo,O=Tv(l);zd(l,O,S);break;default:throw Error(n(161))}}catch(F){at(l,l.return,F)}l.flags&=-3}c&4096&&(l.flags&=-4097)}function iR(l,c,d){ye=l,Cv(l)}function Cv(l,c,d){for(var m=(l.mode&1)!==0;ye!==null;){var y=ye,b=y.child;if(y.tag===22&&m){var S=y.memoizedState!==null||Fc;if(!S){var O=y.alternate,F=O!==null&&O.memoizedState!==null||Mt;O=Fc;var J=Mt;if(Fc=S,(Mt=F)&&!J)for(ye=y;ye!==null;)S=ye,F=S.child,S.tag===22&&S.memoizedState!==null?kv(y):F!==null?(F.return=S,ye=F):kv(y);for(;b!==null;)ye=b,Cv(b),b=b.sibling;ye=y,Fc=O,Mt=J}Rv(l)}else(y.subtreeFlags&8772)!==0&&b!==null?(b.return=y,ye=b):Rv(l)}}function Rv(l){for(;ye!==null;){var c=ye;if((c.flags&8772)!==0){var d=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:Mt||Lc(5,c);break;case 1:var m=c.stateNode;if(c.flags&4&&!Mt)if(d===null)m.componentDidMount();else{var y=c.elementType===c.type?d.memoizedProps:kn(c.type,d.memoizedProps);m.componentDidUpdate(y,d.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var b=c.updateQueue;b!==null&&I0(c,b,m);break;case 3:var S=c.updateQueue;if(S!==null){if(d=null,c.child!==null)switch(c.child.tag){case 5:d=c.child.stateNode;break;case 1:d=c.child.stateNode}I0(c,S,d)}break;case 5:var O=c.stateNode;if(d===null&&c.flags&4){d=O;var F=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":F.autoFocus&&d.focus();break;case"img":F.src&&(d.src=F.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var J=c.alternate;if(J!==null){var le=J.memoizedState;if(le!==null){var ue=le.dehydrated;ue!==null&&ra(ue)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Mt||c.flags&512&&jd(c)}catch(ae){at(c,c.return,ae)}}if(c===l){ye=null;break}if(d=c.sibling,d!==null){d.return=c.return,ye=d;break}ye=c.return}}function Iv(l){for(;ye!==null;){var c=ye;if(c===l){ye=null;break}var d=c.sibling;if(d!==null){d.return=c.return,ye=d;break}ye=c.return}}function kv(l){for(;ye!==null;){var c=ye;try{switch(c.tag){case 0:case 11:case 15:var d=c.return;try{Lc(4,c)}catch(F){at(c,d,F)}break;case 1:var m=c.stateNode;if(typeof m.componentDidMount=="function"){var y=c.return;try{m.componentDidMount()}catch(F){at(c,y,F)}}var b=c.return;try{jd(c)}catch(F){at(c,b,F)}break;case 5:var S=c.return;try{jd(c)}catch(F){at(c,S,F)}}}catch(F){at(c,c.return,F)}if(c===l){ye=null;break}var O=c.sibling;if(O!==null){O.return=c.return,ye=O;break}ye=c.return}}var sR=Math.ceil,Bc=R.ReactCurrentDispatcher,$d=R.ReactCurrentOwner,hn=R.ReactCurrentBatchConfig,Le=0,xt=null,dt=null,Rt=0,Gt=0,Ws=Zr(0),yt=0,Aa=null,Ui=0,Uc=0,Wd=0,Ca=null,Ht=null,Hd=0,Hs=1/0,Tr=null,jc=!1,Xd=null,ni=null,zc=!1,ri=null,Vc=0,Ra=0,Yd=null,$c=-1,Wc=0;function jt(){return(Le&6)!==0?ut():$c!==-1?$c:$c=ut()}function ii(l){return(l.mode&1)===0?1:(Le&2)!==0&&Rt!==0?Rt&-Rt:VC.transition!==null?(Wc===0&&(Wc=Ty()),Wc):(l=$e,l!==0||(l=window.event,l=l===void 0?16:My(l.type)),l)}function Nn(l,c,d,m){if(50<Ra)throw Ra=0,Yd=null,Error(n(185));Jo(l,d,m),((Le&2)===0||l!==xt)&&(l===xt&&((Le&2)===0&&(Uc|=d),yt===4&&si(l,Rt)),Xt(l,m),d===1&&Le===0&&(c.mode&1)===0&&(Hs=ut()+500,yc&&Jr()))}function Xt(l,c){var d=l.callbackNode;VA(l,c);var m=Gl(l,l===xt?Rt:0);if(m===0)d!==null&&by(d),l.callbackNode=null,l.callbackPriority=0;else if(c=m&-m,l.callbackPriority!==c){if(d!=null&&by(d),c===1)l.tag===0?zC(Mv.bind(null,l)):_0(Mv.bind(null,l)),LC(function(){(Le&6)===0&&Jr()}),d=null;else{switch(Sy(m)){case 1:d=Ah;break;case 4:d=wy;break;case 16:d=Kl;break;case 536870912:d=xy;break;default:d=Kl}d=jv(d,Pv.bind(null,l))}l.callbackPriority=c,l.callbackNode=d}}function Pv(l,c){if($c=-1,Wc=0,(Le&6)!==0)throw Error(n(327));var d=l.callbackNode;if(Xs()&&l.callbackNode!==d)return null;var m=Gl(l,l===xt?Rt:0);if(m===0)return null;if((m&30)!==0||(m&l.expiredLanes)!==0||c)c=Hc(l,m);else{c=m;var y=Le;Le|=2;var b=Ov();(xt!==l||Rt!==c)&&(Tr=null,Hs=ut()+500,zi(l,c));do try{lR();break}catch(O){Nv(l,O)}while(!0);fd(),Bc.current=b,Le=y,dt!==null?c=0:(xt=null,Rt=0,c=yt)}if(c!==0){if(c===2&&(y=Ch(l),y!==0&&(m=y,c=qd(l,y))),c===1)throw d=Aa,zi(l,0),si(l,m),Xt(l,ut()),d;if(c===6)si(l,m);else{if(y=l.current.alternate,(m&30)===0&&!oR(y)&&(c=Hc(l,m),c===2&&(b=Ch(l),b!==0&&(m=b,c=qd(l,b))),c===1))throw d=Aa,zi(l,0),si(l,m),Xt(l,ut()),d;switch(l.finishedWork=y,l.finishedLanes=m,c){case 0:case 1:throw Error(n(345));case 2:Vi(l,Ht,Tr);break;case 3:if(si(l,m),(m&130023424)===m&&(c=Hd+500-ut(),10<c)){if(Gl(l,0)!==0)break;if(y=l.suspendedLanes,(y&m)!==m){jt(),l.pingedLanes|=l.suspendedLanes&y;break}l.timeoutHandle=ed(Vi.bind(null,l,Ht,Tr),c);break}Vi(l,Ht,Tr);break;case 4:if(si(l,m),(m&4194240)===m)break;for(c=l.eventTimes,y=-1;0<m;){var S=31-Cn(m);b=1<<S,S=c[S],S>y&&(y=S),m&=~b}if(m=y,m=ut()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*sR(m/1960))-m,10<m){l.timeoutHandle=ed(Vi.bind(null,l,Ht,Tr),m);break}Vi(l,Ht,Tr);break;case 5:Vi(l,Ht,Tr);break;default:throw Error(n(329))}}}return Xt(l,ut()),l.callbackNode===d?Pv.bind(null,l):null}function qd(l,c){var d=Ca;return l.current.memoizedState.isDehydrated&&(zi(l,c).flags|=256),l=Hc(l,c),l!==2&&(c=Ht,Ht=d,c!==null&&Kd(c)),l}function Kd(l){Ht===null?Ht=l:Ht.push.apply(Ht,l)}function oR(l){for(var c=l;;){if(c.flags&16384){var d=c.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var m=0;m<d.length;m++){var y=d[m],b=y.getSnapshot;y=y.value;try{if(!Rn(b(),y))return!1}catch{return!1}}}if(d=c.child,c.subtreeFlags&16384&&d!==null)d.return=c,c=d;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function si(l,c){for(c&=~Wd,c&=~Uc,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var d=31-Cn(c),m=1<<d;l[d]=-1,c&=~m}}function Mv(l){if((Le&6)!==0)throw Error(n(327));Xs();var c=Gl(l,0);if((c&1)===0)return Xt(l,ut()),null;var d=Hc(l,c);if(l.tag!==0&&d===2){var m=Ch(l);m!==0&&(c=m,d=qd(l,m))}if(d===1)throw d=Aa,zi(l,0),si(l,c),Xt(l,ut()),d;if(d===6)throw Error(n(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,Vi(l,Ht,Tr),Xt(l,ut()),null}function Zd(l,c){var d=Le;Le|=1;try{return l(c)}finally{Le=d,Le===0&&(Hs=ut()+500,yc&&Jr())}}function ji(l){ri!==null&&ri.tag===0&&(Le&6)===0&&Xs();var c=Le;Le|=1;var d=hn.transition,m=$e;try{if(hn.transition=null,$e=1,l)return l()}finally{$e=m,hn.transition=d,Le=c,(Le&6)===0&&Jr()}}function Qd(){Gt=Ws.current,Qe(Ws)}function zi(l,c){l.finishedWork=null,l.finishedLanes=0;var d=l.timeoutHandle;if(d!==-1&&(l.timeoutHandle=-1,FC(d)),dt!==null)for(d=dt.return;d!==null;){var m=d;switch(od(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&mc();break;case 3:zs(),Qe(Vt),Qe(It),vd();break;case 5:_d(m);break;case 4:zs();break;case 13:Qe(nt);break;case 19:Qe(nt);break;case 10:hd(m.type._context);break;case 22:case 23:Qd()}d=d.return}if(xt=l,dt=l=oi(l.current,null),Rt=Gt=c,yt=0,Aa=null,Wd=Uc=Ui=0,Ht=Ca=null,Fi!==null){for(c=0;c<Fi.length;c++)if(d=Fi[c],m=d.interleaved,m!==null){d.interleaved=null;var y=m.next,b=d.pending;if(b!==null){var S=b.next;b.next=y,m.next=S}d.pending=m}Fi=null}return l}function Nv(l,c){do{var d=dt;try{if(fd(),Rc.current=Mc,Ic){for(var m=rt.memoizedState;m!==null;){var y=m.queue;y!==null&&(y.pending=null),m=m.next}Ic=!1}if(Bi=0,wt=_t=rt=null,ba=!1,wa=0,$d.current=null,d===null||d.return===null){yt=1,Aa=c,dt=null;break}e:{var b=l,S=d.return,O=d,F=c;if(c=Rt,O.flags|=32768,F!==null&&typeof F=="object"&&typeof F.then=="function"){var J=F,le=O,ue=le.tag;if((le.mode&1)===0&&(ue===0||ue===11||ue===15)){var ae=le.alternate;ae?(le.updateQueue=ae.updateQueue,le.memoizedState=ae.memoizedState,le.lanes=ae.lanes):(le.updateQueue=null,le.memoizedState=null)}var _e=iv(S);if(_e!==null){_e.flags&=-257,sv(_e,S,O,b,c),_e.mode&1&&rv(b,J,c),c=_e,F=J;var ve=c.updateQueue;if(ve===null){var be=new Set;be.add(F),c.updateQueue=be}else ve.add(F);break e}else{if((c&1)===0){rv(b,J,c),Jd();break e}F=Error(n(426))}}else if(Ge&&O.mode&1){var ft=iv(S);if(ft!==null){(ft.flags&65536)===0&&(ft.flags|=256),sv(ft,S,O,b,c),cd(Vs(F,O));break e}}b=F=Vs(F,O),yt!==4&&(yt=2),Ca===null?Ca=[b]:Ca.push(b),b=S;do{switch(b.tag){case 3:b.flags|=65536,c&=-c,b.lanes|=c;var K=tv(b,F,c);R0(b,K);break e;case 1:O=F;var U=b.type,Q=b.stateNode;if((b.flags&128)===0&&(typeof U.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(ni===null||!ni.has(Q)))){b.flags|=65536,c&=-c,b.lanes|=c;var de=nv(b,O,c);R0(b,de);break e}}b=b.return}while(b!==null)}Fv(d)}catch(we){c=we,dt===d&&d!==null&&(dt=d=d.return);continue}break}while(!0)}function Ov(){var l=Bc.current;return Bc.current=Mc,l===null?Mc:l}function Jd(){(yt===0||yt===3||yt===2)&&(yt=4),xt===null||(Ui&268435455)===0&&(Uc&268435455)===0||si(xt,Rt)}function Hc(l,c){var d=Le;Le|=2;var m=Ov();(xt!==l||Rt!==c)&&(Tr=null,zi(l,c));do try{aR();break}catch(y){Nv(l,y)}while(!0);if(fd(),Le=d,Bc.current=m,dt!==null)throw Error(n(261));return xt=null,Rt=0,yt}function aR(){for(;dt!==null;)Dv(dt)}function lR(){for(;dt!==null&&!NA();)Dv(dt)}function Dv(l){var c=Uv(l.alternate,l,Gt);l.memoizedProps=l.pendingProps,c===null?Fv(l):dt=c,$d.current=null}function Fv(l){var c=l;do{var d=c.alternate;if(l=c.return,(c.flags&32768)===0){if(d=eR(d,c,Gt),d!==null){dt=d;return}}else{if(d=tR(d,c),d!==null){d.flags&=32767,dt=d;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{yt=6,dt=null;return}}if(c=c.sibling,c!==null){dt=c;return}dt=c=l}while(c!==null);yt===0&&(yt=5)}function Vi(l,c,d){var m=$e,y=hn.transition;try{hn.transition=null,$e=1,cR(l,c,d,m)}finally{hn.transition=y,$e=m}return null}function cR(l,c,d,m){do Xs();while(ri!==null);if((Le&6)!==0)throw Error(n(327));d=l.finishedWork;var y=l.finishedLanes;if(d===null)return null;if(l.finishedWork=null,l.finishedLanes=0,d===l.current)throw Error(n(177));l.callbackNode=null,l.callbackPriority=0;var b=d.lanes|d.childLanes;if($A(l,b),l===xt&&(dt=xt=null,Rt=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||zc||(zc=!0,jv(Kl,function(){return Xs(),null})),b=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||b){b=hn.transition,hn.transition=null;var S=$e;$e=1;var O=Le;Le|=4,$d.current=null,rR(l,d),Av(d,l),IC(Jh),nc=!!Qh,Jh=Qh=null,l.current=d,iR(d),OA(),Le=O,$e=S,hn.transition=b}else l.current=d;if(zc&&(zc=!1,ri=l,Vc=y),b=l.pendingLanes,b===0&&(ni=null),LA(d.stateNode),Xt(l,ut()),c!==null)for(m=l.onRecoverableError,d=0;d<c.length;d++)y=c[d],m(y.value,{componentStack:y.stack,digest:y.digest});if(jc)throw jc=!1,l=Xd,Xd=null,l;return(Vc&1)!==0&&l.tag!==0&&Xs(),b=l.pendingLanes,(b&1)!==0?l===Yd?Ra++:(Ra=0,Yd=l):Ra=0,Jr(),null}function Xs(){if(ri!==null){var l=Sy(Vc),c=hn.transition,d=$e;try{if(hn.transition=null,$e=16>l?16:l,ri===null)var m=!1;else{if(l=ri,ri=null,Vc=0,(Le&6)!==0)throw Error(n(331));var y=Le;for(Le|=4,ye=l.current;ye!==null;){var b=ye,S=b.child;if((ye.flags&16)!==0){var O=b.deletions;if(O!==null){for(var F=0;F<O.length;F++){var J=O[F];for(ye=J;ye!==null;){var le=ye;switch(le.tag){case 0:case 11:case 15:Ea(8,le,b)}var ue=le.child;if(ue!==null)ue.return=le,ye=ue;else for(;ye!==null;){le=ye;var ae=le.sibling,_e=le.return;if(wv(le),le===J){ye=null;break}if(ae!==null){ae.return=_e,ye=ae;break}ye=_e}}}var ve=b.alternate;if(ve!==null){var be=ve.child;if(be!==null){ve.child=null;do{var ft=be.sibling;be.sibling=null,be=ft}while(be!==null)}}ye=b}}if((b.subtreeFlags&2064)!==0&&S!==null)S.return=b,ye=S;else e:for(;ye!==null;){if(b=ye,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:Ea(9,b,b.return)}var K=b.sibling;if(K!==null){K.return=b.return,ye=K;break e}ye=b.return}}var U=l.current;for(ye=U;ye!==null;){S=ye;var Q=S.child;if((S.subtreeFlags&2064)!==0&&Q!==null)Q.return=S,ye=Q;else e:for(S=U;ye!==null;){if(O=ye,(O.flags&2048)!==0)try{switch(O.tag){case 0:case 11:case 15:Lc(9,O)}}catch(we){at(O,O.return,we)}if(O===S){ye=null;break e}var de=O.sibling;if(de!==null){de.return=O.return,ye=de;break e}ye=O.return}}if(Le=y,Jr(),$n&&typeof $n.onPostCommitFiberRoot=="function")try{$n.onPostCommitFiberRoot(Zl,l)}catch{}m=!0}return m}finally{$e=d,hn.transition=c}}return!1}function Lv(l,c,d){c=Vs(d,c),c=tv(l,c,1),l=ei(l,c,1),c=jt(),l!==null&&(Jo(l,1,c),Xt(l,c))}function at(l,c,d){if(l.tag===3)Lv(l,l,d);else for(;c!==null;){if(c.tag===3){Lv(c,l,d);break}else if(c.tag===1){var m=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(ni===null||!ni.has(m))){l=Vs(d,l),l=nv(c,l,1),c=ei(c,l,1),l=jt(),c!==null&&(Jo(c,1,l),Xt(c,l));break}}c=c.return}}function uR(l,c,d){var m=l.pingCache;m!==null&&m.delete(c),c=jt(),l.pingedLanes|=l.suspendedLanes&d,xt===l&&(Rt&d)===d&&(yt===4||yt===3&&(Rt&130023424)===Rt&&500>ut()-Hd?zi(l,0):Wd|=d),Xt(l,c)}function Bv(l,c){c===0&&((l.mode&1)===0?c=1:(c=Jl,Jl<<=1,(Jl&130023424)===0&&(Jl=4194304)));var d=jt();l=br(l,c),l!==null&&(Jo(l,c,d),Xt(l,d))}function fR(l){var c=l.memoizedState,d=0;c!==null&&(d=c.retryLane),Bv(l,d)}function hR(l,c){var d=0;switch(l.tag){case 13:var m=l.stateNode,y=l.memoizedState;y!==null&&(d=y.retryLane);break;case 19:m=l.stateNode;break;default:throw Error(n(314))}m!==null&&m.delete(c),Bv(l,d)}var Uv;Uv=function(l,c,d){if(l!==null)if(l.memoizedProps!==c.pendingProps||Vt.current)Wt=!0;else{if((l.lanes&d)===0&&(c.flags&128)===0)return Wt=!1,GC(l,c,d);Wt=(l.flags&131072)!==0}else Wt=!1,Ge&&(c.flags&1048576)!==0&&y0(c,bc,c.index);switch(c.lanes=0,c.tag){case 2:var m=c.type;Dc(l,c),l=c.pendingProps;var y=Os(c,It.current);js(c,d),y=xd(null,c,m,l,y,d);var b=Td();return c.flags|=1,typeof y=="object"&&y!==null&&typeof y.render=="function"&&y.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,$t(m)?(b=!0,_c(c)):b=!1,c.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,gd(c),y.updater=Nc,c.stateNode=y,y._reactInternals=c,Id(c,m,l,d),c=Nd(null,c,m,!0,b,d)):(c.tag=0,Ge&&b&&sd(c),Ut(null,c,y,d),c=c.child),c;case 16:m=c.elementType;e:{switch(Dc(l,c),l=c.pendingProps,y=m._init,m=y(m._payload),c.type=m,y=c.tag=pR(m),l=kn(m,l),y){case 0:c=Md(null,c,m,l,d);break e;case 1:c=fv(null,c,m,l,d);break e;case 11:c=ov(null,c,m,l,d);break e;case 14:c=av(null,c,m,kn(m.type,l),d);break e}throw Error(n(306,m,""))}return c;case 0:return m=c.type,y=c.pendingProps,y=c.elementType===m?y:kn(m,y),Md(l,c,m,y,d);case 1:return m=c.type,y=c.pendingProps,y=c.elementType===m?y:kn(m,y),fv(l,c,m,y,d);case 3:e:{if(hv(c),l===null)throw Error(n(387));m=c.pendingProps,b=c.memoizedState,y=b.element,C0(l,c),Ac(c,m,null,d);var S=c.memoizedState;if(m=S.element,b.isDehydrated)if(b={element:m,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},c.updateQueue.baseState=b,c.memoizedState=b,c.flags&256){y=Vs(Error(n(423)),c),c=dv(l,c,m,d,y);break e}else if(m!==y){y=Vs(Error(n(424)),c),c=dv(l,c,m,d,y);break e}else for(Jt=Kr(c.stateNode.containerInfo.firstChild),Qt=c,Ge=!0,In=null,d=E0(c,null,m,d),c.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Ls(),m===y){c=xr(l,c,d);break e}Ut(l,c,m,d)}c=c.child}return c;case 5:return k0(c),l===null&&ld(c),m=c.type,y=c.pendingProps,b=l!==null?l.memoizedProps:null,S=y.children,Gh(m,y)?S=null:b!==null&&Gh(m,b)&&(c.flags|=32),uv(l,c),Ut(l,c,S,d),c.child;case 6:return l===null&&ld(c),null;case 13:return pv(l,c,d);case 4:return md(c,c.stateNode.containerInfo),m=c.pendingProps,l===null?c.child=Bs(c,null,m,d):Ut(l,c,m,d),c.child;case 11:return m=c.type,y=c.pendingProps,y=c.elementType===m?y:kn(m,y),ov(l,c,m,y,d);case 7:return Ut(l,c,c.pendingProps,d),c.child;case 8:return Ut(l,c,c.pendingProps.children,d),c.child;case 12:return Ut(l,c,c.pendingProps.children,d),c.child;case 10:e:{if(m=c.type._context,y=c.pendingProps,b=c.memoizedProps,S=y.value,Ye(Tc,m._currentValue),m._currentValue=S,b!==null)if(Rn(b.value,S)){if(b.children===y.children&&!Vt.current){c=xr(l,c,d);break e}}else for(b=c.child,b!==null&&(b.return=c);b!==null;){var O=b.dependencies;if(O!==null){S=b.child;for(var F=O.firstContext;F!==null;){if(F.context===m){if(b.tag===1){F=wr(-1,d&-d),F.tag=2;var J=b.updateQueue;if(J!==null){J=J.shared;var le=J.pending;le===null?F.next=F:(F.next=le.next,le.next=F),J.pending=F}}b.lanes|=d,F=b.alternate,F!==null&&(F.lanes|=d),dd(b.return,d,c),O.lanes|=d;break}F=F.next}}else if(b.tag===10)S=b.type===c.type?null:b.child;else if(b.tag===18){if(S=b.return,S===null)throw Error(n(341));S.lanes|=d,O=S.alternate,O!==null&&(O.lanes|=d),dd(S,d,c),S=b.sibling}else S=b.child;if(S!==null)S.return=b;else for(S=b;S!==null;){if(S===c){S=null;break}if(b=S.sibling,b!==null){b.return=S.return,S=b;break}S=S.return}b=S}Ut(l,c,y.children,d),c=c.child}return c;case 9:return y=c.type,m=c.pendingProps.children,js(c,d),y=un(y),m=m(y),c.flags|=1,Ut(l,c,m,d),c.child;case 14:return m=c.type,y=kn(m,c.pendingProps),y=kn(m.type,y),av(l,c,m,y,d);case 15:return lv(l,c,c.type,c.pendingProps,d);case 17:return m=c.type,y=c.pendingProps,y=c.elementType===m?y:kn(m,y),Dc(l,c),c.tag=1,$t(m)?(l=!0,_c(c)):l=!1,js(c,d),G0(c,m,y),Id(c,m,y,d),Nd(null,c,m,!0,l,d);case 19:return mv(l,c,d);case 22:return cv(l,c,d)}throw Error(n(156,c.tag))};function jv(l,c){return vy(l,c)}function dR(l,c,d,m){this.tag=l,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(l,c,d,m){return new dR(l,c,d,m)}function Gd(l){return l=l.prototype,!(!l||!l.isReactComponent)}function pR(l){if(typeof l=="function")return Gd(l)?1:0;if(l!=null){if(l=l.$$typeof,l===te)return 11;if(l===G)return 14}return 2}function oi(l,c){var d=l.alternate;return d===null?(d=dn(l.tag,c,l.key,l.mode),d.elementType=l.elementType,d.type=l.type,d.stateNode=l.stateNode,d.alternate=l,l.alternate=d):(d.pendingProps=c,d.type=l.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=l.flags&14680064,d.childLanes=l.childLanes,d.lanes=l.lanes,d.child=l.child,d.memoizedProps=l.memoizedProps,d.memoizedState=l.memoizedState,d.updateQueue=l.updateQueue,c=l.dependencies,d.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},d.sibling=l.sibling,d.index=l.index,d.ref=l.ref,d}function Xc(l,c,d,m,y,b){var S=2;if(m=l,typeof l=="function")Gd(l)&&(S=1);else if(typeof l=="string")S=5;else e:switch(l){case L:return $i(d.children,y,b,c);case W:S=8,y|=8;break;case H:return l=dn(12,d,c,y|2),l.elementType=H,l.lanes=b,l;case ie:return l=dn(13,d,c,y),l.elementType=ie,l.lanes=b,l;case se:return l=dn(19,d,c,y),l.elementType=se,l.lanes=b,l;case xe:return Yc(d,y,b,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case X:S=10;break e;case B:S=9;break e;case te:S=11;break e;case G:S=14;break e;case ce:S=16,m=null;break e}throw Error(n(130,l==null?l:typeof l,""))}return c=dn(S,d,c,y),c.elementType=l,c.type=m,c.lanes=b,c}function $i(l,c,d,m){return l=dn(7,l,m,c),l.lanes=d,l}function Yc(l,c,d,m){return l=dn(22,l,m,c),l.elementType=xe,l.lanes=d,l.stateNode={isHidden:!1},l}function ep(l,c,d){return l=dn(6,l,null,c),l.lanes=d,l}function tp(l,c,d){return c=dn(4,l.children!==null?l.children:[],l.key,c),c.lanes=d,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function gR(l,c,d,m,y){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rh(0),this.expirationTimes=Rh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rh(0),this.identifierPrefix=m,this.onRecoverableError=y,this.mutableSourceEagerHydrationData=null}function np(l,c,d,m,y,b,S,O,F){return l=new gR(l,c,d,O,F),c===1?(c=1,b===!0&&(c|=8)):c=0,b=dn(3,null,null,c),l.current=b,b.stateNode=l,b.memoizedState={element:m,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},gd(b),l}function mR(l,c,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:m==null?null:""+m,children:l,containerInfo:c,implementation:d}}function zv(l){if(!l)return Qr;l=l._reactInternals;e:{if(Pi(l)!==l||l.tag!==1)throw Error(n(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if($t(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(n(171))}if(l.tag===1){var d=l.type;if($t(d))return g0(l,d,c)}return c}function Vv(l,c,d,m,y,b,S,O,F){return l=np(d,m,!0,l,y,b,S,O,F),l.context=zv(null),d=l.current,m=jt(),y=ii(d),b=wr(m,y),b.callback=c??null,ei(d,b,y),l.current.lanes=y,Jo(l,y,m),Xt(l,m),l}function qc(l,c,d,m){var y=c.current,b=jt(),S=ii(y);return d=zv(d),c.context===null?c.context=d:c.pendingContext=d,c=wr(b,S),c.payload={element:l},m=m===void 0?null:m,m!==null&&(c.callback=m),l=ei(y,c,S),l!==null&&(Nn(l,y,S,b),Ec(l,y,S)),S}function Kc(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return l.child.stateNode;default:return l.child.stateNode}}function $v(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var d=l.retryLane;l.retryLane=d!==0&&d<c?d:c}}function rp(l,c){$v(l,c),(l=l.alternate)&&$v(l,c)}function _R(){return null}var Wv=typeof reportError=="function"?reportError:function(l){console.error(l)};function ip(l){this._internalRoot=l}Zc.prototype.render=ip.prototype.render=function(l){var c=this._internalRoot;if(c===null)throw Error(n(409));qc(l,c,null,null)},Zc.prototype.unmount=ip.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var c=l.containerInfo;ji(function(){qc(null,l,null,null)}),c[mr]=null}};function Zc(l){this._internalRoot=l}Zc.prototype.unstable_scheduleHydration=function(l){if(l){var c=Cy();l={blockedOn:null,target:l,priority:c};for(var d=0;d<Xr.length&&c!==0&&c<Xr[d].priority;d++);Xr.splice(d,0,l),d===0&&ky(l)}};function sp(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function Qc(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11&&(l.nodeType!==8||l.nodeValue!==" react-mount-point-unstable "))}function Hv(){}function yR(l,c,d,m,y){if(y){if(typeof m=="function"){var b=m;m=function(){var J=Kc(S);b.call(J)}}var S=Vv(c,m,l,0,null,!1,!1,"",Hv);return l._reactRootContainer=S,l[mr]=S.current,ha(l.nodeType===8?l.parentNode:l),ji(),S}for(;y=l.lastChild;)l.removeChild(y);if(typeof m=="function"){var O=m;m=function(){var J=Kc(F);O.call(J)}}var F=np(l,0,!1,null,null,!1,!1,"",Hv);return l._reactRootContainer=F,l[mr]=F.current,ha(l.nodeType===8?l.parentNode:l),ji(function(){qc(c,F,d,m)}),F}function Jc(l,c,d,m,y){var b=d._reactRootContainer;if(b){var S=b;if(typeof y=="function"){var O=y;y=function(){var F=Kc(S);O.call(F)}}qc(c,S,l,y)}else S=yR(d,c,l,y,m);return Kc(S)}Ey=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var d=Qo(c.pendingLanes);d!==0&&(Ih(c,d|1),Xt(c,ut()),(Le&6)===0&&(Hs=ut()+500,Jr()))}break;case 13:ji(function(){var m=br(l,1);if(m!==null){var y=jt();Nn(m,l,1,y)}}),rp(l,1)}},kh=function(l){if(l.tag===13){var c=br(l,134217728);if(c!==null){var d=jt();Nn(c,l,134217728,d)}rp(l,134217728)}},Ay=function(l){if(l.tag===13){var c=ii(l),d=br(l,c);if(d!==null){var m=jt();Nn(d,l,c,m)}rp(l,c)}},Cy=function(){return $e},Ry=function(l,c){var d=$e;try{return $e=l,c()}finally{$e=d}},xh=function(l,c,d){switch(c){case"input":if(Ho(l,d),c=d.name,d.type==="radio"&&c!=null){for(d=l;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<d.length;c++){var m=d[c];if(m!==l&&m.form===l.form){var y=gc(m);if(!y)throw Error(n(90));hr(m),Ho(m,y)}}}break;case"textarea":Wl(l,d);break;case"select":c=d.value,c!=null&&pr(l,!!d.multiple,c,!1)}},hy=Zd,dy=ji;var vR={usingClientEntryPoint:!1,Events:[ga,Ms,gc,uy,fy,Zd]},Ia={findFiberByHostInstance:Mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bR={bundleType:Ia.bundleType,version:Ia.version,rendererPackageName:Ia.rendererPackageName,rendererConfig:Ia.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(l){return l=_y(l),l===null?null:l.stateNode},findFiberByHostInstance:Ia.findFiberByHostInstance||_R,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gc.isDisabled&&Gc.supportsFiber)try{Zl=Gc.inject(bR),$n=Gc}catch{}}return Yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vR,Yt.createPortal=function(l,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sp(c))throw Error(n(200));return mR(l,c,null,d)},Yt.createRoot=function(l,c){if(!sp(l))throw Error(n(299));var d=!1,m="",y=Wv;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(m=c.identifierPrefix),c.onRecoverableError!==void 0&&(y=c.onRecoverableError)),c=np(l,1,!1,null,null,d,!1,m,y),l[mr]=c.current,ha(l.nodeType===8?l.parentNode:l),new ip(c)},Yt.findDOMNode=function(l){if(l==null)return null;if(l.nodeType===1)return l;var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=_y(c),l=l===null?null:l.stateNode,l},Yt.flushSync=function(l){return ji(l)},Yt.hydrate=function(l,c,d){if(!Qc(c))throw Error(n(200));return Jc(null,l,c,!0,d)},Yt.hydrateRoot=function(l,c,d){if(!sp(l))throw Error(n(405));var m=d!=null&&d.hydratedSources||null,y=!1,b="",S=Wv;if(d!=null&&(d.unstable_strictMode===!0&&(y=!0),d.identifierPrefix!==void 0&&(b=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),c=Vv(c,null,l,1,d??null,y,!1,b,S),l[mr]=c.current,ha(l),m)for(l=0;l<m.length;l++)d=m[l],y=d._getVersion,y=y(d._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[d,y]:c.mutableSourceEagerHydrationData.push(d,y);return new Zc(c)},Yt.render=function(l,c,d){if(!Qc(c))throw Error(n(200));return Jc(null,l,c,!1,d)},Yt.unmountComponentAtNode=function(l){if(!Qc(l))throw Error(n(40));return l._reactRootContainer?(ji(function(){Jc(null,null,l,!1,function(){l._reactRootContainer=null,l[mr]=null})}),!0):!1},Yt.unstable_batchedUpdates=Zd,Yt.unstable_renderSubtreeIntoContainer=function(l,c,d,m){if(!Qc(d))throw Error(n(200));if(l==null||l._reactInternals===void 0)throw Error(n(38));return Jc(l,c,d,!1,m)},Yt.version="18.3.1-next-f1338f8080-20240426",Yt}var Gv;function m2(){if(Gv)return lp.exports;Gv=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),lp.exports=CR(),lp.exports}var e1;function RR(){if(e1)return eu;e1=1;var t=m2();return eu.createRoot=t.createRoot,eu.hydrateRoot=t.hydrateRoot,eu}var IR=RR();const kR=kl(IR);var Pa={},t1;function PR(){if(t1)return Pa;t1=1,Object.defineProperty(Pa,"__esModule",{value:!0}),Pa.parse=o,Pa.serialize=f;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,s=(()=>{const g=function(){};return g.prototype=Object.create(null),g})();function o(g,_){const v=new s,w=g.length;if(w<2)return v;const x=_?.decode||h;let T=0;do{const A=g.indexOf("=",T);if(A===-1)break;const E=g.indexOf(";",T),R=E===-1?w:E;if(A>R){T=g.lastIndexOf(";",A-1)+1;continue}const k=a(g,T,A),M=u(g,A,k),L=g.slice(k,M);if(v[L]===void 0){let W=a(g,A+1,R),H=u(g,R,W);const X=x(g.slice(W,H));v[L]=X}T=R+1}while(T<w);return v}function a(g,_,v){do{const w=g.charCodeAt(_);if(w!==32&&w!==9)return _}while(++_<v);return v}function u(g,_,v){for(;_>v;){const w=g.charCodeAt(--_);if(w!==32&&w!==9)return _+1}return v}function f(g,_,v){const w=v?.encode||encodeURIComponent;if(!t.test(g))throw new TypeError(`argument name is invalid: ${g}`);const x=w(_);if(!e.test(x))throw new TypeError(`argument val is invalid: ${_}`);let T=g+"="+x;if(!v)return T;if(v.maxAge!==void 0){if(!Number.isInteger(v.maxAge))throw new TypeError(`option maxAge is invalid: ${v.maxAge}`);T+="; Max-Age="+v.maxAge}if(v.domain){if(!n.test(v.domain))throw new TypeError(`option domain is invalid: ${v.domain}`);T+="; Domain="+v.domain}if(v.path){if(!r.test(v.path))throw new TypeError(`option path is invalid: ${v.path}`);T+="; Path="+v.path}if(v.expires){if(!p(v.expires)||!Number.isFinite(v.expires.valueOf()))throw new TypeError(`option expires is invalid: ${v.expires}`);T+="; Expires="+v.expires.toUTCString()}if(v.httpOnly&&(T+="; HttpOnly"),v.secure&&(T+="; Secure"),v.partitioned&&(T+="; Partitioned"),v.priority)switch(typeof v.priority=="string"?v.priority.toLowerCase():void 0){case"low":T+="; Priority=Low";break;case"medium":T+="; Priority=Medium";break;case"high":T+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${v.priority}`)}if(v.sameSite)switch(typeof v.sameSite=="string"?v.sameSite.toLowerCase():v.sameSite){case!0:case"strict":T+="; SameSite=Strict";break;case"lax":T+="; SameSite=Lax";break;case"none":T+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${v.sameSite}`)}return T}function h(g){if(g.indexOf("%")===-1)return g;try{return decodeURIComponent(g)}catch{return g}}function p(g){return i.call(g)==="[object Date]"}return Pa}PR();var n1="popstate";function MR(t={}){function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return fg("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:dl(i)}return OR(e,n,null,t)}function ot(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function ar(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function NR(){return Math.random().toString(36).substring(2,10)}function r1(t,e){return{usr:t.state,key:t.key,idx:e}}function fg(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Bo(e):e,state:n,key:e&&e.key||r||NR()}}function dl({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Bo(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function OR(t,e,n,r={}){let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a="POP",u=null,f=h();f==null&&(f=0,o.replaceState({...o.state,idx:f},""));function h(){return(o.state||{idx:null}).idx}function p(){a="POP";let x=h(),T=x==null?null:x-f;f=x,u&&u({action:a,location:w.location,delta:T})}function g(x,T){a="PUSH";let A=fg(w.location,x,T);f=h()+1;let E=r1(A,f),R=w.createHref(A);try{o.pushState(E,"",R)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(R)}s&&u&&u({action:a,location:w.location,delta:1})}function _(x,T){a="REPLACE";let A=fg(w.location,x,T);f=h();let E=r1(A,f),R=w.createHref(A);o.replaceState(E,"",R),s&&u&&u({action:a,location:w.location,delta:0})}function v(x){return DR(x)}let w={get action(){return a},get location(){return t(i,o)},listen(x){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(n1,p),u=x,()=>{i.removeEventListener(n1,p),u=null}},createHref(x){return e(i,x)},createURL:v,encodeLocation(x){let T=v(x);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:g,replace:_,go(x){return o.go(x)}};return w}function DR(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),ot(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:dl(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function _2(t,e,n="/"){return FR(t,e,n,!1)}function FR(t,e,n,r){let i=typeof e=="string"?Bo(e):e,s=Mr(i.pathname||"/",n);if(s==null)return null;let o=y2(t);LR(o);let a=null;for(let u=0;a==null&&u<o.length;++u){let f=qR(s);a=XR(o[u],f,r)}return a}function y2(t,e=[],n=[],r=""){let i=(s,o,a)=>{let u={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};u.relativePath.startsWith("/")&&(ot(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length));let f=Pr([r,u.relativePath]),h=n.concat(u);s.children&&s.children.length>0&&(ot(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),y2(s.children,e,h,f)),!(s.path==null&&!s.index)&&e.push({path:f,score:WR(f,s.index),routesMeta:h})};return t.forEach((s,o)=>{if(s.path===""||!s.path?.includes("?"))i(s,o);else for(let a of v2(s.path))i(s,o,a)}),e}function v2(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=v2(r.join("/")),a=[];return a.push(...o.map(u=>u===""?s:[s,u].join("/"))),i&&a.push(...o),a.map(u=>t.startsWith("/")&&u===""?"/":u)}function LR(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:HR(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var BR=/^:[\w-]+$/,UR=3,jR=2,zR=1,VR=10,$R=-2,i1=t=>t==="*";function WR(t,e){let n=t.split("/"),r=n.length;return n.some(i1)&&(r+=$R),e&&(r+=jR),n.filter(i=>!i1(i)).reduce((i,s)=>i+(BR.test(s)?UR:s===""?zR:VR),r)}function HR(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function XR(t,e,n=!1){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let u=r[a],f=a===r.length-1,h=s==="/"?e:e.slice(s.length)||"/",p=Xu({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},h),g=u.route;if(!p&&f&&n&&!r[r.length-1].route.index&&(p=Xu({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(i,p.params),o.push({params:i,pathname:Pr([s,p.pathname]),pathnameBase:JR(Pr([s,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(s=Pr([s,p.pathnameBase]))}return o}function Xu(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=YR(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((f,{paramName:h,isOptional:p},g)=>{if(h==="*"){let v=a[g]||"";o=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const _=a[g];return p&&!_?f[h]=void 0:f[h]=(_||"").replace(/%2F/g,"/"),f},{}),pathname:s,pathnameBase:o,pattern:t}}function YR(t,e=!1,n=!0){ar(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,u)=>(r.push({paramName:a,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function qR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ar(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Mr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function KR(t,e="/"){let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Bo(t):t;return{pathname:n?n.startsWith("/")?n:ZR(n,e):e,search:GR(r),hash:eI(i)}}function ZR(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function fp(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function QR(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function b2(t){let e=QR(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function w2(t,e,n,r=!1){let i;typeof t=="string"?i=Bo(t):(i={...t},ot(!i.pathname||!i.pathname.includes("?"),fp("?","pathname","search",i)),ot(!i.pathname||!i.pathname.includes("#"),fp("#","pathname","hash",i)),ot(!i.search||!i.search.includes("#"),fp("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;i.pathname=g.join("/")}a=p>=0?e[p]:"/"}let u=KR(i,a),f=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(f||h)&&(u.pathname+="/"),u}var Pr=t=>t.join("/").replace(/\/\/+/g,"/"),JR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),GR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,eI=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function tI(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var x2=["POST","PUT","PATCH","DELETE"];new Set(x2);var nI=["GET",...x2];new Set(nI);var Uo=P.createContext(null);Uo.displayName="DataRouter";var Wf=P.createContext(null);Wf.displayName="DataRouterState";var T2=P.createContext({isTransitioning:!1});T2.displayName="ViewTransition";var rI=P.createContext(new Map);rI.displayName="Fetchers";var iI=P.createContext(null);iI.displayName="Await";var ur=P.createContext(null);ur.displayName="Navigation";var Pl=P.createContext(null);Pl.displayName="Location";var Br=P.createContext({outlet:null,matches:[],isDataRoute:!1});Br.displayName="Route";var Lm=P.createContext(null);Lm.displayName="RouteError";function sI(t,{relative:e}={}){ot(Ml(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=P.useContext(ur),{hash:i,pathname:s,search:o}=Nl(t,{relative:e}),a=s;return n!=="/"&&(a=s==="/"?n:Pr([n,s])),r.createHref({pathname:a,search:o,hash:i})}function Ml(){return P.useContext(Pl)!=null}function Ei(){return ot(Ml(),"useLocation() may be used only in the context of a <Router> component."),P.useContext(Pl).location}var S2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function E2(t){P.useContext(ur).static||P.useLayoutEffect(t)}function oI(){let{isDataRoute:t}=P.useContext(Br);return t?vI():aI()}function aI(){ot(Ml(),"useNavigate() may be used only in the context of a <Router> component.");let t=P.useContext(Uo),{basename:e,navigator:n}=P.useContext(ur),{matches:r}=P.useContext(Br),{pathname:i}=Ei(),s=JSON.stringify(b2(r)),o=P.useRef(!1);return E2(()=>{o.current=!0}),P.useCallback((u,f={})=>{if(ar(o.current,S2),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=w2(u,JSON.parse(s),i,f.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Pr([e,h.pathname])),(f.replace?n.replace:n.push)(h,f.state,f)},[e,n,s,i,t])}P.createContext(null);function Nl(t,{relative:e}={}){let{matches:n}=P.useContext(Br),{pathname:r}=Ei(),i=JSON.stringify(b2(n));return P.useMemo(()=>w2(t,JSON.parse(i),r,e==="path"),[t,i,r,e])}function lI(t,e){return A2(t,e)}function A2(t,e,n,r){ot(Ml(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=P.useContext(ur),{matches:s}=P.useContext(Br),o=s[s.length-1],a=o?o.params:{},u=o?o.pathname:"/",f=o?o.pathnameBase:"/",h=o&&o.route;{let T=h&&h.path||"";C2(u,!h||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let p=Ei(),g;if(e){let T=typeof e=="string"?Bo(e):e;ot(f==="/"||T.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${T.pathname}" was given in the \`location\` prop.`),g=T}else g=p;let _=g.pathname||"/",v=_;if(f!=="/"){let T=f.replace(/^\//,"").split("/");v="/"+_.replace(/^\//,"").split("/").slice(T.length).join("/")}let w=_2(t,{pathname:v});ar(h||w!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),ar(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=dI(w&&w.map(T=>Object.assign({},T,{params:Object.assign({},a,T.params),pathname:Pr([f,i.encodeLocation?i.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?f:Pr([f,i.encodeLocation?i.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),s,n,r);return e&&x?P.createElement(Pl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},x):x}function cI(){let t=yI(),e=tI(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=P.createElement(P.Fragment,null,P.createElement("p",null,"💿 Hey developer 👋"),P.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",P.createElement("code",{style:s},"ErrorBoundary")," or"," ",P.createElement("code",{style:s},"errorElement")," prop on your route.")),P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),n?P.createElement("pre",{style:i},n):null,o)}var uI=P.createElement(cI,null),fI=class extends P.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?P.createElement(Br.Provider,{value:this.props.routeContext},P.createElement(Lm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function hI({routeContext:t,match:e,children:n}){let r=P.useContext(Uo);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),P.createElement(Br.Provider,{value:t},n)}function dI(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,s=n?.errors;if(s!=null){let u=i.findIndex(f=>f.route.id&&s?.[f.route.id]!==void 0);ot(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),i=i.slice(0,Math.min(i.length,u+1))}let o=!1,a=-1;if(n)for(let u=0;u<i.length;u++){let f=i[u];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(a=u),f.route.id){let{loaderData:h,errors:p}=n,g=f.route.loader&&!h.hasOwnProperty(f.route.id)&&(!p||p[f.route.id]===void 0);if(f.route.lazy||g){o=!0,a>=0?i=i.slice(0,a+1):i=[i[0]];break}}}return i.reduceRight((u,f,h)=>{let p,g=!1,_=null,v=null;n&&(p=s&&f.route.id?s[f.route.id]:void 0,_=f.route.errorElement||uI,o&&(a<0&&h===0?(C2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,v=null):a===h&&(g=!0,v=f.route.hydrateFallbackElement||null)));let w=e.concat(i.slice(0,h+1)),x=()=>{let T;return p?T=_:g?T=v:f.route.Component?T=P.createElement(f.route.Component,null):f.route.element?T=f.route.element:T=u,P.createElement(hI,{match:f,routeContext:{outlet:u,matches:w,isDataRoute:n!=null},children:T})};return n&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?P.createElement(fI,{location:n.location,revalidation:n.revalidation,component:_,error:p,children:x(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):x()},null)}function Bm(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function pI(t){let e=P.useContext(Uo);return ot(e,Bm(t)),e}function gI(t){let e=P.useContext(Wf);return ot(e,Bm(t)),e}function mI(t){let e=P.useContext(Br);return ot(e,Bm(t)),e}function Um(t){let e=mI(t),n=e.matches[e.matches.length-1];return ot(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function _I(){return Um("useRouteId")}function yI(){let t=P.useContext(Lm),e=gI("useRouteError"),n=Um("useRouteError");return t!==void 0?t:e.errors?.[n]}function vI(){let{router:t}=pI("useNavigate"),e=Um("useNavigate"),n=P.useRef(!1);return E2(()=>{n.current=!0}),P.useCallback(async(i,s={})=>{ar(n.current,S2),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...s}))},[t,e])}var s1={};function C2(t,e,n){!e&&!s1[t]&&(s1[t]=!0,ar(!1,n))}P.memo(bI);function bI({routes:t,future:e,state:n}){return A2(t,void 0,n,e)}function pn(t){ot(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function wI({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:i,static:s=!1}){ot(!Ml(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=P.useMemo(()=>({basename:o,navigator:i,static:s,future:{}}),[o,i,s]);typeof n=="string"&&(n=Bo(n));let{pathname:u="/",search:f="",hash:h="",state:p=null,key:g="default"}=n,_=P.useMemo(()=>{let v=Mr(u,o);return v==null?null:{location:{pathname:v,search:f,hash:h,state:p,key:g},navigationType:r}},[o,u,f,h,p,g,r]);return ar(_!=null,`<Router basename="${o}"> is not able to match the URL "${u}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:P.createElement(ur.Provider,{value:a},P.createElement(Pl.Provider,{children:e,value:_}))}function xI({children:t,location:e}){return lI(hg(t),e)}function hg(t,e=[]){let n=[];return P.Children.forEach(t,(r,i)=>{if(!P.isValidElement(r))return;let s=[...e,i];if(r.type===P.Fragment){n.push.apply(n,hg(r.props.children,s));return}ot(r.type===pn,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ot(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=hg(r.props.children,s)),n.push(o)}),n}var Ru="get",Iu="application/x-www-form-urlencoded";function Hf(t){return t!=null&&typeof t.tagName=="string"}function TI(t){return Hf(t)&&t.tagName.toLowerCase()==="button"}function SI(t){return Hf(t)&&t.tagName.toLowerCase()==="form"}function EI(t){return Hf(t)&&t.tagName.toLowerCase()==="input"}function AI(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function CI(t,e){return t.button===0&&(!e||e==="_self")&&!AI(t)}var tu=null;function RI(){if(tu===null)try{new FormData(document.createElement("form"),0),tu=!1}catch{tu=!0}return tu}var II=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function hp(t){return t!=null&&!II.has(t)?(ar(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Iu}"`),null):t}function kI(t,e){let n,r,i,s,o;if(SI(t)){let a=t.getAttribute("action");r=a?Mr(a,e):null,n=t.getAttribute("method")||Ru,i=hp(t.getAttribute("enctype"))||Iu,s=new FormData(t)}else if(TI(t)||EI(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||a.getAttribute("action");if(r=u?Mr(u,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||Ru,i=hp(t.getAttribute("formenctype"))||hp(a.getAttribute("enctype"))||Iu,s=new FormData(a,t),!RI()){let{name:f,type:h,value:p}=t;if(h==="image"){let g=f?`${f}.`:"";s.append(`${g}x`,"0"),s.append(`${g}y`,"0")}else f&&s.append(f,p)}}else{if(Hf(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Ru,r=null,i=Iu,o=t}return s&&i==="text/plain"&&(o=s,s=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:s,body:o}}function jm(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function PI(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function MI(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function NI(t,e,n){let r=await Promise.all(t.map(async i=>{let s=e.routes[i.route.id];if(s){let o=await PI(s,n);return o.links?o.links():[]}return[]}));return LI(r.flat(1).filter(MI).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function o1(t,e,n,r,i,s){let o=(u,f)=>n[f]?u.route.id!==n[f].route.id:!0,a=(u,f)=>n[f].pathname!==u.pathname||n[f].route.path?.endsWith("*")&&n[f].params["*"]!==u.params["*"];return s==="assets"?e.filter((u,f)=>o(u,f)||a(u,f)):s==="data"?e.filter((u,f)=>{let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,f)||a(u,f))return!0;if(u.route.shouldRevalidate){let p=u.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function OI(t,e,{includeHydrateFallback:n}={}){return DI(t.map(r=>{let i=e.routes[r.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function DI(t){return[...new Set(t)]}function FI(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function LI(t,e){let n=new Set;return new Set(e),t.reduce((r,i)=>{let s=JSON.stringify(FI(i));return n.has(s)||(n.add(s),r.push({key:s,link:i})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var BI=new Set([100,101,204,205]);function UI(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&Mr(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function R2(){let t=P.useContext(Uo);return jm(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function jI(){let t=P.useContext(Wf);return jm(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var zm=P.createContext(void 0);zm.displayName="FrameworkContext";function I2(){let t=P.useContext(zm);return jm(t,"You must render this element inside a <HydratedRouter> element"),t}function zI(t,e){let n=P.useContext(zm),[r,i]=P.useState(!1),[s,o]=P.useState(!1),{onFocus:a,onBlur:u,onMouseEnter:f,onMouseLeave:h,onTouchStart:p}=e,g=P.useRef(null);P.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let w=T=>{T.forEach(A=>{o(A.isIntersecting)})},x=new IntersectionObserver(w,{threshold:.5});return g.current&&x.observe(g.current),()=>{x.disconnect()}}},[t]),P.useEffect(()=>{if(r){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[r]);let _=()=>{i(!0)},v=()=>{i(!1),o(!1)};return n?t!=="intent"?[s,g,{}]:[s,g,{onFocus:Ma(a,_),onBlur:Ma(u,v),onMouseEnter:Ma(f,_),onMouseLeave:Ma(h,v),onTouchStart:Ma(p,_)}]:[!1,g,{}]}function Ma(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function VI({page:t,...e}){let{router:n}=R2(),r=P.useMemo(()=>_2(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?P.createElement(WI,{page:t,matches:r,...e}):null}function $I(t){let{manifest:e,routeModules:n}=I2(),[r,i]=P.useState([]);return P.useEffect(()=>{let s=!1;return NI(t,e,n).then(o=>{s||i(o)}),()=>{s=!0}},[t,e,n]),r}function WI({page:t,matches:e,...n}){let r=Ei(),{manifest:i,routeModules:s}=I2(),{basename:o}=R2(),{loaderData:a,matches:u}=jI(),f=P.useMemo(()=>o1(t,e,u,i,r,"data"),[t,e,u,i,r]),h=P.useMemo(()=>o1(t,e,u,i,r,"assets"),[t,e,u,i,r]),p=P.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let v=new Set,w=!1;if(e.forEach(T=>{let A=i.routes[T.route.id];!A||!A.hasLoader||(!f.some(E=>E.route.id===T.route.id)&&T.route.id in a&&s[T.route.id]?.shouldRevalidate||A.hasClientLoader?w=!0:v.add(T.route.id))}),v.size===0)return[];let x=UI(t,o);return w&&v.size>0&&x.searchParams.set("_routes",e.filter(T=>v.has(T.route.id)).map(T=>T.route.id).join(",")),[x.pathname+x.search]},[o,a,r,i,f,e,t,s]),g=P.useMemo(()=>OI(h,i),[h,i]),_=$I(h);return P.createElement(P.Fragment,null,p.map(v=>P.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...n})),g.map(v=>P.createElement("link",{key:v,rel:"modulepreload",href:v,...n})),_.map(({key:v,link:w})=>P.createElement("link",{key:v,...w})))}function HI(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var k2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{k2&&(window.__reactRouterVersion="7.6.3")}catch{}function XI({basename:t,children:e,window:n}){let r=P.useRef();r.current==null&&(r.current=MR({window:n,v5Compat:!0}));let i=r.current,[s,o]=P.useState({action:i.action,location:i.location}),a=P.useCallback(u=>{P.startTransition(()=>o(u))},[o]);return P.useLayoutEffect(()=>i.listen(a),[i,a]),P.createElement(wI,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:i})}var P2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Et=P.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:i,reloadDocument:s,replace:o,state:a,target:u,to:f,preventScrollReset:h,viewTransition:p,...g},_){let{basename:v}=P.useContext(ur),w=typeof f=="string"&&P2.test(f),x,T=!1;if(typeof f=="string"&&w&&(x=f,k2))try{let H=new URL(window.location.href),X=f.startsWith("//")?new URL(H.protocol+f):new URL(f),B=Mr(X.pathname,v);X.origin===H.origin&&B!=null?f=B+X.search+X.hash:T=!0}catch{ar(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let A=sI(f,{relative:i}),[E,R,k]=zI(r,g),M=KI(f,{replace:o,state:a,target:u,preventScrollReset:h,relative:i,viewTransition:p});function L(H){e&&e(H),H.defaultPrevented||M(H)}let W=P.createElement("a",{...g,...k,href:x||A,onClick:T||s?e:L,ref:HI(_,R),target:u,"data-discover":!w&&n==="render"?"true":void 0});return E&&!w?P.createElement(P.Fragment,null,W,P.createElement(VI,{page:A})):W});Et.displayName="Link";var Gs=P.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:i=!1,style:s,to:o,viewTransition:a,children:u,...f},h){let p=Nl(o,{relative:f.relative}),g=Ei(),_=P.useContext(Wf),{navigator:v,basename:w}=P.useContext(ur),x=_!=null&&ek(p)&&a===!0,T=v.encodeLocation?v.encodeLocation(p).pathname:p.pathname,A=g.pathname,E=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;n||(A=A.toLowerCase(),E=E?E.toLowerCase():null,T=T.toLowerCase()),E&&w&&(E=Mr(E,w)||E);const R=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let k=A===T||!i&&A.startsWith(T)&&A.charAt(R)==="/",M=E!=null&&(E===T||!i&&E.startsWith(T)&&E.charAt(T.length)==="/"),L={isActive:k,isPending:M,isTransitioning:x},W=k?e:void 0,H;typeof r=="function"?H=r(L):H=[r,k?"active":null,M?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let X=typeof s=="function"?s(L):s;return P.createElement(Et,{...f,"aria-current":W,className:H,ref:h,style:X,to:o,viewTransition:a},typeof u=="function"?u(L):u)});Gs.displayName="NavLink";var YI=P.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:i,state:s,method:o=Ru,action:a,onSubmit:u,relative:f,preventScrollReset:h,viewTransition:p,...g},_)=>{let v=JI(),w=GI(a,{relative:f}),x=o.toLowerCase()==="get"?"get":"post",T=typeof a=="string"&&P2.test(a),A=E=>{if(u&&u(E),E.defaultPrevented)return;E.preventDefault();let R=E.nativeEvent.submitter,k=R?.getAttribute("formmethod")||o;v(R||E.currentTarget,{fetcherKey:e,method:k,navigate:n,replace:i,state:s,relative:f,preventScrollReset:h,viewTransition:p})};return P.createElement("form",{ref:_,method:x,action:w,onSubmit:r?u:A,...g,"data-discover":!T&&t==="render"?"true":void 0})});YI.displayName="Form";function qI(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function M2(t){let e=P.useContext(Uo);return ot(e,qI(t)),e}function KI(t,{target:e,replace:n,state:r,preventScrollReset:i,relative:s,viewTransition:o}={}){let a=oI(),u=Ei(),f=Nl(t,{relative:s});return P.useCallback(h=>{if(CI(h,e)){h.preventDefault();let p=n!==void 0?n:dl(u)===dl(f);a(t,{replace:p,state:r,preventScrollReset:i,relative:s,viewTransition:o})}},[u,a,f,n,r,e,t,i,s,o])}var ZI=0,QI=()=>`__${String(++ZI)}__`;function JI(){let{router:t}=M2("useSubmit"),{basename:e}=P.useContext(ur),n=_I();return P.useCallback(async(r,i={})=>{let{action:s,method:o,encType:a,formData:u,body:f}=kI(r,e);if(i.navigate===!1){let h=i.fetcherKey||QI();await t.fetch(h,n,i.action||s,{preventScrollReset:i.preventScrollReset,formData:u,body:f,formMethod:i.method||o,formEncType:i.encType||a,flushSync:i.flushSync})}else await t.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:u,body:f,formMethod:i.method||o,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function GI(t,{relative:e}={}){let{basename:n}=P.useContext(ur),r=P.useContext(Br);ot(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),s={...Nl(t||".",{relative:e})},o=Ei();if(t==null){s.search=o.search;let a=new URLSearchParams(s.search),u=a.getAll("index");if(u.some(h=>h==="")){a.delete("index"),u.filter(p=>p).forEach(p=>a.append("index",p));let h=a.toString();s.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:Pr([n,s.pathname])),dl(s)}function ek(t,e={}){let n=P.useContext(T2);ot(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=M2("useViewTransitionState"),i=Nl(t,{relative:e.relative});if(!n.isTransitioning)return!1;let s=Mr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Mr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Xu(i.pathname,o)!=null||Xu(i.pathname,s)!=null}[...BI];const N2="data:image/svg+xml,%3csvg%20width='100'%20height='100'%20viewBox='45%2045%20110%20110'%20xmlns='http://www.w3.org/2000/svg'%20fill='none'%3e%3ccircle%20cx='100'%20cy='100'%20r='50'%20fill='%230D1321'/%3e%3cpath%20d='M60%20100%20A40%2020%200%200%201%20140%20100'%20stroke='%23FFB800'%20stroke-width='2'%20fill='none'/%3e%3cpath%20d='M100%2060%20A20%2040%200%200%201%20100%20140'%20stroke='%23FF6666'%20stroke-width='2'%20fill='none'/%3e%3ccircle%20cx='100'%20cy='100'%20r='4'%20fill='%23FFFFFF'/%3e%3c/svg%3e";function tk(){const[t,e]=P.useState(!1);return P.useEffect(()=>{const n=()=>{const r=window.scrollY>10;r!==t&&e(r)};return window.addEventListener("scroll",n),()=>{window.removeEventListener("scroll",n)}},[t]),C.jsxs("header",{className:`header-container ${t?"scrolled":""}`,children:[C.jsxs("div",{className:"header",children:[C.jsx("div",{className:"left-header",children:C.jsx("div",{className:"logo",children:C.jsxs(Et,{to:"/",children:[C.jsx("img",{src:N2,alt:"logo-img",className:"logo-img"}),C.jsx("span",{className:`brand-name ${t?"scrolled":""}`,children:"PixelMap"})]})})}),C.jsx("div",{className:"center-header",children:C.jsx("nav",{className:"main-nav",children:C.jsxs("ul",{children:[C.jsx("li",{children:C.jsx(Et,{to:"/",className:t?"scrolled":"",children:"Home"})}),C.jsx("li",{children:C.jsx(Et,{to:"/services",className:t?"scrolled":"",children:"Services"})}),C.jsx("li",{children:C.jsx(Et,{to:"/about",className:t?"scrolled":"",children:"About"})})]})})}),C.jsx("div",{className:"right-header",children:C.jsx("nav",{className:"main-nav",children:C.jsx("ul",{children:C.jsx("li",{children:C.jsx(Et,{to:"/contact",className:t?"scrolled":"",children:"Contact"})})})})})]}),C.jsx("div",{className:"mobile-nav",children:C.jsx("nav",{className:"main-nav",children:C.jsxs("ul",{children:[C.jsx("li",{children:C.jsx(Et,{to:"/",className:t?"scrolled":"",children:"Home"})}),C.jsx("li",{children:C.jsx(Et,{to:"/services",className:t?"scrolled":"",children:"Services"})}),C.jsx("li",{children:C.jsx(Et,{to:"/about",className:t?"scrolled":"",children:"About"})})]})})})]})}var ku={exports:{}},nk=ku.exports,a1;function rk(){return a1||(a1=1,function(t,e){(function(n,r){t.exports=r($f())})(typeof self<"u"?self:nk,n=>(()=>{var r={2:(a,u,f)=>{var h=f(2199),p=f(4664),g=f(5950);a.exports=function(_){return h(_,g,p)}},79:(a,u,f)=>{var h=f(3702),p=f(80),g=f(4739),_=f(8655),v=f(1175);function w(x){var T=-1,A=x==null?0:x.length;for(this.clear();++T<A;){var E=x[T];this.set(E[0],E[1])}}w.prototype.clear=h,w.prototype.delete=p,w.prototype.get=g,w.prototype.has=_,w.prototype.set=v,a.exports=w},80:(a,u,f)=>{var h=f(6025),p=Array.prototype.splice;a.exports=function(g){var _=this.__data__,v=h(_,g);return!(v<0||(v==_.length-1?_.pop():p.call(_,v,1),--this.size,0))}},270:(a,u,f)=>{var h=f(7068),p=f(346);a.exports=function g(_,v,w,x,T){return _===v||(_==null||v==null||!p(_)&&!p(v)?_!=_&&v!=v:h(_,v,w,x,g,T))}},289:(a,u,f)=>{var h=f(2651);a.exports=function(p){return h(this,p).get(p)}},294:a=>{a.exports=function(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=9007199254740991}},317:a=>{a.exports=function(u){var f=-1,h=Array(u.size);return u.forEach(function(p,g){h[++f]=[g,p]}),h}},346:a=>{a.exports=function(u){return u!=null&&typeof u=="object"}},361:a=>{var u=/^(?:0|[1-9]\d*)$/;a.exports=function(f,h){var p=typeof f;return!!(h=h??9007199254740991)&&(p=="number"||p!="symbol"&&u.test(f))&&f>-1&&f%1==0&&f<h}},392:a=>{a.exports=function(u,f){return u?.[f]}},659:(a,u,f)=>{var h=f(1873),p=Object.prototype,g=p.hasOwnProperty,_=p.toString,v=h?h.toStringTag:void 0;a.exports=function(w){var x=g.call(w,v),T=w[v];try{w[v]=void 0;var A=!0}catch{}var E=_.call(w);return A&&(x?w[v]=T:delete w[v]),E}},689:(a,u,f)=>{var h=f(2),p=Object.prototype.hasOwnProperty;a.exports=function(g,_,v,w,x,T){var A=1&v,E=h(g),R=E.length;if(R!=h(_).length&&!A)return!1;for(var k=R;k--;){var M=E[k];if(!(A?M in _:p.call(_,M)))return!1}var L=T.get(g),W=T.get(_);if(L&&W)return L==_&&W==g;var H=!0;T.set(g,_),T.set(_,g);for(var X=A;++k<R;){var B=g[M=E[k]],te=_[M];if(w)var ie=A?w(te,B,M,_,g,T):w(B,te,M,g,_,T);if(!(ie===void 0?B===te||x(B,te,v,w,T):ie)){H=!1;break}X||(X=M=="constructor")}if(H&&!X){var se=g.constructor,G=_.constructor;se==G||!("constructor"in g)||!("constructor"in _)||typeof se=="function"&&se instanceof se&&typeof G=="function"&&G instanceof G||(H=!1)}return T.delete(g),T.delete(_),H}},695:(a,u,f)=>{var h=f(8096),p=f(2428),g=f(6449),_=f(3656),v=f(361),w=f(7167),x=Object.prototype.hasOwnProperty;a.exports=function(T,A){var E=g(T),R=!E&&p(T),k=!E&&!R&&_(T),M=!E&&!R&&!k&&w(T),L=E||R||k||M,W=L?h(T.length,String):[],H=W.length;for(var X in T)!A&&!x.call(T,X)||L&&(X=="length"||k&&(X=="offset"||X=="parent")||M&&(X=="buffer"||X=="byteLength"||X=="byteOffset")||v(X,H))||W.push(X);return W}},938:a=>{a.exports=function(u){var f=this.__data__,h=f.delete(u);return this.size=f.size,h}},945:(a,u,f)=>{var h=f(79),p=f(8223),g=f(3661);a.exports=function(_,v){var w=this.__data__;if(w instanceof h){var x=w.__data__;if(!p||x.length<199)return x.push([_,v]),this.size=++w.size,this;w=this.__data__=new g(x)}return w.set(_,v),this.size=w.size,this}},1042:(a,u,f)=>{var h=f(6110)(Object,"create");a.exports=h},1175:(a,u,f)=>{var h=f(6025);a.exports=function(p,g){var _=this.__data__,v=h(_,p);return v<0?(++this.size,_.push([p,g])):_[v][1]=g,this}},1380:a=>{a.exports=function(u){return this.__data__.set(u,"__lodash_hash_undefined__"),this}},1420:(a,u,f)=>{var h=f(79);a.exports=function(){this.__data__=new h,this.size=0}},1459:a=>{a.exports=function(u){return this.__data__.has(u)}},1549:(a,u,f)=>{var h=f(2032),p=f(3862),g=f(6721),_=f(2749),v=f(5749);function w(x){var T=-1,A=x==null?0:x.length;for(this.clear();++T<A;){var E=x[T];this.set(E[0],E[1])}}w.prototype.clear=h,w.prototype.delete=p,w.prototype.get=g,w.prototype.has=_,w.prototype.set=v,a.exports=w},1873:(a,u,f)=>{var h=f(9325).Symbol;a.exports=h},1882:(a,u,f)=>{var h=f(2552),p=f(3805);a.exports=function(g){if(!p(g))return!1;var _=h(g);return _=="[object Function]"||_=="[object GeneratorFunction]"||_=="[object AsyncFunction]"||_=="[object Proxy]"}},1986:(a,u,f)=>{var h=f(1873),p=f(7828),g=f(5288),_=f(5911),v=f(317),w=f(4247),x=h?h.prototype:void 0,T=x?x.valueOf:void 0;a.exports=function(A,E,R,k,M,L,W){switch(R){case"[object DataView]":if(A.byteLength!=E.byteLength||A.byteOffset!=E.byteOffset)return!1;A=A.buffer,E=E.buffer;case"[object ArrayBuffer]":return!(A.byteLength!=E.byteLength||!L(new p(A),new p(E)));case"[object Boolean]":case"[object Date]":case"[object Number]":return g(+A,+E);case"[object Error]":return A.name==E.name&&A.message==E.message;case"[object RegExp]":case"[object String]":return A==E+"";case"[object Map]":var H=v;case"[object Set]":var X=1&k;if(H||(H=w),A.size!=E.size&&!X)return!1;var B=W.get(A);if(B)return B==E;k|=2,W.set(A,E);var te=_(H(A),H(E),k,M,L,W);return W.delete(A),te;case"[object Symbol]":if(T)return T.call(A)==T.call(E)}return!1}},2032:(a,u,f)=>{var h=f(1042);a.exports=function(){this.__data__=h?h(null):{},this.size=0}},2199:(a,u,f)=>{var h=f(4528),p=f(6449);a.exports=function(g,_,v){var w=_(g);return p(g)?w:h(w,v(g))}},2404:(a,u,f)=>{var h=f(270);a.exports=function(p,g){return h(p,g)}},2428:(a,u,f)=>{var h=f(7534),p=f(346),g=Object.prototype,_=g.hasOwnProperty,v=g.propertyIsEnumerable,w=h(function(){return arguments}())?h:function(x){return p(x)&&_.call(x,"callee")&&!v.call(x,"callee")};a.exports=w},2552:(a,u,f)=>{var h=f(1873),p=f(659),g=f(9350),_=h?h.toStringTag:void 0;a.exports=function(v){return v==null?v===void 0?"[object Undefined]":"[object Null]":_&&_ in Object(v)?p(v):g(v)}},2651:(a,u,f)=>{var h=f(4218);a.exports=function(p,g){var _=p.__data__;return h(g)?_[typeof g=="string"?"string":"hash"]:_.map}},2749:(a,u,f)=>{var h=f(1042),p=Object.prototype.hasOwnProperty;a.exports=function(g){var _=this.__data__;return h?_[g]!==void 0:p.call(_,g)}},2804:(a,u,f)=>{var h=f(6110)(f(9325),"Promise");a.exports=h},2949:(a,u,f)=>{var h=f(2651);a.exports=function(p,g){var _=h(this,p),v=_.size;return _.set(p,g),this.size+=_.size==v?0:1,this}},3040:(a,u,f)=>{var h=f(1549),p=f(79),g=f(8223);a.exports=function(){this.size=0,this.__data__={hash:new h,map:new(g||p),string:new h}}},3146:(a,u,f)=>{for(var h=f(3491),p=typeof window>"u"?f.g:window,g=["moz","webkit"],_="AnimationFrame",v=p["request"+_],w=p["cancel"+_]||p["cancelRequest"+_],x=0;!v&&x<g.length;x++)v=p[g[x]+"Request"+_],w=p[g[x]+"Cancel"+_]||p[g[x]+"CancelRequest"+_];if(!v||!w){var T=0,A=0,E=[],R=1e3/60;v=function(k){if(E.length===0){var M=h(),L=Math.max(0,R-(M-T));T=L+M,setTimeout(function(){var W=E.slice(0);E.length=0;for(var H=0;H<W.length;H++)if(!W[H].cancelled)try{W[H].callback(T)}catch(X){setTimeout(function(){throw X},0)}},Math.round(L))}return E.push({handle:++A,callback:k,cancelled:!1}),A},w=function(k){for(var M=0;M<E.length;M++)E[M].handle===k&&(E[M].cancelled=!0)}}a.exports=function(k){return v.call(p,k)},a.exports.cancel=function(){w.apply(p,arguments)},a.exports.polyfill=function(k){k||(k=p),k.requestAnimationFrame=v,k.cancelAnimationFrame=w}},3345:a=>{a.exports=function(){return[]}},3491:function(a){(function(){var u,f,h,p,g,_;typeof performance<"u"&&performance!==null&&performance.now?a.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(a.exports=function(){return(u()-g)/1e6},f=process.hrtime,p=(u=function(){var v;return 1e9*(v=f())[0]+v[1]})(),_=1e9*process.uptime(),g=p-_):Date.now?(a.exports=function(){return Date.now()-h},h=Date.now()):(a.exports=function(){return new Date().getTime()-h},h=new Date().getTime())}).call(this)},3605:a=>{a.exports=function(u){return this.__data__.get(u)}},3650:(a,u,f)=>{var h=f(4335)(Object.keys,Object);a.exports=h},3656:(a,u,f)=>{a=f.nmd(a);var h=f(9325),p=f(9935),g=u&&!u.nodeType&&u,_=g&&a&&!a.nodeType&&a,v=_&&_.exports===g?h.Buffer:void 0,w=(v?v.isBuffer:void 0)||p;a.exports=w},3661:(a,u,f)=>{var h=f(3040),p=f(7670),g=f(289),_=f(4509),v=f(2949);function w(x){var T=-1,A=x==null?0:x.length;for(this.clear();++T<A;){var E=x[T];this.set(E[0],E[1])}}w.prototype.clear=h,w.prototype.delete=p,w.prototype.get=g,w.prototype.has=_,w.prototype.set=v,a.exports=w},3702:a=>{a.exports=function(){this.__data__=[],this.size=0}},3805:a=>{a.exports=function(u){var f=typeof u;return u!=null&&(f=="object"||f=="function")}},3862:a=>{a.exports=function(u){var f=this.has(u)&&delete this.__data__[u];return this.size-=f?1:0,f}},4218:a=>{a.exports=function(u){var f=typeof u;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?u!=="__proto__":u===null}},4247:a=>{a.exports=function(u){var f=-1,h=Array(u.size);return u.forEach(function(p){h[++f]=p}),h}},4248:a=>{a.exports=function(u,f){for(var h=-1,p=u==null?0:u.length;++h<p;)if(f(u[h],h,u))return!0;return!1}},4335:a=>{a.exports=function(u,f){return function(h){return u(f(h))}}},4509:(a,u,f)=>{var h=f(2651);a.exports=function(p){return h(this,p).has(p)}},4528:a=>{a.exports=function(u,f){for(var h=-1,p=f.length,g=u.length;++h<p;)u[g+h]=f[h];return u}},4664:(a,u,f)=>{var h=f(9770),p=f(3345),g=Object.prototype.propertyIsEnumerable,_=Object.getOwnPropertySymbols,v=_?function(w){return w==null?[]:(w=Object(w),h(_(w),function(x){return g.call(w,x)}))}:p;a.exports=v},4739:(a,u,f)=>{var h=f(6025);a.exports=function(p){var g=this.__data__,_=h(g,p);return _<0?void 0:g[_][1]}},4840:(a,u,f)=>{var h=typeof f.g=="object"&&f.g&&f.g.Object===Object&&f.g;a.exports=h},4894:(a,u,f)=>{var h=f(1882),p=f(294);a.exports=function(g){return g!=null&&p(g.length)&&!h(g)}},4901:(a,u,f)=>{var h=f(2552),p=f(294),g=f(346),_={};_["[object Float32Array]"]=_["[object Float64Array]"]=_["[object Int8Array]"]=_["[object Int16Array]"]=_["[object Int32Array]"]=_["[object Uint8Array]"]=_["[object Uint8ClampedArray]"]=_["[object Uint16Array]"]=_["[object Uint32Array]"]=!0,_["[object Arguments]"]=_["[object Array]"]=_["[object ArrayBuffer]"]=_["[object Boolean]"]=_["[object DataView]"]=_["[object Date]"]=_["[object Error]"]=_["[object Function]"]=_["[object Map]"]=_["[object Number]"]=_["[object Object]"]=_["[object RegExp]"]=_["[object Set]"]=_["[object String]"]=_["[object WeakMap]"]=!1,a.exports=function(v){return g(v)&&p(v.length)&&!!_[h(v)]}},5083:(a,u,f)=>{var h=f(1882),p=f(7296),g=f(3805),_=f(7473),v=/^\[object .+?Constructor\]$/,w=Function.prototype,x=Object.prototype,T=w.toString,A=x.hasOwnProperty,E=RegExp("^"+T.call(A).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");a.exports=function(R){return!(!g(R)||p(R))&&(h(R)?E:v).test(_(R))}},5288:a=>{a.exports=function(u,f){return u===f||u!=u&&f!=f}},5481:(a,u,f)=>{var h=f(9325)["__core-js_shared__"];a.exports=h},5527:a=>{var u=Object.prototype;a.exports=function(f){var h=f&&f.constructor;return f===(typeof h=="function"&&h.prototype||u)}},5580:(a,u,f)=>{var h=f(6110)(f(9325),"DataView");a.exports=h},5749:(a,u,f)=>{var h=f(1042);a.exports=function(p,g){var _=this.__data__;return this.size+=this.has(p)?0:1,_[p]=h&&g===void 0?"__lodash_hash_undefined__":g,this}},5861:(a,u,f)=>{var h=f(5580),p=f(8223),g=f(2804),_=f(6545),v=f(8303),w=f(2552),x=f(7473),T="[object Map]",A="[object Promise]",E="[object Set]",R="[object WeakMap]",k="[object DataView]",M=x(h),L=x(p),W=x(g),H=x(_),X=x(v),B=w;(h&&B(new h(new ArrayBuffer(1)))!=k||p&&B(new p)!=T||g&&B(g.resolve())!=A||_&&B(new _)!=E||v&&B(new v)!=R)&&(B=function(te){var ie=w(te),se=ie=="[object Object]"?te.constructor:void 0,G=se?x(se):"";if(G)switch(G){case M:return k;case L:return T;case W:return A;case H:return E;case X:return R}return ie}),a.exports=B},5911:(a,u,f)=>{var h=f(8859),p=f(4248),g=f(9219);a.exports=function(_,v,w,x,T,A){var E=1&w,R=_.length,k=v.length;if(R!=k&&!(E&&k>R))return!1;var M=A.get(_),L=A.get(v);if(M&&L)return M==v&&L==_;var W=-1,H=!0,X=2&w?new h:void 0;for(A.set(_,v),A.set(v,_);++W<R;){var B=_[W],te=v[W];if(x)var ie=E?x(te,B,W,v,_,A):x(B,te,W,_,v,A);if(ie!==void 0){if(ie)continue;H=!1;break}if(X){if(!p(v,function(se,G){if(!g(X,G)&&(B===se||T(B,se,w,x,A)))return X.push(G)})){H=!1;break}}else if(B!==te&&!T(B,te,w,x,A)){H=!1;break}}return A.delete(_),A.delete(v),H}},5950:(a,u,f)=>{var h=f(695),p=f(8984),g=f(4894);a.exports=function(_){return g(_)?h(_):p(_)}},6009:(a,u,f)=>{a=f.nmd(a);var h=f(4840),p=u&&!u.nodeType&&u,g=p&&a&&!a.nodeType&&a,_=g&&g.exports===p&&h.process,v=function(){try{return g&&g.require&&g.require("util").types||_&&_.binding&&_.binding("util")}catch{}}();a.exports=v},6025:(a,u,f)=>{var h=f(5288);a.exports=function(p,g){for(var _=p.length;_--;)if(h(p[_][0],g))return _;return-1}},6110:(a,u,f)=>{var h=f(5083),p=f(392);a.exports=function(g,_){var v=p(g,_);return h(v)?v:void 0}},6449:a=>{var u=Array.isArray;a.exports=u},6545:(a,u,f)=>{var h=f(6110)(f(9325),"Set");a.exports=h},6721:(a,u,f)=>{var h=f(1042),p=Object.prototype.hasOwnProperty;a.exports=function(g){var _=this.__data__;if(h){var v=_[g];return v==="__lodash_hash_undefined__"?void 0:v}return p.call(_,g)?_[g]:void 0}},7068:(a,u,f)=>{var h=f(7217),p=f(5911),g=f(1986),_=f(689),v=f(5861),w=f(6449),x=f(3656),T=f(7167),A="[object Arguments]",E="[object Array]",R="[object Object]",k=Object.prototype.hasOwnProperty;a.exports=function(M,L,W,H,X,B){var te=w(M),ie=w(L),se=te?E:v(M),G=ie?E:v(L),ce=(se=se==A?R:se)==R,xe=(G=G==A?R:G)==R,oe=se==G;if(oe&&x(M)){if(!x(L))return!1;te=!0,ce=!1}if(oe&&!ce)return B||(B=new h),te||T(M)?p(M,L,W,H,X,B):g(M,L,se,W,H,X,B);if(!(1&W)){var ne=ce&&k.call(M,"__wrapped__"),ee=xe&&k.call(L,"__wrapped__");if(ne||ee){var D=ne?M.value():M,Z=ee?L.value():L;return B||(B=new h),X(D,Z,W,H,B)}}return!!oe&&(B||(B=new h),_(M,L,W,H,X,B))}},7167:(a,u,f)=>{var h=f(4901),p=f(7301),g=f(6009),_=g&&g.isTypedArray,v=_?p(_):h;a.exports=v},7217:(a,u,f)=>{var h=f(79),p=f(1420),g=f(938),_=f(3605),v=f(9817),w=f(945);function x(T){var A=this.__data__=new h(T);this.size=A.size}x.prototype.clear=p,x.prototype.delete=g,x.prototype.get=_,x.prototype.has=v,x.prototype.set=w,a.exports=x},7296:(a,u,f)=>{var h,p=f(5481),g=(h=/[^.]+$/.exec(p&&p.keys&&p.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"";a.exports=function(_){return!!g&&g in _}},7301:a=>{a.exports=function(u){return function(f){return u(f)}}},7473:a=>{var u=Function.prototype.toString;a.exports=function(f){if(f!=null){try{return u.call(f)}catch{}try{return f+""}catch{}}return""}},7534:(a,u,f)=>{var h=f(2552),p=f(346);a.exports=function(g){return p(g)&&h(g)=="[object Arguments]"}},7670:(a,u,f)=>{var h=f(2651);a.exports=function(p){var g=h(this,p).delete(p);return this.size-=g?1:0,g}},7828:(a,u,f)=>{var h=f(9325).Uint8Array;a.exports=h},8096:a=>{a.exports=function(u,f){for(var h=-1,p=Array(u);++h<u;)p[h]=f(h);return p}},8223:(a,u,f)=>{var h=f(6110)(f(9325),"Map");a.exports=h},8303:(a,u,f)=>{var h=f(6110)(f(9325),"WeakMap");a.exports=h},8655:(a,u,f)=>{var h=f(6025);a.exports=function(p){return h(this.__data__,p)>-1}},8859:(a,u,f)=>{var h=f(3661),p=f(1380),g=f(1459);function _(v){var w=-1,x=v==null?0:v.length;for(this.__data__=new h;++w<x;)this.add(v[w])}_.prototype.add=_.prototype.push=p,_.prototype.has=g,a.exports=_},8984:(a,u,f)=>{var h=f(5527),p=f(3650),g=Object.prototype.hasOwnProperty;a.exports=function(_){if(!h(_))return p(_);var v=[];for(var w in Object(_))g.call(_,w)&&w!="constructor"&&v.push(w);return v}},9155:a=>{a.exports=n},9219:a=>{a.exports=function(u,f){return u.has(f)}},9325:(a,u,f)=>{var h=f(4840),p=typeof self=="object"&&self&&self.Object===Object&&self,g=h||p||Function("return this")();a.exports=g},9350:a=>{var u=Object.prototype.toString;a.exports=function(f){return u.call(f)}},9770:a=>{a.exports=function(u,f){for(var h=-1,p=u==null?0:u.length,g=0,_=[];++h<p;){var v=u[h];f(v,h,u)&&(_[g++]=v)}return _}},9817:a=>{a.exports=function(u){return this.__data__.has(u)}},9905:(a,u,f)=>{f.d(u,{default:()=>oe});var h=f(3146),p=f.n(h);const g=function(ne){return new RegExp(/<[a-z][\s\S]*>/i).test(ne)},_=function(ne,ee){return Math.floor(Math.random()*(ee-ne+1))+ne};var v="TYPE_CHARACTER",w="REMOVE_CHARACTER",x="REMOVE_ALL",T="REMOVE_LAST_VISIBLE_NODE",A="PAUSE_FOR",E="CALL_FUNCTION",R="ADD_HTML_TAG_ELEMENT",k="CHANGE_DELETE_SPEED",M="CHANGE_DELAY",L="CHANGE_CURSOR",W="PASTE_STRING",H="HTML_TAG";function X(ne){return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ee){return typeof ee}:function(ee){return ee&&typeof Symbol=="function"&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},X(ne)}function B(ne,ee){var D=Object.keys(ne);if(Object.getOwnPropertySymbols){var Z=Object.getOwnPropertySymbols(ne);ee&&(Z=Z.filter(function(ge){return Object.getOwnPropertyDescriptor(ne,ge).enumerable})),D.push.apply(D,Z)}return D}function te(ne){for(var ee=1;ee<arguments.length;ee++){var D=arguments[ee]!=null?arguments[ee]:{};ee%2?B(Object(D),!0).forEach(function(Z){ce(ne,Z,D[Z])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ne,Object.getOwnPropertyDescriptors(D)):B(Object(D)).forEach(function(Z){Object.defineProperty(ne,Z,Object.getOwnPropertyDescriptor(D,Z))})}return ne}function ie(ne){return function(ee){if(Array.isArray(ee))return se(ee)}(ne)||function(ee){if(typeof Symbol<"u"&&ee[Symbol.iterator]!=null||ee["@@iterator"]!=null)return Array.from(ee)}(ne)||function(ee,D){if(ee){if(typeof ee=="string")return se(ee,D);var Z={}.toString.call(ee).slice(8,-1);return Z==="Object"&&ee.constructor&&(Z=ee.constructor.name),Z==="Map"||Z==="Set"?Array.from(ee):Z==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Z)?se(ee,D):void 0}}(ne)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function se(ne,ee){(ee==null||ee>ne.length)&&(ee=ne.length);for(var D=0,Z=Array(ee);D<ee;D++)Z[D]=ne[D];return Z}function G(ne,ee){for(var D=0;D<ee.length;D++){var Z=ee[D];Z.enumerable=Z.enumerable||!1,Z.configurable=!0,"value"in Z&&(Z.writable=!0),Object.defineProperty(ne,xe(Z.key),Z)}}function ce(ne,ee,D){return(ee=xe(ee))in ne?Object.defineProperty(ne,ee,{value:D,enumerable:!0,configurable:!0,writable:!0}):ne[ee]=D,ne}function xe(ne){var ee=function(D){if(X(D)!="object"||!D)return D;var Z=D[Symbol.toPrimitive];if(Z!==void 0){var ge=Z.call(D,"string");if(X(ge)!="object")return ge;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(D)}(ne);return X(ee)=="symbol"?ee:ee+""}const oe=function(){function ne(Z,ge){var Y=this;if(function(pe,Se){if(!(pe instanceof Se))throw new TypeError("Cannot call a class as a function")}(this,ne),ce(this,"state",{cursorAnimation:null,lastFrameTime:null,pauseUntil:null,eventQueue:[],eventLoop:null,eventLoopPaused:!1,reverseCalledEvents:[],calledEvents:[],visibleNodes:[],initialOptions:null,elements:{container:null,wrapper:document.createElement("span"),cursor:document.createElement("span")}}),ce(this,"options",{strings:null,cursor:"|",delay:"natural",pauseFor:1500,deleteSpeed:"natural",loop:!1,autoStart:!1,devMode:!1,skipAddStyles:!1,wrapperClassName:"Typewriter__wrapper",cursorClassName:"Typewriter__cursor",stringSplitter:null,onCreateTextNode:null,onRemoveNode:null}),ce(this,"setupWrapperElement",function(){Y.state.elements.container&&(Y.state.elements.wrapper.className=Y.options.wrapperClassName,Y.state.elements.cursor.className=Y.options.cursorClassName,Y.state.elements.cursor.innerHTML=Y.options.cursor,Y.state.elements.container.innerHTML="",Y.state.elements.container.appendChild(Y.state.elements.wrapper),Y.state.elements.container.appendChild(Y.state.elements.cursor))}),ce(this,"start",function(){return Y.state.eventLoopPaused=!1,Y.runEventLoop(),Y}),ce(this,"pause",function(){return Y.state.eventLoopPaused=!0,Y}),ce(this,"stop",function(){return Y.state.eventLoop&&((0,h.cancel)(Y.state.eventLoop),Y.state.eventLoop=null),Y}),ce(this,"pauseFor",function(pe){return Y.addEventToQueue(A,{ms:pe}),Y}),ce(this,"typeOutAllStrings",function(){return typeof Y.options.strings=="string"?(Y.typeString(Y.options.strings).pauseFor(Y.options.pauseFor),Y):(Y.options.strings.forEach(function(pe){Y.typeString(pe).pauseFor(Y.options.pauseFor).deleteAll(Y.options.deleteSpeed)}),Y)}),ce(this,"typeString",function(pe){var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(g(pe))return Y.typeOutHTMLString(pe,Se);if(pe){var ke=(Y.options||{}).stringSplitter,Me=typeof ke=="function"?ke(pe):pe.split("");Y.typeCharacters(Me,Se)}return Y}),ce(this,"pasteString",function(pe){var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return g(pe)?Y.typeOutHTMLString(pe,Se,!0):(pe&&Y.addEventToQueue(W,{character:pe,node:Se}),Y)}),ce(this,"typeOutHTMLString",function(pe){var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,ke=arguments.length>2?arguments[2]:void 0,Me=function(Vn){var dr=document.createElement("div");return dr.innerHTML=Vn,dr.childNodes}(pe);if(Me.length>0)for(var Ne=0;Ne<Me.length;Ne++){var At=Me[Ne],hr=At.innerHTML;At&&At.nodeType!==3?(At.innerHTML="",Y.addEventToQueue(R,{node:At,parentNode:Se}),ke?Y.pasteString(hr,At):Y.typeString(hr,At)):At.textContent&&(ke?Y.pasteString(At.textContent,Se):Y.typeString(At.textContent,Se))}return Y}),ce(this,"deleteAll",function(){var pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"natural";return Y.addEventToQueue(x,{speed:pe}),Y}),ce(this,"changeDeleteSpeed",function(pe){if(!pe)throw new Error("Must provide new delete speed");return Y.addEventToQueue(k,{speed:pe}),Y}),ce(this,"changeDelay",function(pe){if(!pe)throw new Error("Must provide new delay");return Y.addEventToQueue(M,{delay:pe}),Y}),ce(this,"changeCursor",function(pe){if(!pe)throw new Error("Must provide new cursor");return Y.addEventToQueue(L,{cursor:pe}),Y}),ce(this,"deleteChars",function(pe){if(!pe)throw new Error("Must provide amount of characters to delete");for(var Se=0;Se<pe;Se++)Y.addEventToQueue(w);return Y}),ce(this,"callFunction",function(pe,Se){if(!pe||typeof pe!="function")throw new Error("Callback must be a function");return Y.addEventToQueue(E,{cb:pe,thisArg:Se}),Y}),ce(this,"typeCharacters",function(pe){var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!pe||!Array.isArray(pe))throw new Error("Characters must be an array");return pe.forEach(function(ke){Y.addEventToQueue(v,{character:ke,node:Se})}),Y}),ce(this,"removeCharacters",function(pe){if(!pe||!Array.isArray(pe))throw new Error("Characters must be an array");return pe.forEach(function(){Y.addEventToQueue(w)}),Y}),ce(this,"addEventToQueue",function(pe,Se){var ke=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return Y.addEventToStateProperty(pe,Se,ke,"eventQueue")}),ce(this,"addReverseCalledEvent",function(pe,Se){var ke=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return Y.options.loop?Y.addEventToStateProperty(pe,Se,ke,"reverseCalledEvents"):Y}),ce(this,"addEventToStateProperty",function(pe,Se){var ke=arguments.length>2&&arguments[2]!==void 0&&arguments[2],Me=arguments.length>3?arguments[3]:void 0,Ne={eventName:pe,eventArgs:Se||{}};return Y.state[Me]=ke?[Ne].concat(ie(Y.state[Me])):[].concat(ie(Y.state[Me]),[Ne]),Y}),ce(this,"runEventLoop",function(){Y.state.lastFrameTime||(Y.state.lastFrameTime=Date.now());var pe=Date.now(),Se=pe-Y.state.lastFrameTime;if(!Y.state.eventQueue.length){if(!Y.options.loop)return;Y.state.eventQueue=ie(Y.state.calledEvents),Y.state.calledEvents=[],Y.options=te({},Y.state.initialOptions)}if(Y.state.eventLoop=p()(Y.runEventLoop),!Y.state.eventLoopPaused){if(Y.state.pauseUntil){if(pe<Y.state.pauseUntil)return;Y.state.pauseUntil=null}var ke,Me=ie(Y.state.eventQueue),Ne=Me.shift();if(!(Se<=(ke=Ne.eventName===T||Ne.eventName===w?Y.options.deleteSpeed==="natural"?_(40,80):Y.options.deleteSpeed:Y.options.delay==="natural"?_(120,160):Y.options.delay))){var At=Ne.eventName,hr=Ne.eventArgs;switch(Y.logInDevMode({currentEvent:Ne,state:Y.state,delay:ke}),At){case W:case v:var Vn=hr.character,dr=hr.node,Wo=document.createTextNode(Vn),Vr=Wo;Y.options.onCreateTextNode&&typeof Y.options.onCreateTextNode=="function"&&(Vr=Y.options.onCreateTextNode(Vn,Wo)),Vr&&(dr?dr.appendChild(Vr):Y.state.elements.wrapper.appendChild(Vr)),Y.state.visibleNodes=[].concat(ie(Y.state.visibleNodes),[{type:"TEXT_NODE",character:Vn,node:Vr}]);break;case w:Me.unshift({eventName:T,eventArgs:{removingCharacterNode:!0}});break;case A:var Ho=Ne.eventArgs.ms;Y.state.pauseUntil=Date.now()+parseInt(Ho);break;case E:var Xo=Ne.eventArgs,Yo=Xo.cb,Ci=Xo.thisArg;Yo.call(Ci,{elements:Y.state.elements});break;case R:var pr=Ne.eventArgs,Ri=pr.node,ys=pr.parentNode;ys?ys.appendChild(Ri):Y.state.elements.wrapper.appendChild(Ri),Y.state.visibleNodes=[].concat(ie(Y.state.visibleNodes),[{type:H,node:Ri,parentNode:ys||Y.state.elements.wrapper}]);break;case x:var Wl=Y.state.visibleNodes,vs=hr.speed,Ii=[];vs&&Ii.push({eventName:k,eventArgs:{speed:vs,temp:!0}});for(var bs=0,ws=Wl.length;bs<ws;bs++)Ii.push({eventName:T,eventArgs:{removingCharacterNode:!1}});vs&&Ii.push({eventName:k,eventArgs:{speed:Y.options.deleteSpeed,temp:!0}}),Me.unshift.apply(Me,Ii);break;case T:var Hl=Ne.eventArgs.removingCharacterNode;if(Y.state.visibleNodes.length){var gr=Y.state.visibleNodes.pop(),ki=gr.type,xs=gr.node,Xl=gr.character;Y.options.onRemoveNode&&typeof Y.options.onRemoveNode=="function"&&Y.options.onRemoveNode({node:xs,character:Xl}),xs&&xs.parentNode.removeChild(xs),ki===H&&Hl&&Me.unshift({eventName:T,eventArgs:{}})}break;case k:Y.options.deleteSpeed=Ne.eventArgs.speed;break;case M:Y.options.delay=Ne.eventArgs.delay;break;case L:Y.options.cursor=Ne.eventArgs.cursor,Y.state.elements.cursor.innerHTML=Ne.eventArgs.cursor}Y.options.loop&&(Ne.eventName===T||Ne.eventArgs&&Ne.eventArgs.temp||(Y.state.calledEvents=[].concat(ie(Y.state.calledEvents),[Ne]))),Y.state.eventQueue=Me,Y.state.lastFrameTime=pe}}}),Z)if(typeof Z=="string"){var Re=document.querySelector(Z);if(!Re)throw new Error("Could not find container element");this.state.elements.container=Re}else this.state.elements.container=Z;ge&&(this.options=te(te({},this.options),ge)),this.state.initialOptions=te({},this.options),this.init()}var ee,D;return ee=ne,(D=[{key:"init",value:function(){var Z,ge;this.setupWrapperElement(),this.addEventToQueue(L,{cursor:this.options.cursor},!0),this.addEventToQueue(x,null,!0),!window||window.___TYPEWRITER_JS_STYLES_ADDED___||this.options.skipAddStyles||(Z=".Typewriter__cursor{-webkit-animation:Typewriter-cursor 1s infinite;animation:Typewriter-cursor 1s infinite;margin-left:1px}@-webkit-keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}@keyframes Typewriter-cursor{0%{opacity:0}50%{opacity:1}100%{opacity:0}}",(ge=document.createElement("style")).appendChild(document.createTextNode(Z)),document.head.appendChild(ge),window.___TYPEWRITER_JS_STYLES_ADDED___=!0),this.options.autoStart===!0&&this.options.strings&&this.typeOutAllStrings().start()}},{key:"logInDevMode",value:function(Z){this.options.devMode&&console.log(Z)}}])&&G(ee.prototype,D),Object.defineProperty(ee,"prototype",{writable:!1}),ne}()},9935:a=>{a.exports=function(){return!1}}},i={};function s(a){var u=i[a];if(u!==void 0)return u.exports;var f=i[a]={id:a,loaded:!1,exports:{}};return r[a].call(f.exports,f,f.exports,s),f.loaded=!0,f.exports}s.n=a=>{var u=a&&a.__esModule?()=>a.default:()=>a;return s.d(u,{a:u}),u},s.d=(a,u)=>{for(var f in u)s.o(u,f)&&!s.o(a,f)&&Object.defineProperty(a,f,{enumerable:!0,get:u[f]})},s.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),s.o=(a,u)=>Object.prototype.hasOwnProperty.call(a,u),s.nmd=a=>(a.paths=[],a.children||(a.children=[]),a);var o={};return(()=>{s.d(o,{default:()=>R});var a=s(9155),u=s.n(a),f=s(9905),h=s(2404),p=s.n(h);function g(k){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},g(k)}function _(k,M){for(var L=0;L<M.length;L++){var W=M[L];W.enumerable=W.enumerable||!1,W.configurable=!0,"value"in W&&(W.writable=!0),Object.defineProperty(k,A(W.key),W)}}function v(k,M){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(L,W){return L.__proto__=W,L},v(k,M)}function w(k){if(k===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k}function x(){try{var k=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(x=function(){return!!k})()}function T(k){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(M){return M.__proto__||Object.getPrototypeOf(M)},T(k)}function A(k){var M=function(L){if(g(L)!="object"||!L)return L;var W=L[Symbol.toPrimitive];if(W!==void 0){var H=W.call(L,"string");if(g(H)!="object")return H;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(L)}(k);return g(M)=="symbol"?M:M+""}var E=function(k){(function(X,B){if(typeof B!="function"&&B!==null)throw new TypeError("Super expression must either be null or a function");X.prototype=Object.create(B&&B.prototype,{constructor:{value:X,writable:!0,configurable:!0}}),Object.defineProperty(X,"prototype",{writable:!1}),B&&v(X,B)})(H,k);var M,L,W=function(X){var B=x();return function(){var te,ie=T(X);if(B){var se=T(this).constructor;te=Reflect.construct(ie,arguments,se)}else te=ie.apply(this,arguments);return function(G,ce){if(ce&&(g(ce)=="object"||typeof ce=="function"))return ce;if(ce!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w(G)}(this,te)}}(H);function H(){var X,B,te,ie;(function(xe,oe){if(!(xe instanceof oe))throw new TypeError("Cannot call a class as a function")})(this,H);for(var se=arguments.length,G=new Array(se),ce=0;ce<se;ce++)G[ce]=arguments[ce];return B=w(X=W.call.apply(W,[this].concat(G))),ie={instance:null},(te=A(te="state"))in B?Object.defineProperty(B,te,{value:ie,enumerable:!0,configurable:!0,writable:!0}):B[te]=ie,X}return M=H,(L=[{key:"componentDidMount",value:function(){var X=this,B=new f.default(this.typewriter,this.props.options);this.setState({instance:B},function(){var te=X.props.onInit;te&&te(B)})}},{key:"componentDidUpdate",value:function(X){p()(this.props.options,X.options)||this.setState({instance:new f.default(this.typewriter,this.props.options)})}},{key:"componentWillUnmount",value:function(){this.state.instance&&this.state.instance.stop()}},{key:"render",value:function(){var X=this,B=this.props.component;return u().createElement(B,{ref:function(te){return X.typewriter=te},className:"Typewriter","data-testid":"typewriter-wrapper"})}}])&&_(M.prototype,L),Object.defineProperty(M,"prototype",{writable:!1}),H}(a.Component);E.defaultProps={component:"div"};const R=E})(),o.default})())}(ku)),ku.exports}var ik=rk();const sk=kl(ik);function ok(){return C.jsx(sk,{options:{strings:["interactive","transformed","mapped","simplified","processed","connected","beautiful"],autoStart:!0,loop:!0,deleteSpeed:50}})}function ak(){return C.jsxs("div",{className:"hero-wrapper",children:[C.jsxs("div",{className:"hero-content",children:[C.jsx("div",{className:"hero-message--constant",children:"Data can be"}),C.jsx("div",{className:"hero-message--with-type",children:C.jsx(ok,{})})]}),C.jsx("div",{className:"hero-bottom-image"})]})}function lk(){const t=[{id:1,title:"Markers and InfoWindows",category:"Google Maps",completed:!0,image:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/temps.png",link:"/projects/markers-and-infowindows"},{id:2,title:"Health-adjusted Life Expectancy",category:"ZingChart",completed:!0,image:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/hle.png",link:"/projects/health-adjusted-life-expectancy"},{id:3,title:"Earthquake Magnitude Heatmap",category:"Google Maps",completed:!0,image:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/eHeatmap.png",link:"/projects/earthquake-magnitude-heatmap"},{id:4,title:"Historical FIFA world cup geo map",category:"Google Maps",completed:!0,image:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/fifaewc.png",link:"/projects/fifa-world-cup"},{id:5,title:"Personal injury road accidents in GB from 1979",category:"D3",completed:!0,image:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/gba.png",link:"/projects/personal-injury-road-accidents"},{id:6,title:"Uber pick up locations in New York City",category:"D3",completed:!0,image:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/upl.png",link:"/projects/uber-pickup-locations-in-new-york-city"}];return C.jsx("div",{className:"portfolio-wrapper",children:C.jsxs("div",{className:"portfolio-content",children:[C.jsx("div",{className:"portfolio-header",children:"Our Portfolio"}),C.jsx("p",{className:"portfolio-description",children:"Explore our recent projects showcasing innovative digital solutions that drive business growth and enhance user experiences."}),C.jsx("div",{className:"portfolio-flex-container",children:t.map(e=>C.jsx("div",{className:"portfolio-item",children:e.completed?C.jsxs(Et,{to:e.link,className:"portfolio-link",children:[C.jsx("div",{className:"portfolio-image-container",children:C.jsx("img",{src:e.image,alt:e.title,className:"portfolio-image"})}),C.jsx("div",{className:"portfolio-info",children:C.jsx("p",{children:e.title})})]}):C.jsxs("div",{className:"portfolio-link",children:[C.jsx("div",{className:"portfolio-image-container",children:C.jsx("img",{src:e.image,alt:e.title,className:"portfolio-image coming-soon-image"})}),C.jsx("div",{className:"portfolio-info",children:C.jsxs("p",{children:[e.title,"(Coming Soon)"]})})]})},e.id))})]})})}/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */function ck(t,e,n){return(e=fk(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function fe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?l1(Object(n),!0).forEach(function(r){ck(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function uk(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fk(t){var e=uk(t,"string");return typeof e=="symbol"?e:e+""}const c1=()=>{};let Vm={},O2={},D2=null,F2={mark:c1,measure:c1};try{typeof window<"u"&&(Vm=window),typeof document<"u"&&(O2=document),typeof MutationObserver<"u"&&(D2=MutationObserver),typeof performance<"u"&&(F2=performance)}catch{}const{userAgent:u1=""}=Vm.navigator||{},wi=Vm,Je=O2,f1=D2,nu=F2;wi.document;const Ur=!!Je.documentElement&&!!Je.head&&typeof Je.addEventListener=="function"&&typeof Je.createElement=="function",L2=~u1.indexOf("MSIE")||~u1.indexOf("Trident/");var hk=/fa(s|r|l|t|d|dr|dl|dt|b|k|kd|ss|sr|sl|st|sds|sdr|sdl|sdt)?[\-\ ]/,dk=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,B2={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fab:"brands","fa-brands":"brands"},duotone:{fa:"solid",fad:"solid","fa-solid":"solid","fa-duotone":"solid",fadr:"regular","fa-regular":"regular",fadl:"light","fa-light":"light",fadt:"thin","fa-thin":"thin"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid",fasdr:"regular","fa-regular":"regular",fasdl:"light","fa-light":"light",fasdt:"thin","fa-thin":"thin"}},pk={GROUP:"duotone-group",PRIMARY:"primary",SECONDARY:"secondary"},U2=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],Bt="classic",Xf="duotone",gk="sharp",mk="sharp-duotone",j2=[Bt,Xf,gk,mk],_k={classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},duotone:{900:"fad",400:"fadr",300:"fadl",100:"fadt"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds",400:"fasdr",300:"fasdl",100:"fasdt"}},yk={"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad",400:"fadr",normal:"fadr",300:"fadl",100:"fadt"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds",400:"fasdr",normal:"fasdr",300:"fasdl",100:"fasdt"}},vk=new Map([["classic",{defaultShortPrefixId:"fas",defaultStyleId:"solid",styleIds:["solid","regular","light","thin","brands"],futureStyleIds:[],defaultFontWeight:900}],["sharp",{defaultShortPrefixId:"fass",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["duotone",{defaultShortPrefixId:"fad",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}],["sharp-duotone",{defaultShortPrefixId:"fasds",defaultStyleId:"solid",styleIds:["solid","regular","light","thin"],futureStyleIds:[],defaultFontWeight:900}]]),bk={classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",brands:"fab"},duotone:{solid:"fad",regular:"fadr",light:"fadl",thin:"fadt"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds",regular:"fasdr",light:"fasdl",thin:"fasdt"}},wk=["fak","fa-kit","fakd","fa-kit-duotone"],h1={kit:{fak:"kit","fa-kit":"kit"},"kit-duotone":{fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"}},xk=["kit"],Tk={kit:{"fa-kit":"fak"}},Sk=["fak","fakd"],Ek={kit:{fak:"fa-kit"}},d1={kit:{kit:"fak"},"kit-duotone":{"kit-duotone":"fakd"}},ru={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},Ak=["fa-classic","fa-duotone","fa-sharp","fa-sharp-duotone"],Ck=["fak","fa-kit","fakd","fa-kit-duotone"],Rk={"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}},Ik={classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},duotone:{"fa-regular":"fadr","fa-light":"fadl","fa-thin":"fadt"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds","fa-regular":"fasdr","fa-light":"fasdl","fa-thin":"fasdt"}},kk={classic:["fas","far","fal","fat","fad"],duotone:["fadr","fadl","fadt"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds","fasdr","fasdl","fasdt"]},dg={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},duotone:{fadr:"fa-regular",fadl:"fa-light",fadt:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid",fasdr:"fa-regular",fasdl:"fa-light",fasdt:"fa-thin"}},Pk=["fa-solid","fa-regular","fa-light","fa-thin","fa-duotone","fa-brands"],pg=["fa","fas","far","fal","fat","fad","fadr","fadl","fadt","fab","fass","fasr","fasl","fast","fasds","fasdr","fasdl","fasdt",...Ak,...Pk],Mk=["solid","regular","light","thin","duotone","brands"],z2=[1,2,3,4,5,6,7,8,9,10],Nk=z2.concat([11,12,13,14,15,16,17,18,19,20]),Ok=[...Object.keys(kk),...Mk,"2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",ru.GROUP,ru.SWAP_OPACITY,ru.PRIMARY,ru.SECONDARY].concat(z2.map(t=>"".concat(t,"x"))).concat(Nk.map(t=>"w-".concat(t))),Dk={"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"}};const Nr="___FONT_AWESOME___",gg=16,V2="fa",$2="svg-inline--fa",rs="data-fa-i2svg",mg="data-fa-pseudo-element",Fk="data-fa-pseudo-element-pending",$m="data-prefix",Wm="data-icon",p1="fontawesome-i2svg",Lk="async",Bk=["HTML","HEAD","STYLE","SCRIPT"],W2=(()=>{try{return!0}catch{return!1}})();function Ol(t){return new Proxy(t,{get(e,n){return n in e?e[n]:e[Bt]}})}const H2=fe({},B2);H2[Bt]=fe(fe(fe(fe({},{"fa-duotone":"duotone"}),B2[Bt]),h1.kit),h1["kit-duotone"]);const Uk=Ol(H2),_g=fe({},bk);_g[Bt]=fe(fe(fe(fe({},{duotone:"fad"}),_g[Bt]),d1.kit),d1["kit-duotone"]);const g1=Ol(_g),yg=fe({},dg);yg[Bt]=fe(fe({},yg[Bt]),Ek.kit);const Hm=Ol(yg),vg=fe({},Ik);vg[Bt]=fe(fe({},vg[Bt]),Tk.kit);Ol(vg);const jk=hk,X2="fa-layers-text",zk=dk,Vk=fe({},_k);Ol(Vk);const $k=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],dp=pk,Wk=[...xk,...Ok],Ga=wi.FontAwesomeConfig||{};function Hk(t){var e=Je.querySelector("script["+t+"]");if(e)return e.getAttribute(t)}function Xk(t){return t===""?!0:t==="false"?!1:t==="true"?!0:t}Je&&typeof Je.querySelector=="function"&&[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach(e=>{let[n,r]=e;const i=Xk(Hk(n));i!=null&&(Ga[r]=i)});const Y2={styleDefault:"solid",familyDefault:Bt,cssPrefix:V2,replacementClass:$2,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};Ga.familyPrefix&&(Ga.cssPrefix=Ga.familyPrefix);const vo=fe(fe({},Y2),Ga);vo.autoReplaceSvg||(vo.observeMutations=!1);const Te={};Object.keys(Y2).forEach(t=>{Object.defineProperty(Te,t,{enumerable:!0,set:function(e){vo[t]=e,el.forEach(n=>n(Te))},get:function(){return vo[t]}})});Object.defineProperty(Te,"familyPrefix",{enumerable:!0,set:function(t){vo.cssPrefix=t,el.forEach(e=>e(Te))},get:function(){return vo.cssPrefix}});wi.FontAwesomeConfig=Te;const el=[];function Yk(t){return el.push(t),()=>{el.splice(el.indexOf(t),1)}}const li=gg,nr={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function qk(t){if(!t||!Ur)return;const e=Je.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=t;const n=Je.head.childNodes;let r=null;for(let i=n.length-1;i>-1;i--){const s=n[i],o=(s.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(o)>-1&&(r=s)}return Je.head.insertBefore(e,r),t}const Kk="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function pl(){let t=12,e="";for(;t-- >0;)e+=Kk[Math.random()*62|0];return e}function jo(t){const e=[];for(let n=(t||[]).length>>>0;n--;)e[n]=t[n];return e}function Xm(t){return t.classList?jo(t.classList):(t.getAttribute("class")||"").split(" ").filter(e=>e)}function q2(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Zk(t){return Object.keys(t||{}).reduce((e,n)=>e+"".concat(n,'="').concat(q2(t[n]),'" '),"").trim()}function Yf(t){return Object.keys(t||{}).reduce((e,n)=>e+"".concat(n,": ").concat(t[n].trim(),";"),"")}function Ym(t){return t.size!==nr.size||t.x!==nr.x||t.y!==nr.y||t.rotate!==nr.rotate||t.flipX||t.flipY}function Qk(t){let{transform:e,containerWidth:n,iconWidth:r}=t;const i={transform:"translate(".concat(n/2," 256)")},s="translate(".concat(e.x*32,", ").concat(e.y*32,") "),o="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)"),u={transform:"".concat(s," ").concat(o," ").concat(a)},f={transform:"translate(".concat(r/2*-1," -256)")};return{outer:i,inner:u,path:f}}function Jk(t){let{transform:e,width:n=gg,height:r=gg,startCentered:i=!1}=t,s="";return i&&L2?s+="translate(".concat(e.x/li-n/2,"em, ").concat(e.y/li-r/2,"em) "):i?s+="translate(calc(-50% + ".concat(e.x/li,"em), calc(-50% + ").concat(e.y/li,"em)) "):s+="translate(".concat(e.x/li,"em, ").concat(e.y/li,"em) "),s+="scale(".concat(e.size/li*(e.flipX?-1:1),", ").concat(e.size/li*(e.flipY?-1:1),") "),s+="rotate(".concat(e.rotate,"deg) "),s}var Gk=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-regular: normal 400 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-light: normal 300 1em/1 "Font Awesome 6 Duotone";
  --fa-font-duotone-thin: normal 100 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";
  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-regular: normal 400 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-light: normal 300 1em/1 "Font Awesome 6 Sharp Duotone";
  --fa-font-sharp-duotone-thin: normal 100 1em/1 "Font Awesome 6 Sharp Duotone";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-counter-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  transform: scale(var(--fa-layers-scale, 0.25));
  transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(-1 * var(--fa-li-width, 2em));
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  animation-name: fa-beat;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  animation-name: fa-bounce;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  animation-name: fa-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  animation-name: fa-beat-fade;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  animation-name: fa-flip;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  animation-name: fa-shake;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  animation-name: fa-spin;
  animation-delay: var(--fa-animation-delay, 0s);
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 2s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  animation-name: fa-spin;
  animation-direction: var(--fa-animation-direction, normal);
  animation-duration: var(--fa-animation-duration, 1s);
  animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    animation-delay: -1ms;
    animation-duration: 1ms;
    animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@keyframes fa-beat {
  0%, 90% {
    transform: scale(1);
  }
  45% {
    transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-bounce {
  0% {
    transform: scale(1, 1) translateY(0);
  }
  10% {
    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    transform: scale(1, 1) translateY(0);
  }
  100% {
    transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-flip {
  50% {
    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-shake {
  0% {
    transform: rotate(-15deg);
  }
  4% {
    transform: rotate(15deg);
  }
  8%, 24% {
    transform: rotate(-18deg);
  }
  12%, 28% {
    transform: rotate(18deg);
  }
  16% {
    transform: rotate(-22deg);
  }
  20% {
    transform: rotate(22deg);
  }
  32% {
    transform: rotate(-12deg);
  }
  36% {
    transform: rotate(12deg);
  }
  40%, 100% {
    transform: rotate(0deg);
  }
}
@keyframes fa-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  transform: rotate(90deg);
}

.fa-rotate-180 {
  transform: rotate(180deg);
}

.fa-rotate-270 {
  transform: rotate(270deg);
}

.fa-flip-horizontal {
  transform: scale(-1, 1);
}

.fa-flip-vertical {
  transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  transform: scale(-1, -1);
}

.fa-rotate-by {
  transform: rotate(var(--fa-rotate-angle, 0));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}`;function K2(){const t=V2,e=$2,n=Te.cssPrefix,r=Te.replacementClass;let i=Gk;if(n!==t||r!==e){const s=new RegExp("\\.".concat(t,"\\-"),"g"),o=new RegExp("\\--".concat(t,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");i=i.replace(s,".".concat(n,"-")).replace(o,"--".concat(n,"-")).replace(a,".".concat(r))}return i}let m1=!1;function pp(){Te.autoAddCss&&!m1&&(qk(K2()),m1=!0)}var eP={mixout(){return{dom:{css:K2,insertCss:pp}}},hooks(){return{beforeDOMElementCreation(){pp()},beforeI2svg(){pp()}}}};const Or=wi||{};Or[Nr]||(Or[Nr]={});Or[Nr].styles||(Or[Nr].styles={});Or[Nr].hooks||(Or[Nr].hooks={});Or[Nr].shims||(Or[Nr].shims=[]);var rr=Or[Nr];const Z2=[],Q2=function(){Je.removeEventListener("DOMContentLoaded",Q2),Yu=1,Z2.map(t=>t())};let Yu=!1;Ur&&(Yu=(Je.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(Je.readyState),Yu||Je.addEventListener("DOMContentLoaded",Q2));function tP(t){Ur&&(Yu?setTimeout(t,0):Z2.push(t))}function Dl(t){const{tag:e,attributes:n={},children:r=[]}=t;return typeof t=="string"?q2(t):"<".concat(e," ").concat(Zk(n),">").concat(r.map(Dl).join(""),"</").concat(e,">")}function _1(t,e,n){if(t&&t[e]&&t[e][n])return{prefix:e,iconName:n,icon:t[e][n]}}var gp=function(e,n,r,i){var s=Object.keys(e),o=s.length,a=n,u,f,h;for(r===void 0?(u=1,h=e[s[0]]):(u=0,h=r);u<o;u++)f=s[u],h=a(h,e[f],f,e);return h};function nP(t){const e=[];let n=0;const r=t.length;for(;n<r;){const i=t.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){const s=t.charCodeAt(n++);(s&64512)==56320?e.push(((i&1023)<<10)+(s&1023)+65536):(e.push(i),n--)}else e.push(i)}return e}function bg(t){const e=nP(t);return e.length===1?e[0].toString(16):null}function rP(t,e){const n=t.length;let r=t.charCodeAt(e),i;return r>=55296&&r<=56319&&n>e+1&&(i=t.charCodeAt(e+1),i>=56320&&i<=57343)?(r-55296)*1024+i-56320+65536:r}function y1(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return!!r.icon?e[r.iconName]=r.icon:e[n]=r,e},{})}function wg(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{skipHooks:r=!1}=n,i=y1(e);typeof rr.hooks.addPack=="function"&&!r?rr.hooks.addPack(t,y1(e)):rr.styles[t]=fe(fe({},rr.styles[t]||{}),i),t==="fas"&&wg("fa",e)}const{styles:gl,shims:iP}=rr,J2=Object.keys(Hm),sP=J2.reduce((t,e)=>(t[e]=Object.keys(Hm[e]),t),{});let qm=null,G2={},e3={},t3={},n3={},r3={};function oP(t){return~Wk.indexOf(t)}function aP(t,e){const n=e.split("-"),r=n[0],i=n.slice(1).join("-");return r===t&&i!==""&&!oP(i)?i:null}const i3=()=>{const t=r=>gp(gl,(i,s,o)=>(i[o]=gp(s,r,{}),i),{});G2=t((r,i,s)=>(i[3]&&(r[i[3]]=s),i[2]&&i[2].filter(a=>typeof a=="number").forEach(a=>{r[a.toString(16)]=s}),r)),e3=t((r,i,s)=>(r[s]=s,i[2]&&i[2].filter(a=>typeof a=="string").forEach(a=>{r[a]=s}),r)),r3=t((r,i,s)=>{const o=i[2];return r[s]=s,o.forEach(a=>{r[a]=s}),r});const e="far"in gl||Te.autoFetchSvg,n=gp(iP,(r,i)=>{const s=i[0];let o=i[1];const a=i[2];return o==="far"&&!e&&(o="fas"),typeof s=="string"&&(r.names[s]={prefix:o,iconName:a}),typeof s=="number"&&(r.unicodes[s.toString(16)]={prefix:o,iconName:a}),r},{names:{},unicodes:{}});t3=n.names,n3=n.unicodes,qm=qf(Te.styleDefault,{family:Te.familyDefault})};Yk(t=>{qm=qf(t.styleDefault,{family:Te.familyDefault})});i3();function Km(t,e){return(G2[t]||{})[e]}function lP(t,e){return(e3[t]||{})[e]}function Yi(t,e){return(r3[t]||{})[e]}function s3(t){return t3[t]||{prefix:null,iconName:null}}function cP(t){const e=n3[t],n=Km("fas",t);return e||(n?{prefix:"fas",iconName:n}:null)||{prefix:null,iconName:null}}function xi(){return qm}const o3=()=>({prefix:null,iconName:null,rest:[]});function uP(t){let e=Bt;const n=J2.reduce((r,i)=>(r[i]="".concat(Te.cssPrefix,"-").concat(i),r),{});return j2.forEach(r=>{(t.includes(n[r])||t.some(i=>sP[r].includes(i)))&&(e=r)}),e}function qf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{family:n=Bt}=e,r=Uk[n][t];if(n===Xf&&!t)return"fad";const i=g1[n][t]||g1[n][r],s=t in rr.styles?t:null;return i||s||null}function fP(t){let e=[],n=null;return t.forEach(r=>{const i=aP(Te.cssPrefix,r);i?n=i:r&&e.push(r)}),{iconName:n,rest:e}}function v1(t){return t.sort().filter((e,n,r)=>r.indexOf(e)===n)}function Kf(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{skipLookups:n=!1}=e;let r=null;const i=pg.concat(Ck),s=v1(t.filter(p=>i.includes(p))),o=v1(t.filter(p=>!pg.includes(p))),a=s.filter(p=>(r=p,!U2.includes(p))),[u=null]=a,f=uP(s),h=fe(fe({},fP(o)),{},{prefix:qf(u,{family:f})});return fe(fe(fe({},h),gP({values:t,family:f,styles:gl,config:Te,canonical:h,givenPrefix:r})),hP(n,r,h))}function hP(t,e,n){let{prefix:r,iconName:i}=n;if(t||!r||!i)return{prefix:r,iconName:i};const s=e==="fa"?s3(i):{},o=Yi(r,i);return i=s.iconName||o||i,r=s.prefix||r,r==="far"&&!gl.far&&gl.fas&&!Te.autoFetchSvg&&(r="fas"),{prefix:r,iconName:i}}const dP=j2.filter(t=>t!==Bt||t!==Xf),pP=Object.keys(dg).filter(t=>t!==Bt).map(t=>Object.keys(dg[t])).flat();function gP(t){const{values:e,family:n,canonical:r,givenPrefix:i="",styles:s={},config:o={}}=t,a=n===Xf,u=e.includes("fa-duotone")||e.includes("fad"),f=o.familyDefault==="duotone",h=r.prefix==="fad"||r.prefix==="fa-duotone";if(!a&&(u||f||h)&&(r.prefix="fad"),(e.includes("fa-brands")||e.includes("fab"))&&(r.prefix="fab"),!r.prefix&&dP.includes(n)&&(Object.keys(s).find(g=>pP.includes(g))||o.autoFetchSvg)){const g=vk.get(n).defaultShortPrefixId;r.prefix=g,r.iconName=Yi(r.prefix,r.iconName)||r.iconName}return(r.prefix==="fa"||i==="fa")&&(r.prefix=xi()||"fas"),r}class mP{constructor(){this.definitions={}}add(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach(s=>{this.definitions[s]=fe(fe({},this.definitions[s]||{}),i[s]),wg(s,i[s]);const o=Hm[Bt][s];o&&wg(o,i[s]),i3()})}reset(){this.definitions={}}_pullDefinitions(e,n){const r=n.prefix&&n.iconName&&n.icon?{0:n}:n;return Object.keys(r).map(i=>{const{prefix:s,iconName:o,icon:a}=r[i],u=a[2];e[s]||(e[s]={}),u.length>0&&u.forEach(f=>{typeof f=="string"&&(e[s][f]=a)}),e[s][o]=a}),e}}let b1=[],no={};const ho={},_P=Object.keys(ho);function yP(t,e){let{mixoutsTo:n}=e;return b1=t,no={},Object.keys(ho).forEach(r=>{_P.indexOf(r)===-1&&delete ho[r]}),b1.forEach(r=>{const i=r.mixout?r.mixout():{};if(Object.keys(i).forEach(s=>{typeof i[s]=="function"&&(n[s]=i[s]),typeof i[s]=="object"&&Object.keys(i[s]).forEach(o=>{n[s]||(n[s]={}),n[s][o]=i[s][o]})}),r.hooks){const s=r.hooks();Object.keys(s).forEach(o=>{no[o]||(no[o]=[]),no[o].push(s[o])})}r.provides&&r.provides(ho)}),n}function xg(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return(no[t]||[]).forEach(o=>{e=o.apply(null,[e,...r])}),e}function is(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];(no[t]||[]).forEach(s=>{s.apply(null,n)})}function Ti(){const t=arguments[0],e=Array.prototype.slice.call(arguments,1);return ho[t]?ho[t].apply(null,e):void 0}function Tg(t){t.prefix==="fa"&&(t.prefix="fas");let{iconName:e}=t;const n=t.prefix||xi();if(e)return e=Yi(n,e)||e,_1(a3.definitions,n,e)||_1(rr.styles,n,e)}const a3=new mP,vP=()=>{Te.autoReplaceSvg=!1,Te.observeMutations=!1,is("noAuto")},bP={i2svg:function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Ur?(is("beforeI2svg",t),Ti("pseudoElements2svg",t),Ti("i2svg",t)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e}=t;Te.autoReplaceSvg===!1&&(Te.autoReplaceSvg=!0),Te.observeMutations=!0,tP(()=>{xP({autoReplaceSvgRoot:e}),is("watch",t)})}},wP={icon:t=>{if(t===null)return null;if(typeof t=="object"&&t.prefix&&t.iconName)return{prefix:t.prefix,iconName:Yi(t.prefix,t.iconName)||t.iconName};if(Array.isArray(t)&&t.length===2){const e=t[1].indexOf("fa-")===0?t[1].slice(3):t[1],n=qf(t[0]);return{prefix:n,iconName:Yi(n,e)||e}}if(typeof t=="string"&&(t.indexOf("".concat(Te.cssPrefix,"-"))>-1||t.match(jk))){const e=Kf(t.split(" "),{skipLookups:!0});return{prefix:e.prefix||xi(),iconName:Yi(e.prefix,e.iconName)||e.iconName}}if(typeof t=="string"){const e=xi();return{prefix:e,iconName:Yi(e,t)||t}}}},an={noAuto:vP,config:Te,dom:bP,parse:wP,library:a3,findIconDefinition:Tg,toHtml:Dl},xP=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{autoReplaceSvgRoot:e=Je}=t;(Object.keys(rr.styles).length>0||Te.autoFetchSvg)&&Ur&&Te.autoReplaceSvg&&an.dom.i2svg({node:e})};function Zf(t,e){return Object.defineProperty(t,"abstract",{get:e}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(n=>Dl(n))}}),Object.defineProperty(t,"node",{get:function(){if(!Ur)return;const n=Je.createElement("div");return n.innerHTML=t.html,n.children}}),t}function TP(t){let{children:e,main:n,mask:r,attributes:i,styles:s,transform:o}=t;if(Ym(o)&&n.found&&!r.found){const{width:a,height:u}=n,f={x:a/u/2,y:.5};i.style=Yf(fe(fe({},s),{},{"transform-origin":"".concat(f.x+o.x/16,"em ").concat(f.y+o.y/16,"em")}))}return[{tag:"svg",attributes:i,children:e}]}function SP(t){let{prefix:e,iconName:n,children:r,attributes:i,symbol:s}=t;const o=s===!0?"".concat(e,"-").concat(Te.cssPrefix,"-").concat(n):s;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:fe(fe({},i),{},{id:o}),children:r}]}]}function Zm(t){const{icons:{main:e,mask:n},prefix:r,iconName:i,transform:s,symbol:o,title:a,maskId:u,titleId:f,extra:h,watchable:p=!1}=t,{width:g,height:_}=n.found?n:e,v=Sk.includes(r),w=[Te.replacementClass,i?"".concat(Te.cssPrefix,"-").concat(i):""].filter(k=>h.classes.indexOf(k)===-1).filter(k=>k!==""||!!k).concat(h.classes).join(" ");let x={children:[],attributes:fe(fe({},h.attributes),{},{"data-prefix":r,"data-icon":i,class:w,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(g," ").concat(_)})};const T=v&&!~h.classes.indexOf("fa-fw")?{width:"".concat(g/_*16*.0625,"em")}:{};p&&(x.attributes[rs]=""),a&&(x.children.push({tag:"title",attributes:{id:x.attributes["aria-labelledby"]||"title-".concat(f||pl())},children:[a]}),delete x.attributes.title);const A=fe(fe({},x),{},{prefix:r,iconName:i,main:e,mask:n,maskId:u,transform:s,symbol:o,styles:fe(fe({},T),h.styles)}),{children:E,attributes:R}=n.found&&e.found?Ti("generateAbstractMask",A)||{children:[],attributes:{}}:Ti("generateAbstractIcon",A)||{children:[],attributes:{}};return A.children=E,A.attributes=R,o?SP(A):TP(A)}function w1(t){const{content:e,width:n,height:r,transform:i,title:s,extra:o,watchable:a=!1}=t,u=fe(fe(fe({},o.attributes),s?{title:s}:{}),{},{class:o.classes.join(" ")});a&&(u[rs]="");const f=fe({},o.styles);Ym(i)&&(f.transform=Jk({transform:i,startCentered:!0,width:n,height:r}),f["-webkit-transform"]=f.transform);const h=Yf(f);h.length>0&&(u.style=h);const p=[];return p.push({tag:"span",attributes:u,children:[e]}),s&&p.push({tag:"span",attributes:{class:"sr-only"},children:[s]}),p}function EP(t){const{content:e,title:n,extra:r}=t,i=fe(fe(fe({},r.attributes),n?{title:n}:{}),{},{class:r.classes.join(" ")}),s=Yf(r.styles);s.length>0&&(i.style=s);const o=[];return o.push({tag:"span",attributes:i,children:[e]}),n&&o.push({tag:"span",attributes:{class:"sr-only"},children:[n]}),o}const{styles:mp}=rr;function Sg(t){const e=t[0],n=t[1],[r]=t.slice(4);let i=null;return Array.isArray(r)?i={tag:"g",attributes:{class:"".concat(Te.cssPrefix,"-").concat(dp.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Te.cssPrefix,"-").concat(dp.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(Te.cssPrefix,"-").concat(dp.PRIMARY),fill:"currentColor",d:r[1]}}]}:i={tag:"path",attributes:{fill:"currentColor",d:r}},{found:!0,width:e,height:n,icon:i}}const AP={found:!1,width:512,height:512};function CP(t,e){!W2&&!Te.showMissingIcons&&t&&console.error('Icon with name "'.concat(t,'" and prefix "').concat(e,'" is missing.'))}function Eg(t,e){let n=e;return e==="fa"&&Te.styleDefault!==null&&(e=xi()),new Promise((r,i)=>{if(n==="fa"){const s=s3(t)||{};t=s.iconName||t,e=s.prefix||e}if(t&&e&&mp[e]&&mp[e][t]){const s=mp[e][t];return r(Sg(s))}CP(t,e),r(fe(fe({},AP),{},{icon:Te.showMissingIcons&&t?Ti("missingIconAbstract")||{}:{}}))})}const x1=()=>{},Ag=Te.measurePerformance&&nu&&nu.mark&&nu.measure?nu:{mark:x1,measure:x1},Ua='FA "6.7.2"',RP=t=>(Ag.mark("".concat(Ua," ").concat(t," begins")),()=>l3(t)),l3=t=>{Ag.mark("".concat(Ua," ").concat(t," ends")),Ag.measure("".concat(Ua," ").concat(t),"".concat(Ua," ").concat(t," begins"),"".concat(Ua," ").concat(t," ends"))};var Qm={begin:RP,end:l3};const Pu=()=>{};function T1(t){return typeof(t.getAttribute?t.getAttribute(rs):null)=="string"}function IP(t){const e=t.getAttribute?t.getAttribute($m):null,n=t.getAttribute?t.getAttribute(Wm):null;return e&&n}function kP(t){return t&&t.classList&&t.classList.contains&&t.classList.contains(Te.replacementClass)}function PP(){return Te.autoReplaceSvg===!0?Mu.replace:Mu[Te.autoReplaceSvg]||Mu.replace}function MP(t){return Je.createElementNS("http://www.w3.org/2000/svg",t)}function NP(t){return Je.createElement(t)}function c3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{ceFn:n=t.tag==="svg"?MP:NP}=e;if(typeof t=="string")return Je.createTextNode(t);const r=n(t.tag);return Object.keys(t.attributes||[]).forEach(function(s){r.setAttribute(s,t.attributes[s])}),(t.children||[]).forEach(function(s){r.appendChild(c3(s,{ceFn:n}))}),r}function OP(t){let e=" ".concat(t.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}const Mu={replace:function(t){const e=t[0];if(e.parentNode)if(t[1].forEach(n=>{e.parentNode.insertBefore(c3(n),e)}),e.getAttribute(rs)===null&&Te.keepOriginalSource){let n=Je.createComment(OP(e));e.parentNode.replaceChild(n,e)}else e.remove()},nest:function(t){const e=t[0],n=t[1];if(~Xm(e).indexOf(Te.replacementClass))return Mu.replace(t);const r=new RegExp("".concat(Te.cssPrefix,"-.*"));if(delete n[0].attributes.id,n[0].attributes.class){const s=n[0].attributes.class.split(" ").reduce((o,a)=>(a===Te.replacementClass||a.match(r)?o.toSvg.push(a):o.toNode.push(a),o),{toNode:[],toSvg:[]});n[0].attributes.class=s.toSvg.join(" "),s.toNode.length===0?e.removeAttribute("class"):e.setAttribute("class",s.toNode.join(" "))}const i=n.map(s=>Dl(s)).join(`
`);e.setAttribute(rs,""),e.innerHTML=i}};function S1(t){t()}function u3(t,e){const n=typeof e=="function"?e:Pu;if(t.length===0)n();else{let r=S1;Te.mutateApproach===Lk&&(r=wi.requestAnimationFrame||S1),r(()=>{const i=PP(),s=Qm.begin("mutate");t.map(i),s(),n()})}}let Jm=!1;function f3(){Jm=!0}function Cg(){Jm=!1}let qu=null;function E1(t){if(!f1||!Te.observeMutations)return;const{treeCallback:e=Pu,nodeCallback:n=Pu,pseudoElementsCallback:r=Pu,observeMutationsRoot:i=Je}=t;qu=new f1(s=>{if(Jm)return;const o=xi();jo(s).forEach(a=>{if(a.type==="childList"&&a.addedNodes.length>0&&!T1(a.addedNodes[0])&&(Te.searchPseudoElements&&r(a.target),e(a.target)),a.type==="attributes"&&a.target.parentNode&&Te.searchPseudoElements&&r(a.target.parentNode),a.type==="attributes"&&T1(a.target)&&~$k.indexOf(a.attributeName))if(a.attributeName==="class"&&IP(a.target)){const{prefix:u,iconName:f}=Kf(Xm(a.target));a.target.setAttribute($m,u||o),f&&a.target.setAttribute(Wm,f)}else kP(a.target)&&n(a.target)})}),Ur&&qu.observe(i,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function DP(){qu&&qu.disconnect()}function FP(t){const e=t.getAttribute("style");let n=[];return e&&(n=e.split(";").reduce((r,i)=>{const s=i.split(":"),o=s[0],a=s.slice(1);return o&&a.length>0&&(r[o]=a.join(":").trim()),r},{})),n}function LP(t){const e=t.getAttribute("data-prefix"),n=t.getAttribute("data-icon"),r=t.innerText!==void 0?t.innerText.trim():"";let i=Kf(Xm(t));return i.prefix||(i.prefix=xi()),e&&n&&(i.prefix=e,i.iconName=n),i.iconName&&i.prefix||(i.prefix&&r.length>0&&(i.iconName=lP(i.prefix,t.innerText)||Km(i.prefix,bg(t.innerText))),!i.iconName&&Te.autoFetchSvg&&t.firstChild&&t.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=t.firstChild.data)),i}function BP(t){const e=jo(t.attributes).reduce((i,s)=>(i.name!=="class"&&i.name!=="style"&&(i[s.name]=s.value),i),{}),n=t.getAttribute("title"),r=t.getAttribute("data-fa-title-id");return Te.autoA11y&&(n?e["aria-labelledby"]="".concat(Te.replacementClass,"-title-").concat(r||pl()):(e["aria-hidden"]="true",e.focusable="false")),e}function UP(){return{iconName:null,title:null,titleId:null,prefix:null,transform:nr,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function A1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0};const{iconName:n,prefix:r,rest:i}=LP(t),s=BP(t),o=xg("parseNodeAttributes",{},t);let a=e.styleParser?FP(t):[];return fe({iconName:n,title:t.getAttribute("title"),titleId:t.getAttribute("data-fa-title-id"),prefix:r,transform:nr,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:i,styles:a,attributes:s}},o)}const{styles:jP}=rr;function h3(t){const e=Te.autoReplaceSvg==="nest"?A1(t,{styleParser:!1}):A1(t);return~e.extra.classes.indexOf(X2)?Ti("generateLayersText",t,e):Ti("generateSvgReplacementMutation",t,e)}function zP(){return[...wk,...pg]}function C1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!Ur)return Promise.resolve();const n=Je.documentElement.classList,r=h=>n.add("".concat(p1,"-").concat(h)),i=h=>n.remove("".concat(p1,"-").concat(h)),s=Te.autoFetchSvg?zP():U2.concat(Object.keys(jP));s.includes("fa")||s.push("fa");const o=[".".concat(X2,":not([").concat(rs,"])")].concat(s.map(h=>".".concat(h,":not([").concat(rs,"])"))).join(", ");if(o.length===0)return Promise.resolve();let a=[];try{a=jo(t.querySelectorAll(o))}catch{}if(a.length>0)r("pending"),i("complete");else return Promise.resolve();const u=Qm.begin("onTree"),f=a.reduce((h,p)=>{try{const g=h3(p);g&&h.push(g)}catch(g){W2||g.name==="MissingIcon"&&console.error(g)}return h},[]);return new Promise((h,p)=>{Promise.all(f).then(g=>{u3(g,()=>{r("active"),r("complete"),i("pending"),typeof e=="function"&&e(),u(),h()})}).catch(g=>{u(),p(g)})})}function VP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;h3(t).then(n=>{n&&u3([n],e)})}function $P(t){return function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=(e||{}).icon?e:Tg(e||{});let{mask:i}=n;return i&&(i=(i||{}).icon?i:Tg(i||{})),t(r,fe(fe({},n),{},{mask:i}))}}const WP=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:n=nr,symbol:r=!1,mask:i=null,maskId:s=null,title:o=null,titleId:a=null,classes:u=[],attributes:f={},styles:h={}}=e;if(!t)return;const{prefix:p,iconName:g,icon:_}=t;return Zf(fe({type:"icon"},t),()=>(is("beforeDOMElementCreation",{iconDefinition:t,params:e}),Te.autoA11y&&(o?f["aria-labelledby"]="".concat(Te.replacementClass,"-title-").concat(a||pl()):(f["aria-hidden"]="true",f.focusable="false")),Zm({icons:{main:Sg(_),mask:i?Sg(i.icon):{found:!1,width:null,height:null,icon:{}}},prefix:p,iconName:g,transform:fe(fe({},nr),n),symbol:r,title:o,maskId:s,titleId:a,extra:{attributes:f,styles:h,classes:u}})))};var HP={mixout(){return{icon:$P(WP)}},hooks(){return{mutationObserverCallbacks(t){return t.treeCallback=C1,t.nodeCallback=VP,t}}},provides(t){t.i2svg=function(e){const{node:n=Je,callback:r=()=>{}}=e;return C1(n,r)},t.generateSvgReplacementMutation=function(e,n){const{iconName:r,title:i,titleId:s,prefix:o,transform:a,symbol:u,mask:f,maskId:h,extra:p}=n;return new Promise((g,_)=>{Promise.all([Eg(r,o),f.iconName?Eg(f.iconName,f.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(v=>{let[w,x]=v;g([e,Zm({icons:{main:w,mask:x},prefix:o,iconName:r,transform:a,symbol:u,maskId:h,title:i,titleId:s,extra:p,watchable:!0})])}).catch(_)})},t.generateAbstractIcon=function(e){let{children:n,attributes:r,main:i,transform:s,styles:o}=e;const a=Yf(o);a.length>0&&(r.style=a);let u;return Ym(s)&&(u=Ti("generateAbstractTransformGrouping",{main:i,transform:s,containerWidth:i.width,iconWidth:i.width})),n.push(u||i.icon),{children:n,attributes:r}}}},XP={mixout(){return{layer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{classes:n=[]}=e;return Zf({type:"layer"},()=>{is("beforeDOMElementCreation",{assembler:t,params:e});let r=[];return t(i=>{Array.isArray(i)?i.map(s=>{r=r.concat(s.abstract)}):r=r.concat(i.abstract)}),[{tag:"span",attributes:{class:["".concat(Te.cssPrefix,"-layers"),...n].join(" ")},children:r}]})}}}},YP={mixout(){return{counter(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{title:n=null,classes:r=[],attributes:i={},styles:s={}}=e;return Zf({type:"counter",content:t},()=>(is("beforeDOMElementCreation",{content:t,params:e}),EP({content:t.toString(),title:n,extra:{attributes:i,styles:s,classes:["".concat(Te.cssPrefix,"-layers-counter"),...r]}})))}}}},qP={mixout(){return{text(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{transform:n=nr,title:r=null,classes:i=[],attributes:s={},styles:o={}}=e;return Zf({type:"text",content:t},()=>(is("beforeDOMElementCreation",{content:t,params:e}),w1({content:t,transform:fe(fe({},nr),n),title:r,extra:{attributes:s,styles:o,classes:["".concat(Te.cssPrefix,"-layers-text"),...i]}})))}}},provides(t){t.generateLayersText=function(e,n){const{title:r,transform:i,extra:s}=n;let o=null,a=null;if(L2){const u=parseInt(getComputedStyle(e).fontSize,10),f=e.getBoundingClientRect();o=f.width/u,a=f.height/u}return Te.autoA11y&&!r&&(s.attributes["aria-hidden"]="true"),Promise.resolve([e,w1({content:e.innerHTML,width:o,height:a,transform:i,title:r,extra:s,watchable:!0})])}}};const KP=new RegExp('"',"ug"),R1=[1105920,1112319],I1=fe(fe(fe(fe({},{FontAwesome:{normal:"fas",400:"fas"}}),yk),Dk),Rk),Rg=Object.keys(I1).reduce((t,e)=>(t[e.toLowerCase()]=I1[e],t),{}),ZP=Object.keys(Rg).reduce((t,e)=>{const n=Rg[e];return t[e]=n[900]||[...Object.entries(n)][0][1],t},{});function QP(t){const e=t.replace(KP,""),n=rP(e,0),r=n>=R1[0]&&n<=R1[1],i=e.length===2?e[0]===e[1]:!1;return{value:bg(i?e[0]:e),isSecondary:r||i}}function JP(t,e){const n=t.replace(/^['"]|['"]$/g,"").toLowerCase(),r=parseInt(e),i=isNaN(r)?"normal":r;return(Rg[n]||{})[i]||ZP[n]}function k1(t,e){const n="".concat(Fk).concat(e.replace(":","-"));return new Promise((r,i)=>{if(t.getAttribute(n)!==null)return r();const o=jo(t.children).filter(g=>g.getAttribute(mg)===e)[0],a=wi.getComputedStyle(t,e),u=a.getPropertyValue("font-family"),f=u.match(zk),h=a.getPropertyValue("font-weight"),p=a.getPropertyValue("content");if(o&&!f)return t.removeChild(o),r();if(f&&p!=="none"&&p!==""){const g=a.getPropertyValue("content");let _=JP(u,h);const{value:v,isSecondary:w}=QP(g),x=f[0].startsWith("FontAwesome");let T=Km(_,v),A=T;if(x){const E=cP(v);E.iconName&&E.prefix&&(T=E.iconName,_=E.prefix)}if(T&&!w&&(!o||o.getAttribute($m)!==_||o.getAttribute(Wm)!==A)){t.setAttribute(n,A),o&&t.removeChild(o);const E=UP(),{extra:R}=E;R.attributes[mg]=e,Eg(T,_).then(k=>{const M=Zm(fe(fe({},E),{},{icons:{main:k,mask:o3()},prefix:_,iconName:A,extra:R,watchable:!0})),L=Je.createElementNS("http://www.w3.org/2000/svg","svg");e==="::before"?t.insertBefore(L,t.firstChild):t.appendChild(L),L.outerHTML=M.map(W=>Dl(W)).join(`
`),t.removeAttribute(n),r()}).catch(i)}else r()}else r()})}function GP(t){return Promise.all([k1(t,"::before"),k1(t,"::after")])}function eM(t){return t.parentNode!==document.head&&!~Bk.indexOf(t.tagName.toUpperCase())&&!t.getAttribute(mg)&&(!t.parentNode||t.parentNode.tagName!=="svg")}function P1(t){if(Ur)return new Promise((e,n)=>{const r=jo(t.querySelectorAll("*")).filter(eM).map(GP),i=Qm.begin("searchPseudoElements");f3(),Promise.all(r).then(()=>{i(),Cg(),e()}).catch(()=>{i(),Cg(),n()})})}var tM={hooks(){return{mutationObserverCallbacks(t){return t.pseudoElementsCallback=P1,t}}},provides(t){t.pseudoElements2svg=function(e){const{node:n=Je}=e;Te.searchPseudoElements&&P1(n)}}};let M1=!1;var nM={mixout(){return{dom:{unwatch(){f3(),M1=!0}}}},hooks(){return{bootstrap(){E1(xg("mutationObserverCallbacks",{}))},noAuto(){DP()},watch(t){const{observeMutationsRoot:e}=t;M1?Cg():E1(xg("mutationObserverCallbacks",{observeMutationsRoot:e}))}}}};const N1=t=>{let e={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return t.toLowerCase().split(" ").reduce((n,r)=>{const i=r.toLowerCase().split("-"),s=i[0];let o=i.slice(1).join("-");if(s&&o==="h")return n.flipX=!0,n;if(s&&o==="v")return n.flipY=!0,n;if(o=parseFloat(o),isNaN(o))return n;switch(s){case"grow":n.size=n.size+o;break;case"shrink":n.size=n.size-o;break;case"left":n.x=n.x-o;break;case"right":n.x=n.x+o;break;case"up":n.y=n.y-o;break;case"down":n.y=n.y+o;break;case"rotate":n.rotate=n.rotate+o;break}return n},e)};var rM={mixout(){return{parse:{transform:t=>N1(t)}}},hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-transform");return n&&(t.transform=N1(n)),t}}},provides(t){t.generateAbstractTransformGrouping=function(e){let{main:n,transform:r,containerWidth:i,iconWidth:s}=e;const o={transform:"translate(".concat(i/2," 256)")},a="translate(".concat(r.x*32,", ").concat(r.y*32,") "),u="scale(".concat(r.size/16*(r.flipX?-1:1),", ").concat(r.size/16*(r.flipY?-1:1),") "),f="rotate(".concat(r.rotate," 0 0)"),h={transform:"".concat(a," ").concat(u," ").concat(f)},p={transform:"translate(".concat(s/2*-1," -256)")},g={outer:o,inner:h,path:p};return{tag:"g",attributes:fe({},g.outer),children:[{tag:"g",attributes:fe({},g.inner),children:[{tag:n.icon.tag,children:n.icon.children,attributes:fe(fe({},n.icon.attributes),g.path)}]}]}}}};const _p={x:0,y:0,width:"100%",height:"100%"};function O1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.attributes&&(t.attributes.fill||e)&&(t.attributes.fill="black"),t}function iM(t){return t.tag==="g"?t.children:[t]}var sM={hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-mask"),r=n?Kf(n.split(" ").map(i=>i.trim())):o3();return r.prefix||(r.prefix=xi()),t.mask=r,t.maskId=e.getAttribute("data-fa-mask-id"),t}}},provides(t){t.generateAbstractMask=function(e){let{children:n,attributes:r,main:i,mask:s,maskId:o,transform:a}=e;const{width:u,icon:f}=i,{width:h,icon:p}=s,g=Qk({transform:a,containerWidth:h,iconWidth:u}),_={tag:"rect",attributes:fe(fe({},_p),{},{fill:"white"})},v=f.children?{children:f.children.map(O1)}:{},w={tag:"g",attributes:fe({},g.inner),children:[O1(fe({tag:f.tag,attributes:fe(fe({},f.attributes),g.path)},v))]},x={tag:"g",attributes:fe({},g.outer),children:[w]},T="mask-".concat(o||pl()),A="clip-".concat(o||pl()),E={tag:"mask",attributes:fe(fe({},_p),{},{id:T,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[_,x]},R={tag:"defs",children:[{tag:"clipPath",attributes:{id:A},children:iM(p)},E]};return n.push(R,{tag:"rect",attributes:fe({fill:"currentColor","clip-path":"url(#".concat(A,")"),mask:"url(#".concat(T,")")},_p)}),{children:n,attributes:r}}}},oM={provides(t){let e=!1;wi.matchMedia&&(e=wi.matchMedia("(prefers-reduced-motion: reduce)").matches),t.missingIconAbstract=function(){const n=[],r={fill:"currentColor"},i={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};n.push({tag:"path",attributes:fe(fe({},r),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});const s=fe(fe({},i),{},{attributeName:"opacity"}),o={tag:"circle",attributes:fe(fe({},r),{},{cx:"256",cy:"364",r:"28"}),children:[]};return e||o.children.push({tag:"animate",attributes:fe(fe({},i),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:fe(fe({},s),{},{values:"1;0;1;1;0;1;"})}),n.push(o),n.push({tag:"path",attributes:fe(fe({},r),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:e?[]:[{tag:"animate",attributes:fe(fe({},s),{},{values:"1;0;0;0;0;1;"})}]}),e||n.push({tag:"path",attributes:fe(fe({},r),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:fe(fe({},s),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:n}}}},aM={hooks(){return{parseNodeAttributes(t,e){const n=e.getAttribute("data-fa-symbol"),r=n===null?!1:n===""?!0:n;return t.symbol=r,t}}}},lM=[eP,HP,XP,YP,qP,tM,nM,rM,sM,oM,aM];yP(lM,{mixoutsTo:an});an.noAuto;an.config;an.library;an.dom;const Ig=an.parse;an.findIconDefinition;an.toHtml;const cM=an.icon;an.layer;an.text;an.counter;var yp={exports:{}},vp,D1;function uM(){if(D1)return vp;D1=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return vp=t,vp}var bp,F1;function fM(){if(F1)return bp;F1=1;var t=uM();function e(){}function n(){}return n.resetWarningCache=e,bp=function(){function r(o,a,u,f,h,p){if(p!==t){var g=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw g.name="Invariant Violation",g}}r.isRequired=r;function i(){return r}var s={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:e};return s.PropTypes=s,s},bp}var L1;function hM(){return L1||(L1=1,yp.exports=fM()()),yp.exports}var dM=hM();const De=kl(dM);function B1(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Qn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?B1(Object(n),!0).forEach(function(r){ro(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):B1(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ku(t){"@babel/helpers - typeof";return Ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ku(t)}function ro(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pM(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function gM(t,e){if(t==null)return{};var n=pM(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function kg(t){return mM(t)||_M(t)||yM(t)||vM()}function mM(t){if(Array.isArray(t))return Pg(t)}function _M(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function yM(t,e){if(t){if(typeof t=="string")return Pg(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pg(t,e)}}function Pg(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function vM(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bM(t){var e,n=t.beat,r=t.fade,i=t.beatFade,s=t.bounce,o=t.shake,a=t.flash,u=t.spin,f=t.spinPulse,h=t.spinReverse,p=t.pulse,g=t.fixedWidth,_=t.inverse,v=t.border,w=t.listItem,x=t.flip,T=t.size,A=t.rotation,E=t.pull,R=(e={"fa-beat":n,"fa-fade":r,"fa-beat-fade":i,"fa-bounce":s,"fa-shake":o,"fa-flash":a,"fa-spin":u,"fa-spin-reverse":h,"fa-spin-pulse":f,"fa-pulse":p,"fa-fw":g,"fa-inverse":_,"fa-border":v,"fa-li":w,"fa-flip":x===!0,"fa-flip-horizontal":x==="horizontal"||x==="both","fa-flip-vertical":x==="vertical"||x==="both"},ro(e,"fa-".concat(T),typeof T<"u"&&T!==null),ro(e,"fa-rotate-".concat(A),typeof A<"u"&&A!==null&&A!==0),ro(e,"fa-pull-".concat(E),typeof E<"u"&&E!==null),ro(e,"fa-swap-opacity",t.swapOpacity),e);return Object.keys(R).map(function(k){return R[k]?k:null}).filter(function(k){return k})}function wM(t){return t=t-0,t===t}function d3(t){return wM(t)?t:(t=t.replace(/[\-_\s]+(.)?/g,function(e,n){return n?n.toUpperCase():""}),t.substr(0,1).toLowerCase()+t.substr(1))}var xM=["style"];function TM(t){return t.charAt(0).toUpperCase()+t.slice(1)}function SM(t){return t.split(";").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,n){var r=n.indexOf(":"),i=d3(n.slice(0,r)),s=n.slice(r+1).trim();return i.startsWith("webkit")?e[TM(i)]=s:e[i]=s,e},{})}function p3(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof e=="string")return e;var r=(e.children||[]).map(function(u){return p3(t,u)}),i=Object.keys(e.attributes||{}).reduce(function(u,f){var h=e.attributes[f];switch(f){case"class":u.attrs.className=h,delete e.attributes.class;break;case"style":u.attrs.style=SM(h);break;default:f.indexOf("aria-")===0||f.indexOf("data-")===0?u.attrs[f.toLowerCase()]=h:u.attrs[d3(f)]=h}return u},{attrs:{}}),s=n.style,o=s===void 0?{}:s,a=gM(n,xM);return i.attrs.style=Qn(Qn({},i.attrs.style),o),t.apply(void 0,[e.tag,Qn(Qn({},i.attrs),a)].concat(kg(r)))}var g3=!1;try{g3=!0}catch{}function EM(){if(!g3&&console&&typeof console.error=="function"){var t;(t=console).error.apply(t,arguments)}}function U1(t){if(t&&Ku(t)==="object"&&t.prefix&&t.iconName&&t.icon)return t;if(Ig.icon)return Ig.icon(t);if(t===null)return null;if(t&&Ku(t)==="object"&&t.prefix&&t.iconName)return t;if(Array.isArray(t)&&t.length===2)return{prefix:t[0],iconName:t[1]};if(typeof t=="string")return{prefix:"fas",iconName:t}}function wp(t,e){return Array.isArray(e)&&e.length>0||!Array.isArray(e)&&e?ro({},t,e):{}}var j1={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1},qi=ht.forwardRef(function(t,e){var n=Qn(Qn({},j1),t),r=n.icon,i=n.mask,s=n.symbol,o=n.className,a=n.title,u=n.titleId,f=n.maskId,h=U1(r),p=wp("classes",[].concat(kg(bM(n)),kg((o||"").split(" ")))),g=wp("transform",typeof n.transform=="string"?Ig.transform(n.transform):n.transform),_=wp("mask",U1(i)),v=cM(h,Qn(Qn(Qn(Qn({},p),g),_),{},{symbol:s,title:a,titleId:u,maskId:f}));if(!v)return EM("Could not find icon",h),null;var w=v.abstract,x={ref:e};return Object.keys(n).forEach(function(T){j1.hasOwnProperty(T)||(x[T]=n[T])}),AM(w[0],x)});qi.displayName="FontAwesomeIcon";qi.propTypes={beat:De.bool,border:De.bool,beatFade:De.bool,bounce:De.bool,className:De.string,fade:De.bool,flash:De.bool,mask:De.oneOfType([De.object,De.array,De.string]),maskId:De.string,fixedWidth:De.bool,inverse:De.bool,flip:De.oneOf([!0,!1,"horizontal","vertical","both"]),icon:De.oneOfType([De.object,De.array,De.string]),listItem:De.bool,pull:De.oneOf(["right","left"]),pulse:De.bool,rotation:De.oneOf([0,90,180,270]),shake:De.bool,size:De.oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:De.bool,spinPulse:De.bool,spinReverse:De.bool,symbol:De.oneOfType([De.bool,De.string]),title:De.string,titleId:De.string,transform:De.oneOfType([De.string,De.object]),swapOpacity:De.bool};var AM=p3.bind(null,ht.createElement);/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const CM={prefix:"fab",iconName:"x-twitter",icon:[512,512,[],"e61b","M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"]},RM={prefix:"fab",iconName:"instagram",icon:[448,512,[],"f16d","M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"]},IM={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256C0 376 82.7 476.8 194.2 504.5V334.2H141.4V256h52.8V222.3c0-87.1 39.4-127.5 125-127.5c16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1c-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287V510.1C413.8 494.8 512 386.9 512 256h0z"]},kM={prefix:"fab",iconName:"bluesky",icon:[512,512,[],"e671","M111.8 62.2C170.2 105.9 233 194.7 256 242.4c23-47.6 85.8-136.4 144.2-180.2c42.1-31.6 110.3-56 110.3 21.8c0 15.5-8.9 130.5-14.1 149.2C478.2 298 412 314.6 353.1 304.5c102.9 17.5 129.1 75.5 72.5 133.5c-107.4 110.2-154.3-27.6-166.3-62.9l0 0c-1.7-4.9-2.6-7.8-3.3-7.8s-1.6 3-3.3 7.8l0 0c-12 35.3-59 173.1-166.3 62.9c-56.5-58-30.4-116 72.5-133.5C100 314.6 33.8 298 15.7 233.1C10.4 214.4 1.5 99.4 1.5 83.9c0-77.8 68.2-53.4 110.3-21.8z"]};function m3(){return C.jsx("div",{className:"footer-container",children:C.jsxs("footer",{className:"footer",children:[C.jsxs("div",{className:"footer-columns",children:[C.jsxs("div",{className:"column-one",children:[C.jsx("div",{className:"logo",children:C.jsx("p",{className:"brand-name",children:"PixelMap"})}),C.jsx("p",{className:"brand-slogan",children:"precise data-viz craftsmanship"}),C.jsxs("div",{className:"brand-social-icons",children:[C.jsx("a",{href:"https://x.com",target:"_blank",rel:"noopener noreferrer","aria-label":"xTwitter",children:C.jsx(qi,{icon:CM})}),C.jsx("a",{href:"https://facebook.com",target:"_blank",rel:"noopener noreferrer","aria-label":"Facebook",children:C.jsx(qi,{icon:IM})}),C.jsx("a",{href:"https://instagram.com",target:"_blank",rel:"noopener noreferrer","aria-label":"Instagram",children:C.jsx(qi,{icon:RM})}),C.jsx("a",{href:"https://bluesky.com",target:"_blank",rel:"noopener noreferrer","aria-label":"Threads",children:C.jsx(qi,{icon:kM})})]})]}),C.jsxs("div",{className:"column-two",children:[C.jsxs("div",{className:"column-three",children:[C.jsx("p",{className:"footer-column-heading mb-3",children:"Products & Services"}),C.jsx("p",{className:"footer-column-option mb-3",children:"For Business"}),C.jsx("p",{className:"footer-column-option mb-3",children:"For Partners"}),C.jsx("p",{className:"footer-column-option mb-3",children:"For Advertising"}),C.jsx("p",{className:"footer-column-option mb-3",children:"For Developers"})]}),C.jsxs("div",{className:"column-four",children:[C.jsx("p",{className:"footer-column-heading mb-3",children:"Contact"}),C.jsx("p",{className:"footer-column-option mb-3",children:"lasabahebwa@gmail.com"}),C.jsx("p",{className:"footer-column-option mb-3",children:"(+256) 785 759096"})]})]})]}),C.jsxs("div",{className:"footer-bottom",children:[C.jsxs("div",{className:"footer-bottom-trademark",children:[" ",'© 2025 PixelMap, Inc. "PixelMap" and the logo design are registered trademarks of PixelMap. All Rights Reserved.'," "]}),C.jsxs("div",{className:"footer-bottom-links",children:[C.jsx("span",{children:"Terms of Use"}),"|",C.jsx("span",{children:"Privacy Policy"}),"|",C.jsx("span",{children:"Cookie Policy"})]})]})]})})}function PM(){return C.jsxs(C.Fragment,{children:[C.jsx(tk,{}),C.jsx(ak,{}),C.jsx(lk,{}),C.jsx(m3,{})]})}function MM(){return C.jsxs("header",{className:"pages-header-container",children:[C.jsxs("div",{className:"pages-header",children:[C.jsx("div",{className:"pages-left-header",children:C.jsx("div",{className:"logo",children:C.jsxs(Et,{to:"/",children:[C.jsx("img",{src:N2,alt:"logo-img",className:"logo-img"}),C.jsx("span",{className:"pages-brand-name",children:"PixelMap"})]})})}),C.jsx("div",{className:"pages-center-header",children:C.jsx("nav",{className:"pages-main-nav",children:C.jsxs("ul",{children:[C.jsx("li",{children:C.jsx(Et,{to:"/",children:"Home"})}),C.jsx("li",{children:C.jsx(Gs,{to:"/services",className:({isActive:t})=>t?"active-nav-link":"",children:"Services"})}),C.jsx("li",{children:C.jsx(Gs,{to:"/about",className:({isActive:t})=>t?"active-nav-link":"",children:"About"})})]})})}),C.jsx("div",{className:"pages-right-header",children:C.jsx("nav",{className:"main-nav",children:C.jsx("ul",{children:C.jsx("li",{children:C.jsx(Gs,{to:"/contact",className:({isActive:t})=>t?"active-nav-link":"",children:"Contact"})})})})})]}),C.jsx("div",{className:"pages-mobile-nav",children:C.jsx("nav",{className:"pages-main-nav",children:C.jsxs("ul",{children:[C.jsx("li",{children:C.jsx(Et,{to:"/",children:"Home"})}),C.jsx("li",{children:C.jsx(Gs,{to:"/services",className:({isActive:t})=>t?"active-nav-link":"",children:"Services"})}),C.jsx("li",{children:C.jsx(Gs,{to:"/about",className:({isActive:t})=>t?"active-nav-link":"",children:"About"})})]})})})]})}function jr({children:t}){return C.jsxs(C.Fragment,{children:[C.jsx(MM,{}),t,C.jsx(m3,{})]})}function NM(){const t=[{id:1,title:"Mapping",icon:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/mapping.png",description:"Creating maps to show data distribution, density, and relationships. Our mapping solutions help you visualize geographical data patterns and make informed decisions based on spatial information."},{id:2,title:"3D Modeling",icon:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/3dmodelling.png",description:"Representing geographical areas in three dimensions for a more immersive view. Our 3D modeling brings depth and perspective to your spatial data, creating engaging and intuitive visualizations."},{id:3,title:"Dashboards",icon:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/dashboards.png",description:"Developing dashboards with interactive maps and visualizations for exploration and analysis. Our interactive solutions allow users to dynamically engage with data for deeper insights."},{id:4,title:"Interactivity",icon:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/interactivity.png",description:"Enabling users to zoom, pan, filter, and interact with the data on the map"},{id:5,title:"Scalability",icon:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/scalability.png",description:"Handling large datasets and providing access to visualizations through web and mobile platforms."},{id:6,title:"Customization",icon:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/customization.png",description:"Offering options to customize map styles, visualizations, and user interfaces."}];return C.jsxs("div",{className:"services-container",children:[C.jsx("div",{className:"services-hero-container",children:C.jsx("div",{className:"services-hero-image",children:C.jsxs("div",{className:"services-hero-content",children:[C.jsx("h1",{className:"services-hero-title",children:"We help you explore, understand, and communicate your data in a visually impactful way."}),C.jsx(Et,{to:"/contact",className:"contact-button",children:"Let's talk"})]})})}),C.jsx("div",{className:"services-approach-container",children:C.jsxs("div",{className:"services-approach-wrapper",children:[C.jsx("div",{className:"services-approach-image",children:C.jsx("img",{src:"https://weathersasa.lon1.cdn.digitaloceanspaces.com/pixelmapstudio/images/layouts.png",alt:"approach"})}),C.jsxs("div",{className:"services-approach-content",children:[C.jsx("h3",{children:" Our Approach"}),C.jsxs("div",{className:"grid grid-cols-[40px_1fr] gap-x-2 px-4",children:[C.jsxs("div",{className:"flex flex-col items-center gap-1 pt-3",children:[C.jsx("div",{"data-icon":"MagnifyingGlass","data-size":"24px","data-weight":"regular",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",fill:"currentColor",viewBox:"0 0 256 256",children:C.jsx("path",{d:"M229.66,218.34l-50.07-50.06a88.11,88.11,0,1,0-11.31,11.31l50.06,50.07a8,8,0,0,0,11.32-11.32ZM40,112a72,72,0,1,1,72,72A72.08,72.08,0,0,1,40,112Z"})})}),C.jsx("div",{className:"w-[1.5px] bg-[#dbe0e6] h-2 grow"})]}),C.jsxs("div",{className:"flex flex-1 flex-col py-3",children:[C.jsx("p",{className:"text-[#ffffff] text-base font-medium leading-normal",children:"Strategy"}),C.jsx("p",{children:"In the initial phase, we collaborate to define the project's goals and expectations. This involves understanding the availability and structure of the dataset to be visualized."})]}),C.jsxs("div",{className:"flex flex-col items-center gap-1",children:[C.jsx("div",{className:"w-[1.5px] bg-[#ffffff] h-2"}),C.jsx("div",{"data-icon":"PencilSimple","data-size":"24px","data-weight":"regular",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",fill:"currentColor",viewBox:"0 0 256 256",children:C.jsx("path",{d:"M227.31,73.37,182.63,28.68a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69A15.86,15.86,0,0,0,104,219.31L227.31,96a16,16,0,0,0,0-22.63ZM92.69,208H48V163.31l88-88L180.69,120ZM192,108.68,147.31,64l24-24L216,84.68Z"})})}),C.jsx("div",{className:"w-[1.5px] bg-[#dbe0e6] h-2 grow"})]}),C.jsxs("div",{className:"flex flex-1 flex-col py-3",children:[C.jsx("p",{className:"text-[#ffffff] text-base font-medium leading-normal",children:"Pre-production"}),C.jsx("p",{children:"In this phase, I develop a demo version of the final product. A smaller subset of the dataset is analyzed and visualized, incorporating preliminary user experience elements."})]}),C.jsxs("div",{className:"flex flex-col items-center gap-1 pb-3",children:[C.jsx("div",{className:"w-[1.5px] bg-[#dbe0e6] h-2"}),C.jsx("div",{"data-icon":"FilmSlate","data-size":"24px","data-weight":"regular",children:C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24px",height:"24px",fill:"currentColor",viewBox:"0 0 256 256",children:C.jsx("path",{d:"M216,104H102.09L210,75.51a8,8,0,0,0,5.68-9.84l-8.16-30a15.93,15.93,0,0,0-19.42-11.13L35.81,64.74a15.75,15.75,0,0,0-9.7,7.4,15.51,15.51,0,0,0-1.55,12L32,111.56c0,.14,0,.29,0,.44v88a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V112A8,8,0,0,0,216,104ZM192.16,40l6,22.07-22.62,6L147.42,51.83Zm-66.69,17.6,28.12,16.24-36.94,9.75L88.53,67.37Zm-79.4,44.62-6-22.08,26.5-7L94.69,89.4ZM208,200H48V120H208v80Z"})})})]}),C.jsxs("div",{className:"flex flex-1 flex-col py-3",children:[C.jsx("p",{className:"text-[#ffffff] text-base font-medium leading-normal",children:"Production"}),C.jsx("p",{children:"In the final phase, the entire dataset is integrated. All visual and interactive elements—such as styles, fonts, colors, layers, and transitions—are tailored to match the project's overarching aesthetic and functionality."})]})]})]})]})}),C.jsxs("div",{className:"actual-services",children:[C.jsx("h2",{children:"Services to grow your brand"}),C.jsx("div",{className:"services-flex-container",children:t.map(e=>C.jsxs("div",{className:"service-item",children:[C.jsx("div",{className:"service-icon",children:C.jsx("img",{src:e.icon,alt:"customization",width:60,height:60})}),C.jsxs("div",{className:"service-info",children:[C.jsx("h5",{className:"service-title",children:e.title}),C.jsx("p",{className:"service-description",children:e.description})]}),C.jsxs("div",{className:"service-portfolio-link",children:["See ",e.title.toLowerCase()," demos",C.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-2 inline-block",viewBox:"0 0 20 20",fill:"currentColor",children:C.jsx("path",{fillRule:"evenodd",d:"M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]},e.id))}),C.jsx(Et,{to:"/contact",className:"mb-12 inline-block px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-300",children:"Let's talk"})]})]})}function OM(){return C.jsx(jr,{children:C.jsx(NM,{})})}function DM(){return C.jsxs("div",{className:"about-container",children:[C.jsx("h1",{className:"about-heading",children:"Who we are"}),C.jsx("p",{className:"first-paragraph",children:"PixelMap is a digital creative studio where data visualization meets design to create impactful solutions. By combining technical expertise and creativity, you can turn complex data into interactive, user-friendly experiences."}),C.jsxs("p",{className:"second-paragraph",children:["PixelMap is a freelancer practice created by"," ",C.jsx("span",{className:"founder",children:"Livingstone Asabahebwa"})," in 2025. He specializes in transforming geographic data into interactive, visually compelling maps and data-driven visualizations."]}),C.jsx("h1",{className:"about-heading",children:"Our mission"}),C.jsx("p",{className:"first-paragraph",children:"Our services help organizations, researchers, and businesses explore, understand, and communicate complex spatial data, leading to actionable insights and better decision-making."}),C.jsx("h1",{className:"about-heading",children:"What we offer"}),C.jsx("p",{className:"first-paragraph",children:"With expertise across the full spectrum of data visualization, PixelMap manages everything from data collection and processing to the creation of highly customized, interactive graphics. Whether it's creating dashbaords, geospatial analysis, or data-driven storytelling, we deliver solutions tailored to your specific needs."}),C.jsx("p",{className:"second-paragraph",children:"Using a cutting-edge tech stack — Mapbox, D3.js, Metabse, and JavaScript/TypeScript — we create custom mapping and interactive visualizations that work seamlessly on both desktop and mobile platforms. The projects focus on crafting intuitive user experiences and immersive visual environments, leveraging advanced geospatial tools to bring geographic data to life."}),C.jsx("h1",{className:"about-heading",children:"How we work"}),C.jsx("p",{className:"first-paragraph",children:"At PixelMap, every project begins with a deep understanding of your data, goals, and audience. We take a collaborative, iterative approach—working closely with clients to define the problem, clarify the story, and design solutions that are both visually compelling and functionally effective. From initial research and data wrangling to prototyping and final deployment, we prioritize clarity, usability, and performance. Using agile workflows and modern development tools, we ensure that each visualization is not only accurate and engaging but also tailored to fit seamlessly within your digital ecosystem."}),C.jsx("h1",{className:"about-heading",children:"Meet the founder"}),C.jsxs("p",{className:"founder",children:[" ","Livingstone Asabahebwa - Senior Frontend Engineer"]}),C.jsx("p",{className:"first-paragraph",children:"Livingstone Asabahebwa is a seasoned frontend engineer with 5+ years of experience building responsive web applications, specializing in web frontend development using React and JavaScript/TypeScript. Skilled in integrating data-vis and geospatial technologies into major frontend frameworks and libraries to create interactive visual stories."}),C.jsx(Et,{to:"/contact",className:"about-contact-button",children:"Let's talk"})]})}const FM=()=>C.jsx(jr,{children:C.jsx(DM,{})});/*!
 * Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2024 Fonticons, Inc.
 */const LM={prefix:"fas",iconName:"paper-plane",icon:[512,512,[61913],"f1d8","M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480l0-83.6c0-4 1.5-7.8 4.2-10.8L331.8 202.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8 17.7 316.6C7.1 311.3 .3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4z"]};function BM(){const[t,e]=P.useState({firstName:"",lastName:"",email:"",message:""}),[n,r]=P.useState({submitted:!1,success:!1,message:""}),[i,s]=P.useState(!1),o=u=>{const{name:f,value:h}=u.target;e(p=>({...p,[f]:h}))},a=async u=>{u.preventDefault(),s(!0);try{if((await(await fetch("https://formsubmit.co/ajax/lasabahebwa@gmail.com",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({name:`${t.firstName} ${t.lastName}`,email:t.email,message:t.message})})).json()).success)r({submitted:!0,success:!0,message:"Thank you! Your message has been sent successfully."}),e({firstName:"",lastName:"",email:"",message:""});else throw new Error("Something went wrong")}catch{r({submitted:!0,success:!1,message:"There was a problem sending your message. Please try again later."})}finally{s(!1)}};return C.jsx("div",{className:"py-16 px-4 sm:px-6 lg:px-8 min-h-screen flex justify-center items-center",children:C.jsxs("div",{className:"w-full max-w-3xl mx-auto",children:[C.jsxs("div",{className:"text-center mb-12",children:[C.jsx("h1",{className:"text-4xl text-[#293340] mb-4",children:"Contact Us"}),C.jsx("p",{className:"text-lg text-[#666]",children:"Have questions about our services or want to collaborate? Send us a message and we'll get back to you as soon as possible."})]}),C.jsx("div",{className:"rounded-lg overflow-hidden",style:{backgroundColor:"#f7f9fb"},children:C.jsxs("div",{className:"px-6 py-8 sm:p-10",children:[C.jsx("div",{className:"flex items-center justify-center mb-6",children:C.jsx("h2",{className:"text-2xl  text-[#293340]",children:"Send Us A Message"})}),n.submitted&&C.jsx("div",{className:`p-4 mb-6 rounded-md ${n.success?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:n.message}),C.jsxs("form",{onSubmit:a,className:"space-y-6",children:[C.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[C.jsxs("div",{children:[C.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-[#293340] mb-1",children:"First Name"}),C.jsx("input",{type:"text",id:"firstName",name:"firstName",value:t.firstName,onChange:o,required:!0,placeholder:"Enter your first name",className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),C.jsxs("div",{children:[C.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-[#293340] mb-1",children:"Last Name"}),C.jsx("input",{type:"text",id:"lastName",name:"lastName",value:t.lastName,onChange:o,required:!0,placeholder:"Enter your last name",className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]}),C.jsxs("div",{children:[C.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-[#293340] mb-1",children:"Email Address"}),C.jsx("input",{type:"email",id:"email",name:"email",value:t.email,onChange:o,required:!0,placeholder:"Enter your email address",className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),C.jsxs("div",{children:[C.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-[#293340] mb-1",children:"Message"}),C.jsx("textarea",{id:"message",name:"message",value:t.message,onChange:o,required:!0,placeholder:"Type your message here...",rows:5,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),C.jsx("div",{children:C.jsx("button",{type:"submit",disabled:i,className:"w-full flex justify-center items-center py-3 px-6 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:i?C.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[C.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),C.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):C.jsxs(C.Fragment,{children:[C.jsx("span",{children:"Send Message"}),C.jsx(qi,{icon:LM,className:"ml-2 h-4 w-4"})]})})})]})]})}),C.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:C.jsxs("p",{children:["You can also reach us directly at"," ",C.jsx("a",{href:"mailto:lasabahebwa@gmail.com",className:"text-blue-600 hover:underline",children:"lasabahebwa@gmail.com"})," ","or"," ",C.jsx("a",{href:"tel:+256785759096",className:"text-blue-600 hover:underline",children:"(+256) 785 759096"})]})})]})})}const UM=()=>C.jsx(jr,{children:C.jsx(BM,{})});var Gm=m2(),xp,z1;function jM(){return z1||(z1=1,xp=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var o=s[i];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}),xp}var zM=jM();const VM=kl(zM);function sr(){return sr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sr.apply(null,arguments)}function bo(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function $M(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function WM(t){var e=$M(t,"string");return typeof e=="symbol"?e:e+""}const Rr={NOT_LOADED:"NOT_LOADED",LOADING:"LOADING",LOADED:"LOADED",FAILED:"FAILED",AUTH_FAILURE:"AUTH_FAILURE"},HM="https://maps.googleapis.com/maps/api/js";class ml{static async load(e,n){var r;const i=e.libraries?e.libraries.split(","):[],s=this.serializeParams(e);this.listeners.push(n),(r=window.google)!=null&&(r=r.maps)!=null&&r.importLibrary?(this.serializedApiParams||(this.loadingStatus=Rr.LOADED),this.notifyLoadingStatusListeners()):(this.serializedApiParams=s,this.initImportLibrary(e)),this.serializedApiParams&&this.serializedApiParams!==s&&console.warn("[google-maps-api-loader] The maps API has already been loaded with different parameters and will not be loaded again. Refresh the page for new values to have effect.");const o=["maps",...i];await Promise.all(o.map(a=>google.maps.importLibrary(a)))}static serializeParams(e){return[e.v,e.key,e.language,e.region,e.authReferrerPolicy,e.solutionChannel].join("/")}static initImportLibrary(e){if(window.google||(window.google={}),window.google.maps||(window.google.maps={}),window.google.maps.importLibrary){console.error("[google-maps-api-loader-internal]: initImportLibrary must only be called once");return}let n=null;const r=()=>n||(n=new Promise((i,s)=>{var o;const a=document.createElement("script"),u=new URLSearchParams;for(const[f,h]of Object.entries(e)){const p=f.replace(/[A-Z]/g,g=>"_"+g[0].toLowerCase());u.set(p,String(h))}u.set("loading","async"),u.set("callback","__googleMapsCallback__"),a.async=!0,a.src=HM+"?"+u.toString(),a.nonce=((o=document.querySelector("script[nonce]"))==null?void 0:o.nonce)||"",a.onerror=()=>{this.loadingStatus=Rr.FAILED,this.notifyLoadingStatusListeners(),s(new Error("The Google Maps JavaScript API could not load."))},window.__googleMapsCallback__=()=>{this.loadingStatus=Rr.LOADED,this.notifyLoadingStatusListeners(),i()},window.gm_authFailure=()=>{this.loadingStatus=Rr.AUTH_FAILURE,this.notifyLoadingStatusListeners()},this.loadingStatus=Rr.LOADING,this.notifyLoadingStatusListeners(),document.head.append(a)}),n);google.maps.importLibrary=i=>r().then(()=>google.maps.importLibrary(i))}static notifyLoadingStatusListeners(){for(const e of this.listeners)e(this.loadingStatus)}}ml.loadingStatus=Rr.NOT_LOADED;ml.serializedApiParams=void 0;ml.listeners=[];const XM=["onLoad","onError","apiKey","version","libraries"],YM=["children"],qM="GMP_visgl_rgmlibrary_v1_default",Fl=ht.createContext(null);function KM(){const[t,e]=P.useState({});return{mapInstances:t,addMapInstance:(s,o="default")=>{e(a=>sr({},a,{[o]:s}))},removeMapInstance:(s="default")=>{e(o=>bo(o,[s].map(WM)))},clearMapInstances:()=>{e({})}}}function ZM(t){const{onLoad:e,onError:n,apiKey:r,version:i,libraries:s=[]}=t,o=bo(t,XM),[a,u]=P.useState(ml.loadingStatus),[f,h]=P.useReducer((v,w)=>v[w.name]?v:sr({},v,{[w.name]:w.value}),{}),p=P.useMemo(()=>s?.join(","),[s]),g=P.useMemo(()=>JSON.stringify(sr({apiKey:r,version:i},o)),[r,i,o]),_=P.useCallback(async v=>{var w;if(f[v])return f[v];if(!((w=google)!=null&&(w=w.maps)!=null&&w.importLibrary))throw new Error("[api-provider-internal] importLibrary was called before google.maps.importLibrary was defined.");const x=await window.google.maps.importLibrary(v);return h({name:v,value:x}),x},[f]);return P.useEffect(()=>{(async()=>{try{const v=sr({key:r},o);i&&(v.v=i),p?.length>0&&(v.libraries=p),(v.channel===void 0||v.channel<0||v.channel>999)&&delete v.channel,v.solutionChannel===void 0?v.solutionChannel=qM:v.solutionChannel===""&&delete v.solutionChannel,await ml.load(v,w=>u(w));for(const w of["core","maps",...s])await _(w);e&&e()}catch(v){n?n(v):console.error("<ApiProvider> failed to load the Google Maps JavaScript API",v)}})()},[r,p,g]),{status:a,loadedLibraries:f,importLibrary:_}}const _3=t=>{const{children:e}=t,n=bo(t,YM),{mapInstances:r,addMapInstance:i,removeMapInstance:s,clearMapInstances:o}=KM(),{status:a,loadedLibraries:u,importLibrary:f}=ZM(n),h=P.useMemo(()=>({mapInstances:r,addMapInstance:i,removeMapInstance:s,clearMapInstances:o,status:a,loadedLibraries:u,importLibrary:f}),[r,i,s,o,a,u,f]);return ht.createElement(Fl.Provider,{value:h},e)};function QM(t,e){for(const n of t4){const r=e[n],i=y3[n];P.useEffect(()=>{if(!t||!r)return;const s=google.maps.event.addListener(t,i,o=>{r(JM(i,t,o))});return()=>s.remove()},[t,i,r])}}function JM(t,e,n){const r={type:t,map:e,detail:{},stoppable:!1,stop:()=>{}};if(GM.includes(t)){const s=r,o=e.getCenter(),a=e.getZoom(),u=e.getHeading()||0,f=e.getTilt()||0,h=e.getBounds();return(!o||!h||!Number.isFinite(a))&&console.warn("[createEvent] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),s.detail={center:o?.toJSON()||{lat:0,lng:0},zoom:a||0,heading:u,tilt:f,bounds:h?.toJSON()||{north:90,east:180,south:-90,west:-180}},s}else if(e4.includes(t)){var i;if(!n)throw new Error("[createEvent] mouse events must provide a srcEvent");const s=r;return s.domEvent=n.domEvent,s.stoppable=!0,s.stop=()=>n.stop(),s.detail={latLng:((i=n.latLng)==null?void 0:i.toJSON())||null,placeId:n.placeId},s}return r}const y3={onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onContextmenu:"contextmenu",onDblclick:"dblclick",onDrag:"drag",onDragend:"dragend",onDragstart:"dragstart",onHeadingChanged:"heading_changed",onIdle:"idle",onIsFractionalZoomEnabledChanged:"isfractionalzoomenabled_changed",onMapCapabilitiesChanged:"mapcapabilities_changed",onMapTypeIdChanged:"maptypeid_changed",onMousemove:"mousemove",onMouseout:"mouseout",onMouseover:"mouseover",onProjectionChanged:"projection_changed",onRenderingTypeChanged:"renderingtype_changed",onTilesLoaded:"tilesloaded",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed",onCameraChanged:"bounds_changed"},GM=["bounds_changed","center_changed","heading_changed","tilt_changed","zoom_changed"],e4=["click","contextmenu","dblclick","mousemove","mouseout","mouseover"],t4=Object.keys(y3);function n4(t,e){const n=P.useRef(t);return e(t,n.current)||(n.current=t),n.current}function r4(t,e,n){P.useEffect(t,[n4(e,n)])}function i4(t,e){r4(t,e,VM)}const s4=new Set(["backgroundColor","clickableIcons","controlSize","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","fullscreenControl","fullscreenControlOptions","gestureHandling","headingInteractionEnabled","isFractionalZoomEnabled","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","restriction","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","streetView","streetViewControl","streetViewControlOptions","styles","tiltInteractionEnabled","zoomControl","zoomControlOptions"]);function o4(t,e){const n={},r=Object.keys(e);for(const i of r)s4.has(i)&&(n[i]=e[i]);i4(()=>{t&&t.setOptions(n)},[n])}function v3(){var t;return((t=P.useContext(Fl))==null?void 0:t.status)||Rr.NOT_LOADED}function a4(t,e){const{viewport:n,viewState:r}=e,i=!!n;return P.useLayoutEffect(()=>{if(!t||!r)return;const{latitude:s,longitude:o,bearing:a,pitch:u,zoom:f}=r;t.moveCamera({center:{lat:s,lng:o},heading:a,tilt:u,zoom:f+1})},[t,r]),i}function l4(t){return!t||typeof t!="object"||!("lat"in t&&"lng"in t)?!1:Number.isFinite(t.lat)&&Number.isFinite(t.lng)}function b3(t){return l4(t)?t:t.toJSON()}function c4(t,e,n){const r=n.center?b3(n.center):null;let i=null,s=null;r&&Number.isFinite(r.lat)&&Number.isFinite(r.lng)&&(i=r.lat,s=r.lng);const o=Number.isFinite(n.zoom)?n.zoom:null,a=Number.isFinite(n.heading)?n.heading:null,u=Number.isFinite(n.tilt)?n.tilt:null;P.useLayoutEffect(()=>{if(!t)return;const f={};let h=!1;i!==null&&s!==null&&(e.current.center.lat!==i||e.current.center.lng!==s)&&(f.center={lat:i,lng:s},h=!0),o!==null&&e.current.zoom!==o&&(f.zoom=o,h=!0),a!==null&&e.current.heading!==a&&(f.heading=a,h=!0),u!==null&&e.current.tilt!==u&&(f.tilt=u,h=!0),h&&t.moveCamera(f)})}const u4=()=>{const t={position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:999,display:"flex",flexFlow:"column nowrap",textAlign:"center",justifyContent:"center",fontSize:".8rem",color:"rgba(0,0,0,0.6)",background:"#dddddd",padding:"1rem 1.5rem"};return ht.createElement("div",{style:t},ht.createElement("h2",null,"Error: AuthFailure"),ht.createElement("p",null,"A problem with your API key prevents the map from rendering correctly. Please make sure the value of the ",ht.createElement("code",null,"APIProvider.apiKey")," prop is correct. Check the error-message in the console for further details."))};function f4(){const[t,e]=P.useState(null),n=P.useCallback(r=>e(r),[e]);return[t,n]}function w3(){return v3()===Rr.LOADED}function h4(){const[,t]=P.useReducer(e=>e+1,0);return t}function d4(t,e){const n=t.getCenter(),r=t.getZoom(),i=t.getHeading()||0,s=t.getTilt()||0,o=t.getBounds();(!n||!o||!Number.isFinite(r))&&console.warn("[useTrackedCameraState] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),Object.assign(e.current,{center:n?.toJSON()||{lat:0,lng:0},zoom:r||0,heading:i,tilt:s})}function p4(t){const e=h4(),n=P.useRef({center:{lat:0,lng:0},heading:0,tilt:0,zoom:0});return P.useEffect(()=>{if(!t)return;const r=google.maps.event.addListener(t,"bounds_changed",()=>{d4(t,n),e()});return()=>r.remove()},[t,e]),n}const g4=["id","defaultBounds","defaultCenter","defaultZoom","defaultHeading","defaultTilt","reuseMaps","renderingType","colorScheme"],m4=["padding"];class Nu{static has(e){return this.entries[e]&&this.entries[e].length>0}static pop(e){return this.entries[e]&&this.entries[e].pop()||null}static push(e,n){this.entries[e]||(this.entries[e]=[]),this.entries[e].push(n)}}Nu.entries={};function _4(t,e){const n=w3(),[r,i]=P.useState(null),[s,o]=f4(),a=p4(r),{id:u,defaultBounds:f,defaultCenter:h,defaultZoom:p,defaultHeading:g,defaultTilt:_,reuseMaps:v,renderingType:w,colorScheme:x}=t,T=bo(t,g4),A=t.zoom!==void 0||t.defaultZoom!==void 0,E=t.center!==void 0||t.defaultCenter!==void 0;!f&&(!A||!E)&&console.warn("<Map> component is missing configuration. You have to provide zoom and center (via the `zoom`/`defaultZoom` and `center`/`defaultCenter` props) or specify the region to show using `defaultBounds`. See https://visgl.github.io/react-google-maps/docs/api-reference/components/map#required"),!T.center&&h&&(T.center=h),!T.zoom&&Number.isFinite(p)&&(T.zoom=p),!T.heading&&Number.isFinite(g)&&(T.heading=g),!T.tilt&&Number.isFinite(_)&&(T.tilt=_);for(const k of Object.keys(T))T[k]===void 0&&delete T[k];const R=P.useRef(void 0);return P.useEffect(()=>{if(!s||!n)return;const{addMapInstance:k,removeMapInstance:M}=e,{mapId:L}=t,W=`${L||"default"}:${w||"default"}:${x||"LIGHT"}`;let H,X;if(v&&Nu.has(W)?(X=Nu.pop(W),H=X.getDiv(),s.appendChild(H),X.setOptions(T),setTimeout(()=>X.setCenter(X.getCenter()),0)):(H=document.createElement("div"),H.style.height="100%",s.appendChild(H),X=new google.maps.Map(H,sr({},T,w?{renderingType:w}:{},x?{colorScheme:x}:{}))),i(X),k(X,u),f){const{padding:B}=f,te=bo(f,m4);X.fitBounds(te,B)}else(!A||!E)&&X.fitBounds({east:180,west:-180,south:-90,north:90});if(R.current){const{mapId:B,cameraState:te}=R.current;B!==L&&X.setOptions(te)}return()=>{R.current={mapId:L,cameraState:a.current},H.remove(),v?Nu.push(W,X):google.maps.event.clearInstanceListeners(X),i(null),M(u)}},[s,n,u,t.mapId,t.renderingType,t.colorScheme]),[r,o,a]}const x3=ht.createContext(null),e_=t=>{const{children:e,id:n,className:r,style:i}=t,s=P.useContext(Fl),o=v3();if(!s)throw new Error("<Map> can only be used inside an <ApiProvider> component.");const[a,u,f]=_4(t,s);c4(a,f,t),QM(a,t),o4(a,t);const h=a4(a,t),p=!!t.controlled;P.useEffect(()=>{if(a)return h&&a.setOptions({disableDefaultUI:!0}),(h||p)&&a.setOptions({gestureHandling:"none",keyboardShortcuts:!1}),()=>{a.setOptions({gestureHandling:t.gestureHandling,keyboardShortcuts:t.keyboardShortcuts})}},[a,h,p,t.gestureHandling,t.keyboardShortcuts]);const g=t.center?b3(t.center):null;let _=null,v=null;g&&Number.isFinite(g.lat)&&Number.isFinite(g.lng)&&(_=g.lat,v=g.lng);const w=P.useMemo(()=>{var A,E,R,k,M;return{center:{lat:(A=_)!=null?A:0,lng:(E=v)!=null?E:0},zoom:(R=t.zoom)!=null?R:0,heading:(k=t.heading)!=null?k:0,tilt:(M=t.tilt)!=null?M:0}},[_,v,t.zoom,t.heading,t.tilt]);P.useLayoutEffect(()=>{if(!a||!p)return;a.moveCamera(w);const A=a.addListener("bounds_changed",()=>{a.moveCamera(w)});return()=>A.remove()},[a,p,w]);const x=P.useMemo(()=>sr({width:"100%",height:"100%",position:"relative",zIndex:h?-1:0},i),[i,h]),T=P.useMemo(()=>({map:a}),[a]);return o===Rr.AUTH_FAILURE?ht.createElement("div",{style:sr({position:"relative"},r?{}:x),className:r},ht.createElement(u4,null)):ht.createElement("div",sr({ref:u,"data-testid":"map",style:r?void 0:x,className:r},n?{id:n}:{}),a?ht.createElement(x3.Provider,{value:T},e):null)};e_.deckGLViewProps=!0;const V1=new Set;function y4(...t){const e=JSON.stringify(t);V1.has(e)||(V1.add(e),console.error(...t))}const Qf=(t=null)=>{const e=P.useContext(Fl),{map:n}=P.useContext(x3)||{};if(e===null)return y4("useMap(): failed to retrieve APIProviderContext. Make sure that the <APIProvider> component exists and that the component you are calling `useMap()` from is a sibling of the <APIProvider>."),null;const{mapInstances:r}=e;return t!==null?r[t]||null:n||r.default||null};function T3(t){const e=w3(),n=P.useContext(Fl);return P.useEffect(()=>{!e||!n||n.importLibrary(t)},[e,n,t]),n?.loadedLibraries[t]||null}function iu(t,e,n){P.useEffect(()=>{if(!t||!e||!n)return;const r=google.maps.event.addListener(t,e,n);return()=>r.remove()},[t,e,n])}function su(t,e,n){P.useEffect(()=>{t&&(t[e]=n)},[t,e,n])}function $1(t,e,n){P.useEffect(()=>{if(!(!t||!e||!n))return t.addEventListener(e,n),()=>t.removeEventListener(e,n)},[t,e,n])}function W1(t){return t.nodeType===Node.ELEMENT_NODE}const v4=ht.createContext(null),b4={BOTTOM:["50%","100%"]},w4=({children:t,styles:e,className:n,anchorPoint:r})=>{const[i,s]=r??b4.BOTTOM;let o=`-${i}`,a=`-${s}`;i.trimStart().startsWith("-")&&(o=i.substring(1)),s.trimStart().startsWith("-")&&(a=s.substring(1));const u=`translate(50%, 100%) translate(${o}, ${a})`;return ht.createElement("div",{style:{transform:u}},ht.createElement("div",{className:n,style:e},t))};function x4(t){const[e,n]=P.useState(null),[r,i]=P.useState(null),s=Qf(),o=T3("marker"),{children:a,onClick:u,className:f,onMouseEnter:h,onMouseLeave:p,onDrag:g,onDragStart:_,onDragEnd:v,collisionBehavior:w,clickable:x,draggable:T,position:A,title:E,zIndex:R}=t,k=P.Children.count(a);return P.useEffect(()=>{if(!s||!o)return;const M=new o.AdvancedMarkerElement;M.map=s,n(M);let L=null;return k>0&&(L=document.createElement("div"),L.isCustomMarker=!0,M.content=L,i(L)),()=>{var W;M.map=null,(W=L)==null||W.remove(),n(null),i(null)}},[s,o,k]),P.useEffect(()=>{!(e!=null&&e.content)||!W1(e.content)||k>0||(e.content.className=f??"")},[e,f,k]),su(e,"position",A),su(e,"title",E??""),su(e,"zIndex",R),su(e,"collisionBehavior",w),P.useEffect(()=>{e&&(T!==void 0?e.gmpDraggable=T:g||_||v?e.gmpDraggable=!0:e.gmpDraggable=!1)},[e,T,g,v,_]),P.useEffect(()=>{if(!e)return;const M=x!==void 0||!!u||!!h||!!p;e.gmpClickable=M,M&&e!=null&&e.content&&W1(e.content)&&(e.content.style.pointerEvents="none",e.content.firstElementChild&&(e.content.firstElementChild.style.pointerEvents="all"))},[e,x,u,h,p]),iu(e,"click",u),iu(e,"drag",g),iu(e,"dragstart",_),iu(e,"dragend",v),$1(e?.element,"mouseenter",h),$1(e?.element,"mouseleave",p),[e,r]}const S3=P.forwardRef((t,e)=>{const{children:n,style:r,className:i,anchorPoint:s}=t,[o,a]=x4(t),u=P.useMemo(()=>o?{marker:o}:null,[o]);return P.useImperativeHandle(e,()=>o,[o]),a?ht.createElement(v4.Provider,{value:u},Gm.createPortal(ht.createElement(w4,{anchorPoint:s,styles:r,className:i},n),a)):null});function E3(){const[t,e]=P.useState(null);return[P.useCallback(r=>{e(r)},[]),t]}const T4=["onClick","onDrag","onDragStart","onDragEnd","onMouseOver","onMouseOut"];function S4(t){const[e,n]=P.useState(null),r=Qf(),{onClick:i,onDrag:s,onDragStart:o,onDragEnd:a,onMouseOver:u,onMouseOut:f}=t,h=bo(t,T4),{position:p,draggable:g}=h;return P.useEffect(()=>{if(!r){r===void 0&&console.error("<Marker> has to be inside a Map component.");return}const _=new google.maps.Marker(h);return _.setMap(r),n(_),()=>{_.setMap(null),n(null)}},[r]),P.useEffect(()=>{if(!e)return;const _=e,v=google.maps.event;return i&&v.addListener(_,"click",i),s&&v.addListener(_,"drag",s),o&&v.addListener(_,"dragstart",o),a&&v.addListener(_,"dragend",a),u&&v.addListener(_,"mouseover",u),f&&v.addListener(_,"mouseout",f),e.setDraggable(!!g),()=>{v.clearInstanceListeners(_)}},[e,g,i,s,o,a,u,f]),P.useEffect(()=>{e&&h&&e.setOptions(h)},[e,h]),P.useEffect(()=>{g||!p||!e||e.setPosition(p)},[g,p,e]),e}P.forwardRef((t,e)=>{const n=S4(t);return P.useImperativeHandle(e,()=>n,[n]),ht.createElement(ht.Fragment,null)});const E4=()=>{const t=Qf();return P.useEffect(()=>{t&&t&&t.setZoom(3)},[t]),null},A4=({poi:t,getTempColor:e})=>{const[n]=E3();return C.jsx(C.Fragment,{children:C.jsx(S3,{position:{lat:t.location.lat,lng:t.location.lng},ref:n,children:C.jsxs("div",{className:"info-window",style:{position:"absolute",left:15,top:-16,background:"white"},children:[C.jsx("div",{className:"info-window-location",children:t.key}),C.jsxs("div",{className:"info-window-temp",children:[C.jsx("div",{className:"info-window-temp-value",children:Math.trunc(t.temp)}),C.jsx("div",{className:"info-window-temp-color",style:{backgroundColor:e(Math.trunc(t.temp))}})]})]})})})},C4=()=>{const[t,e]=P.useState(3),[n,r]=P.useState(!0),i=[{key:"San Francisco",temp:13,rainfall:25,location:{lat:37.775,lng:-122.418}},{key:"Nairobi",temp:22,rainfall:25,location:{lat:-1.283,lng:36.817}},{key:"Doha",temp:33,rainfall:25,location:{lat:25.287,lng:51.533}},{key:"Moscow",temp:6,rainfall:25,location:{lat:55.752,lng:37.616}},{key:"New York",temp:24,rainfall:2500,location:{lat:40.712776,lng:-74.005974}},{key:"San Paulo",temp:25,rainfall:250,location:{lat:-23.533,lng:-46.617}},{key:"Rome",temp:23,rainfall:25,location:{lat:41.9,lng:12.483}},{key:"Madrid",temp:19,rainfall:25,location:{lat:40.4,lng:-3.683}},{key:"Kyiv",temp:13,rainfall:25,location:{lat:50.433,lng:30.517}},{key:"Berlin",temp:15,rainfall:25,location:{lat:52.517,lng:13.4}},{key:"Cairo",temp:40,rainfall:25,location:{lat:30.05,lng:31.25}},{key:"Lagos",temp:30,rainfall:25,location:{lat:6.453,lng:3.396}},{key:"Rabat",temp:20,rainfall:25,location:{lat:34.025,lng:-6.836}},{key:"Beijing",temp:30,rainfall:25,location:{lat:39.929,lng:116.388}},{key:"New Delhi",temp:40,rainfall:25,location:{lat:28.6,lng:77.2}},{key:"Seoul",temp:21,rainfall:25,location:{lat:37.566,lng:127}},{key:"Cape Town",temp:16,rainfall:25,location:{lat:-33.917,lng:18.417}},{key:"Miami",temp:27,rainfall:25,location:{lat:25.774,lng:-80.194}},{key:"Vancouver",temp:14,rainfall:25,location:{lat:49.25,lng:-123.133}},{key:"Anchorage",temp:8,rainfall:25,location:{lat:61.218,lng:-149.9}},{key:"Yellowknife",temp:0,rainfall:25,location:{lat:62.45,lng:-114.35}},{key:"Nuuk",temp:-5,rainfall:25,location:{lat:64.183,lng:-51.75}},{key:"Qaarsut",temp:-10,rainfall:25,location:{lat:70.733,lng:-52.65}},{key:"Bogota",temp:17,rainfall:25,location:{lat:4.6,lng:-74.083}},{key:"Sydney",temp:20,rainfall:25,location:{lat:-33.883,lng:151.217}},{key:"Darwin",temp:30,rainfall:25,location:{lat:-12.467,lng:130.833}},{key:"Auckland",temp:18,rainfall:25,location:{lat:-36.867,lng:174.767}},{key:"Manila",temp:33,rainfall:25,location:{lat:14.604,lng:120.982}},{key:"Murmansk",temp:6,rainfall:25,location:{lat:68.967,lng:33.083}}],s=f=>{let h;switch(f){case"Berlin":case"Kyiv":case"Madrid":case"Seoul":h=4;break;case"Rome":case"Cairo":case"Manila":case"Miami":case"Vancouver":case"Yellowknife":case"Nuuk":case"Sydney":case"New Delhi":case"Nairobi":case"San Francisco":h=3;break;default:h=2}return h};let o=i.map(f=>{const h=f.key;return{...f,visible:t>=s(h)}});const a=f=>{e(f.detail.zoom)},u=f=>{switch(!0){case f<-30:return"#241967";case f<-28:return"#272579";case f<-26:return"#20348D";case f<-24:return"#214295";case f<-22:return"#3054A2";case f<-20:return"#3E65AF";case f<-18:return"#4976BA";case f<-16:return"#5784C2";case f<-14:return"#688FCA";case f<-12:return"#759FD3";case f<-10:return"#89ADDC";case f<-8:return"#9AB9E3";case f<-6:return"#9BC3DA";case f<-4:return"#9ACDCF";case f<-2:return"#9CD2C1";case f<0:return"#9ED0AA";case f<2:return"#D7DE7E";case f<4:return"#EADA6F";case f<6:return"#F4D862";case f<8:return"#FCCC4E";case f<10:return"#F7B42D";case f<12:return"#F29C00";case f<14:return"#F29400";case f<16:return"#F3840D";case f<18:return"#EE730E";case f<20:return"#ED6517";case f<22:return"#EB561E";case f<24:return"#E84B1A";case f<26:return"#E04016";case f<28:return"#D83412";case f<30:return"#D2270F";case f<32:return"#C30507";case f<34:return"#B6070D";case f<36:return"#A90914";case f<38:return"#89061A";case f<40:return"#6F0317";case f>=40:return"#4D0014";default:return"black"}};return P.useEffect(()=>{r(!0),setTimeout(()=>{r(!1)},1e3)},[]),n?C.jsx("div",{className:"location-maps-loading",children:C.jsx("div",{className:"flex flex-col items-center",children:C.jsxs("svg",{className:"animate-spin h-10 w-10 mb-4 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[C.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),C.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})}):C.jsx("div",{className:"maps-container",children:C.jsx(_3,{apiKey:"AIzaSyCZiZ8D_BD0q5D6mFn2nWqbyLH4ub5xAjQ",libraries:["visualization"],children:C.jsxs(e_,{mapId:"DEMO_MAP_ID",disableDefaultUI:!1,mapTypeControl:!1,streetViewControl:!1,rotateControl:!1,keyboardShortcuts:!1,cameraControl:!1,onZoomChanged:a,mapTypeId:"satellite",defaultZoom:3,defaultCenter:{lat:20,lng:0},minZoom:2,maxZoom:20,children:[C.jsx(E4,{}),i&&C.jsx(I4,{locations:o,getTempColor:u})]})})})},R4=({poi:t,getTempColor:e,visible:n})=>{const[r,i]=E3();return n?C.jsxs(C.Fragment,{children:[C.jsx(S3,{position:{lat:t.location.lat,lng:t.location.lng},ref:r,children:C.jsx("div",{style:{width:10,height:10,position:"absolute",top:0,left:0,background:"#ffffff",transform:"translate(-50%, -50%)"}})}),i&&C.jsx(A4,{poi:t,getTempColor:e})]}):null},I4=({locations:t,getTempColor:e})=>C.jsx(C.Fragment,{children:t.map((n,r)=>C.jsx(R4,{poi:n,getTempColor:e,visible:n.visible},r))});function k4(){return C.jsx(jr,{children:C.jsx(C4,{})})}async function P4(){const t=new URL("/assets/earthquakes-BtU0I1Kh.json",import.meta.url);return await fetch(t).then(e=>e.json())}const M4=[{elementType:"geometry",stylers:[{color:"#0F1114"}]},{featureType:"all",elementType:"labels",stylers:[{visibility:"simplified"},{lightness:-80}]},{featureType:"administrative.country",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"administrative.locality",stylers:[{visibility:"off"}]},{featureType:"administrative.province",stylers:[{visibility:"off"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{elementType:"labels.text.stroke",stylers:[{color:"#212121"}]},{featureType:"administrative",elementType:"geometry",stylers:[{color:"#757575"}]},{featureType:"administrative.country",elementType:"labels.text.fill",stylers:[{color:"#9e9e9e"}]},{featureType:"administrative.land_parcel",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#bdbdbd"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#181818"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"poi.park",elementType:"labels.text.stroke",stylers:[{color:"#1b1b1b"}]},{featureType:"road",elementType:"geometry.fill",stylers:[{color:"#2c2c2c"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#8a8a8a"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#373737"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#3c3c3c"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#4e4e4e"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#616161"}]},{featureType:"transit",elementType:"labels.text.fill",stylers:[{color:"#757575"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#000000"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#3d3d3d"}]}],N4={styles:M4},O4=()=>{const[t,e]=P.useState(!0),n=25,r=.8,[i,s]=P.useState();return P.useEffect(()=>{P4().then(o=>s(o))},[]),P.useEffect(()=>{e(!0),setTimeout(()=>{e(!1)},1e3)},[]),t?C.jsx("div",{className:"heatmap-loading",children:C.jsx("div",{className:"flex flex-col items-center",children:C.jsxs("svg",{className:"animate-spin h-10 w-10 mb-4 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[C.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),C.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})}):C.jsx("div",{className:"maps-container",children:C.jsxs(_3,{apiKey:"AIzaSyCZiZ8D_BD0q5D6mFn2nWqbyLH4ub5xAjQ",children:[C.jsx(e_,{defaultCenter:{lat:40.7749,lng:-130.4194},defaultZoom:3,disableDefaultUI:!1,mapTypeControl:!1,streetViewControl:!1,rotateControl:!1,keyboardShortcuts:!1,cameraControl:!1,styles:N4.styles,minZoom:2,maxZoom:20}),i&&C.jsx(D4,{geojson:i,radius:n,opacity:r})]})})},D4=({geojson:t,radius:e,opacity:n})=>{const r=Qf(),i=T3("visualization"),s=P.useMemo(()=>i?new window.google.maps.visualization.HeatmapLayer({radius:e,opacity:n}):null,[i,e,n]);return P.useEffect(()=>{s&&s.setData(t.features.map(o=>{const[a,u]=o.geometry.coordinates;return{location:new window.google.maps.LatLng(u,a),weight:o.properties?.mag}}))},[s,t,e,n]),P.useEffect(()=>{if(s)return s.setMap(r),()=>{s.setMap(null)}},[s,r]),null};function F4(){return C.jsx(jr,{children:C.jsx(O4,{})})}function L4(){return C.jsxs("div",{className:"not-found-container",children:[C.jsx("h1",{children:"Error 404"}),C.jsx("h2",{children:"Woops. Looks like this page does not exist"}),C.jsx("p",{children:"The page you are looking for might have been removed, had its name changed, or is temporarily unavailable."}),C.jsx(Et,{to:"/",className:"home-button",children:"Go to Homepage"})]})}function po(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function B4(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function A3(t){let e,n,r;t.length!==2?(e=po,n=(a,u)=>po(t(a),u),r=(a,u)=>t(a)-u):(e=t===po||t===B4?t:U4,n=t,r=t);function i(a,u,f=0,h=a.length){if(f<h){if(e(u,u)!==0)return h;do{const p=f+h>>>1;n(a[p],u)<0?f=p+1:h=p}while(f<h)}return f}function s(a,u,f=0,h=a.length){if(f<h){if(e(u,u)!==0)return h;do{const p=f+h>>>1;n(a[p],u)<=0?f=p+1:h=p}while(f<h)}return f}function o(a,u,f=0,h=a.length){const p=i(a,u,f,h-1);return p>f&&r(a[p-1],u)>-r(a[p],u)?p-1:p}return{left:i,center:o,right:s}}function U4(){return 0}function j4(t){return t===null?NaN:+t}function*z4(t,e){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const V4=A3(po),$4=V4.right;A3(j4).center;function C3(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}class ss{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],o=e+s,a=Math.abs(e)<Math.abs(s)?e-(o-s):s-(o-e);a&&(n[r++]=a),e=o}return n[r]=e,this._n=r+1,this}valueOf(){const e=this._partials;let n=this._n,r,i,s,o=0;if(n>0){for(o=e[--n];n>0&&(r=o,i=e[--n],o=r+i,s=i-(o-r),!s););n>0&&(s<0&&e[n-1]<0||s>0&&e[n-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}}class Mg extends Map{constructor(e,n=X4){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(H1(this,e))}has(e){return super.has(H1(this,e))}set(e,n){return super.set(W4(this,e),n)}delete(e){return super.delete(H4(this,e))}}function H1({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function W4({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function H4({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function X4(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Y4(t){return t}function q4(t,e,...n){return K4(t,Y4,e,n)}function K4(t,e,n,r){return function i(s,o){if(o>=r.length)return n(s);const a=new Mg,u=r[o++];let f=-1;for(const h of s){const p=u(h,++f,s),g=a.get(p);g?g.push(h):a.set(p,[h])}for(const[h,p]of a)a.set(h,i(p,o));return e(a)}(t,0)}function Z4(t=po){if(t===po)return R3;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function R3(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const Q4=Math.sqrt(50),J4=Math.sqrt(10),G4=Math.sqrt(2);function Zu(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=Q4?10:s>=J4?5:s>=G4?2:1;let a,u,f;return i<0?(f=Math.pow(10,-i)/o,a=Math.round(t*f),u=Math.round(e*f),a/f<t&&++a,u/f>e&&--u,f=-f):(f=Math.pow(10,i)*o,a=Math.round(t/f),u=Math.round(e/f),a*f<t&&++a,u*f>e&&--u),u<a&&.5<=n&&n<2?Zu(t,e,n*2):[a,u,f]}function eN(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,o]=r?Zu(e,t,n):Zu(t,e,n);if(!(s>=i))return[];const a=s-i+1,u=new Array(a);if(r)if(o<0)for(let f=0;f<a;++f)u[f]=(s-f)/-o;else for(let f=0;f<a;++f)u[f]=(s-f)*o;else if(o<0)for(let f=0;f<a;++f)u[f]=(i+f)/-o;else for(let f=0;f<a;++f)u[f]=(i+f)*o;return u}function Ng(t,e,n){return e=+e,t=+t,n=+n,Zu(t,e,n)[2]}function tN(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?Ng(e,t,n):Ng(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function X1(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function Y1(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function I3(t,e,n=0,r=1/0,i){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=i===void 0?R3:Z4(i);r>n;){if(r-n>600){const u=r-n+1,f=e-n+1,h=Math.log(u),p=.5*Math.exp(2*h/3),g=.5*Math.sqrt(h*p*(u-p)/u)*(f-u/2<0?-1:1),_=Math.max(n,Math.floor(e-f*p/u+g)),v=Math.min(r,Math.floor(e+(u-f)*p/u+g));I3(t,e,_,v,i)}const s=t[e];let o=n,a=r;for(Na(t,n,e),i(t[r],s)>0&&Na(t,n,r);o<a;){for(Na(t,o,a),++o,--a;i(t[o],s)<0;)++o;for(;i(t[a],s)>0;)--a}i(t[n],s)===0?Na(t,n,a):(++a,Na(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}return t}function Na(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function nN(t,e,n){if(t=Float64Array.from(z4(t)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return Y1(t);if(e>=1)return X1(t);var r,i=(r-1)*e,s=Math.floor(i),o=X1(I3(t,s).subarray(0,s+1)),a=Y1(t.subarray(s+1));return o+(a-o)*(i-s)}}function q1(t,e){let n=0,r=0;if(e===void 0)for(let i of t)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function*rN(t){for(const e of t)yield*e}function k3(t){return Array.from(rN(t))}function Og(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}function iN(t,e){let n=0;if(e===void 0)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function sN(t){return t}var oN=3,K1=1e-6;function aN(t){return"translate("+t+",0)"}function lN(t){return e=>+t(e)}function cN(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function uN(){return!this.__axis}function fN(t,e){var n=[],r=null,i=null,s=6,o=6,a=3,u=typeof window<"u"&&window.devicePixelRatio>1?0:.5,f=1,h="y",p=aN;function g(_){var v=r??(e.ticks?e.ticks.apply(e,n):e.domain()),w=i??(e.tickFormat?e.tickFormat.apply(e,n):sN),x=Math.max(s,0)+a,T=e.range(),A=+T[0]+u,E=+T[T.length-1]+u,R=(e.bandwidth?cN:lN)(e.copy(),u),k=_.selection?_.selection():_,M=k.selectAll(".domain").data([null]),L=k.selectAll(".tick").data(v,e).order(),W=L.exit(),H=L.enter().append("g").attr("class","tick"),X=L.select("line"),B=L.select("text");M=M.merge(M.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),L=L.merge(H),X=X.merge(H.append("line").attr("stroke","currentColor").attr(h+"2",f*s)),B=B.merge(H.append("text").attr("fill","currentColor").attr(h,f*x).attr("dy","0.71em")),_!==k&&(M=M.transition(_),L=L.transition(_),X=X.transition(_),B=B.transition(_),W=W.transition(_).attr("opacity",K1).attr("transform",function(te){return isFinite(te=R(te))?p(te+u):this.getAttribute("transform")}),H.attr("opacity",K1).attr("transform",function(te){var ie=this.parentNode.__axis;return p((ie&&isFinite(ie=ie(te))?ie:R(te))+u)})),W.remove(),M.attr("d",o?"M"+A+","+f*o+"V"+u+"H"+E+"V"+f*o:"M"+A+","+u+"H"+E),L.attr("opacity",1).attr("transform",function(te){return p(R(te)+u)}),X.attr(h+"2",f*s),B.attr(h,f*x).text(w),k.filter(uN).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),k.each(function(){this.__axis=R})}return g.scale=function(_){return arguments.length?(e=_,g):e},g.ticks=function(){return n=Array.from(arguments),g},g.tickArguments=function(_){return arguments.length?(n=_==null?[]:Array.from(_),g):n.slice()},g.tickValues=function(_){return arguments.length?(r=_==null?null:Array.from(_),g):r&&r.slice()},g.tickFormat=function(_){return arguments.length?(i=_,g):i},g.tickSize=function(_){return arguments.length?(s=o=+_,g):s},g.tickSizeInner=function(_){return arguments.length?(s=+_,g):s},g.tickSizeOuter=function(_){return arguments.length?(o=+_,g):o},g.tickPadding=function(_){return arguments.length?(a=+_,g):a},g.offset=function(_){return arguments.length?(u=+_,g):u},g}function hN(t){return fN(oN,t)}var dN={value:()=>{}};function P3(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ou(n)}function Ou(t){this._=t}function pN(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ou.prototype=P3.prototype={constructor:Ou,on:function(t,e){var n=this._,r=pN(t+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(t=r[s]).type)&&(i=gN(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=Z1(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Z1(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ou(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function gN(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Z1(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=dN,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Dg="http://www.w3.org/1999/xhtml";const Q1={svg:"http://www.w3.org/2000/svg",xhtml:Dg,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Jf(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Q1.hasOwnProperty(e)?{space:Q1[e],local:t}:t}function mN(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Dg&&e.documentElement.namespaceURI===Dg?e.createElement(t):e.createElementNS(n,t)}}function _N(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function t_(t){var e=Jf(t);return(e.local?_N:mN)(e)}function yN(){}function n_(t){return t==null?yN:function(){return this.querySelector(t)}}function vN(t){typeof t!="function"&&(t=n_(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=new Array(o),u,f,h=0;h<o;++h)(u=s[h])&&(f=t.call(u,u.__data__,h,s))&&("__data__"in u&&(f.__data__=u.__data__),a[h]=f);return new on(r,this._parents)}function bN(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function wN(){return[]}function M3(t){return t==null?wN:function(){return this.querySelectorAll(t)}}function xN(t){return function(){return bN(t.apply(this,arguments))}}function TN(t){typeof t=="function"?t=xN(t):t=M3(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var o=e[s],a=o.length,u,f=0;f<a;++f)(u=o[f])&&(r.push(t.call(u,u.__data__,f,o)),i.push(u));return new on(r,i)}function N3(t){return function(){return this.matches(t)}}function O3(t){return function(e){return e.matches(t)}}var SN=Array.prototype.find;function EN(t){return function(){return SN.call(this.children,t)}}function AN(){return this.firstElementChild}function CN(t){return this.select(t==null?AN:EN(typeof t=="function"?t:O3(t)))}var RN=Array.prototype.filter;function IN(){return Array.from(this.children)}function kN(t){return function(){return RN.call(this.children,t)}}function PN(t){return this.selectAll(t==null?IN:kN(typeof t=="function"?t:O3(t)))}function MN(t){typeof t!="function"&&(t=N3(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],u,f=0;f<o;++f)(u=s[f])&&t.call(u,u.__data__,f,s)&&a.push(u);return new on(r,this._parents)}function D3(t){return new Array(t.length)}function NN(){return new on(this._enter||this._groups.map(D3),this._parents)}function Qu(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Qu.prototype={constructor:Qu,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function ON(t){return function(){return t}}function DN(t,e,n,r,i,s){for(var o=0,a,u=e.length,f=s.length;o<f;++o)(a=e[o])?(a.__data__=s[o],r[o]=a):n[o]=new Qu(t,s[o]);for(;o<u;++o)(a=e[o])&&(i[o]=a)}function FN(t,e,n,r,i,s,o){var a,u,f=new Map,h=e.length,p=s.length,g=new Array(h),_;for(a=0;a<h;++a)(u=e[a])&&(g[a]=_=o.call(u,u.__data__,a,e)+"",f.has(_)?i[a]=u:f.set(_,u));for(a=0;a<p;++a)_=o.call(t,s[a],a,s)+"",(u=f.get(_))?(r[a]=u,u.__data__=s[a],f.delete(_)):n[a]=new Qu(t,s[a]);for(a=0;a<h;++a)(u=e[a])&&f.get(g[a])===u&&(i[a]=u)}function LN(t){return t.__data__}function BN(t,e){if(!arguments.length)return Array.from(this,LN);var n=e?FN:DN,r=this._parents,i=this._groups;typeof t!="function"&&(t=ON(t));for(var s=i.length,o=new Array(s),a=new Array(s),u=new Array(s),f=0;f<s;++f){var h=r[f],p=i[f],g=p.length,_=UN(t.call(h,h&&h.__data__,f,r)),v=_.length,w=a[f]=new Array(v),x=o[f]=new Array(v),T=u[f]=new Array(g);n(h,p,w,x,T,_,e);for(var A=0,E=0,R,k;A<v;++A)if(R=w[A]){for(A>=E&&(E=A+1);!(k=x[E])&&++E<v;);R._next=k||null}}return o=new on(o,r),o._enter=a,o._exit=u,o}function UN(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function jN(){return new on(this._exit||this._groups.map(D3),this._parents)}function zN(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function VN(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),u=0;u<o;++u)for(var f=n[u],h=r[u],p=f.length,g=a[u]=new Array(p),_,v=0;v<p;++v)(_=f[v]||h[v])&&(g[v]=_);for(;u<i;++u)a[u]=n[u];return new on(a,this._parents)}function $N(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function WN(t){t||(t=HN);function e(p,g){return p&&g?t(p.__data__,g.__data__):!p-!g}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,u=i[s]=new Array(a),f,h=0;h<a;++h)(f=o[h])&&(u[h]=f);u.sort(e)}return new on(i,this._parents).order()}function HN(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function XN(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function YN(){return Array.from(this)}function qN(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function KN(){let t=0;for(const e of this)++t;return t}function ZN(){return!this.node()}function QN(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&t.call(a,a.__data__,s,i);return this}function JN(t){return function(){this.removeAttribute(t)}}function GN(t){return function(){this.removeAttributeNS(t.space,t.local)}}function eO(t,e){return function(){this.setAttribute(t,e)}}function tO(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function nO(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function rO(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function iO(t,e){var n=Jf(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?GN:JN:typeof e=="function"?n.local?rO:nO:n.local?tO:eO)(n,e))}function F3(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function sO(t){return function(){this.style.removeProperty(t)}}function oO(t,e,n){return function(){this.style.setProperty(t,e,n)}}function aO(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function lO(t,e,n){return arguments.length>1?this.each((e==null?sO:typeof e=="function"?aO:oO)(t,e,n??"")):wo(this.node(),t)}function wo(t,e){return t.style.getPropertyValue(e)||F3(t).getComputedStyle(t,null).getPropertyValue(e)}function cO(t){return function(){delete this[t]}}function uO(t,e){return function(){this[t]=e}}function fO(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function hO(t,e){return arguments.length>1?this.each((e==null?cO:typeof e=="function"?fO:uO)(t,e)):this.node()[t]}function L3(t){return t.trim().split(/^|\s+/)}function r_(t){return t.classList||new B3(t)}function B3(t){this._node=t,this._names=L3(t.getAttribute("class")||"")}B3.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function U3(t,e){for(var n=r_(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function j3(t,e){for(var n=r_(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function dO(t){return function(){U3(this,t)}}function pO(t){return function(){j3(this,t)}}function gO(t,e){return function(){(e.apply(this,arguments)?U3:j3)(this,t)}}function mO(t,e){var n=L3(t+"");if(arguments.length<2){for(var r=r_(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?gO:e?dO:pO)(n,e))}function _O(){this.textContent=""}function yO(t){return function(){this.textContent=t}}function vO(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function bO(t){return arguments.length?this.each(t==null?_O:(typeof t=="function"?vO:yO)(t)):this.node().textContent}function wO(){this.innerHTML=""}function xO(t){return function(){this.innerHTML=t}}function TO(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function SO(t){return arguments.length?this.each(t==null?wO:(typeof t=="function"?TO:xO)(t)):this.node().innerHTML}function EO(){this.nextSibling&&this.parentNode.appendChild(this)}function AO(){return this.each(EO)}function CO(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function RO(){return this.each(CO)}function IO(t){var e=typeof t=="function"?t:t_(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function kO(){return null}function PO(t,e){var n=typeof t=="function"?t:t_(t),r=e==null?kO:typeof e=="function"?e:n_(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function MO(){var t=this.parentNode;t&&t.removeChild(this)}function NO(){return this.each(MO)}function OO(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function DO(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function FO(t){return this.select(t?DO:OO)}function LO(t){return arguments.length?this.property("__data__",t):this.node().__data__}function BO(t){return function(e){t.call(this,e,this.__data__)}}function UO(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function jO(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function zO(t,e,n){return function(){var r=this.__on,i,s=BO(e);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function VO(t,e,n){var r=UO(t+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,f=a.length,h;u<f;++u)for(i=0,h=a[u];i<s;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value}return}for(a=e?zO:jO,i=0;i<s;++i)this.each(a(r[i],e,n));return this}function z3(t,e,n){var r=F3(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function $O(t,e){return function(){return z3(this,t,e)}}function WO(t,e){return function(){return z3(this,t,e.apply(this,arguments))}}function HO(t,e){return this.each((typeof e=="function"?WO:$O)(t,e))}function*XO(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var V3=[null];function on(t,e){this._groups=t,this._parents=e}function Ll(){return new on([[document.documentElement]],V3)}function YO(){return this}on.prototype=Ll.prototype={constructor:on,select:vN,selectAll:TN,selectChild:CN,selectChildren:PN,filter:MN,data:BN,enter:NN,exit:jN,join:zN,merge:VN,selection:YO,order:$N,sort:WN,call:XN,nodes:YN,node:qN,size:KN,empty:ZN,each:QN,attr:iO,style:lO,property:hO,classed:mO,text:bO,html:SO,raise:AO,lower:RO,append:IO,insert:PO,remove:NO,clone:FO,datum:LO,on:VO,dispatch:HO,[Symbol.iterator]:XO};function go(t){return typeof t=="string"?new on([[document.querySelector(t)]],[document.documentElement]):new on([[t]],V3)}function qO(t){return go(t_(t).call(document.documentElement))}function i_(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function $3(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Bl(){}var _l=.7,Ju=1/_l,mo="\\s*([+-]?\\d+)\\s*",yl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",or="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",KO=/^#([0-9a-f]{3,8})$/,ZO=new RegExp(`^rgb\\(${mo},${mo},${mo}\\)$`),QO=new RegExp(`^rgb\\(${or},${or},${or}\\)$`),JO=new RegExp(`^rgba\\(${mo},${mo},${mo},${yl}\\)$`),GO=new RegExp(`^rgba\\(${or},${or},${or},${yl}\\)$`),e6=new RegExp(`^hsl\\(${yl},${or},${or}\\)$`),t6=new RegExp(`^hsla\\(${yl},${or},${or},${yl}\\)$`),J1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};i_(Bl,os,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:G1,formatHex:G1,formatHex8:n6,formatHsl:r6,formatRgb:eb,toString:eb});function G1(){return this.rgb().formatHex()}function n6(){return this.rgb().formatHex8()}function r6(){return W3(this).formatHsl()}function eb(){return this.rgb().formatRgb()}function os(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=KO.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?tb(e):n===3?new qt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ou(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ou(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=ZO.exec(t))?new qt(e[1],e[2],e[3],1):(e=QO.exec(t))?new qt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=JO.exec(t))?ou(e[1],e[2],e[3],e[4]):(e=GO.exec(t))?ou(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=e6.exec(t))?ib(e[1],e[2]/100,e[3]/100,1):(e=t6.exec(t))?ib(e[1],e[2]/100,e[3]/100,e[4]):J1.hasOwnProperty(t)?tb(J1[t]):t==="transparent"?new qt(NaN,NaN,NaN,0):null}function tb(t){return new qt(t>>16&255,t>>8&255,t&255,1)}function ou(t,e,n,r){return r<=0&&(t=e=n=NaN),new qt(t,e,n,r)}function i6(t){return t instanceof Bl||(t=os(t)),t?(t=t.rgb(),new qt(t.r,t.g,t.b,t.opacity)):new qt}function Gu(t,e,n,r){return arguments.length===1?i6(t):new qt(t,e,n,r??1)}function qt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}i_(qt,Gu,$3(Bl,{brighter(t){return t=t==null?Ju:Math.pow(Ju,t),new qt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?_l:Math.pow(_l,t),new qt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new qt(Ji(this.r),Ji(this.g),Ji(this.b),ef(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:nb,formatHex:nb,formatHex8:s6,formatRgb:rb,toString:rb}));function nb(){return`#${Ki(this.r)}${Ki(this.g)}${Ki(this.b)}`}function s6(){return`#${Ki(this.r)}${Ki(this.g)}${Ki(this.b)}${Ki((isNaN(this.opacity)?1:this.opacity)*255)}`}function rb(){const t=ef(this.opacity);return`${t===1?"rgb(":"rgba("}${Ji(this.r)}, ${Ji(this.g)}, ${Ji(this.b)}${t===1?")":`, ${t})`}`}function ef(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ji(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ki(t){return t=Ji(t),(t<16?"0":"")+t.toString(16)}function ib(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ln(t,e,n,r)}function W3(t){if(t instanceof Ln)return new Ln(t.h,t.s,t.l,t.opacity);if(t instanceof Bl||(t=os(t)),!t)return new Ln;if(t instanceof Ln)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,u=(s+i)/2;return a?(e===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-e)/a+2:o=(e-n)/a+4,a/=u<.5?s+i:2-s-i,o*=60):a=u>0&&u<1?0:o,new Ln(o,a,u,t.opacity)}function o6(t,e,n,r){return arguments.length===1?W3(t):new Ln(t,e,n,r??1)}function Ln(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}i_(Ln,o6,$3(Bl,{brighter(t){return t=t==null?Ju:Math.pow(Ju,t),new Ln(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?_l:Math.pow(_l,t),new Ln(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new qt(Tp(t>=240?t-240:t+120,i,r),Tp(t,i,r),Tp(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Ln(sb(this.h),au(this.s),au(this.l),ef(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ef(this.opacity);return`${t===1?"hsl(":"hsla("}${sb(this.h)}, ${au(this.s)*100}%, ${au(this.l)*100}%${t===1?")":`, ${t})`}`}}));function sb(t){return t=(t||0)%360,t<0?t+360:t}function au(t){return Math.max(0,Math.min(1,t||0))}function Tp(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function a6(t,e,n,r,i){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*n+(1+3*t+3*s-3*o)*r+o*i)/6}function l6(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],s=t[r+1],o=r>0?t[r-1]:2*i-s,a=r<e-1?t[r+2]:2*s-i;return a6((n-r/e)*e,o,i,s,a)}}const s_=t=>()=>t;function c6(t,e){return function(n){return t+n*e}}function u6(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function f6(t){return(t=+t)==1?H3:function(e,n){return n-e?u6(e,n,t):s_(isNaN(e)?n:e)}}function H3(t,e){var n=e-t;return n?c6(t,n):s_(isNaN(t)?e:t)}const tf=function t(e){var n=f6(e);function r(i,s){var o=n((i=Gu(i)).r,(s=Gu(s)).r),a=n(i.g,s.g),u=n(i.b,s.b),f=H3(i.opacity,s.opacity);return function(h){return i.r=o(h),i.g=a(h),i.b=u(h),i.opacity=f(h),i+""}}return r.gamma=t,r}(1);function h6(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Gu(e[o]),r[o]=a.r||0,i[o]=a.g||0,s[o]=a.b||0;return r=t(r),i=t(i),s=t(s),a.opacity=1,function(u){return a.r=r(u),a.g=i(u),a.b=s(u),a+""}}}var d6=h6(l6);function p6(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function g6(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function m6(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=xo(t[o],e[o]);for(;o<n;++o)s[o]=e[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function _6(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function Fn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function y6(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=xo(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var Fg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Sp=new RegExp(Fg.source,"g");function v6(t){return function(){return t}}function b6(t){return function(e){return t(e)+""}}function X3(t,e){var n=Fg.lastIndex=Sp.lastIndex=0,r,i,s,o=-1,a=[],u=[];for(t=t+"",e=e+"";(r=Fg.exec(t))&&(i=Sp.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,u.push({i:o,x:Fn(r,i)})),n=Sp.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?u[0]?b6(u[0].x):v6(e):(e=u.length,function(f){for(var h=0,p;h<e;++h)a[(p=u[h]).i]=p.x(f);return a.join("")})}function xo(t,e){var n=typeof e,r;return e==null||n==="boolean"?s_(e):(n==="number"?Fn:n==="string"?(r=os(e))?(e=r,tf):X3:e instanceof os?tf:e instanceof Date?_6:g6(e)?p6:Array.isArray(e)?m6:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?y6:Fn)(t,e)}function o_(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var ob=180/Math.PI,Lg={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Y3(t,e,n,r,i,s){var o,a,u;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),t*r<e*n&&(t=-t,e=-e,u=-u,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*ob,skewX:Math.atan(u)*ob,scaleX:o,scaleY:a}}var lu;function w6(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Lg:Y3(e.a,e.b,e.c,e.d,e.e,e.f)}function x6(t){return t==null||(lu||(lu=document.createElementNS("http://www.w3.org/2000/svg","g")),lu.setAttribute("transform",t),!(t=lu.transform.baseVal.consolidate()))?Lg:(t=t.matrix,Y3(t.a,t.b,t.c,t.d,t.e,t.f))}function q3(t,e,n,r){function i(f){return f.length?f.pop()+" ":""}function s(f,h,p,g,_,v){if(f!==p||h!==g){var w=_.push("translate(",null,e,null,n);v.push({i:w-4,x:Fn(f,p)},{i:w-2,x:Fn(h,g)})}else(p||g)&&_.push("translate("+p+e+g+n)}function o(f,h,p,g){f!==h?(f-h>180?h+=360:h-f>180&&(f+=360),g.push({i:p.push(i(p)+"rotate(",null,r)-2,x:Fn(f,h)})):h&&p.push(i(p)+"rotate("+h+r)}function a(f,h,p,g){f!==h?g.push({i:p.push(i(p)+"skewX(",null,r)-2,x:Fn(f,h)}):h&&p.push(i(p)+"skewX("+h+r)}function u(f,h,p,g,_,v){if(f!==p||h!==g){var w=_.push(i(_)+"scale(",null,",",null,")");v.push({i:w-4,x:Fn(f,p)},{i:w-2,x:Fn(h,g)})}else(p!==1||g!==1)&&_.push(i(_)+"scale("+p+","+g+")")}return function(f,h){var p=[],g=[];return f=t(f),h=t(h),s(f.translateX,f.translateY,h.translateX,h.translateY,p,g),o(f.rotate,h.rotate,p,g),a(f.skewX,h.skewX,p,g),u(f.scaleX,f.scaleY,h.scaleX,h.scaleY,p,g),f=h=null,function(_){for(var v=-1,w=g.length,x;++v<w;)p[(x=g[v]).i]=x.x(_);return p.join("")}}}var T6=q3(w6,"px, ","px)","deg)"),S6=q3(x6,", ",")",")");function ab(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}var To=0,ja=0,Oa=0,K3=1e3,nf,za,rf=0,as=0,Gf=0,vl=typeof performance=="object"&&performance.now?performance:Date,Z3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function a_(){return as||(Z3(E6),as=vl.now()+Gf)}function E6(){as=0}function sf(){this._call=this._time=this._next=null}sf.prototype=Q3.prototype={constructor:sf,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?a_():+n)+(e==null?0:+e),!this._next&&za!==this&&(za?za._next=this:nf=this,za=this),this._call=t,this._time=n,Bg()},stop:function(){this._call&&(this._call=null,this._time=1/0,Bg())}};function Q3(t,e,n){var r=new sf;return r.restart(t,e,n),r}function A6(){a_(),++To;for(var t=nf,e;t;)(e=as-t._time)>=0&&t._call.call(void 0,e),t=t._next;--To}function lb(){as=(rf=vl.now())+Gf,To=ja=0;try{A6()}finally{To=0,R6(),as=0}}function C6(){var t=vl.now(),e=t-rf;e>K3&&(Gf-=e,rf=t)}function R6(){for(var t,e=nf,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:nf=n);za=t,Bg(r)}function Bg(t){if(!To){ja&&(ja=clearTimeout(ja));var e=t-as;e>24?(t<1/0&&(ja=setTimeout(lb,t-vl.now()-Gf)),Oa&&(Oa=clearInterval(Oa))):(Oa||(rf=vl.now(),Oa=setInterval(C6,K3)),To=1,Z3(lb))}}function cb(t,e,n){var r=new sf;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var I6=P3("start","end","cancel","interrupt"),k6=[],J3=0,ub=1,Ug=2,Du=3,fb=4,jg=5,Fu=6;function eh(t,e,n,r,i,s){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;P6(t,n,{name:e,index:r,group:i,on:I6,tween:k6,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:J3})}function l_(t,e){var n=jn(t,e);if(n.state>J3)throw new Error("too late; already scheduled");return n}function fr(t,e){var n=jn(t,e);if(n.state>Du)throw new Error("too late; already running");return n}function jn(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function P6(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Q3(s,0,n.time);function s(f){n.state=ub,n.timer.restart(o,n.delay,n.time),n.delay<=f&&o(f-n.delay)}function o(f){var h,p,g,_;if(n.state!==ub)return u();for(h in r)if(_=r[h],_.name===n.name){if(_.state===Du)return cb(o);_.state===fb?(_.state=Fu,_.timer.stop(),_.on.call("interrupt",t,t.__data__,_.index,_.group),delete r[h]):+h<e&&(_.state=Fu,_.timer.stop(),_.on.call("cancel",t,t.__data__,_.index,_.group),delete r[h])}if(cb(function(){n.state===Du&&(n.state=fb,n.timer.restart(a,n.delay,n.time),a(f))}),n.state=Ug,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Ug){for(n.state=Du,i=new Array(g=n.tween.length),h=0,p=-1;h<g;++h)(_=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(i[++p]=_);i.length=p+1}}function a(f){for(var h=f<n.duration?n.ease.call(null,f/n.duration):(n.timer.restart(u),n.state=jg,1),p=-1,g=i.length;++p<g;)i[p].call(t,h);n.state===jg&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){n.state=Fu,n.timer.stop(),delete r[e];for(var f in r)return;delete t.__transition}}function M6(t,e){var n=t.__transition,r,i,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){s=!1;continue}i=r.state>Ug&&r.state<jg,r.state=Fu,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}s&&delete t.__transition}}function N6(t){return this.each(function(){M6(this,t)})}function O6(t,e){var n,r;return function(){var i=fr(this,t),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function D6(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=fr(this,t),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:e,value:n},u=0,f=i.length;u<f;++u)if(i[u].name===e){i[u]=a;break}u===f&&i.push(a)}s.tween=i}}function F6(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=jn(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?O6:D6)(n,t,e))}function c_(t,e,n){var r=t._id;return t.each(function(){var i=fr(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return jn(i,r).value[e]}}function G3(t,e){var n;return(typeof e=="number"?Fn:e instanceof os?tf:(n=os(e))?(e=n,tf):X3)(t,e)}function L6(t){return function(){this.removeAttribute(t)}}function B6(t){return function(){this.removeAttributeNS(t.space,t.local)}}function U6(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttribute(t);return o===i?null:o===r?s:s=e(r=o,n)}}function j6(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?s:s=e(r=o,n)}}function z6(t,e,n){var r,i,s;return function(){var o,a=n(this),u;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),u=a+"",o===u?null:o===r&&u===i?s:(i=u,s=e(r=o,a)))}}function V6(t,e,n){var r,i,s;return function(){var o,a=n(this),u;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),u=a+"",o===u?null:o===r&&u===i?s:(i=u,s=e(r=o,a)))}}function $6(t,e){var n=Jf(t),r=n==="transform"?S6:G3;return this.attrTween(t,typeof e=="function"?(n.local?V6:z6)(n,r,c_(this,"attr."+t,e)):e==null?(n.local?B6:L6)(n):(n.local?j6:U6)(n,r,e))}function W6(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function H6(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function X6(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&H6(t,s)),n}return i._value=e,i}function Y6(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&W6(t,s)),n}return i._value=e,i}function q6(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Jf(t);return this.tween(n,(r.local?X6:Y6)(r,e))}function K6(t,e){return function(){l_(this,t).delay=+e.apply(this,arguments)}}function Z6(t,e){return e=+e,function(){l_(this,t).delay=e}}function Q6(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?K6:Z6)(e,t)):jn(this.node(),e).delay}function J6(t,e){return function(){fr(this,t).duration=+e.apply(this,arguments)}}function G6(t,e){return e=+e,function(){fr(this,t).duration=e}}function eD(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?J6:G6)(e,t)):jn(this.node(),e).duration}function tD(t,e){if(typeof e!="function")throw new Error;return function(){fr(this,t).ease=e}}function nD(t){var e=this._id;return arguments.length?this.each(tD(e,t)):jn(this.node(),e).ease}function rD(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;fr(this,t).ease=n}}function iD(t){if(typeof t!="function")throw new Error;return this.each(rD(this._id,t))}function sD(t){typeof t!="function"&&(t=N3(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],u,f=0;f<o;++f)(u=s[f])&&t.call(u,u.__data__,f,s)&&a.push(u);return new Dr(r,this._parents,this._name,this._id)}function oD(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var u=e[a],f=n[a],h=u.length,p=o[a]=new Array(h),g,_=0;_<h;++_)(g=u[_]||f[_])&&(p[_]=g);for(;a<r;++a)o[a]=e[a];return new Dr(o,this._parents,this._name,this._id)}function aD(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function lD(t,e,n){var r,i,s=aD(e)?l_:fr;return function(){var o=s(this,t),a=o.on;a!==r&&(i=(r=a).copy()).on(e,n),o.on=i}}function cD(t,e){var n=this._id;return arguments.length<2?jn(this.node(),n).on.on(t):this.each(lD(n,t,e))}function uD(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function fD(){return this.on("end.remove",uD(this._id))}function hD(t){var e=this._name,n=this._id;typeof t!="function"&&(t=n_(t));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],u=a.length,f=s[o]=new Array(u),h,p,g=0;g<u;++g)(h=a[g])&&(p=t.call(h,h.__data__,g,a))&&("__data__"in h&&(p.__data__=h.__data__),f[g]=p,eh(f[g],e,n,g,f,jn(h,n)));return new Dr(s,this._parents,e,n)}function dD(t){var e=this._name,n=this._id;typeof t!="function"&&(t=M3(t));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var u=r[a],f=u.length,h,p=0;p<f;++p)if(h=u[p]){for(var g=t.call(h,h.__data__,p,u),_,v=jn(h,n),w=0,x=g.length;w<x;++w)(_=g[w])&&eh(_,e,n,w,g,v);s.push(g),o.push(h)}return new Dr(s,o,e,n)}var pD=Ll.prototype.constructor;function gD(){return new pD(this._groups,this._parents)}function mD(t,e){var n,r,i;return function(){var s=wo(this,t),o=(this.style.removeProperty(t),wo(this,t));return s===o?null:s===n&&o===r?i:i=e(n=s,r=o)}}function eT(t){return function(){this.style.removeProperty(t)}}function _D(t,e,n){var r,i=n+"",s;return function(){var o=wo(this,t);return o===i?null:o===r?s:s=e(r=o,n)}}function yD(t,e,n){var r,i,s;return function(){var o=wo(this,t),a=n(this),u=a+"";return a==null&&(u=a=(this.style.removeProperty(t),wo(this,t))),o===u?null:o===r&&u===i?s:(i=u,s=e(r=o,a))}}function vD(t,e){var n,r,i,s="style."+e,o="end."+s,a;return function(){var u=fr(this,t),f=u.on,h=u.value[s]==null?a||(a=eT(e)):void 0;(f!==n||i!==h)&&(r=(n=f).copy()).on(o,i=h),u.on=r}}function bD(t,e,n){var r=(t+="")=="transform"?T6:G3;return e==null?this.styleTween(t,mD(t,r)).on("end.style."+t,eT(t)):typeof e=="function"?this.styleTween(t,yD(t,r,c_(this,"style."+t,e))).each(vD(this._id,t)):this.styleTween(t,_D(t,r,e),n).on("end.style."+t,null)}function wD(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function xD(t,e,n){var r,i;function s(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&wD(t,o,n)),r}return s._value=e,s}function TD(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,xD(t,e,n??""))}function SD(t){return function(){this.textContent=t}}function ED(t){return function(){var e=t(this);this.textContent=e??""}}function AD(t){return this.tween("text",typeof t=="function"?ED(c_(this,"text",t)):SD(t==null?"":t+""))}function CD(t){return function(e){this.textContent=t.call(this,e)}}function RD(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&CD(i)),e}return r._value=t,r}function ID(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,RD(t))}function kD(){for(var t=this._name,e=this._id,n=tT(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,u,f=0;f<a;++f)if(u=o[f]){var h=jn(u,e);eh(u,t,n,f,o,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Dr(r,this._parents,t,n)}function PD(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},u={value:function(){--i===0&&s()}};n.each(function(){var f=fr(this,r),h=f.on;h!==t&&(e=(t=h).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(u)),f.on=e}),i===0&&s()})}var MD=0;function Dr(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function tT(){return++MD}var Sr=Ll.prototype;Dr.prototype={constructor:Dr,select:hD,selectAll:dD,selectChild:Sr.selectChild,selectChildren:Sr.selectChildren,filter:sD,merge:oD,selection:gD,transition:kD,call:Sr.call,nodes:Sr.nodes,node:Sr.node,size:Sr.size,empty:Sr.empty,each:Sr.each,on:cD,attr:$6,attrTween:q6,style:bD,styleTween:TD,text:AD,textTween:ID,remove:fD,tween:F6,delay:Q6,duration:eD,ease:nD,easeVarying:iD,end:PD,[Symbol.iterator]:Sr[Symbol.iterator]};function ND(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var OD={time:null,delay:0,duration:250,ease:ND};function DD(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function FD(t){var e,n;t instanceof Dr?(e=t._id,t=t._name):(e=tT(),(n=OD).time=a_(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,u,f=0;f<a;++f)(u=o[f])&&eh(u,t,e,f,o,n||DD(u,e));return new Dr(r,this._parents,t,e)}Ll.prototype.interrupt=N6;Ll.prototype.transition=FD;function LD(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function BD(t,e){return fetch(t,e).then(LD)}function UD(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function of(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function So(t){return t=of(Math.abs(t)),t?t[1]:NaN}function jD(t,e){return function(n,r){for(var i=n.length,s=[],o=0,a=t[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),s.push(n.substring(i-=a,i+a)),!((u+=a+1)>r));)a=t[o=(o+1)%t.length];return s.reverse().join(e)}}function zD(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var VD=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function af(t){if(!(e=VD.exec(t)))throw new Error("invalid format: "+t);var e;return new u_({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}af.prototype=u_.prototype;function u_(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}u_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function $D(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var nT;function WD(t,e){var n=of(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(nT=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+of(t,Math.max(0,e+s-1))[0]}function hb(t,e){var n=of(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const db={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:UD,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>hb(t*100,e),r:hb,s:WD,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function pb(t){return t}var gb=Array.prototype.map,mb=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function HD(t){var e=t.grouping===void 0||t.thousands===void 0?pb:jD(gb.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?pb:zD(gb.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function f(p){p=af(p);var g=p.fill,_=p.align,v=p.sign,w=p.symbol,x=p.zero,T=p.width,A=p.comma,E=p.precision,R=p.trim,k=p.type;k==="n"?(A=!0,k="g"):db[k]||(E===void 0&&(E=12),R=!0,k="g"),(x||g==="0"&&_==="=")&&(x=!0,g="0",_="=");var M=w==="$"?n:w==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",L=w==="$"?r:/[%p]/.test(k)?o:"",W=db[k],H=/[defgprs%]/.test(k);E=E===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E));function X(B){var te=M,ie=L,se,G,ce;if(k==="c")ie=W(B)+ie,B="";else{B=+B;var xe=B<0||1/B<0;if(B=isNaN(B)?u:W(Math.abs(B),E),R&&(B=$D(B)),xe&&+B==0&&v!=="+"&&(xe=!1),te=(xe?v==="("?v:a:v==="-"||v==="("?"":v)+te,ie=(k==="s"?mb[8+nT/3]:"")+ie+(xe&&v==="("?")":""),H){for(se=-1,G=B.length;++se<G;)if(ce=B.charCodeAt(se),48>ce||ce>57){ie=(ce===46?i+B.slice(se+1):B.slice(se))+ie,B=B.slice(0,se);break}}}A&&!x&&(B=e(B,1/0));var oe=te.length+B.length+ie.length,ne=oe<T?new Array(T-oe+1).join(g):"";switch(A&&x&&(B=e(ne+B,ne.length?T-ie.length:1/0),ne=""),_){case"<":B=te+B+ie+ne;break;case"=":B=te+ne+B+ie;break;case"^":B=ne.slice(0,oe=ne.length>>1)+te+B+ie+ne.slice(oe);break;default:B=ne+te+B+ie;break}return s(B)}return X.toString=function(){return p+""},X}function h(p,g){var _=f((p=af(p),p.type="f",p)),v=Math.max(-8,Math.min(8,Math.floor(So(g)/3)))*3,w=Math.pow(10,-v),x=mb[8+v/3];return function(T){return _(w*T)+x}}return{format:f,formatPrefix:h}}var cu,bl,rT;XD({thousands:",",grouping:[3],currency:["$",""]});function XD(t){return cu=HD(t),bl=cu.format,rT=cu.formatPrefix,cu}function YD(t){return Math.max(0,-So(Math.abs(t)))}function qD(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(So(e)/3)))*3-So(Math.abs(t)))}function KD(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,So(e)-So(t))+1}var qe=1e-6,iT=1e-12,Be=Math.PI,mn=Be/2,_b=Be/4,Sn=Be*2,Er=180/Be,nn=Be/180,et=Math.abs,ZD=Math.atan,wl=Math.atan2,it=Math.cos,st=Math.sin,QD=Math.sign||function(t){return t>0?1:t<0?-1:0},Ai=Math.sqrt;function JD(t){return t>1?0:t<-1?Be:Math.acos(t)}function ls(t){return t>1?mn:t<-1?-mn:Math.asin(t)}function _n(){}function lf(t,e){t&&vb.hasOwnProperty(t.type)&&vb[t.type](t,e)}var yb={Feature:function(t,e){lf(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)lf(n[r].geometry,e)}},vb={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){zg(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)zg(n[r],e,0)},Polygon:function(t,e){bb(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)bb(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)lf(n[r],e)}};function zg(t,e,n){var r=-1,i=t.length-n,s;for(e.lineStart();++r<i;)s=t[r],e.point(s[0],s[1],s[2]);e.lineEnd()}function bb(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)zg(t[n],e,1);e.polygonEnd()}function eo(t,e){t&&yb.hasOwnProperty(t.type)?yb[t.type](t,e):lf(t,e)}function Vg(t){return[wl(t[1],t[0]),ls(t[2])]}function Eo(t){var e=t[0],n=t[1],r=it(n);return[r*it(e),r*st(e),st(n)]}function uu(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function cf(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Ep(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function fu(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function $g(t){var e=Ai(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Wg(t,e){function n(r,i){return r=t(r,i),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,i){return r=e.invert(r,i),r&&t.invert(r[0],r[1])}),n}function Hg(t,e){return et(t)>Be&&(t-=Math.round(t/Sn)*Sn),[t,e]}Hg.invert=Hg;function GD(t,e,n){return(t%=Sn)?e||n?Wg(xb(t),Tb(e,n)):xb(t):e||n?Tb(e,n):Hg}function wb(t){return function(e,n){return e+=t,et(e)>Be&&(e-=Math.round(e/Sn)*Sn),[e,n]}}function xb(t){var e=wb(t);return e.invert=wb(-t),e}function Tb(t,e){var n=it(t),r=st(t),i=it(e),s=st(e);function o(a,u){var f=it(u),h=it(a)*f,p=st(a)*f,g=st(u),_=g*n+h*r;return[wl(p*i-_*s,h*n-g*r),ls(_*i+p*s)]}return o.invert=function(a,u){var f=it(u),h=it(a)*f,p=st(a)*f,g=st(u),_=g*i-p*s;return[wl(p*i+g*s,h*n+_*r),ls(_*n-h*r)]},o}function eF(t,e,n,r,i,s){if(n){var o=it(e),a=st(e),u=r*n;i==null?(i=e+r*Sn,s=e-u/2):(i=Sb(o,i),s=Sb(o,s),(r>0?i<s:i>s)&&(i+=r*Sn));for(var f,h=i;r>0?h>s:h<s;h-=u)f=Vg([o,-a*it(h),-a*st(h)]),t.point(f[0],f[1])}}function Sb(t,e){e=Eo(e),e[0]-=t,$g(e);var n=JD(-e[1]);return((-e[2]<0?-n:n)+Sn-qe)%Sn}function sT(){var t=[],e;return{point:function(n,r,i){e.push([n,r,i])},lineStart:function(){t.push(e=[])},lineEnd:_n,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function Lu(t,e){return et(t[0]-e[0])<qe&&et(t[1]-e[1])<qe}function hu(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function oT(t,e,n,r,i){var s=[],o=[],a,u;if(t.forEach(function(v){if(!((w=v.length-1)<=0)){var w,x=v[0],T=v[w],A;if(Lu(x,T)){if(!x[2]&&!T[2]){for(i.lineStart(),a=0;a<w;++a)i.point((x=v[a])[0],x[1]);i.lineEnd();return}T[0]+=2*qe}s.push(A=new hu(x,v,null,!0)),o.push(A.o=new hu(x,null,A,!1)),s.push(A=new hu(T,v,null,!1)),o.push(A.o=new hu(T,null,A,!0))}}),!!s.length){for(o.sort(e),Eb(s),Eb(o),a=0,u=o.length;a<u;++a)o[a].e=n=!n;for(var f=s[0],h,p;;){for(var g=f,_=!0;g.v;)if((g=g.n)===f)return;h=g.z,i.lineStart();do{if(g.v=g.o.v=!0,g.e){if(_)for(a=0,u=h.length;a<u;++a)i.point((p=h[a])[0],p[1]);else r(g.x,g.n.x,1,i);g=g.n}else{if(_)for(h=g.p.z,a=h.length-1;a>=0;--a)i.point((p=h[a])[0],p[1]);else r(g.x,g.p.x,-1,i);g=g.p}g=g.o,h=g.z,_=!_}while(!g.v);i.lineEnd()}}}function Eb(t){if(e=t.length){for(var e,n=0,r=t[0],i;++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}function Ap(t){return et(t[0])<=Be?t[0]:QD(t[0])*((et(t[0])+Be)%Sn-Be)}function tF(t,e){var n=Ap(e),r=e[1],i=st(r),s=[st(n),-it(n),0],o=0,a=0,u=new ss;i===1?r=mn+qe:i===-1&&(r=-mn-qe);for(var f=0,h=t.length;f<h;++f)if(g=(p=t[f]).length)for(var p,g,_=p[g-1],v=Ap(_),w=_[1]/2+_b,x=st(w),T=it(w),A=0;A<g;++A,v=R,x=M,T=L,_=E){var E=p[A],R=Ap(E),k=E[1]/2+_b,M=st(k),L=it(k),W=R-v,H=W>=0?1:-1,X=H*W,B=X>Be,te=x*M;if(u.add(wl(te*H*st(X),T*L+te*it(X))),o+=B?W+H*Sn:W,B^v>=n^R>=n){var ie=cf(Eo(_),Eo(E));$g(ie);var se=cf(s,ie);$g(se);var G=(B^W>=0?-1:1)*ls(se[2]);(r>G||r===G&&(ie[0]||ie[1]))&&(a+=B^W>=0?1:-1)}}return(o<-qe||o<qe&&u<-iT)^a&1}function aT(t,e,n,r){return function(i){var s=e(i),o=sT(),a=e(o),u=!1,f,h,p,g={point:_,lineStart:w,lineEnd:x,polygonStart:function(){g.point=T,g.lineStart=A,g.lineEnd=E,h=[],f=[]},polygonEnd:function(){g.point=_,g.lineStart=w,g.lineEnd=x,h=k3(h);var R=tF(f,r);h.length?(u||(i.polygonStart(),u=!0),oT(h,rF,R,n,i)):R&&(u||(i.polygonStart(),u=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),u&&(i.polygonEnd(),u=!1),h=f=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function _(R,k){t(R,k)&&i.point(R,k)}function v(R,k){s.point(R,k)}function w(){g.point=v,s.lineStart()}function x(){g.point=_,s.lineEnd()}function T(R,k){p.push([R,k]),a.point(R,k)}function A(){a.lineStart(),p=[]}function E(){T(p[0][0],p[0][1]),a.lineEnd();var R=a.clean(),k=o.result(),M,L=k.length,W,H,X;if(p.pop(),f.push(p),p=null,!!L){if(R&1){if(H=k[0],(W=H.length-1)>0){for(u||(i.polygonStart(),u=!0),i.lineStart(),M=0;M<W;++M)i.point((X=H[M])[0],X[1]);i.lineEnd()}return}L>1&&R&2&&k.push(k.pop().concat(k.shift())),h.push(k.filter(nF))}}return g}}function nF(t){return t.length>1}function rF(t,e){return((t=t.x)[0]<0?t[1]-mn-qe:mn-t[1])-((e=e.x)[0]<0?e[1]-mn-qe:mn-e[1])}const Ab=aT(function(){return!0},iF,oF,[-Be,-mn]);function iF(t){var e=NaN,n=NaN,r=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(s,o){var a=s>0?Be:-Be,u=et(s-e);et(u-Be)<qe?(t.point(e,n=(n+o)/2>0?mn:-mn),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),t.point(s,n),i=0):r!==a&&u>=Be&&(et(e-r)<qe&&(e-=r*qe),et(s-a)<qe&&(s-=a*qe),n=sF(e,n,s,o),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),i=0),t.point(e=s,n=o),r=a},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-i}}}function sF(t,e,n,r){var i,s,o=st(t-n);return et(o)>qe?ZD((st(e)*(s=it(r))*st(n)-st(r)*(i=it(e))*st(t))/(i*s*o)):(e+r)/2}function oF(t,e,n,r){var i;if(t==null)i=n*mn,r.point(-Be,i),r.point(0,i),r.point(Be,i),r.point(Be,0),r.point(Be,-i),r.point(0,-i),r.point(-Be,-i),r.point(-Be,0),r.point(-Be,i);else if(et(t[0]-e[0])>qe){var s=t[0]<e[0]?Be:-Be;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(e[0],e[1])}function aF(t){var e=it(t),n=2*nn,r=e>0,i=et(e)>qe;function s(h,p,g,_){eF(_,t,n,g,h,p)}function o(h,p){return it(h)*it(p)>e}function a(h){var p,g,_,v,w;return{lineStart:function(){v=_=!1,w=1},point:function(x,T){var A=[x,T],E,R=o(x,T),k=r?R?0:f(x,T):R?f(x+(x<0?Be:-Be),T):0;if(!p&&(v=_=R)&&h.lineStart(),R!==_&&(E=u(p,A),(!E||Lu(p,E)||Lu(A,E))&&(A[2]=1)),R!==_)w=0,R?(h.lineStart(),E=u(A,p),h.point(E[0],E[1])):(E=u(p,A),h.point(E[0],E[1],2),h.lineEnd()),p=E;else if(i&&p&&r^R){var M;!(k&g)&&(M=u(A,p,!0))&&(w=0,r?(h.lineStart(),h.point(M[0][0],M[0][1]),h.point(M[1][0],M[1][1]),h.lineEnd()):(h.point(M[1][0],M[1][1]),h.lineEnd(),h.lineStart(),h.point(M[0][0],M[0][1],3)))}R&&(!p||!Lu(p,A))&&h.point(A[0],A[1]),p=A,_=R,g=k},lineEnd:function(){_&&h.lineEnd(),p=null},clean:function(){return w|(v&&_)<<1}}}function u(h,p,g){var _=Eo(h),v=Eo(p),w=[1,0,0],x=cf(_,v),T=uu(x,x),A=x[0],E=T-A*A;if(!E)return!g&&h;var R=e*T/E,k=-e*A/E,M=cf(w,x),L=fu(w,R),W=fu(x,k);Ep(L,W);var H=M,X=uu(L,H),B=uu(H,H),te=X*X-B*(uu(L,L)-1);if(!(te<0)){var ie=Ai(te),se=fu(H,(-X-ie)/B);if(Ep(se,L),se=Vg(se),!g)return se;var G=h[0],ce=p[0],xe=h[1],oe=p[1],ne;ce<G&&(ne=G,G=ce,ce=ne);var ee=ce-G,D=et(ee-Be)<qe,Z=D||ee<qe;if(!D&&oe<xe&&(ne=xe,xe=oe,oe=ne),Z?D?xe+oe>0^se[1]<(et(se[0]-G)<qe?xe:oe):xe<=se[1]&&se[1]<=oe:ee>Be^(G<=se[0]&&se[0]<=ce)){var ge=fu(H,(-X+ie)/B);return Ep(ge,L),[se,Vg(ge)]}}}function f(h,p){var g=r?t:Be-t,_=0;return h<-g?_|=1:h>g&&(_|=2),p<-g?_|=4:p>g&&(_|=8),_}return aT(o,a,s,r?[0,-t]:[-Be,t-Be])}function lF(t,e,n,r,i,s){var o=t[0],a=t[1],u=e[0],f=e[1],h=0,p=1,g=u-o,_=f-a,v;if(v=n-o,!(!g&&v>0)){if(v/=g,g<0){if(v<h)return;v<p&&(p=v)}else if(g>0){if(v>p)return;v>h&&(h=v)}if(v=i-o,!(!g&&v<0)){if(v/=g,g<0){if(v>p)return;v>h&&(h=v)}else if(g>0){if(v<h)return;v<p&&(p=v)}if(v=r-a,!(!_&&v>0)){if(v/=_,_<0){if(v<h)return;v<p&&(p=v)}else if(_>0){if(v>p)return;v>h&&(h=v)}if(v=s-a,!(!_&&v<0)){if(v/=_,_<0){if(v>p)return;v>h&&(h=v)}else if(_>0){if(v<h)return;v<p&&(p=v)}return h>0&&(t[0]=o+h*g,t[1]=a+h*_),p<1&&(e[0]=o+p*g,e[1]=a+p*_),!0}}}}}var Va=1e9,du=-Va;function cF(t,e,n,r){function i(f,h){return t<=f&&f<=n&&e<=h&&h<=r}function s(f,h,p,g){var _=0,v=0;if(f==null||(_=o(f,p))!==(v=o(h,p))||u(f,h)<0^p>0)do g.point(_===0||_===3?t:n,_>1?r:e);while((_=(_+p+4)%4)!==v);else g.point(h[0],h[1])}function o(f,h){return et(f[0]-t)<qe?h>0?0:3:et(f[0]-n)<qe?h>0?2:1:et(f[1]-e)<qe?h>0?1:0:h>0?3:2}function a(f,h){return u(f.x,h.x)}function u(f,h){var p=o(f,1),g=o(h,1);return p!==g?p-g:p===0?h[1]-f[1]:p===1?f[0]-h[0]:p===2?f[1]-h[1]:h[0]-f[0]}return function(f){var h=f,p=sT(),g,_,v,w,x,T,A,E,R,k,M,L={point:W,lineStart:te,lineEnd:ie,polygonStart:X,polygonEnd:B};function W(G,ce){i(G,ce)&&h.point(G,ce)}function H(){for(var G=0,ce=0,xe=_.length;ce<xe;++ce)for(var oe=_[ce],ne=1,ee=oe.length,D=oe[0],Z,ge,Y=D[0],Re=D[1];ne<ee;++ne)Z=Y,ge=Re,D=oe[ne],Y=D[0],Re=D[1],ge<=r?Re>r&&(Y-Z)*(r-ge)>(Re-ge)*(t-Z)&&++G:Re<=r&&(Y-Z)*(r-ge)<(Re-ge)*(t-Z)&&--G;return G}function X(){h=p,g=[],_=[],M=!0}function B(){var G=H(),ce=M&&G,xe=(g=k3(g)).length;(ce||xe)&&(f.polygonStart(),ce&&(f.lineStart(),s(null,null,1,f),f.lineEnd()),xe&&oT(g,a,G,s,f),f.polygonEnd()),h=f,g=_=v=null}function te(){L.point=se,_&&_.push(v=[]),k=!0,R=!1,A=E=NaN}function ie(){g&&(se(w,x),T&&R&&p.rejoin(),g.push(p.result())),L.point=W,R&&h.lineEnd()}function se(G,ce){var xe=i(G,ce);if(_&&v.push([G,ce]),k)w=G,x=ce,T=xe,k=!1,xe&&(h.lineStart(),h.point(G,ce));else if(xe&&R)h.point(G,ce);else{var oe=[A=Math.max(du,Math.min(Va,A)),E=Math.max(du,Math.min(Va,E))],ne=[G=Math.max(du,Math.min(Va,G)),ce=Math.max(du,Math.min(Va,ce))];lF(oe,ne,t,e,n,r)?(R||(h.lineStart(),h.point(oe[0],oe[1])),h.point(ne[0],ne[1]),xe||h.lineEnd(),M=!1):xe&&(h.lineStart(),h.point(G,ce),M=!1)}A=G,E=ce,R=xe}return L}}const Xg=t=>t;var Cp=new ss,Yg=new ss,lT,cT,qg,Kg,Ir={point:_n,lineStart:_n,lineEnd:_n,polygonStart:function(){Ir.lineStart=uF,Ir.lineEnd=hF},polygonEnd:function(){Ir.lineStart=Ir.lineEnd=Ir.point=_n,Cp.add(et(Yg)),Yg=new ss},result:function(){var t=Cp/2;return Cp=new ss,t}};function uF(){Ir.point=fF}function fF(t,e){Ir.point=uT,lT=qg=t,cT=Kg=e}function uT(t,e){Yg.add(Kg*t-qg*e),qg=t,Kg=e}function hF(){uT(lT,cT)}var Ao=1/0,uf=Ao,xl=-Ao,ff=xl,hf={point:dF,lineStart:_n,lineEnd:_n,polygonStart:_n,polygonEnd:_n,result:function(){var t=[[Ao,uf],[xl,ff]];return xl=ff=-(uf=Ao=1/0),t}};function dF(t,e){t<Ao&&(Ao=t),t>xl&&(xl=t),e<uf&&(uf=e),e>ff&&(ff=e)}var Zg=0,Qg=0,$a=0,df=0,pf=0,io=0,Jg=0,Gg=0,Wa=0,fT,hT,Gn,er,gn={point:cs,lineStart:Cb,lineEnd:Rb,polygonStart:function(){gn.lineStart=mF,gn.lineEnd=_F},polygonEnd:function(){gn.point=cs,gn.lineStart=Cb,gn.lineEnd=Rb},result:function(){var t=Wa?[Jg/Wa,Gg/Wa]:io?[df/io,pf/io]:$a?[Zg/$a,Qg/$a]:[NaN,NaN];return Zg=Qg=$a=df=pf=io=Jg=Gg=Wa=0,t}};function cs(t,e){Zg+=t,Qg+=e,++$a}function Cb(){gn.point=pF}function pF(t,e){gn.point=gF,cs(Gn=t,er=e)}function gF(t,e){var n=t-Gn,r=e-er,i=Ai(n*n+r*r);df+=i*(Gn+t)/2,pf+=i*(er+e)/2,io+=i,cs(Gn=t,er=e)}function Rb(){gn.point=cs}function mF(){gn.point=yF}function _F(){dT(fT,hT)}function yF(t,e){gn.point=dT,cs(fT=Gn=t,hT=er=e)}function dT(t,e){var n=t-Gn,r=e-er,i=Ai(n*n+r*r);df+=i*(Gn+t)/2,pf+=i*(er+e)/2,io+=i,i=er*t-Gn*e,Jg+=i*(Gn+t),Gg+=i*(er+e),Wa+=i*3,cs(Gn=t,er=e)}function pT(t){this._context=t}pT.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Sn);break}}},result:_n};var em=new ss,Rp,gT,mT,Ha,Xa,Tl={point:_n,lineStart:function(){Tl.point=vF},lineEnd:function(){Rp&&_T(gT,mT),Tl.point=_n},polygonStart:function(){Rp=!0},polygonEnd:function(){Rp=null},result:function(){var t=+em;return em=new ss,t}};function vF(t,e){Tl.point=_T,gT=Ha=t,mT=Xa=e}function _T(t,e){Ha-=t,Xa-=e,em.add(Ai(Ha*Ha+Xa*Xa)),Ha=t,Xa=e}let Ib,gf,kb,Pb;class Mb{constructor(e){this._append=e==null?yT:bF(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:{this._append`M${e},${n}`,this._point=1;break}case 1:{this._append`L${e},${n}`;break}default:{if(this._append`M${e},${n}`,this._radius!==kb||this._append!==gf){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,kb=r,gf=this._append,Pb=this._,this._=i}this._+=Pb;break}}}result(){const e=this._;return this._="",e.length?e:null}}function yT(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function bF(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return yT;if(e!==Ib){const n=10**e;Ib=e,gf=function(i){let s=1;this._+=i[0];for(const o=i.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return gf}function vT(t,e){let n=3,r=4.5,i,s;function o(a){return a&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),eo(a,i(s))),s.result()}return o.area=function(a){return eo(a,i(Ir)),Ir.result()},o.measure=function(a){return eo(a,i(Tl)),Tl.result()},o.bounds=function(a){return eo(a,i(hf)),hf.result()},o.centroid=function(a){return eo(a,i(gn)),gn.result()},o.projection=function(a){return arguments.length?(i=a==null?(t=null,Xg):(t=a).stream,o):t},o.context=function(a){return arguments.length?(s=a==null?(e=null,new Mb(n)):new pT(e=a),typeof r!="function"&&s.pointRadius(r),o):e},o.pointRadius=function(a){return arguments.length?(r=typeof a=="function"?a:(s.pointRadius(+a),+a),o):r},o.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);n=u}return e===null&&(s=new Mb(n)),o},o.projection(t).digits(n).context(e)}function f_(t){return function(e){var n=new tm;for(var r in t)n[r]=t[r];return n.stream=e,n}}function tm(){}tm.prototype={constructor:tm,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function h_(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),eo(n,t.stream(hf)),e(hf.result()),r!=null&&t.clipExtent(r),t}function bT(t,e,n){return h_(t,function(r){var i=e[1][0]-e[0][0],s=e[1][1]-e[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),a=+e[0][0]+(i-o*(r[1][0]+r[0][0]))/2,u=+e[0][1]+(s-o*(r[1][1]+r[0][1]))/2;t.scale(150*o).translate([a,u])},n)}function wF(t,e,n){return bT(t,[[0,0],e],n)}function xF(t,e,n){return h_(t,function(r){var i=+e,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,a=-s*r[0][1];t.scale(150*s).translate([o,a])},n)}function TF(t,e,n){return h_(t,function(r){var i=+e,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],a=(i-s*(r[1][1]+r[0][1]))/2;t.scale(150*s).translate([o,a])},n)}var Nb=16,SF=it(30*nn);function Ob(t,e){return+e?AF(t,e):EF(t)}function EF(t){return f_({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function AF(t,e){function n(r,i,s,o,a,u,f,h,p,g,_,v,w,x){var T=f-r,A=h-i,E=T*T+A*A;if(E>4*e&&w--){var R=o+g,k=a+_,M=u+v,L=Ai(R*R+k*k+M*M),W=ls(M/=L),H=et(et(M)-1)<qe||et(s-p)<qe?(s+p)/2:wl(k,R),X=t(H,W),B=X[0],te=X[1],ie=B-r,se=te-i,G=A*ie-T*se;(G*G/E>e||et((T*ie+A*se)/E-.5)>.3||o*g+a*_+u*v<SF)&&(n(r,i,s,o,a,u,B,te,H,R/=L,k/=L,M,w,x),x.point(B,te),n(B,te,H,R,k,M,f,h,p,g,_,v,w,x))}}return function(r){var i,s,o,a,u,f,h,p,g,_,v,w,x={point:T,lineStart:A,lineEnd:R,polygonStart:function(){r.polygonStart(),x.lineStart=k},polygonEnd:function(){r.polygonEnd(),x.lineStart=A}};function T(W,H){W=t(W,H),r.point(W[0],W[1])}function A(){p=NaN,x.point=E,r.lineStart()}function E(W,H){var X=Eo([W,H]),B=t(W,H);n(p,g,h,_,v,w,p=B[0],g=B[1],h=W,_=X[0],v=X[1],w=X[2],Nb,r),r.point(p,g)}function R(){x.point=T,r.lineEnd()}function k(){A(),x.point=M,x.lineEnd=L}function M(W,H){E(i=W,H),s=p,o=g,a=_,u=v,f=w,x.point=E}function L(){n(p,g,h,_,v,w,s,o,i,a,u,f,Nb,r),x.lineEnd=R,R()}return x}}var CF=f_({point:function(t,e){this.stream.point(t*nn,e*nn)}});function RF(t){return f_({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}function IF(t,e,n,r,i){function s(o,a){return o*=r,a*=i,[e+t*o,n-t*a]}return s.invert=function(o,a){return[(o-e)/t*r,(n-a)/t*i]},s}function Db(t,e,n,r,i,s){if(!s)return IF(t,e,n,r,i);var o=it(s),a=st(s),u=o*t,f=a*t,h=o/t,p=a/t,g=(a*n-o*e)/t,_=(a*e+o*n)/t;function v(w,x){return w*=r,x*=i,[u*w-f*x+e,n-f*w-u*x]}return v.invert=function(w,x){return[r*(h*w-p*x+g),i*(_-p*w-h*x)]},v}function kF(t){return PF(function(){return t})()}function PF(t){var e,n=150,r=480,i=250,s=0,o=0,a=0,u=0,f=0,h,p=0,g=1,_=1,v=null,w=Ab,x=null,T,A,E,R=Xg,k=.5,M,L,W,H,X;function B(G){return W(G[0]*nn,G[1]*nn)}function te(G){return G=W.invert(G[0],G[1]),G&&[G[0]*Er,G[1]*Er]}B.stream=function(G){return H&&X===G?H:H=CF(RF(h)(w(M(R(X=G)))))},B.preclip=function(G){return arguments.length?(w=G,v=void 0,se()):w},B.postclip=function(G){return arguments.length?(R=G,x=T=A=E=null,se()):R},B.clipAngle=function(G){return arguments.length?(w=+G?aF(v=G*nn):(v=null,Ab),se()):v*Er},B.clipExtent=function(G){return arguments.length?(R=G==null?(x=T=A=E=null,Xg):cF(x=+G[0][0],T=+G[0][1],A=+G[1][0],E=+G[1][1]),se()):x==null?null:[[x,T],[A,E]]},B.scale=function(G){return arguments.length?(n=+G,ie()):n},B.translate=function(G){return arguments.length?(r=+G[0],i=+G[1],ie()):[r,i]},B.center=function(G){return arguments.length?(s=G[0]%360*nn,o=G[1]%360*nn,ie()):[s*Er,o*Er]},B.rotate=function(G){return arguments.length?(a=G[0]%360*nn,u=G[1]%360*nn,f=G.length>2?G[2]%360*nn:0,ie()):[a*Er,u*Er,f*Er]},B.angle=function(G){return arguments.length?(p=G%360*nn,ie()):p*Er},B.reflectX=function(G){return arguments.length?(g=G?-1:1,ie()):g<0},B.reflectY=function(G){return arguments.length?(_=G?-1:1,ie()):_<0},B.precision=function(G){return arguments.length?(M=Ob(L,k=G*G),se()):Ai(k)},B.fitExtent=function(G,ce){return bT(B,G,ce)},B.fitSize=function(G,ce){return wF(B,G,ce)},B.fitWidth=function(G,ce){return xF(B,G,ce)},B.fitHeight=function(G,ce){return TF(B,G,ce)};function ie(){var G=Db(n,0,0,g,_,p).apply(null,e(s,o)),ce=Db(n,r-G[0],i-G[1],g,_,p);return h=GD(a,u,f),L=Wg(e,ce),W=Wg(h,L),M=Ob(L,k),se()}function se(){return H=X=null,B}return function(){return e=t.apply(this,arguments),B.invert=e.invert&&te,ie()}}var tl=1.340264,nl=-.081106,rl=893e-6,il=.003796,mf=Ai(3)/2,MF=12;function wT(t,e){var n=ls(mf*st(e)),r=n*n,i=r*r*r;return[t*it(n)/(mf*(tl+3*nl*r+i*(7*rl+9*il*r))),n*(tl+nl*r+i*(rl+il*r))]}wT.invert=function(t,e){for(var n=e,r=n*n,i=r*r*r,s=0,o,a,u;s<MF&&(a=n*(tl+nl*r+i*(rl+il*r))-e,u=tl+3*nl*r+i*(7*rl+9*il*r),n-=o=a/u,r=n*n,i=r*r*r,!(et(o)<iT));++s);return[mf*t*(tl+3*nl*r+i*(7*rl+9*il*r))/it(n),ls(st(n)/mf)]};function xT(){return kF(wT).scale(177.158)}function th(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function NF(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Fb=Symbol("implicit");function TT(){var t=new Mg,e=[],n=[],r=Fb;function i(s){let o=t.get(s);if(o===void 0){if(r!==Fb)return r;t.set(s,o=e.push(s)-1)}return n[o%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new Mg;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return TT(e,n).unknown(r)},th.apply(i,arguments),i}function ST(){var t=TT().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,s,o,a=!1,u=0,f=0,h=.5;delete t.unknown;function p(){var g=e().length,_=i<r,v=_?i:r,w=_?r:i;s=(w-v)/Math.max(1,g-u+f*2),a&&(s=Math.floor(s)),v+=(w-v-s*(g-u))*h,o=s*(1-u),a&&(v=Math.round(v),o=Math.round(o));var x=Og(g).map(function(T){return v+s*T});return n(_?x.reverse():x)}return t.domain=function(g){return arguments.length?(e(g),p()):e()},t.range=function(g){return arguments.length?([r,i]=g,r=+r,i=+i,p()):[r,i]},t.rangeRound=function(g){return[r,i]=g,r=+r,i=+i,a=!0,p()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(g){return arguments.length?(a=!!g,p()):a},t.padding=function(g){return arguments.length?(u=Math.min(1,f=+g),p()):u},t.paddingInner=function(g){return arguments.length?(u=Math.min(1,g),p()):u},t.paddingOuter=function(g){return arguments.length?(f=+g,p()):f},t.align=function(g){return arguments.length?(h=Math.max(0,Math.min(1,g)),p()):h},t.copy=function(){return ST(e(),[r,i]).round(a).paddingInner(u).paddingOuter(f).align(h)},th.apply(p(),arguments)}function OF(t){return function(){return t}}function DF(t){return+t}var Lb=[0,1];function yn(t){return t}function nm(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:OF(isNaN(e)?NaN:.5)}function FF(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function LF(t,e,n){var r=t[0],i=t[1],s=e[0],o=e[1];return i<r?(r=nm(i,r),s=n(o,s)):(r=nm(r,i),s=n(s,o)),function(a){return s(r(a))}}function BF(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=nm(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(a){var u=$4(t,a,1,r)-1;return s[u](i[u](a))}}function ET(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function AT(){var t=Lb,e=Lb,n=xo,r,i,s,o=yn,a,u,f;function h(){var g=Math.min(t.length,e.length);return o!==yn&&(o=FF(t[0],t[g-1])),a=g>2?BF:LF,u=f=null,p}function p(g){return g==null||isNaN(g=+g)?s:(u||(u=a(t.map(r),e,n)))(r(o(g)))}return p.invert=function(g){return o(i((f||(f=a(e,t.map(r),Fn)))(g)))},p.domain=function(g){return arguments.length?(t=Array.from(g,DF),h()):t.slice()},p.range=function(g){return arguments.length?(e=Array.from(g),h()):e.slice()},p.rangeRound=function(g){return e=Array.from(g),n=o_,h()},p.clamp=function(g){return arguments.length?(o=g?!0:yn,h()):o!==yn},p.interpolate=function(g){return arguments.length?(n=g,h()):n},p.unknown=function(g){return arguments.length?(s=g,p):s},function(g,_){return r=g,i=_,h()}}function UF(){return AT()(yn,yn)}function jF(t,e,n,r){var i=tN(t,e,n),s;switch(r=af(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=qD(i,o))&&(r.precision=s),rT(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=KD(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=YD(i))&&(r.precision=s-(r.type==="%")*2);break}}return bl(r)}function d_(t){var e=t.domain;return t.ticks=function(n){var r=e();return eN(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return jF(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,o=r[i],a=r[s],u,f,h=10;for(a<o&&(f=o,o=a,a=f,f=i,i=s,s=f);h-- >0;){if(f=Ng(o,a,n),f===u)return r[i]=o,r[s]=a,e(r);if(f>0)o=Math.floor(o/f)*f,a=Math.ceil(a/f)*f;else if(f<0)o=Math.ceil(o*f)/f,a=Math.floor(a*f)/f;else break;u=f}return t},t}function CT(){var t=UF();return t.copy=function(){return ET(t,CT())},th.apply(t,arguments),d_(t)}function Bb(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function zF(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function VF(t){return t<0?-t*t:t*t}function $F(t){var e=t(yn,yn),n=1;function r(){return n===1?t(yn,yn):n===.5?t(zF,VF):t(Bb(n),Bb(1/n))}return e.exponent=function(i){return arguments.length?(n=+i,r()):n},d_(e)}function RT(){var t=$F(AT());return t.copy=function(){return ET(t,RT()).exponent(t.exponent())},th.apply(t,arguments),t}function WF(){return RT.apply(null,arguments).exponent(.5)}function HF(){var t=0,e=1,n,r,i,s,o=yn,a=!1,u;function f(p){return p==null||isNaN(p=+p)?u:o(i===0?.5:(p=(s(p)-n)*i,a?Math.max(0,Math.min(1,p)):p))}f.domain=function(p){return arguments.length?([t,e]=p,n=s(t=+t),r=s(e=+e),i=n===r?0:1/(r-n),f):[t,e]},f.clamp=function(p){return arguments.length?(a=!!p,f):a},f.interpolator=function(p){return arguments.length?(o=p,f):o};function h(p){return function(g){var _,v;return arguments.length?([_,v]=g,o=p(_,v),f):[o(0),o(1)]}}return f.range=h(xo),f.rangeRound=h(o_),f.unknown=function(p){return arguments.length?(u=p,f):u},function(p){return s=p,n=p(t),r=p(e),i=n===r?0:1/(r-n),f}}function XF(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function IT(){var t=d_(HF()(yn));return t.copy=function(){return XF(t,IT())},NF.apply(t,arguments)}function YF(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const qF=t=>d6(t[t.length-1]);var KF=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(YF);const ZF=qF(KF);function Ya(t,e,n){this.k=t,this.x=e,this.y=n}Ya.prototype={constructor:Ya,scale:function(t){return t===1?this:new Ya(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Ya(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Ya.prototype;function QF(t){return t}function JF(t){if(t==null)return QF;var e,n,r=t.scale[0],i=t.scale[1],s=t.translate[0],o=t.translate[1];return function(a,u){u||(e=n=0);var f=2,h=a.length,p=new Array(h);for(p[0]=(e+=a[0])*r+s,p[1]=(n+=a[1])*i+o;f<h;)p[f]=a[f],++f;return p}}function GF(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}function eL(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(n){return Ub(t,n)})}:Ub(t,e)}function Ub(t,e){var n=e.id,r=e.bbox,i=e.properties==null?{}:e.properties,s=kT(t,e);return n==null&&r==null?{type:"Feature",properties:i,geometry:s}:r==null?{type:"Feature",id:n,properties:i,geometry:s}:{type:"Feature",id:n,bbox:r,properties:i,geometry:s}}function kT(t,e){var n=JF(t.transform),r=t.arcs;function i(h,p){p.length&&p.pop();for(var g=r[h<0?~h:h],_=0,v=g.length;_<v;++_)p.push(n(g[_],_));h<0&&GF(p,v)}function s(h){return n(h)}function o(h){for(var p=[],g=0,_=h.length;g<_;++g)i(h[g],p);return p.length<2&&p.push(p[0]),p}function a(h){for(var p=o(h);p.length<4;)p.push(p[0]);return p}function u(h){return h.map(a)}function f(h){var p=h.type,g;switch(p){case"GeometryCollection":return{type:p,geometries:h.geometries.map(f)};case"Point":g=s(h.coordinates);break;case"MultiPoint":g=h.coordinates.map(s);break;case"LineString":g=o(h.arcs);break;case"MultiLineString":g=h.arcs.map(o);break;case"Polygon":g=u(h.arcs);break;case"MultiPolygon":g=h.arcs.map(u);break;default:return null}return{type:p,coordinates:g}}return f(e)}function tL(t,e){var n={},r={},i={},s=[],o=-1;e.forEach(function(f,h){var p=t.arcs[f<0?~f:f],g;p.length<3&&!p[1][0]&&!p[1][1]&&(g=e[++o],e[o]=f,e[h]=g)}),e.forEach(function(f){var h=a(f),p=h[0],g=h[1],_,v;if(_=i[p])if(delete i[_.end],_.push(f),_.end=g,v=r[g]){delete r[v.start];var w=v===_?_:_.concat(v);r[w.start=_.start]=i[w.end=v.end]=w}else r[_.start]=i[_.end]=_;else if(_=r[g])if(delete r[_.start],_.unshift(f),_.start=p,v=i[p]){delete i[v.end];var x=v===_?_:v.concat(_);r[x.start=v.start]=i[x.end=_.end]=x}else r[_.start]=i[_.end]=_;else _=[f],r[_.start=p]=i[_.end=g]=_});function a(f){var h=t.arcs[f<0?~f:f],p=h[0],g;return t.transform?(g=[0,0],h.forEach(function(_){g[0]+=_[0],g[1]+=_[1]})):g=h[h.length-1],f<0?[g,p]:[p,g]}function u(f,h){for(var p in f){var g=f[p];delete h[g.start],delete g.start,delete g.end,g.forEach(function(_){n[_<0?~_:_]=1}),s.push(g)}}return u(i,r),u(r,i),e.forEach(function(f){n[f<0?~f:f]||s.push([f])}),s}function nL(t){return kT(t,rL.apply(this,arguments))}function rL(t,e,n){var r,i,s;if(arguments.length>1)r=iL(t,e,n);else for(i=0,r=new Array(s=t.arcs.length);i<s;++i)r[i]=i;return{type:"MultiLineString",arcs:tL(t,r)}}function iL(t,e,n){var r=[],i=[],s;function o(p){var g=p<0?~p:p;(i[g]||(i[g]=[])).push({i:p,g:s})}function a(p){p.forEach(o)}function u(p){p.forEach(a)}function f(p){p.forEach(u)}function h(p){switch(s=p,p.type){case"GeometryCollection":p.geometries.forEach(h);break;case"LineString":a(p.arcs);break;case"MultiLineString":case"Polygon":u(p.arcs);break;case"MultiPolygon":f(p.arcs);break}}return h(e),i.forEach(n==null?function(p){r.push(p[0].i)}:function(p){n(p[0].g,p[p.length-1].g)&&r.push(p[0].i)}),r}function sL(t,{title:e,tickSize:n=6,width:r=320,height:i=44+n,marginTop:s=18,marginRight:o=0,marginBottom:a=16+n,marginLeft:u=0,ticks:f=r/64,tickFormat:h,tickValues:p}={}){function g(x,T=256){const A=document.createElement("canvas");A.width=T,A.height=1;const E=A.getContext("2d");for(let R=0;R<T;++R)E.fillStyle=x(R/(T-1)),E.fillRect(R,0,1,1);return A}const _=qO("svg").attr("width",r).attr("height",i).attr("viewBox",[0,0,r,i]).style("overflow","visible").style("display","block");let v=x=>x.selectAll(".tick line").attr("y1",s+a-i),w;if(t.interpolate){const x=Math.min(t.domain().length,t.range().length);w=t.copy().rangeRound(ab(xo(u,r-o),x)),_.append("image").attr("x",u).attr("y",s).attr("width",r-u-o).attr("height",i-s-a).attr("preserveAspectRatio","none").attr("xlink:href",g(t.copy().domain(ab(xo(0,1),x))).toDataURL())}else if(t.interpolator){if(w=Object.assign(t.copy().interpolator(o_(u,r-o)),{range(){return[u,r-o]}}),_.append("image").attr("x",u).attr("y",s).attr("width",r-u-o).attr("height",i-s-a).attr("preserveAspectRatio","none").attr("xlink:href",g(t.interpolator()).toDataURL()),!w.ticks){if(p===void 0){const x=Math.round(f+1);p=Og(x).map(T=>nN(t.domain(),T/(x-1)))}typeof h!="function"&&(h=bl(h===void 0?",f":h))}}else if(t.invertExtent){const x=t.thresholds?t.thresholds():t.quantiles?t.quantiles():t.domain(),T=h===void 0?A=>A:typeof h=="string"?bl(h):h;w=CT().domain([-1,t.range().length-1]).rangeRound([u,r-o]),_.append("g").selectAll("rect").data(t.range()).join("rect").attr("x",A=>w(A-1)).attr("y",s).attr("width",A=>w(A)-w(A-1)).attr("height",i-s-a).attr("fill",A=>A),p=Og(x.length),h=A=>T(x[A],A)}else w=ST().domain(t.domain()).rangeRound([u,r-o]),_.append("g").selectAll("rect").data(t.domain()).join("rect").attr("x",w).attr("y",s).attr("width",Math.max(0,w.bandwidth()-1)).attr("height",i-s-a).attr("fill",t),v=()=>{};return _.append("g").attr("transform",`translate(0,${i-a})`).call(hN(w).ticks(f,typeof h=="string"?h:void 0).tickFormat(typeof h=="function"?h:void 0).tickSize(n).tickValues(p)).call(v).call(x=>x.select(".domain").remove()).call(x=>x.append("text").attr("x",u).attr("y",s+a-i-6).attr("fill","currentColor").attr("text-anchor","start").attr("font-weight","bold").attr("class","title").text(e)),_.node()}const oL=[{name:"Afghanistan",hale:53},{name:"Albania",hale:68.1},{name:"Algeria",hale:65.5},{name:"Andorra",hale:null},{name:"Angola",hale:55.8},{name:"Antigua and Barb.",hale:67},{name:"Argentina",hale:68.4},{name:"Armenia",hale:66.3},{name:"Australia",hale:73},{name:"Austria",hale:72.4},{name:"Azerbaijan",hale:64.9},{name:"Bahamas",hale:66.8},{name:"Bahrain",hale:68.1},{name:"Bangladesh",hale:63.3},{name:"Barbados",hale:67},{name:"Belarus",hale:65.5},{name:"Belgium",hale:71.6},{name:"Belize",hale:62.5},{name:"Benin",hale:53.5},{name:"Bhutan",hale:60.7},{name:"Bolivia",hale:63},{name:"Bosnia and Herz.",hale:67.2},{name:"Botswana",hale:57.5},{name:"Brazil",hale:66},{name:"Brunei",hale:67.9},{name:"Bulgaria",hale:66.4},{name:"Burkina Faso",hale:52.9},{name:"Burundi",hale:52.6},{name:"Cabo Verde",hale:64.5},{name:"Cambodia",hale:60.8},{name:"Cameroon",hale:51.1},{name:"Canada",hale:73.2},{name:"Central African Rep.",hale:44.9},{name:"Chad",hale:47.2},{name:"Chile",hale:69.7},{name:"China",hale:68.7},{name:"Colombia",hale:67.1},{name:"Comoros",hale:56.6},{name:"Congo",hale:56.7},{name:"Cook Is.",hale:null},{name:"Costa Rica",hale:70.9},{name:"Côte d'Ivoire",hale:48.3},{name:"Croatia",hale:69},{name:"Cuba",hale:69.9},{name:"Cyprus",hale:73.3},{name:"Czechia",hale:69.3},{name:"North Korea",hale:64.6},{name:"Dem. Rep. Congo",hale:52.5},{name:"Denmark",hale:71.8},{name:"Djibouti",hale:56.6},{name:"Dominica",hale:null},{name:"Dominican Rep.",hale:65.2},{name:"Ecuador",hale:67.9},{name:"Egypt",hale:61.1},{name:"El Salvador",hale:65.5},{name:"Eq. Guinea",hale:53.8},{name:"Eritrea",hale:57.4},{name:"Estonia",hale:68.2},{name:"Ethiopia",hale:57.5},{name:"Fiji",hale:61.3},{name:"Finland",hale:71.7},{name:"France",hale:73.4},{name:"Gabon",hale:58.7},{name:"Gambia",hale:54.4},{name:"Georgia",hale:64.9},{name:"Germany",hale:71.6},{name:"Ghana",hale:56.4},{name:"Greece",hale:72},{name:"Grenada",hale:64.7},{name:"Guatemala",hale:64.2},{name:"Guinea",hale:52.2},{name:"Guinea-Bissau",hale:51.7},{name:"Guyana",hale:58.3},{name:"Haiti",hale:55.3},{name:"Honduras",hale:66.8},{name:"Hungary",hale:66.8},{name:"Iceland",hale:73},{name:"India",hale:59.3},{name:"Indonesia",hale:61.7},{name:"Iran",hale:65.4},{name:"Iraq",hale:59},{name:"Ireland",hale:72.1},{name:"Israel",hale:72.9},{name:"Italy",hale:73.2},{name:"Jamaica",hale:66.9},{name:"Japan",hale:74.8},{name:"Jordan",hale:66.4},{name:"Kazakhstan",hale:63.4},{name:"Kenya",hale:58.9},{name:"Kiribati",hale:57.8},{name:"Kuwait",hale:66.3},{name:"Kyrgyzstan",hale:63.5},{name:"Laos",hale:57.9},{name:"Latvia",hale:66.2},{name:"Lebanon",hale:66.1},{name:"Lesotho",hale:46.6},{name:"Liberia",hale:54.5},{name:"Libya",hale:62.3},{name:"Lithuania",hale:66.1},{name:"Luxembourg",hale:72.6},{name:"Madagascar",hale:58.3},{name:"Malawi",hale:56.2},{name:"Malaysia",hale:66.6},{name:"Maldives",hale:69.8},{name:"Mali",hale:50.7},{name:"Malta",hale:72.2},{name:"Marshall Is.",hale:null},{name:"Mauritania",hale:56.4},{name:"Mauritius",hale:65.8},{name:"Mexico",hale:67.7},{name:"Micronesia",hale:61.1},{name:"Monaco",hale:null},{name:"Mongolia",hale:61.9},{name:"Montenegro",hale:68.1},{name:"Morocco",hale:65.3},{name:"Mozambique",hale:52.2},{name:"Myanmar",hale:58.4},{name:"Namibia",hale:55.9},{name:"Nauru",hale:null},{name:"Nepal",hale:61.3},{name:"Netherlands",hale:72.1},{name:"New Zealand",hale:72.8},{name:"Nicaragua",hale:66.9},{name:"Niger",hale:52.5},{name:"Nigeria",hale:48.9},{name:"Niue",hale:null},{name:"Norway",hale:73},{name:"Oman",hale:65.6},{name:"Pakistan",hale:57.7},{name:"Palau",hale:null},{name:"Panama",hale:69.4},{name:"Papua New Guinea",hale:58},{name:"Paraguay",hale:65.3},{name:"Peru",hale:67.5},{name:"Philippines",hale:61.7},{name:"Poland",hale:68.5},{name:"Portugal",hale:72},{name:"Qatar",hale:68.6},{name:"South Korea",hale:73},{name:"Moldova",hale:63.6},{name:"Romania",hale:66.6},{name:"Russia",hale:63.5},{name:"Rwanda",hale:59.9},{name:"St. Kitts and Nevis",hale:null},{name:"Saint Lucia",hale:66.4},{name:"St. Vin. and Gren.",hale:63.4},{name:"Samoa",hale:66},{name:"San Marino",hale:null},{name:"São Tomé and Principe",hale:60.7},{name:"Saudi Arabia",hale:65.7},{name:"Senegal",hale:58.8},{name:"Serbia",hale:67.4},{name:"Seychelles",hale:65.7},{name:"Sierra Leone",hale:47.6},{name:"Singapore",hale:76.2},{name:"Slovakia",hale:68.3},{name:"Slovenia",hale:70.5},{name:"Solomon Is.",hale:61.9},{name:"Somalia",hale:50},{name:"South Africa",hale:55.7},{name:"S. Sudan",hale:50.6},{name:"Spain",hale:73.8},{name:"Sri Lanka",hale:66.8},{name:"Sudan",hale:55.7},{name:"Suriname",hale:63.2},{name:"eSwatini",hale:50.2},{name:"Sweden",hale:72.4},{name:"Switzerland",hale:73.5},{name:"Syria",hale:55.8},{name:"Tajikistan",hale:63.5},{name:"Thailand",hale:66.8},{name:"Macedonia",hale:67.1},{name:"Timor-Leste",hale:59.2},{name:"Togo",hale:53.9},{name:"Tonga",hale:64.3},{name:"Trinidad and Tobago",hale:63.3},{name:"Tunisia",hale:66.3},{name:"Turkey",hale:66},{name:"Turkmenistan",hale:61.4},{name:"Tuvalu",hale:null},{name:"Uganda",hale:54.9},{name:"Ukraine",hale:64},{name:"United Arab Emirates",hale:66.7},{name:"United Kingdom",hale:71.9},{name:"Tanzania",hale:56.5},{name:"United States of America",hale:68.5},{name:"Uruguay",hale:68.8},{name:"Uzbekistan",hale:64.5},{name:"Vanuatu",hale:62.7},{name:"Venezuela",hale:66.1},{name:"Vietnam",hale:67.5},{name:"Yemen",hale:55.1},{name:"Zambia",hale:54.3},{name:"Zimbabwe",hale:54.4}];function aL(){const t=P.useRef(null),[e,n]=P.useState(null),[r,i]=P.useState(!0),[s,o]=P.useState(null);return P.useEffect(()=>{i(!0),BD("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-50m.json").then(a=>{n(a),i(!1)}).catch(a=>{i(!1),o("Failed to load world data: "+a.message)})},[]),P.useEffect(()=>{if(!e)return;const a=eL(e,e.objects.countries),u=nL(e,e.objects.countries,(A,E)=>A!==E),f=928,h=46,p=f/2+h,g=xT().fitExtent([[2,h+2],[f-2,p]],{type:"Sphere"}),_=vT(g),v=new Map(oL.map(A=>[A.name,A.hale])),w=Array.from(v.values()).filter(A=>A!==null),x=IT(C3(w),ZF);go(t.current).selectAll("svg").remove();const T=go(t.current).append("svg").attr("width",f).attr("height",p).attr("viewBox",[0,0,f,p]).attr("style","max-width: 100%; height: auto;");T.append("g").attr("transform","translate(20,0)").append(()=>sL(x,{title:"Healthy life expectancy (years)",width:260})),T.append("path").datum({type:"Sphere"}).attr("fill","white").attr("stroke","currentColor").attr("d",_),T.append("g").selectAll("path").data(a.features).join("path").attr("fill",A=>x(v.get(A.properties?.name)||0)).attr("d",_).append("title").text(A=>`${A.properties?.name}
${v.get(A.properties?.name)}`),T.append("path").datum(u).attr("fill","none").attr("stroke","white").attr("d",_)},[e]),s?C.jsx("div",{className:"life-expectancy-error",children:s}):r?C.jsx("div",{className:"life-expectancy-loading",children:C.jsx("div",{className:"flex flex-col items-center",children:C.jsxs("svg",{className:"animate-spin h-10 w-10 mb-4 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[C.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),C.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})}):C.jsx("div",{ref:t,className:"life-expectancy-container"})}function lL(){return C.jsx(jr,{children:C.jsx(aL,{})})}function cL(){const[t,e]=P.useState(null),[n,r]=P.useState([]),[i,s]=P.useState(!0),[o,a]=P.useState(!1),[u,f]=P.useState(window.innerWidth),[h,p]=P.useState(window.innerHeight);P.useEffect(()=>{const _=()=>{f(window.innerWidth),p(window.innerHeight)};return window.addEventListener("resize",_),()=>{window.removeEventListener("resize",_)}},[]);const g=P.useRef(null);return P.useEffect(()=>{s(!0),Promise.all([fetch("https://raw.githubusercontent.com/asabahebwa/geo_mapping/master/src/world_countries.json"),fetch("https://raw.githubusercontent.com/asabahebwa/geo_mapping/master/src/world_cup_geo.json")]).then(_=>Promise.all(_.map(v=>v.json()))).then(([_,v])=>{e(_),r(v),s(!1)}).catch(_=>{a(_)})},[]),P.useEffect(()=>{if(!t||!n)return;go(g.current).selectAll("svg").remove();const _=928,v=46,w=_/2+v,x=xT().fitExtent([[2,v+2],[_-2,w]],{type:"Sphere"}),T=vT(x);go(g.current).selectAll("svg").remove();const A=go(g.current).append("svg").attr("width",_).attr("height",w).attr("viewBox",[0,0,_,w]).attr("style","max-width: 100%; height: auto;");A.append("path").datum({type:"Sphere"}).attr("fill","#f8f9fa").attr("stroke","#000").attr("stroke-width",1).attr("d",T),A.selectAll("path").data(t.features).enter().append("path").attr("d",T).style("fill","rgb(9, 157, 217)").style("stroke","black").style("stroke-width",.5);const E=Array.from(q4(n,M=>({attendance:iN(M,L=>+L.attendance),x:q1(M,L=>x([+L.long,+L.lat])?.[0]),y:q1(M,L=>x([+L.long,+L.lat])?.[1]),country:M[0].home}),M=>M.year),([M,L])=>({key:M,value:L})),R=C3(E,M=>M.value.attendance),k=WF().domain(R).range([0,8]);A.append("g").attr("class","bubble").selectAll("circle").data(E.sort(function(M,L){return L.value.attendance-M.value.attendance})).enter().append("circle").attr("fill","rgb(247, 148, 42)").attr("cx",M=>M.value.x||0).attr("cy",M=>M.value.y||0).attr("r",M=>k(M.value.attendance)).attr("stroke","black").attr("stroke-width",.7).attr("opacity",.7).append("title").text(M=>{const L=bl(",")(M.value.attendance);return`${M.key} - ${M.value.country}
Attendance: ${L}`})},[t,n]),i?C.jsx("div",{className:"worldcup-loading",children:C.jsx("div",{className:"flex flex-col items-center",children:C.jsxs("svg",{className:"animate-spin h-10 w-10 mb-4 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[C.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),C.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})}):o?C.jsx("div",{className:"worldcup-error",children:"Error loading data. Please try again later."}):C.jsx("div",{ref:g,className:"worldcup-container"})}function uL(){return C.jsx(jr,{children:C.jsx(cL,{})})}const fL="modulepreload",hL=function(t){return"/"+t},jb={},dL=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let u=function(f){return Promise.all(f.map(h=>Promise.resolve(h).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=u(n.map(f=>{if(f=hL(f),f in jb)return;jb[f]=!0;const h=f.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${p}`))return;const g=document.createElement("link");if(g.rel=h?"stylesheet":fL,h||(g.as="script"),g.crossOrigin="",g.href=f,a&&g.setAttribute("nonce",a),document.head.appendChild(g),h)return new Promise((_,v)=>{g.addEventListener("load",_),g.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${f}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},pL=P.createContext(null);function gL(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function Jn(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Jn(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!Jn(t[i],e[i]))return!1;return!0}return!1}function zb(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function Vb(t,e){const n=e.viewState||e,r={};if("longitude"in n&&"latitude"in n&&(n.longitude!==t.center.lng||n.latitude!==t.center.lat)){const i=t.center.constructor;r.center=new i(n.longitude,n.latitude)}return"zoom"in n&&n.zoom!==t.zoom&&(r.zoom=n.zoom),"bearing"in n&&n.bearing!==t.bearing&&(r.bearing=n.bearing),"pitch"in n&&n.pitch!==t.pitch&&(r.pitch=n.pitch),n.padding&&t.padding&&!Jn(n.padding,t.padding)&&(r.padding=n.padding),r}const mL=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function $b(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const o of mL)o in s&&(i[o]=s[o])}return i||r});return{...t,layers:n}}const Wb={version:8,sources:{},layers:[]},Hb={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Xb={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Yb={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},_L=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],yL=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Co{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=i=>{const s=this.props[Yb[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onCameraEvent=i=>{if(this._internalUpdate)return;i.viewState=this._propsedCameraUpdate||zb(this._map.transform);const s=this.props[Xb[i.type]];s&&s(i)},this._onCameraUpdate=i=>this._internalUpdate?i:(this._propsedCameraUpdate=zb(i),Vb(i,this.props)),this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[Hb[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n),i=this._updateSize(e),s=this._updateViewState(e);this._updateStyle(e,n),this._updateStyleComponents(e),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=Co.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const o=i._resizeObserver;o&&(o.disconnect(),o.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:a}=e;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a)),i.isStyleLoaded()?i.fire("load"):i.once("style.load",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=Wb}=n,i={...n,...n.initialViewState,container:e,style:$b(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const a=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=a,n.gl)}const o=new this._MapClass(i);s.padding&&o.setPadding(s.padding),n.cursor&&(o.getCanvas().style.cursor=n.cursor),o.transformCameraUpdate=this._onCameraUpdate,o.on("style.load",()=>{this._styleComponents={light:o.getLight(),sky:o.getSky(),projection:o.getProjection?.(),terrain:o.getTerrain()},this._updateStyleComponents(this.props)}),o.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const a in Hb)o.on(a,this._onPointerEvent);for(const a in Xb)o.on(a,this._onCameraEvent);for(const a in Yb)o.on(a,this._onEvent);this._map=o}recycle(){this.map.getContainer().querySelector("[mapboxgl-children]")?.remove(),Co.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e){const n=this._map,r=n.transform;if(!n.isMoving()){const s=Vb(r,e);if(Object.keys(s).length>0)return this._internalUpdate=!0,n.jumpTo(s),this._internalUpdate=!1,!0}return!1}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of _L)s in e&&!Jn(e[s],n[s])&&(i=!0,r[`set${s[0].toUpperCase()}${s.slice(1)}`]?.call(r,e[s]));return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=Wb,styleDiffing:i=!0}=e,s={diff:i};"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle($b(r),s)}}_updateStyleComponents({light:e,projection:n,sky:r,terrain:i}){const s=this._map,o=this._styleComponents;s.style._loaded&&(e&&!Jn(e,o.light)&&(o.light=e,s.setLight(e)),n&&!Jn(n,o.projection)&&n!==o.projection?.type&&(o.projection=typeof n=="string"?{type:n}:n,s.setProjection?.(o.projection)),r&&!Jn(r,o.sky)&&(o.sky=r,s.setSky(r)),i!==void 0&&!Jn(i,o.terrain)&&(!i||s.getSource(i.source))&&(o.terrain=i,s.setTerrain(i)))}_updateHandlers(e,n){const r=this._map;for(const i of yL){const s=e[i]??!0,o=n[i]??!0;Jn(s,o)||(s?r[i].enable(s):r[i].disable())}}_queryRenderedFeatures(e){const n=this._map,{interactiveLayerIds:r=[]}=this.props;try{return n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(e){const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const i=e.type,s=this._hoveredFeatures?.length>0,o=this._queryRenderedFeatures(e.point),a=o.length>0;!a&&s&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=o,a&&!s&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=i}else this._hoveredFeatures=null}}Co.savedMaps=[];const vL=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function bL(t){if(!t)return null;const e=t.map,n={getMap:()=>e};for(const r of wL(e))!(r in n)&&!vL.includes(r)&&(n[r]=e[r].bind(e));return n}function wL(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const xL=typeof document<"u"?P.useLayoutEffect:P.useEffect;function TL(t,e){const{RTLTextPlugin:n,maxParallelImageRequests:r,workerCount:i,workerUrl:s}=e;if(n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:o,lazy:a=!0}=typeof n=="string"?{pluginUrl:n}:n;t.setRTLTextPlugin(o,u=>{u&&console.error(u)},a)}r!==void 0&&t.setMaxParallelImageRequests(r),i!==void 0&&t.setWorkerCount(i),s!==void 0&&t.setWorkerUrl(s)}const nh=P.createContext(null);function SL(t,e){const n=P.useContext(pL),[r,i]=P.useState(null),s=P.useRef(),{current:o}=P.useRef({mapLib:null,map:null});P.useEffect(()=>{const f=t.mapLib;let h=!0,p;return Promise.resolve(f||dL(()=>import("./maplibre-gl-DhL22Hr2.js").then(g=>g.m),[])).then(g=>{if(!h)return;if(!g)throw new Error("Invalid mapLib");const _="Map"in g?g:g.default;if(!_.Map)throw new Error("Invalid mapLib");TL(_,t),t.reuseMaps&&(p=Co.reuse(t,s.current)),p||(p=new Co(_.Map,t,s.current)),o.map=bL(p),o.mapLib=_,i(p),n?.onMapMount(o.map,t.id)}).catch(g=>{const{onError:_}=t;_?_({type:"error",target:null,originalEvent:null,error:g}):console.error(g)}),()=>{h=!1,p&&(n?.onMapUnmount(t.id),t.reuseMaps?p.recycle():p.destroy())}},[]),xL(()=>{r&&r.setProps(t)}),P.useImperativeHandle(e,()=>o.map,[r]);const a=P.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),u={height:"100%"};return P.createElement("div",{id:t.id,ref:s,style:a},r&&P.createElement(nh.Provider,{value:o},P.createElement("div",{"mapboxgl-children":"",style:u},t.children)))}const PT=P.forwardRef(SL),EL=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function zr(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!EL.test(r)?n[r]=`${i}px`:n[r]=i}}function MT(t,e){if(t===e)return null;const n=qb(t),r=qb(e),i=[];for(const s of r)n.has(s)||i.push(s);for(const s of n)r.has(s)||i.push(s);return i.length===0?null:i}function qb(t){return new Set(t?t.trim().split(/\s+/):[])}P.memo(P.forwardRef((t,e)=>{const{map:n,mapLib:r}=P.useContext(nh),i=P.useRef({props:t}),s=P.useMemo(()=>{let T=!1;P.Children.forEach(t.children,R=>{R&&(T=!0)});const A={...t,element:T?document.createElement("div"):void 0},E=new r.Marker(A);return E.setLngLat([t.longitude,t.latitude]),E.getElement().addEventListener("click",R=>{i.current.props.onClick?.({type:"click",target:E,originalEvent:R})}),E.on("dragstart",R=>{const k=R;k.lngLat=s.getLngLat(),i.current.props.onDragStart?.(k)}),E.on("drag",R=>{const k=R;k.lngLat=s.getLngLat(),i.current.props.onDrag?.(k)}),E.on("dragend",R=>{const k=R;k.lngLat=s.getLngLat(),i.current.props.onDragEnd?.(k)}),E},[]);P.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:o,latitude:a,offset:u,style:f,draggable:h=!1,popup:p=null,rotation:g=0,rotationAlignment:_="auto",pitchAlignment:v="auto"}=t;P.useEffect(()=>{zr(s.getElement(),f)},[f]),P.useImperativeHandle(e,()=>s,[]);const w=i.current.props;(s.getLngLat().lng!==o||s.getLngLat().lat!==a)&&s.setLngLat([o,a]),u&&!gL(s.getOffset(),u)&&s.setOffset(u),s.isDraggable()!==h&&s.setDraggable(h),s.getRotation()!==g&&s.setRotation(g),s.getRotationAlignment()!==_&&s.setRotationAlignment(_),s.getPitchAlignment()!==v&&s.setPitchAlignment(v),s.getPopup()!==p&&s.setPopup(p);const x=MT(w.className,t.className);if(x)for(const T of x)s.toggleClassName(T);return i.current.props=t,Gm.createPortal(t.children,s.getElement())}));P.memo(P.forwardRef((t,e)=>{const{map:n,mapLib:r}=P.useContext(nh),i=P.useMemo(()=>document.createElement("div"),[]),s=P.useRef({props:t}),o=P.useMemo(()=>{const a={...t},u=new r.Popup(a);return u.setLngLat([t.longitude,t.latitude]),u.once("open",f=>{s.current.props.onOpen?.(f)}),u},[]);if(P.useEffect(()=>{const a=u=>{s.current.props.onClose?.(u)};return o.on("close",a),o.setDOMContent(i).addTo(n.getMap()),()=>{o.off("close",a),o.isOpen()&&o.remove()}},[]),P.useEffect(()=>{zr(o.getElement(),t.style)},[t.style]),P.useImperativeHandle(e,()=>o,[]),o.isOpen()){const a=s.current.props;(o.getLngLat().lng!==t.longitude||o.getLngLat().lat!==t.latitude)&&o.setLngLat([t.longitude,t.latitude]),t.offset&&!Jn(a.offset,t.offset)&&o.setOffset(t.offset),(a.anchor!==t.anchor||a.maxWidth!==t.maxWidth)&&(o.options.anchor=t.anchor,o.setMaxWidth(t.maxWidth));const u=MT(a.className,t.className);if(u)for(const f of u)o.toggleClassName(f);s.current.props=t}return Gm.createPortal(t.children,i)}));function ps(t,e,n,r){const i=P.useContext(nh),s=P.useMemo(()=>t(i),[]);return P.useEffect(()=>{const o=e,a=null,u=typeof e=="function"?e:null,{map:f}=i;return f.hasControl(s)||(f.addControl(s,o?.position),a&&a(i)),()=>{u&&u(i),f.hasControl(s)&&f.removeControl(s)}},[]),s}function AL(t){const e=ps(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return P.useEffect(()=>{zr(e._container,t.style)},[t.style]),null}P.memo(AL);function CL(t){const e=ps(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return P.useEffect(()=>{zr(e._controlContainer,t.style)},[t.style]),null}P.memo(CL);function RL(t,e){const n=P.useRef({props:t}),r=ps(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=()=>{s._container.hasChildNodes()||o()},s.on("geolocate",a=>{n.current.props.onGeolocate?.(a)}),s.on("error",a=>{n.current.props.onError?.(a)}),s.on("outofmaxbounds",a=>{n.current.props.onOutOfMaxBounds?.(a)}),s.on("trackuserlocationstart",a=>{n.current.props.onTrackUserLocationStart?.(a)}),s.on("trackuserlocationend",a=>{n.current.props.onTrackUserLocationEnd?.(a)}),s},{position:t.position});return n.current.props=t,P.useImperativeHandle(e,()=>r,[]),P.useEffect(()=>{zr(r._container,t.style)},[t.style]),null}P.memo(P.forwardRef(RL));function IL(t){const e=ps(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return P.useEffect(()=>{zr(e._container,t.style)},[t.style]),null}P.memo(IL);function kL(t){const e=ps(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=P.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),P.useEffect(()=>{zr(e._container,i)},[i]),null}P.memo(kL);function PL(t){const e=ps(({mapLib:n})=>new n.TerrainControl(t),{position:t.position});return P.useEffect(()=>{zr(e._container,t.style)},[t.style]),null}P.memo(PL);function ML(t){const e=ps(({mapLib:n})=>new n.LogoControl(t),{position:t.position});return P.useEffect(()=>{zr(e._container,t.style)},[t.style]),null}P.memo(ML);function _f(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const p_=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),Kb=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Kb&&parseFloat(Kb[1]);const Zb=globalThis,Qb=globalThis.process||{},NL=globalThis.navigator||{};function NT(t){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;const n=typeof navigator<"u"&&navigator.userAgent;return!!(n&&n.indexOf("Electron")>=0)}function gs(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||NT()}function OL(t){return gs()?NT()?"Electron":(NL.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const OT="4.1.0";function DL(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class FL{constructor(e,n,r="sessionStorage"){this.storage=DL(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function LL(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function BL(t,e=8){const n=Math.max(e-t.length,0);return`${" ".repeat(n)}${t}`}var yf;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(yf||(yf={}));const UL=10;function Jb(t){return typeof t!="string"?t:(t=t.toUpperCase(),yf[t]||yf.WHITE)}function jL(t,e,n){return!gs&&typeof t=="string"&&(e&&(t=`\x1B[${Jb(e)}m${t}\x1B[39m`),n&&(t=`\x1B[${Jb(n)+UL}m${t}\x1B[49m`)),t}function zL(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const o=i[s];typeof o=="function"&&(e.find(a=>s===a)||(i[s]=o.bind(t)))}}function g_(t,e){if(!t)throw new Error("Assertion failed")}function Ys(){let t;if(gs()&&Zb.performance)t=Zb?.performance?.now?.();else if("hrtime"in Qb){const e=Qb?.hrtime?.();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}const qs={debug:gs()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},VL={enabled:!0,level:0};function Ks(){}const Gb={},ew={once:!0};class Ul{constructor({id:e}={id:""}){this.VERSION=OT,this._startTs=Ys(),this._deltaTs=Ys(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new FL(`__probe-${this.id}__`,VL),this.timeStamp(`${this.id} started`),zL(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Ys()-this._startTs).toPrecision(10))}getDelta(){return Number((Ys()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){if(!e)throw new Error(n||"Assertion failed")}warn(e){return this._getLogFunction(0,e,qs.warn,arguments,ew)}error(e){return this._getLogFunction(0,e,qs.error,arguments)}deprecated(e,n){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${n}\` instead`)}removed(e,n){return this.error(`\`${e}\` has been removed. Use \`${n}\` instead`)}probe(e,n){return this._getLogFunction(e,n,qs.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,qs.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,qs.debug||qs.info,arguments,ew)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Ks,r&&[r],{tag:WL(n)}):Ks}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Ks)}group(e,n,r={collapsed:!1}){const i=tw({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n,r={}){return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ks)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=DT(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=tw({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,g_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Ys();const o=s.tag||s.message;if(s.once&&o)if(!Gb[o])Gb[o]=Ys();else return Ks;return n=$L(this.id,s.message,s),r.bind(console,n,...s.args)}return Ks}}Ul.VERSION=OT;function DT(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return g_(Number.isFinite(e)&&e>=0),e}function tw(t){const{logLevel:e,message:n}=t;t.logLevel=DT(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return g_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function $L(t,e,n){if(typeof e=="string"){const r=n.time?BL(LL(n.total)):"";e=n.time?`${t}: ${r}  ${e}`:`${t}: ${e}`,e=jL(e,n.color,n.background)}return e}function WL(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Ip="4.3.3",HL=Ip[0]>="0"&&Ip[0]<="9"?`v${Ip}`:"";function XL(){const t=new Ul({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=t,globalThis.loaders.version=HL,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=t,t}const YL=XL();function qL(t,e){return FT(t||{},e)}function FT(t,e,n=0){if(n>3)return e;const r={...t};for(const[i,s]of Object.entries(e))s&&typeof s=="object"&&!Array.isArray(s)?r[i]=FT(r[i]||{},e[i],n+1):r[i]=e[i];return r}const KL="latest";function ZL(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}const QL=ZL();function Si(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Gi=typeof process!="object"||String(process)!=="[object process]"||process.browser,JL=typeof window<"u"&&typeof window.orientation<"u",nw=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);nw&&parseFloat(nw[1]);class GL{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,n){this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){Si(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Si(this.isRunning),this.isRunning=!1,this._reject(e)}}class kp{terminate(){}}const Pp=new Map;function e5(t){Si(t.source&&!t.url||!t.source&&t.url);let e=Pp.get(t.source||t.url);return e||(t.url&&(e=t5(t.url),Pp.set(t.url,e)),t.source&&(e=LT(t.source),Pp.set(t.source,e))),Si(e),e}function t5(t){if(!t.startsWith("http"))return t;const e=n5(t);return LT(e)}function LT(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function n5(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function BT(t,e=!0,n){const r=n||new Set;if(t){if(rw(t))r.add(t);else if(rw(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)BT(t[i],e,r)}}return n===void 0?Array.from(r):[]}function rw(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const Mp=()=>{};class rm{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&Gi||typeof kp<"u"&&!Gi}constructor(e){const{name:n,source:r,url:i}=e;Si(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=Mp,this.onError=s=>console.log(s),this.worker=Gi?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Mp,this.onError=Mp,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||BT(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+=`worker ${this.name} from ${this.url}. `,e.message&&(n+=`${e.message} in `),e.lineno&&(n+=`:${e.lineno}:${e.colno}`),new Error(n)}_createBrowserWorker(){this._loadableURL=e5({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new kp(r,{eval:!1})}else if(this.source)e=new kp(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class r5{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return rm.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(i,s,o)=>i.done(o),r=(i,s)=>i.error(s)){const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new GL(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!Gi||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new rm({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return JL?this.maxMobileConcurrency:this.maxConcurrency}}const i5={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class pi{props;workerPools=new Map;static _workerFarm;static isSupported(){return rm.isSupported()}static getWorkerFarm(e={}){return pi._workerFarm=pi._workerFarm||new pi({}),pi._workerFarm.setProps(e),pi._workerFarm}constructor(e){this.props={...i5},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new r5({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function s5(t,e={}){const n=e[t.id]||{},r=Gi?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(Gi?i=`modules/${t.module}/dist/${r}`:i=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let s=t.version;s==="latest"&&(s=KL);const o=s?`@${s}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${o}/dist/${r}`}return Si(i),i}function o5(t,e=QL){Si(t,"no worker provided");const n=t.version;return!(!e||!n)}function a5(t,e){return!pi.isSupported()||!Gi&&!e?._nodeWorkers?!1:t.worker&&e?.worker}async function l5(t,e,n,r,i){const s=t.id,o=s5(t,n),u=pi.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const f=await u.startJob("process-on-worker",c5.bind(null,i));return f.postMessage("process",{input:e,options:n,context:r}),await(await f.result).result}async function c5(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const u=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:u})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}function u5(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function f5(...t){return h5(t)}function h5(t){const e=t.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),n=e.reduce((s,o)=>s+o.byteLength,0),r=new Uint8Array(n);let i=0;for(const s of e)r.set(s,i),i+=s.byteLength;return r.buffer}async function d5(t){const e=[];for await(const n of t)e.push(n);return f5(...e)}function iw(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class sw{constructor(e,n){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=iw(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(iw()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class rh{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,n="count"){return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof sw?i=e:i=new sw(n,r),this.stats[n]=i),i}}let p5="";const ow={};function g5(t){for(const e in ow)if(t.startsWith(e)){const n=ow[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${p5}${t}`),t}function m5(t){return t&&typeof t=="object"&&t.isBuffer}function UT(t){if(m5(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function jT(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function _5(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const y5=t=>typeof t=="boolean",sl=t=>typeof t=="function",jl=t=>t!==null&&typeof t=="object",aw=t=>jl(t)&&t.constructor==={}.constructor,v5=t=>!!t&&typeof t[Symbol.iterator]=="function",b5=t=>t&&typeof t[Symbol.asyncIterator]=="function",ms=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,_s=t=>typeof Blob<"u"&&t instanceof Blob,w5=t=>t&&typeof t=="object"&&t.isBuffer,x5=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||jl(t)&&sl(t.tee)&&sl(t.cancel)&&sl(t.getReader),T5=t=>jl(t)&&sl(t.read)&&sl(t.pipe)&&y5(t.readable),zT=t=>x5(t)||T5(t);class S5 extends Error{constructor(e,n){super(e),this.reason=n.reason,this.url=n.url,this.response=n.response}reason;url;response}const E5=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,A5=/^([-\w.]+\/[-\w.+]+)/;function lw(t,e){return t.toLowerCase()===e.toLowerCase()}function C5(t){const e=A5.exec(t);return e?e[1]:t}function cw(t){const e=E5.exec(t);return e?e[1]:""}const VT=/\?.*/;function R5(t){const e=t.match(VT);return e&&e[0]}function m_(t){return t.replace(VT,"")}function I5(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function ih(t){return ms(t)?t.url:_s(t)?t.name||"":typeof t=="string"?t:""}function __(t){if(ms(t)){const e=t,n=e.headers.get("content-type")||"",r=m_(e.url);return C5(n)||cw(r)}return _s(t)?t.type||"":typeof t=="string"?cw(t):""}function k5(t){return ms(t)?t.headers["content-length"]||-1:_s(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function $T(t){if(ms(t))return t;const e={},n=k5(t);n>=0&&(e["content-length"]=String(n));const r=ih(t),i=__(t);i&&(e["content-type"]=i);const s=await N5(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function P5(t){if(!t.ok)throw await M5(t)}async function M5(t){const e=I5(t.url);let n=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;n=n.length>100?`${n.slice(0,100)}...`:n;const r={reason:t.statusText,url:t.url,response:t};try{const i=t.headers.get("Content-Type");r.reason=!t.bodyUsed&&i?.includes("application/json")?await t.json():await t.text()}catch{}return new S5(n,r)}async function N5(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>r(s?.target?.result),i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5);return`data:base64,${O5(n)}`}return null}function O5(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}function D5(t){return!F5(t)&&!L5(t)}function F5(t){return t.startsWith("http:")||t.startsWith("https:")}function L5(t){return t.startsWith("data:")}async function uw(t,e){if(typeof t=="string"){const n=g5(t);return D5(n)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(n,e):await fetch(n,e)}return await $T(t)}const fw=new Ul({id:"loaders.gl"});class B5{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class U5{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const WT={fetch:null,mimeType:void 0,nothrow:!1,log:new U5,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:p_,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},j5={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function HT(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function XT(){const t=HT();return t.globalOptions=t.globalOptions||{...WT},t.globalOptions}function z5(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],V5(t,n),W5(e,t,r)}function V5(t,e){hw(t,null,WT,j5,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};hw(r,n.id,i,s,e)}}function hw(t,e,n,r,i){const s=e||"Top level",o=e?`${e}.`:"";for(const a in t){const u=!e&&jl(t[a]),f=a==="baseUri"&&!e,h=a==="workerUrl"&&e;if(!(a in n)&&!f&&!h){if(a in r)fw.warn(`${s} loader option '${o}${a}' no longer supported, use '${r[a]}'`)();else if(!u){const p=$5(a,i);fw.warn(`${s} loader option '${o}${a}' not recognized. ${p}`)()}}}}function $5(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return`Did you mean '${i.id}.${s}'?`;const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||`Did you mean '${i.id}.${s}'?`)}return r}function W5(t,e,n){const i={...t.options||{}};return H5(i,n),i.log===null&&(i.log=new B5),dw(i,XT()),dw(i,e),i}function dw(t,e){for(const n in e)if(n in e){const r=e[n];aw(r)&&aw(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function H5(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function y_(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t?.extensions)):!1}function v_(t){_f(t,"null loader"),_f(y_(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t?.parseTextSync||t?.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const YT=()=>{const t=HT();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function X5(t){const e=YT();t=Array.isArray(t)?t:[t];for(const n of t){const r=v_(n);e.find(i=>r===i)||e.unshift(r)}}function Y5(){return YT()}const q5=/\.([^.]+)$/;async function K5(t,e=[],n,r){if(!qT(t))return null;let i=pw(t,e,{...n,nothrow:!0},r);if(i)return i;if(_s(t)&&(t=await t.slice(0,10).arrayBuffer(),i=pw(t,e,n,r)),!i&&!n?.nothrow)throw new Error(KT(t));return i}function pw(t,e=[],n,r){if(!qT(t))return null;if(e&&!Array.isArray(e))return v_(e);let i=[];e&&(i=i.concat(e)),n?.ignoreRegisteredLoaders||i.push(...Y5()),Q5(i);const s=Z5(t,i,n,r);if(!s&&!n?.nothrow)throw new Error(KT(t));return s}function Z5(t,e,n,r){const i=ih(t),s=__(t),o=m_(i)||r?.url;let a=null,u="";return n?.mimeType&&(a=Np(e,n?.mimeType),u=`match forced by supplied MIME type ${n?.mimeType}`),a=a||J5(e,o),u=u||(a?`matched url ${o}`:""),a=a||Np(e,s),u=u||(a?`matched MIME type ${s}`:""),a=a||eB(e,t),u=u||(a?`matched initial data ${ZT(t)}`:""),n?.fallbackMimeType&&(a=a||Np(e,n?.fallbackMimeType),u=u||(a?`matched fallback MIME type ${s}`:"")),u&&YL.log(1,`selectLoader selected ${a?.name}: ${u}.`),a}function qT(t){return!(t instanceof Response&&t.status===204)}function KT(t){const e=ih(t),n=__(t);let r="No valid loader found (";r+=e?`${jT(e)}, `:"no url provided, ",r+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const i=t?ZT(t):"";return r+=i?` first bytes: "${i}"`:"first bytes: not available",r+=")",r}function Q5(t){for(const e of t)v_(e)}function J5(t,e){const n=e&&q5.exec(e),r=n&&n[1];return r?G5(t,r):null}function G5(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function Np(t,e){for(const n of t)if(n.mimeTypes?.some(r=>lw(e,r))||lw(e,`application/x.${n.id}`))return n;return null}function eB(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(tB(e,n))return n}else if(ArrayBuffer.isView(e)){if(gw(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&gw(e,0,n))return n;return null}function tB(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function gw(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>nB(t,e,n,i))}function nB(t,e,n,r){if(r instanceof ArrayBuffer)return u5(r,t,r.byteLength);switch(typeof r){case"function":return r(t);case"string":const i=im(t,e,r.length);return r===i;default:return!1}}function ZT(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?im(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?im(t,0,e):""}function im(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const rB=256*1024;function*iB(t,e){const n=e?.chunkSize||rB;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const sB=256*1024;function*oB(t,e={}){const{chunkSize:n=sB}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}const aB=1024*1024;async function*lB(t,e){const n=e?.chunkSize||aB;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function mw(t,e){return p_?cB(t,e):uB(t)}async function*cB(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e?._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield UT(o)}}catch{n.releaseLock()}}async function*uB(t,e){for await(const n of t)yield UT(n)}function fB(t,e){if(typeof t=="string")return iB(t,e);if(t instanceof ArrayBuffer)return oB(t,e);if(_s(t))return lB(t,e);if(zT(t))return mw(t,e);if(ms(t))return mw(t.body,e);throw new Error("makeIterator")}const QT="Cannot convert supplied data type";function hB(t,e,n){if(e.text&&typeof t=="string")return t;if(w5(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(QT)}async function dB(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return hB(t,e);if(_s(t)&&(t=await $T(t)),ms(t)){const i=t;return await P5(i),e.binary?await i.arrayBuffer():await i.text()}if(zT(t)&&(t=fB(t,n)),v5(t)||b5(t))return d5(t);throw new Error(QT)}function JT(t,e){const n=XT(),r=t||n;return typeof r.fetch=="function"?r.fetch:jl(r.fetch)?i=>uw(i,r.fetch):e?.fetch?e?.fetch:uw}function pB(t,e,n){if(n)return n;const r={fetch:JT(e,t),...t};if(r.url){const i=m_(r.url);r.baseUrl=i,r.queryString=R5(r.url),r.filename=jT(i),r.baseUrl=_5(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function gB(t,e){if(t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:void 0}async function vf(t,e,n,r){e&&!Array.isArray(e)&&!y_(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=ih(t),o=gB(e,r),a=await K5(t,o,n);return a?(n=z5(n,a,o,i),r=pB({url:i,_parse:vf,loaders:o},n,r||null),await mB(a,t,n,r)):null}async function mB(t,e,n,r){if(o5(t),n=qL(t.options,n),ms(e)){const s=e,{ok:o,redirected:a,status:u,statusText:f,type:h,url:p}=s,g=Object.fromEntries(s.headers.entries());r.response={headers:g,ok:o,redirected:a,status:u,statusText:f,type:h,url:p}}e=await dB(e,t,n);const i=t;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,n,r);if(a5(t,n))return await l5(t,e,n,r,vf);if(i.parseText&&typeof e=="string")return await i.parseText(e,n,r);if(i.parse)return await i.parse(e,n,r);throw Si(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}const _w=100;class _B{schema;options;shape;length=0;rows=null;cursor=0;_headers=[];constructor(e,n){if(this.options=n,this.schema=e,!Array.isArray(e)){this._headers=[];for(const r in e)this._headers[e[r].index]=e[r].name}}rowCount(){return this.length}addArrayRow(e,n){Number.isFinite(n)&&(this.cursor=n),this.shape="array-row-table",this.rows=this.rows||new Array(_w),this.rows[this.length]=e,this.length++}addObjectRow(e,n){Number.isFinite(n)&&(this.cursor=n),this.shape="object-row-table",this.rows=this.rows||new Array(_w),this.rows[this.length]=e,this.length++}getBatch(){let e=this.rows;return e?(e=e.slice(0,this.length),this.rows=null,{shape:this.shape||"array-row-table",batchType:"data",data:e,length:this.length,schema:this.schema,cursor:this.cursor}):null}}function GT(t,e){if(!t)throw new Error("null row");const n={};if(e)for(let r=0;r<e.length;r++)n[e[r]]=t[r];else for(let r=0;r<t.length;r++){const i=`column-${r}`;n[i]=t[r]}return n}function eS(t,e){if(!t)throw new Error("null row");if(e){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=t[e[r]];return n}return Object.values(t)}function yB(t){const e=[];for(let n=0;n<t.length;n++){const r=`column-${n}`;e.push(r)}return e}function vB(t){return Object.keys(t)}const yw=100;class bB{schema;options;length=0;objectRows=null;arrayRows=null;cursor=0;_headers=null;constructor(e,n){if(this.options=n,this.schema=e,e){this._headers=[];for(const r in e)this._headers[e[r].index]=e[r].name}}rowCount(){return this.length}addArrayRow(e,n){switch(Number.isFinite(n)&&(this.cursor=n),this._headers||=yB(e),this.options.shape){case"object-row-table":const r=GT(e,this._headers);this.addObjectRow(r,n);break;case"array-row-table":this.arrayRows=this.arrayRows||new Array(yw),this.arrayRows[this.length]=e,this.length++;break}}addObjectRow(e,n){switch(Number.isFinite(n)&&(this.cursor=n),this._headers||=vB(e),this.options.shape){case"array-row-table":const r=eS(e,this._headers);this.addArrayRow(r,n);break;case"object-row-table":this.objectRows=this.objectRows||new Array(yw),this.objectRows[this.length]=e,this.length++;break}}getBatch(){let e=this.arrayRows||this.objectRows;return e?(e=e.slice(0,this.length),this.arrayRows=null,this.objectRows=null,{shape:this.options.shape,batchType:"data",data:e,length:this.length,schema:this.schema,cursor:this.cursor}):null}}const wB=100;class xB{schema;length=0;allocated=0;columns={};constructor(e,n){this.schema=e,this._reallocateColumns()}rowCount(){return this.length}addArrayRow(e){this._reallocateColumns();let n=0;for(const r in this.columns)this.columns[r][this.length]=e[n++];this.length++}addObjectRow(e){this._reallocateColumns();for(const n in e)this.columns[n][this.length]=e[n];this.length++}getBatch(){this._pruneColumns();const e=Array.isArray(this.schema)?this.columns:{};if(!Array.isArray(this.schema))for(const r in this.schema){const i=this.schema[r];e[i.name]=this.columns[i.index]}return this.columns={},{shape:"columnar-table",batchType:"data",data:e,schema:this.schema,length:this.length}}_reallocateColumns(){if(!(this.length<this.allocated)){this.allocated=this.allocated>0?this.allocated*=2:wB,this.columns={};for(const e in this.schema){const n=this.schema[e],r=n.type||Float32Array,i=this.columns[n.index];if(i&&ArrayBuffer.isView(i)){const s=new r(this.allocated);s.set(i),this.columns[n.index]=s}else i?(i.length=this.allocated,this.columns[n.index]=i):this.columns[n.index]=new r(this.allocated)}}}_pruneColumns(){for(const[e,n]of Object.entries(this.columns))this.columns[e]=n.slice(0,this.length)}}const TB={shape:void 0,batchSize:"auto",batchDebounceMs:0,limit:0,_limitMB:0},SB="TableBatchBuilder";class bf{schema;options;aggregator=null;batchCount=0;bytesUsed=0;isChunkComplete=!1;lastBatchEmittedMs=Date.now();totalLength=0;totalBytes=0;rowBytes=0;static ArrowBatch;constructor(e,n){this.schema=e,this.options={...TB,...n}}limitReached(){return!!(this.options?.limit&&this.totalLength>=this.options.limit||this.options?._limitMB&&this.totalBytes/1e6>=this.options._limitMB)}addRow(e){this.limitReached()||(this.totalLength++,this.rowBytes=this.rowBytes||this._estimateRowMB(e),this.totalBytes+=this.rowBytes,Array.isArray(e)?this.addArrayRow(e):this.addObjectRow(e))}addArrayRow(e){if(!this.aggregator){const n=this._getTableBatchType();this.aggregator=new n(this.schema,this.options)}this.aggregator.addArrayRow(e)}addObjectRow(e){if(!this.aggregator){const n=this._getTableBatchType();this.aggregator=new n(this.schema,this.options)}this.aggregator.addObjectRow(e)}chunkComplete(e){e instanceof ArrayBuffer&&(this.bytesUsed+=e.byteLength),typeof e=="string"&&(this.bytesUsed+=e.length),this.isChunkComplete=!0}getFullBatch(e){return this._isFull()?this._getBatch(e):null}getFinalBatch(e){return this._getBatch(e)}_estimateRowMB(e){return Array.isArray(e)?e.length*8:Object.keys(e).length*8}_isFull(){if(!this.aggregator||this.aggregator.rowCount()===0)return!1;if(this.options.batchSize==="auto"){if(!this.isChunkComplete)return!1}else if(this.options.batchSize>this.aggregator.rowCount())return!1;return this.options.batchDebounceMs>Date.now()-this.lastBatchEmittedMs?!1:(this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),!0)}_getBatch(e){if(!this.aggregator)return null;e?.bytesUsed&&(this.bytesUsed=e.bytesUsed);const n=this.aggregator.getBatch();return n.count=this.batchCount,n.bytesUsed=this.bytesUsed,Object.assign(n,e),this.batchCount++,this.aggregator=null,n}_getTableBatchType(){switch(this.options.shape){case"array-row-table":case"object-row-table":return bB;case"columnar-table":return xB;case"arrow-table":if(!bf.ArrowBatch)throw new Error(SB);return bf.ArrowBatch;default:return _B}}}class vw extends Array{enqueue(e){return this.push(e)}dequeue(){return this.shift()}}class EB{_values;_settlers;_closed;constructor(){this._values=new vw,this._settlers=new vw,this._closed=!1}close(){for(;this._settlers.length>0;)this._settlers.dequeue().resolve({done:!0});this._closed=!0}[Symbol.asyncIterator](){return this}enqueue(e){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");const n=this._settlers.dequeue();e instanceof Error?n.reject(e):n.resolve({value:e})}else this._values.enqueue(e)}next(){if(this._values.length>0){const e=this._values.dequeue();return e instanceof Error?Promise.reject(e):Promise.resolve({value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0})}return new Promise((e,n)=>{this._settlers.enqueue({resolve:e,reject:n})})}}async function wf(t,e,n,r){let i,s;!Array.isArray(e)&&!y_(e)?(i=[],s=e):(i=e,s=n);const o=JT(s);let a=t;return typeof t=="string"&&(a=await o(t)),_s(t)&&(a=await o(t)),Array.isArray(i)?await vf(a,i,s):await vf(a,i,s)}const AB="4.3.3",CB=globalThis.loaders?.parseImageNode,sm=typeof Image<"u",om=typeof ImageBitmap<"u",RB=!!CB,am=p_?!0:RB;function IB(t){switch(t){case"auto":return om||sm||am;case"imagebitmap":return om;case"image":return sm;case"data":return am;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function kB(){if(om)return"imagebitmap";if(sm)return"image";if(am)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function PB(t){const e=NB(t);if(!e)throw new Error("Not an image");return e}function MB(t){switch(PB(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function NB(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const OB=/^data:image\/svg\+xml/,DB=/\.svg((\?|#).*)?$/;function b_(t){return t&&(OB.test(t)||DB.test(t))}function FB(t,e){if(b_(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return tS(t,e)}function tS(t,e){if(b_(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function nS(t,e,n){const r=FB(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await LB(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function LB(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>{const o=s instanceof Error?s.message:"error";i(new Error(o))}}catch(s){i(s)}})}const BB={};let bw=!0;async function UB(t,e,n){let r;b_(n)?r=await nS(t,e,n):r=tS(t,n);const i=e&&e.imagebitmap;return await jB(r,i)}async function jB(t,e=null){if((zB(e)||!bw)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),bw=!1}return await createImageBitmap(t)}function zB(t){for(const e in t||BB)return!1;return!0}function VB(t){return!XB(t,"ftyp",4)||(t[8]&96)===0?null:$B(t)}function $B(t){switch(WB(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function WB(t,e,n){return String.fromCharCode(...t.slice(e,n))}function HB(t){return[...t].map(e=>e.charCodeAt(0))}function XB(t,e,n=0){const r=HB(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const tr=!1,ol=!0;function rS(t){const e=zl(t);return qB(e)||QB(e)||KB(e)||ZB(e)||YB(e)}function YB(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=VB(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function qB(t){const e=zl(t);return e.byteLength>=24&&e.getUint32(0,tr)===2303741511?{mimeType:"image/png",width:e.getUint32(16,tr),height:e.getUint32(20,tr)}:null}function KB(t){const e=zl(t);return e.byteLength>=10&&e.getUint32(0,tr)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,ol),height:e.getUint16(8,ol)}:null}function ZB(t){const e=zl(t);return e.byteLength>=14&&e.getUint16(0,tr)===16973&&e.getUint32(2,ol)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,ol),height:e.getUint32(22,ol)}:null}function QB(t){const e=zl(t);if(!(e.byteLength>=3&&e.getUint16(0,tr)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=JB();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,tr);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,tr),width:e.getUint16(s+7,tr)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,tr)}return null}function JB(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function zl(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function GB(t,e){const{mimeType:n}=rS(t)||{},r=globalThis.loaders?.parseImageNode;return _f(r),await r(t,n)}async function e8(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=t8(i);let a;switch(o){case"imagebitmap":a=await UB(t,e,s);break;case"image":a=await nS(t,e,s);break;case"data":a=await GB(t);break;default:_f(!1)}return i==="data"&&(a=MB(a)),a}function t8(t){switch(t){case"auto":case"data":return kB();default:return IB(t),t}}const n8=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],r8=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],i8={image:{type:"auto",decode:!0}},s8={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:AB,mimeTypes:r8,extensions:n8,parse:e8,tests:[t=>!!rS(new DataView(t))],options:i8},Ve=new Ul({id:"deck"});let lm={};function o8(t){lm=t}function Ft(t,e,n,r){Ve.level>0&&lm[t]&&lm[t].call(null,e,n,r)}function a8(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const l8={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:a8,parseTextSync:JSON.parse};function c8(){const t="9.1.13",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(Ve.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Ve,_registerLoggers:o8},X5([l8,[s8,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const u8=c8();function w_(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Op={number:{type:"number",validate(t,e){return Number.isFinite(t)&&typeof e=="object"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:"array",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function f8(t){const e={};for(const[n,r]of Object.entries(t))e[n]=h8(r);return e}function h8(t){let e=ww(t);if(e!=="object")return{value:t,...Op[e],type:e};if(typeof t=="object")return t?t.type!==void 0?{...t,...Op[t.type],type:t.type}:t.value===void 0?{type:"object",value:t}:(e=ww(t.value),{...t,...Op[e],type:e}):{type:"object",value:null};throw new Error("props")}function ww(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const d8=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,p8=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,g8={vertex:d8,fragment:p8},xw=/void\s+main\s*\([^)]*\)\s*\{\n?/,Tw=/}\n?[^{}]*$/,Dp=[],Bu="__LUMA_INJECT_DECLARATIONS__";function m8(t){const e={vertex:{},fragment:{}};for(const n in t){let r=t[n];const i=_8(n);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function _8(t){const e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function xf(t,e,n,r=!1){const i=e==="vertex";for(const s in n){const o=n[s];o.sort((u,f)=>u.order-f.order),Dp.length=o.length;for(let u=0,f=o.length;u<f;++u)Dp[u]=o[u].injection;const a=`${Dp.join(`
`)}
`;switch(s){case"vs:#decl":i&&(t=t.replace(Bu,a));break;case"vs:#main-start":i&&(t=t.replace(xw,u=>u+a));break;case"vs:#main-end":i&&(t=t.replace(Tw,u=>a+u));break;case"fs:#decl":i||(t=t.replace(Bu,a));break;case"fs:#main-start":i||(t=t.replace(xw,u=>u+a));break;case"fs:#main-end":i||(t=t.replace(Tw,u=>a+u));break;default:t=t.replace(s,u=>u+a)}}return t=t.replace(Bu,""),r&&(t=t.replace(/\}\s*$/,s=>s+g8[e])),t}function Tf(t){t.map(e=>y8(e))}function y8(t){if(t.instance)return;Tf(t.dependencies||[]);const{propTypes:e={},deprecations:n=[],inject:r={}}=t,i={normalizedInjections:m8(r),parsedDeprecations:v8(n)};e&&(i.propValidators=f8(e)),t.instance=i;let s={};e&&(s=Object.entries(e).reduce((o,[a,u])=>{const f=u?.value;return f&&(o[a]=f),o},{})),t.defaultUniforms={...t.defaultUniforms,...s}}function iS(t,e,n){t.deprecations?.forEach(r=>{r.regex?.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}function v8(t){return t.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),t}function x_(t){Tf(t);const e={},n={};sS({modules:t,level:0,moduleMap:e,moduleDepth:n});const r=Object.keys(n).sort((i,s)=>n[s]-n[i]).map(i=>e[i]);return Tf(r),r}function sS(t){const{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&sS({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function b8(t){switch(t?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function w8(t,e){if(Number(t.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return t=Sw(t,x8),t;case"fragment":return t=Sw(t,T8),t;default:throw new Error(e)}}const oS=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],x8=[...oS,[cm("attribute"),"in $1"],[cm("varying"),"out $1"]],T8=[...oS,[cm("varying"),"in $1"]];function Sw(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function cm(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function aS(t,e){let n="";for(const r in t){const i=t[r];if(n+=`void ${i.signature} {
`,i.header&&(n+=`  ${i.header}`),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+=`  ${o.injection}
`}i.footer&&(n+=`  ${i.footer}`),n+=`}
`}return n}function lS(t){const e={vertex:{},fragment:{}};for(const n of t){let r,i;typeof n!="string"?(r=n,i=r.hook):(r={},i=n),i=i.trim();const[s,o]=i.split(":"),a=i.replace(/\(.+/,""),u=Object.assign(r,{signature:o});switch(s){case"vs":e.vertex[a]=u;break;case"fs":e.fragment[a]=u;break;default:throw new Error(s)}}return e}function S8(t,e){return{name:E8(t,e),language:"glsl",version:A8(t)}}function E8(t,e="unnamed"){const r=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return r?r[1]:e}function A8(t){let e=100;const n=t.match(/[^\s]+/g);if(n&&n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const cS=`

${Bu}
`,C8=`precision highp float;
`;function R8(t){const e=x_(t.modules||[]);return{source:k8(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:uS(e)}}function I8(t){const{vs:e,fs:n}=t,r=x_(t.modules||[]);return{vs:Ew(t.platformInfo,{...t,source:e,stage:"vertex",modules:r}),fs:Ew(t.platformInfo,{...t,source:n,stage:"fragment",modules:r}),getUniforms:uS(r)}}function k8(t,e){const{source:n,stage:r,modules:i,hookFunctions:s=[],inject:o={},log:a}=e;w_(typeof n=="string","shader source must be a string");const u=n;let f="";const h=lS(s),p={},g={},_={};for(const w in o){const x=typeof o[w]=="string"?{injection:o[w],order:0}:o[w],T=/^(v|f)s:(#)?([\w-]+)$/.exec(w);if(T){const A=T[2],E=T[3];A?E==="decl"?g[w]=[x]:_[w]=[x]:p[w]=[x]}else _[w]=[x]}const v=i;for(const w of v){a&&iS(w,u,a);const x=fS(w,"wgsl");f+=x;const T=w.injections?.[r]||{};for(const A in T){const E=/^(v|f)s:#([\w-]+)$/.exec(A);if(E){const k=E[2]==="decl"?g:_;k[A]=k[A]||[],k[A].push(T[A])}else p[A]=p[A]||[],p[A].push(T[A])}}return f+=cS,f=xf(f,r,g),f+=aS(h[r],p),f+=u,f=xf(f,r,_),f}function Ew(t,e){const{id:n,source:r,stage:i,language:s="glsl",modules:o,defines:a={},hookFunctions:u=[],inject:f={},prologue:h=!0,log:p}=e;w_(typeof r=="string","shader source must be a string");const g=s==="glsl"?S8(r).version:-1,_=t.shaderLanguageVersion,v=g===100?"#version 100":"#version 300 es",x=r.split(`
`).slice(1).join(`
`),T={};o.forEach(L=>{Object.assign(T,L.defines)}),Object.assign(T,a);let A="";switch(s){case"wgsl":break;case"glsl":A=h?`${v}

// ----- PROLOGUE -------------------------
${P8({id:n,source:r,stage:i})}
${`#define SHADER_TYPE_${i.toUpperCase()}`}

${b8(t)}
${i==="fragment"?C8:""}

// ----- APPLICATION DEFINES -------------------------

${M8(T)}

`:`${v}
`;break}const E=lS(u),R={},k={},M={};for(const L in f){const W=typeof f[L]=="string"?{injection:f[L],order:0}:f[L],H=/^(v|f)s:(#)?([\w-]+)$/.exec(L);if(H){const X=H[2],B=H[3];X?B==="decl"?k[L]=[W]:M[L]=[W]:R[L]=[W]}else M[L]=[W]}for(const L of o){p&&iS(L,x,p);const W=fS(L,i);A+=W;const H=L.instance?.normalizedInjections[i]||{};for(const X in H){const B=/^(v|f)s:#([\w-]+)$/.exec(X);if(B){const ie=B[2]==="decl"?k:M;ie[X]=ie[X]||[],ie[X].push(H[X])}else R[X]=R[X]||[],R[X].push(H[X])}}return A+="// ----- MAIN SHADER SOURCE -------------------------",A+=cS,A=xf(A,i,k),A+=aS(E[i],R),A+=x,A=xf(A,i,M),s==="glsl"&&g!==_&&(A=w8(A,i)),A.trim()}function uS(t){return function(n){const r={};for(const i of t){const s=i.getUniforms?.(n,r);Object.assign(r,s)}return r}}function P8(t){const{id:e,source:n,stage:r}=t;return e&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${e}_${r}`:""}function M8(t={}){let e="";for(const n in t){const r=t[n];(r||Number.isFinite(r))&&(e+=`#define ${n.toUpperCase()} ${t[n]}
`)}return e}function fS(t,e){let n;switch(e){case"vertex":n=t.vs||"";break;case"fragment":n=t.fs||"";break;case"wgsl":n=t.source||"";break;default:w_(!1)}if(!t.name)throw new Error("Shader module must have a name");const r=t.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let i=`// ----- MODULE ${t.name} ---------------

`;return e!=="wgsl"&&(i+=`#define MODULE_${r}
`),i+=`${n}
`,i}const N8=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,O8=/^\s*\#\s*endif\s*$/;function D8(t,e){const n=t.split(`
`),r=[];let i=!0,s=null;for(const o of n){const a=o.match(N8),u=o.match(O8);a?(s=a[1],i=!!e?.defines?.[s]):u?i=!0:i&&r.push(o)}return r.join(`
`)}class Zi{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return Zi.defaultShaderAssembler=Zi.defaultShaderAssembler||new Zi,Zi.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(n=>n.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n)}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const n=this._getModuleList(e.modules),r=this._hookFunctions,{source:i,getUniforms:s}=R8({...e,source:e.source,modules:n,hookFunctions:r});return{source:e.platformInfo.shaderLanguage==="wgsl"?D8(i):i,getUniforms:s,modules:n}}assembleGLSLShaderPair(e){const n=this._getModuleList(e.modules),r=this._hookFunctions;return{...I8({...e,vs:e.vs,fs:e.fs,modules:n,hookFunctions:r}),modules:n}}_getModuleList(e=[]){const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],u=a.name;n[i++]=a,r[u]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],u=a.name;r[u]||(n[i++]=a,r[u]=!0)}return n.length=i,Tf(n),n}}const F8=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,L8=`#version 300 es
${F8}`;function hS(t){const{input:e,inputChannels:n,output:r}=t||{};if(!e)return L8;if(!n)throw new Error("inputChannels");const i=B8(n),s=U8(e,n);return`#version 300 es
in ${i} ${e};
out vec4 ${r};
void main() {
  ${r} = ${s};
}`}function B8(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}function U8(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}class j8{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new rh({id:e})),this.stats.get(e)}}const dS=new j8,he=new Ul({id:"luma.gl"}),Fp={};function sh(t="id"){Fp[t]=Fp[t]||1;const e=Fp[t]++;return`${t}-${e}`}let Xe=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,n,r){if(!e)throw new Error("no device");this._device=e,this.props=z8(n,r);const i=this.props.id!=="undefined"?this.props.id:sh(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];e.get(`${n}s Active`).decrementCount()}trackAllocatedMemory(e,n=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").addCount(e),r.get(`${n} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").subtractCount(this.allocatedBytes),n.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${n}s Created`).incrementCount(),e.get(`${n}s Active`).incrementCount()}};function z8(t,e){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}class Ke extends Xe{static defaultProps={...Xe.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,n){const r={...n};(n.usage||0)&Ke.INDEX&&!n.indexType&&(n.data instanceof Uint32Array?r.indexType="uint32":n.data instanceof Uint16Array&&(r.indexType="uint16")),delete r.data,super(e,r,Ke.defaultProps),this.usage=r.usage||0,this.indexType=r.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}readSyncWebGL(e,n){throw new Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,n,r){const i=ArrayBuffer.isView(e)?e.buffer:e,s=Math.min(e?e.byteLength:r,Ke.DEBUG_DATA_MAX_LENGTH);i===null?this.debugData=new ArrayBuffer(s):n===0&&r===i.byteLength?this.debugData=i.slice(0,s):this.debugData=i.slice(n,n+s)}}function pS(t){const e=Aw[t],n=V8(e),r=t.includes("norm"),i=!r&&!t.startsWith("float"),s=t.startsWith("s");return{dataType:Aw[t],byteLength:n,integer:i,signed:s,normalized:r}}function V8(t){return $8[t]}const Aw={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},$8={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},Nt="texture-compression-bc",We="texture-compression-astc",qn="texture-compression-etc2",W8="texture-compression-etc1-webgl",pu="texture-compression-pvrtc-webgl",Lp="texture-compression-atc-webgl",gu="float32-renderable-webgl",Bp="float16-renderable-webgl",H8="rgb9e5ufloat-renderable-webgl",Up="snorm8-renderable-webgl",Da="norm16-renderable-webgl",jp="snorm16-renderable-webgl",mu="float32-filterable",Cw="float16-filterable-webgl";function gS(t){const e=X8[t];if(!e)throw new Error(`Unsupported texture format ${t}`);return e}const X8={r8unorm:{},r8snorm:{render:Up},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:Up},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:Bp,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:Da},"r16snorm-webgl":{f:jp},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:Up},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:Bp,filter:Cw},"rg16unorm-webgl":{render:Da},"rg16snorm-webgl":{render:jp},r32uint:{},r32sint:{},r32float:{render:gu,filter:mu},rgb9e5ufloat:{channels:"rgb",packed:!0,render:H8},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:gu},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:Da},"rgb16snorm-webgl":{f:Da},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:mu},rgba16uint:{},rgba16sint:{},rgba16float:{render:Bp,filter:Cw},"rgba16unorm-webgl":{render:Da},"rgba16snorm-webgl":{render:jp},"rgb32float-webgl":{render:gu,filter:mu},rgba32uint:{},rgba32sint:{},rgba32float:{render:gu,filter:mu},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:Nt},"bc1-rgb-unorm-srgb-webgl":{f:Nt},"bc1-rgba-unorm":{f:Nt},"bc1-rgba-unorm-srgb":{f:Nt},"bc2-rgba-unorm":{f:Nt},"bc2-rgba-unorm-srgb":{f:Nt},"bc3-rgba-unorm":{f:Nt},"bc3-rgba-unorm-srgb":{f:Nt},"bc4-r-unorm":{f:Nt},"bc4-r-snorm":{f:Nt},"bc5-rg-unorm":{f:Nt},"bc5-rg-snorm":{f:Nt},"bc6h-rgb-ufloat":{f:Nt},"bc6h-rgb-float":{f:Nt},"bc7-rgba-unorm":{f:Nt},"bc7-rgba-unorm-srgb":{f:Nt},"etc2-rgb8unorm":{f:qn},"etc2-rgb8unorm-srgb":{f:qn},"etc2-rgb8a1unorm":{f:qn},"etc2-rgb8a1unorm-srgb":{f:qn},"etc2-rgba8unorm":{f:qn},"etc2-rgba8unorm-srgb":{f:qn},"eac-r11unorm":{f:qn},"eac-r11snorm":{f:qn},"eac-rg11unorm":{f:qn},"eac-rg11snorm":{f:qn},"astc-4x4-unorm":{f:We},"astc-4x4-unorm-srgb":{f:We},"astc-5x4-unorm":{f:We},"astc-5x4-unorm-srgb":{f:We},"astc-5x5-unorm":{f:We},"astc-5x5-unorm-srgb":{f:We},"astc-6x5-unorm":{f:We},"astc-6x5-unorm-srgb":{f:We},"astc-6x6-unorm":{f:We},"astc-6x6-unorm-srgb":{f:We},"astc-8x5-unorm":{f:We},"astc-8x5-unorm-srgb":{f:We},"astc-8x6-unorm":{f:We},"astc-8x6-unorm-srgb":{f:We},"astc-8x8-unorm":{f:We},"astc-8x8-unorm-srgb":{f:We},"astc-10x5-unorm":{f:We},"astc-10x5-unorm-srgb":{f:We},"astc-10x6-unorm":{f:We},"astc-10x6-unorm-srgb":{f:We},"astc-10x8-unorm":{f:We},"astc-10x8-unorm-srgb":{f:We},"astc-10x10-unorm":{f:We},"astc-10x10-unorm-srgb":{f:We},"astc-12x10-unorm":{f:We},"astc-12x10-unorm-srgb":{f:We},"astc-12x12-unorm":{f:We},"astc-12x12-unorm-srgb":{f:We},"pvrtc-rgb4unorm-webgl":{f:pu},"pvrtc-rgba4unorm-webgl":{f:pu},"pvrtc-rbg2unorm-webgl":{f:pu},"pvrtc-rgba2unorm-webgl":{f:pu},"etc1-rbg-unorm-webgl":{f:W8},"atc-rgb-unorm-webgl":{f:Lp},"atc-rgba-unorm-webgl":{f:Lp},"atc-rgbai-unorm-webgl":{f:Lp}},Y8=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],q8=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function mS(t){return Y8.some(e=>t.startsWith(e))}function T_(t){let e=K8(t);if(mS(t)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;const r=Z8(t);r&&(e.blockWidth=r.blockWidth,e.blockHeight=r.blockHeight)}const n=q8.exec(t);if(n){const[,r,i,s,o,a]=n,u=`${s}${i}`,f=pS(u),h=f.byteLength*8,p=r.length,g=[h,p>=2?h:0,p>=3?h:0,p>=4?h:0];e={format:t,attachment:e.attachment,dataType:f.dataType,components:p,channels:r,integer:f.integer,signed:f.signed,normalized:f.normalized,bitsPerChannel:g,bytesPerPixel:f.byteLength*r.length,packed:e.packed,srgb:e.srgb},a==="-webgl"&&(e.webgl=!0),o==="-srgb"&&(e.srgb=!0)}return t.endsWith("-webgl")&&(e.webgl=!0),t.endsWith("-srgb")&&(e.srgb=!0),e}function K8(t){const e=gS(t),n=e.bytesPerPixel||1,r=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:t,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||e.channels?.length||1,bytesPerPixel:n,bitsPerChannel:r,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function Z8(t){const n=/.*-(\d+)x(\d+)-.*/.exec(t);if(n){const[,r,i]=n;return{blockWidth:Number(r),blockHeight:Number(i)}}return null}function Q8(t){const e=gS(t),n={format:t,create:e.f??!0,render:e.render??!0,filter:e.filter??!0,blend:e.blend??!0,store:e.store??!0},r=T_(t),i=t.startsWith("depth")||t.startsWith("stencil"),s=r?.signed,o=r?.integer,a=r?.webgl;return n.render&&=!s,n.filter&&=!i&&!s&&!o&&!a,n}class J8{}class G8{features;disabledFeatures;constructor(e=[],n){this.features=new Set(e),this.disabledFeatures=n||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class yi{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:e=>he.error(e.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:he.get("debug")||void 0,debugShaders:he.get("debug-shaders")||void 0,debugFramebuffers:!!he.get("debug-framebuffers"),debugWebGL:!!he.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0};get[Symbol.toStringTag](){return"Device"}constructor(e){this.props={...yi.defaultProps,...e},this.id=this.props.id||sh(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=dS;timestamp=0;_reused=!1;_lumaData={};getTextureFormatCapabilities(e){const n=Q8(e),r=o=>(typeof o=="string"?this.features.has(o):o)??!0,i=r(n.create),s={format:e,create:i,render:i&&r(n.render),filter:i&&r(n.filter),blend:i&&r(n.blend),store:i&&r(n.store)};return this._getDeviceSpecificTextureFormatCapabilities(s)}isTextureFormatSupported(e,n){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return mS(e)}loseDevice(){return!1}reportError(e){this.props.onError(e)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(e={}){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,n){throw new Error("not implemented")}readPixelsToBufferWebGL(e,n){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,n){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const n={...e};return(e.usage||0)&Ke.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?n.indexType="uint32":e.data instanceof Uint16Array?n.indexType="uint16":he.warn("indices buffer content must be of integer type")()),n}}const eU=gs()&&typeof document<"u",tU=()=>eU&&document.readyState==="complete",nU="set luma.log.level=1 (or higher) to trace rendering",Rw="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class so{static defaultProps={...yi.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};static pageLoaded=rU().then(()=>{he.probe(2,"DOM is loaded")()});stats=dS;log=he;VERSION="9.1.9";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw he.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),he.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");he.error("This version of luma.gl has already been initialized")()}he.log(1,`${this.VERSION} - ${nU}`)(),globalThis.luma=this}registerAdapters(e){for(const n of e)this.preregisteredAdapters.set(n.type,n)}getSupportedAdapters(e=[]){const n=this.getAdapterMap(e);return Array.from(n).map(([,r])=>r).filter(r=>r.isSupported?.()).map(r=>r.type)}getBestAvailableAdapter(e=[]){const n=this.getAdapterMap(e);return n.get("webgpu")?.isSupported?.()?"webgpu":n.get("webgl")?.isSupported?.()?"webgl":null}setDefaultDeviceProps(e){Object.assign(so.defaultProps,e)}async createDevice(e={}){e={...so.defaultProps,...e},e.waitForPageLoad&&await so.pageLoaded;const n=this.getAdapterMap(e.adapters);let r=e.type||"";r==="best-available"&&(r=this.getBestAvailableAdapter(e.adapters)||r);const o=await(this.getAdapterMap(e.adapters)||n).get(r)?.create?.(e);if(o)return o;throw new Error(Rw)}async attachDevice(e){const n=this.getAdapterMap(e.adapters);let r="";e.handle instanceof WebGL2RenderingContext&&(r="webgl"),e.createCanvasContext&&await so.pageLoaded,e.handle===null&&(r="unknown");const s=await n.get(r)?.attach?.(null);if(s)return s;throw new Error(Rw)}enforceWebGL2(e=!0,n=[]){const i=this.getAdapterMap(n).get("webgl");i||he.warn("enforceWebGL2: webgl adapter not found")(),i?.enforceWebGL2?.(e)}getAdapterMap(e=[]){const n=new Map(this.preregisteredAdapters);for(const r of e)n.set(r.type,r);return n}registerDevices(e){he.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(const n of e){const r=n.adapter;r&&this.preregisteredAdapters.set(r.type,r)}}}const um=new so;function rU(){return tU()||typeof window>"u"?Promise.resolve():new Promise(t=>{window.addEventListener("load",()=>t())})}class iU{}class S_{static defaultProps={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"};id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...S_.defaultProps,...e},e=this.props,!gs()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(e.canvas)typeof e.canvas=="string"?this.canvas=oU(e.canvas):this.canvas=e.canvas;else{const n=aU(e),r=sU(e?.container||null);r.insertBefore(n,r.firstChild),this.canvas=n,e?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(n=>{for(const r of n)r.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(e){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(e=e===void 0?this.props.useDevicePixels:e,!e||e<=0)?1:e===!0?typeof window<"u"&&window.devicePixelRatio||1:e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),n=this.canvas;return n.parentElement?[n.clientWidth*e,n.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,n]=this.getPixelSize();return e/n}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),n=this._canvasSizeInfo.clientWidth||this.htmlCanvas?.clientWidth;return n?e/n:1}catch{return 1}}cssToDevicePixels(e,n=!0){const r=this.cssToDeviceRatio(),[i,s]=this.getDrawingBufferSize();return lU(e,r,i,s,n)}setDevicePixelRatio(e,n={}){if(!this.htmlCanvas)return;let r="width"in n?n.width:this.htmlCanvas.clientWidth,i="height"in n?n.height:this.htmlCanvas.clientHeight;(!r||!i)&&(he.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);const s=this._canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),u=Math.floor(i*o);if(this.htmlCanvas.width=a,this.htmlCanvas.height=u,this.device.gl){const[h,p]=this.getDrawingBufferSize();(h!==a||p!==u)&&(o=Math.min(h/r,p/i),this.htmlCanvas.width=Math.floor(r*o),this.htmlCanvas.height=Math.floor(i*o),he.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=r,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=e}}}getDrawingBufferSize(){const e=this.device.gl;return e?[e.drawingBufferWidth,e.drawingBufferHeight]:this.getPixelSize()}_setAutoCreatedCanvasId(e){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}}function sU(t){if(typeof t=="string"){const e=document.getElementById(t);if(!e)throw new Error(`${t} is not an HTML element`);return e}else if(t)return t;return document.body}function oU(t){const e=document.getElementById(t);if(!(e instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return e}function aU(t){const{width:e,height:n}=t,r=document.createElement("canvas");return r.id=sh("lumagl-auto-created-canvas"),r.width=e||1,r.height=n||1,r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(n)?`${n}px`:"100%",r}function lU(t,e,n,r,i){const s=t,o=Iw(s[0],e,n);let a=kw(s[1],e,r,i),u=Iw(s[0]+1,e,n);const f=u===n-1?u:u-1;u=kw(s[1]+1,e,r,i);let h;return i?(u=u===0?u:u+1,h=a,a=u):h=u===r-1?u:u-1,{x:o,y:a,width:Math.max(f-o+1,1),height:Math.max(h-a+1,1)}}function Iw(t,e,n){return Math.min(Math.round(t*e),n-1)}function kw(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}class He extends Xe{static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static STORAGE=8;static RENDER_ATTACHMENT=16;static CubeFaces=["+X","-X","+Y","-Y","+Z","-Z"];static defaultProps={...Xe.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0};get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}dimension;format;width;height;depth;mipLevels;updateTimestamp;constructor(e,n){if(n=He.normalizeProps(e,n),super(e,n,He.defaultProps),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.props.width===void 0||this.props.height===void 0){const r=He.getTextureDataSize(this.props.data);this.width=r?.width||1,this.height=r?.height||1}this.props.mipmaps&&this.props.mipLevels===void 0&&(this.props.mipLevels="pyramid"),this.mipLevels=this.props.mipLevels==="pyramid"?He.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createTexture({...this.props,...e})}static isExternalImage(e){return typeof ImageData<"u"&&e instanceof ImageData||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement||typeof VideoFrame<"u"&&e instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas}static getExternalImageSize(e){if(typeof ImageData<"u"&&e instanceof ImageData||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height};if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)return{width:e.naturalWidth,height:e.naturalHeight};if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)return{width:e.videoWidth,height:e.videoHeight};if(typeof VideoFrame<"u"&&e instanceof VideoFrame)return{width:e.displayWidth,height:e.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(e){const n=e?.data;return ArrayBuffer.isView(n)}static getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return He.getTextureDataSize(e[0]);if(He.isExternalImage(e))return He.getExternalImageSize(e);if(e&&typeof e=="object"&&e.constructor===Object){const r=Object.values(e)[0];return{width:r.width,height:r.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(e,n){let r;return ArrayBuffer.isView(e)?r=[{data:e,width:n.width,height:n.height}]:Array.isArray(e)?r=e:r=[e],r}static getMipLevelCount(e,n){return Math.floor(Math.log2(Math.max(e,n)))+1}static getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1};static normalizeProps(e,n){const r={...n},i=e?.props?._resourceDefaults?.texture||{};Object.assign(r,i);const{width:s,height:o}=r;return typeof s=="number"&&(r.width=Math.max(1,Math.ceil(s))),typeof o=="number"&&(r.height=Math.max(1,Math.ceil(o))),r}}class oh extends Xe{static defaultProps={...Xe.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0};get[Symbol.toStringTag](){return"TextureView"}constructor(e,n){super(e,n,oh.defaultProps)}}function cU(t,e,n){let r="";const i=e.split(/\r?\n/),s=t.slice().sort((o,a)=>o.lineNum-a.lineNum);switch(n?.showSourceCode||"no"){case"all":let o=0;for(let a=1;a<=i.length;a++)for(r+=_S(i[a-1],a,n);s.length>o&&s[o].lineNum===a;){const u=s[o++];r+=Pw(u,i,u.lineNum,{...n,inlineSource:!1})}return r;case"issues":case"no":for(const a of t)r+=Pw(a,i,a.lineNum,{inlineSource:n?.showSourceCode!=="no"});return r}}function Pw(t,e,n,r){if(r?.inlineSource){const s=uU(e,n),o=t.linePos>0?`${" ".repeat(t.linePos+5)}^^^
`:"";return`
${s}${o}${t.type.toUpperCase()}: ${t.message}

`}const i=t.type==="error"?"red":"#8B4000";return r?.html?`<div class='luma-compiler-log-error' style="color:${i};"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function uU(t,e,n){let r="";for(let i=e-2;i<=e;i++){const s=t[i-1];s!==void 0&&(r+=_S(s,e,n))}return r}function _S(t,e,n){const r=n?.html?hU(t):t;return`${fU(String(e),4)}: ${r}${n?.html?"<br/>":`
`}`}function fU(t,e){let n="";for(let r=t.length;r<e;++r)n+=" ";return n+t}function hU(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}class ah extends Xe{static defaultProps={...Xe.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0};get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,n){n={...n,debugShaders:n.debugShaders||e.props.debugShaders||"errors"},super(e,{id:dU(n),...n},ah.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const n=await this.getCompilationInfo();e==="warnings"&&n?.length===0||this._displayShaderLog(n)}_displayShaderLog(e){if(typeof document>"u"||!document?.createElement)return;const n=yS(this.source),r=`${this.stage} ${n}`;let i=cU(e,this.source,{showSourceCode:"all",html:!0});const s=this.getTranslatedSource();s&&(i+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${s}</pre></code>`);const o=document.createElement("Button");o.innerHTML=`
<h1>Shader Compilation Error in ${r}</h1><br /><br />
<code style="user-select:text;"><pre>
${i}
</pre></code>`,o.style.top="10px",o.style.left="10px",o.style.position="absolute",o.style.zIndex="9999",o.style.width="100%",o.style.textAlign="left",document.body.appendChild(o),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),o.onclick=()=>{const u=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(u)}}}function dU(t){return yS(t.source)||t.id||sh(`unnamed ${t.stage}-shader`)}function yS(t,e="unnamed"){const r=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return r?r[1]:e}class Sl extends Xe{static defaultProps={...Xe.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,n){n=Sl.normalizeProps(e,n),super(e,n,Sl.defaultProps)}static normalizeProps(e,n){const r=e?.props?._resourceDefaults?.sampler||{};return{...n,...r}}}class lh extends Xe{static defaultProps={...Xe.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,n={}){super(e,n,lh.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const n=this.colorAttachments.map(i=>i.texture.clone(e)),r=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:n,depthStencilAttachment:r})}resize(e){let n=!e;if(e){const[r,i]=Array.isArray(e)?e:[e.width,e.height];n=n||i!==this.height||r!==this.width,this.width=r,this.height=i}n&&(he.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((n,r)=>{if(typeof n=="string"){const i=this.createColorTexture(n,r);return this.attachResource(i),i.view}return n instanceof He?n.view:n});const e=this.props.depthStencilAttachment;if(e)if(typeof e=="string"){const n=this.createDepthStencilTexture(e);this.attachResource(n),this.depthStencilAttachment=n.view}else e instanceof He?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,n){return this.device.createTexture({id:`${this.id}-color-attachment-${n}`,usage:He.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:He.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(e,n){for(let r=0;r<this.colorAttachments.length;++r)if(this.colorAttachments[r]){const i=this.colorAttachments[r].texture.clone({width:e,height:n});this.destroyAttachedResource(this.colorAttachments[r]),this.colorAttachments[r]=i.view,this.attachResource(i.view)}if(this.depthStencilAttachment){const r=this.depthStencilAttachment.texture.clone({width:e,height:n});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=r.view,this.attachResource(r)}this.updateAttachments()}}class Ro extends Xe{static defaultProps={...Xe.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,n){super(e,n,Ro.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(e){throw new Error("Use uniform blocks")}}class Xi extends Xe{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;static defaultProps={...Xe.defaultProps,framebuffer:null,parameters:void 0,clearColor:Xi.defaultClearColor,clearColors:void 0,clearDepth:Xi.defaultClearDepth,clearStencil:Xi.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0};get[Symbol.toStringTag](){return"RenderPass"}constructor(e,n){n=Xi.normalizeProps(e,n),super(e,n,Xi.defaultProps)}static normalizeProps(e,n){return{...e.props._resourceDefaults?.renderPass,...n}}}class Sf extends Xe{static defaultProps={...Xe.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0};get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,n){super(e,n,Sf.defaultProps),this.shaderLayout=n.shaderLayout}}class E_ extends Xe{static defaultProps={...Xe.defaultProps,measureExecutionTime:void 0};get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,n){super(e,n,E_.defaultProps)}}class A_ extends Xe{static defaultProps={...Xe.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,n){super(e,n,A_.defaultProps)}}function pU(t){const[e,n]=mU[t],r=e==="i32"||e==="u32",i=e!=="u32",s=_U[e]*n,o=gU(e,n);return{dataType:e,components:n,defaultVertexFormat:o,byteLength:s,integer:r,signed:i}}function gU(t,e){let n;switch(t){case"f32":n="float32";break;case"i32":n="sint32";break;case"u32":n="uint32";break;case"f16":return e<=2?"float16x2":"float16x4"}return e===1?n:`${n}x${e}`}const mU={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},_U={f32:4,f16:2,i32:4,u32:4};function vS(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);const[n,r]=t.split("x"),i=n,s=r?parseInt(r):1,o=pS(i),a={type:i,components:s,byteLength:o.byteLength*s,integer:o.integer,signed:o.signed,normalized:o.normalized};return e&&(a.webglOnly=!0),a}function bS(t,e){const n={};for(const r of t.attributes){const i=vU(t,e,r.name);i&&(n[r.name]=i)}return n}function yU(t,e,n=16){const r=bS(t,e),i=new Array(n).fill(null);for(const s of Object.values(r))i[s.location]=s;return i}function vU(t,e,n){const r=bU(t,n),i=wU(e,n);if(!r)return null;const s=pU(r.type),o=i?.vertexFormat||s.defaultVertexFormat,a=vS(o);return{attributeName:i?.attributeName||r.name,bufferName:i?.bufferName||r.name,location:r.location,shaderType:r.type,shaderDataType:s.dataType,shaderComponents:s.components,vertexFormat:o,bufferDataType:a.type,bufferComponents:a.components,normalized:a.normalized,integer:s.integer,stepMode:i?.stepMode||r.stepMode||"vertex",byteOffset:i?.byteOffset||0,byteStride:i?.byteStride||0}}function bU(t,e){const n=t.attributes.find(r=>r.name===e);return n||he.warn(`shader layout attribute "${e}" not present in shader`),n||null}function wU(t,e){xU(t);let n=TU(t,e);return n||(n=SU(t,e),n)?n:(he.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function xU(t){for(const e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&he.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function TU(t,e){for(const n of t)if(n.format&&n.name===e)return{attributeName:n.name,bufferName:e,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}function SU(t,e){for(const n of t){let r=n.byteStride;if(typeof n.byteStride!="number")for(const s of n.attributes||[]){const o=vS(s.format);r+=o.byteLength}const i=n.attributes?.find(s=>s.attribute===e);if(i)return{attributeName:i.attribute,bufferName:n.name,stepMode:n.stepMode,vertexFormat:i.format,byteOffset:i.byteOffset,byteStride:r}}return null}class C_ extends Xe{static defaultProps={...Xe.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,n){super(e,n,C_.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);const{shaderLayout:r,bufferLayout:i}=n.renderPipeline||{};if(!r||!i)throw new Error("VertexArray");this.attributeInfos=yU(r,i,this.maxVertexAttributes)}setConstantWebGL(e,n){this.device.reportError(new Error("constant attributes not supported"))}}class R_ extends Xe{static defaultProps={...Xe.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,n){super(e,n,R_.defaultProps)}}class I_ extends Xe{static defaultProps={...Xe.defaultProps,type:void 0,count:void 0};get[Symbol.toStringTag](){return"QuerySet"}constructor(e,n){super(e,n,I_.defaultProps)}}const EU={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function AU(t){return EU[t]}function CU(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}let _u;function wS(t){return(!_u||_u.byteLength<t)&&(_u=new ArrayBuffer(t)),_u}function RU(t,e){const n=wS(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function IU(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Ef(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":IU(t)}const Mw=1024;class kU{layout={};byteLength;constructor(e){let n=0;for(const[i,s]of Object.entries(e)){const o=AU(s),{type:a,components:u}=o;n=CU(n,u);const f=n;n+=u,this.layout[i]={type:a,size:u,offset:f}}n+=(4-n%4)%4;const r=n*4;this.byteLength=Math.max(r,Mw)}getData(e){const n=Math.max(this.byteLength,Mw),r=wS(n),i={i32:new Int32Array(r),u32:new Uint32Array(r),f32:new Float32Array(r),f16:new Uint16Array(r)};for(const[s,o]of Object.entries(e)){const a=this.layout[s];if(!a){he.warn(`Supplied uniform value ${s} not present in uniform block layout`)();continue}const{type:u,size:f,offset:h}=a,p=i[u];if(f===1){if(typeof o!="number"&&typeof o!="boolean"){he.warn(`Supplied value for single component uniform ${s} is not a number: ${o}`)();continue}p[h]=Number(o)}else{if(!Ef(o)){he.warn(`Supplied value for multi component / array uniform ${s} is not a numeric array: ${o}`)();continue}p.set(o,h)}}return new Uint8Array(r)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function PU(t,e,n=16){if(t!==e)return!1;const r=t,i=e;if(!Ef(r))return!1;if(Ef(i)&&r.length===i.length){for(let s=0;s<r.length;++s)if(i[s]!==r[s])return!1}return!0}function MU(t){return Ef(t)?t.slice():t}class NU{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const n=e?.shaderLayout.bindings?.find(i=>i.type==="uniform"&&i.name===e?.name);if(!n)throw new Error(e?.name);const r=n;for(const i of r.uniforms||[])this.bindingLayout[i.name]=i}}setUniforms(e){for(const[n,r]of Object.entries(e))this._setUniform(n,r),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${n}=${r}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,n){PU(this.uniforms[e],n)||(this.uniforms[e]=MU(n),this.modifiedUniforms[e]=!0,this.modified=!0)}}class OU{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(const[n,r]of Object.entries(e)){const i=n,s=new kU(r.uniformTypes||{});this.uniformBufferLayouts.set(i,s);const o=new NU({name:n});o.setUniforms(r.defaultUniforms||{}),this.uniformBlocks.set(i,o)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[n,r]of Object.entries(e))this.uniformBlocks.get(n)?.setUniforms(r);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const n=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(n)}createUniformBuffer(e,n,r){r&&this.setUniforms(r);const i=this.getUniformBufferByteLength(n),s=e.createBuffer({usage:Ke.UNIFORM|Ke.COPY_DST,byteLength:i}),o=this.getUniformBufferData(n);return s.write(o),s}getManagedUniformBuffer(e,n){if(!this.uniformBuffers.get(n)){const r=this.getUniformBufferByteLength(n),i=e.createBuffer({usage:Ke.UNIFORM|Ke.COPY_DST,byteLength:r});this.uniformBuffers.set(n,i)}return this.uniformBuffers.get(n)}updateUniformBuffers(){let e=!1;for(const n of this.uniformBlocks.keys()){const r=this.updateUniformBuffer(n);e||=r}return e&&he.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const n=this.uniformBlocks.get(e);let r=this.uniformBuffers.get(e),i=!1;if(r&&n?.needsRedraw){i||=n.needsRedraw;const s=this.getUniformBufferData(e);r=this.uniformBuffers.get(e),r?.write(s);const o=this.uniformBlocks.get(e)?.getAllUniforms();he.log(4,`Writing to uniform buffer ${String(e)}`,s,o)()}return i}}function xS(t){const e=ArrayBuffer.isView(t)?t.constructor:t;switch(e){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(e.constructor.name)}}function TS(t){switch(t){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(t)}}function DU(t,e,n){if(!e||e>4)throw new Error(`size ${e}`);const r=e;let i=xS(t);if(i==="uint8"&&n&&r===1)return"unorm8-webgl";if(i==="uint8"&&n&&r===3)return"unorm8x3-webgl";if(i==="uint8"||i==="sint8"){if(r===1||r===3)throw new Error(`size: ${e}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}if(i==="uint16"||i==="sint16"){if(r===1||r===3)throw new Error(`size: ${e}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}return r===1?i:`${i}x${r}`}class zp{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(n=>n.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(n=>n.attribute):[e.name]}mergeBufferLayouts(e,n){const r=[...e];for(const i of n){const s=r.findIndex(o=>o.name===i.name);s<0?r.push(i):r[s]=i}return r}getBufferIndex(e){const n=this.bufferLayouts.findIndex(r=>r.name===e);return n===-1&&he.warn(`BufferLayout: Missing buffer for "${e}".`)(),n}}function FU(t,e){const n=Object.fromEntries(t.attributes.map(i=>[i.name,i.location])),r=e.slice();return r.sort((i,s)=>{const o=i.attributes?i.attributes.map(h=>h.attribute):[i.name],a=s.attributes?s.attributes.map(h=>h.attribute):[s.name],u=Math.min(...o.map(h=>n[h])),f=Math.min(...a.map(h=>n[h]));return u-f}),r}class wn{constructor(e,n){this.name=e,this.attributes=n,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class Nw{constructor(e,n,r){this.name=e,this.type=n,this.attributes=r,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class gi extends wn{constructor(e,n){super(e,n),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class vi extends wn{constructor(e,n){super(e,n),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}}class fm extends wn{constructor(e,n,r){super(e,r),this.format=n}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}}class us extends wn{constructor(e,n,r,i){super(e,r),this.format=n,this.access=i}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}var di;(t=>{t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"})(di||(di={}));class yu{constructor(e,n,r,i,s,o,a){this.name=e,this.type=n,this.group=r,this.binding=i,this.attributes=s,this.resourceType=o,this.access=a}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class LU{constructor(e,n){this.name=e,this.type=n}}class BU{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i,this.interpolation=null}}class Ow{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i}}class UU{constructor(e,n,r,i){this.name=e,this.type=n,this.attributes=r,this.id=i}}class jU{constructor(e,n,r){this.name=e,this.type=n,this.attributes=r}}class zU{constructor(e,n=null,r){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=n,this.attributes=r}}class VU{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}const SS=new Float32Array(1),$U=new Int32Array(SS.buffer),Ot=new Uint16Array(1);function WU(t){SS[0]=t;const e=$U[0],n=e>>31&1;let r=e>>23&255,i=8388607&e;if(r===255)return Ot[0]=n<<15|31744|(i!==0?512:0),Ot[0];if(r===0){if(i===0)return Ot[0]=n<<15,Ot[0];i|=8388608;let s=113;for(;!(8388608&i);)i<<=1,s--;return r=127-s,i&=8388607,r>0?(i=(i>>126-r)+(i>>127-r&1),Ot[0]=n<<15|r<<10|i>>13,Ot[0]):(Ot[0]=n<<15,Ot[0])}return r=r-127+15,r>=31?(Ot[0]=n<<15|31744,Ot[0]):r<=0?r<-10?(Ot[0]=n<<15,Ot[0]):(i=(8388608|i)>>1-r,Ot[0]=n<<15|i>>13,Ot[0]):(i>>=13,Ot[0]=n<<15|r<<10|i,Ot[0])}const k_=new Uint32Array(1),ES=new Float32Array(k_.buffer,0,1);function Dw(t){const e=112+(t>>6&31)<<23|(63&t)<<17;return k_[0]=e,ES[0]}function HU(t,e,n,r,i,s,o,a,u){const f=r*(o>>=i)*(s>>=i)+n*o+e*a;switch(u){case"r8unorm":return[je(t,f,"8unorm",1)[0]];case"r8snorm":return[je(t,f,"8snorm",1)[0]];case"r8uint":return[je(t,f,"8uint",1)[0]];case"r8sint":return[je(t,f,"8sint",1)[0]];case"rg8unorm":{const h=je(t,f,"8unorm",2);return[h[0],h[1]]}case"rg8snorm":{const h=je(t,f,"8snorm",2);return[h[0],h[1]]}case"rg8uint":{const h=je(t,f,"8uint",2);return[h[0],h[1]]}case"rg8sint":{const h=je(t,f,"8sint",2);return[h[0],h[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const h=je(t,f,"8unorm",4);return[h[0],h[1],h[2],h[3]]}case"rgba8snorm":{const h=je(t,f,"8snorm",4);return[h[0],h[1],h[2],h[3]]}case"rgba8uint":{const h=je(t,f,"8uint",4);return[h[0],h[1],h[2],h[3]]}case"rgba8sint":{const h=je(t,f,"8sint",4);return[h[0],h[1],h[2],h[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const h=je(t,f,"8unorm",4);return[h[2],h[1],h[0],h[3]]}case"r16uint":return[je(t,f,"16uint",1)[0]];case"r16sint":return[je(t,f,"16sint",1)[0]];case"r16float":return[je(t,f,"16float",1)[0]];case"rg16uint":{const h=je(t,f,"16uint",2);return[h[0],h[1]]}case"rg16sint":{const h=je(t,f,"16sint",2);return[h[0],h[1]]}case"rg16float":{const h=je(t,f,"16float",2);return[h[0],h[1]]}case"rgba16uint":{const h=je(t,f,"16uint",4);return[h[0],h[1],h[2],h[3]]}case"rgba16sint":{const h=je(t,f,"16sint",4);return[h[0],h[1],h[2],h[3]]}case"rgba16float":{const h=je(t,f,"16float",4);return[h[0],h[1],h[2],h[3]]}case"r32uint":return[je(t,f,"32uint",1)[0]];case"r32sint":return[je(t,f,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[je(t,f,"32float",1)[0]];case"rg32uint":{const h=je(t,f,"32uint",2);return[h[0],h[1]]}case"rg32sint":{const h=je(t,f,"32sint",2);return[h[0],h[1]]}case"rg32float":{const h=je(t,f,"32float",2);return[h[0],h[1]]}case"rgba32uint":{const h=je(t,f,"32uint",4);return[h[0],h[1],h[2],h[3]]}case"rgba32sint":{const h=je(t,f,"32sint",4);return[h[0],h[1],h[2],h[3]]}case"rgba32float":{const h=je(t,f,"32float",4);return[h[0],h[1],h[2],h[3]]}case"rg11b10ufloat":{const h=new Uint32Array(t.buffer,f,1)[0],p=(4192256&h)>>11,g=(4290772992&h)>>22;return[Dw(2047&h),Dw(p),function(_){const v=112+(_>>5&31)<<23|(31&_)<<18;return k_[0]=v,ES[0]}(g),1]}}return null}function je(t,e,n,r){const i=[0,0,0,0];for(let f=0;f<r;++f)switch(n){case"8unorm":i[f]=t[e]/255,e++;break;case"8snorm":i[f]=t[e]/255*2-1,e++;break;case"8uint":i[f]=t[e],e++;break;case"8sint":i[f]=t[e]-127,e++;break;case"16uint":i[f]=t[e]|t[e+1]<<8,e+=2;break;case"16sint":i[f]=(t[e]|t[e+1]<<8)-32768,e+=2;break;case"16float":i[f]=(s=t[e]|t[e+1]<<8,o=void 0,a=void 0,u=void 0,o=(32768&s)>>15,u=1023&s,(a=(31744&s)>>10)==0?(o?-1:1)*Math.pow(2,-14)*(u/Math.pow(2,10)):a==31?u?NaN:1/0*(o?-1:1):(o?-1:1)*Math.pow(2,a-15)*(1+u/Math.pow(2,10))),e+=2;break;case"32uint":case"32sint":i[f]=t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24,e+=4;break;case"32float":i[f]=new Float32Array(t.buffer,e,1)[0],e+=4}var s,o,a,u;return i}function ze(t,e,n,r,i){for(let s=0;s<r;++s)switch(n){case"8unorm":t[e]=255*i[s],e++;break;case"8snorm":t[e]=.5*(i[s]+1)*255,e++;break;case"8uint":t[e]=i[s],e++;break;case"8sint":t[e]=i[s]+127,e++;break;case"16uint":new Uint16Array(t.buffer,e,1)[0]=i[s],e+=2;break;case"16sint":new Int16Array(t.buffer,e,1)[0]=i[s],e+=2;break;case"16float":{const o=WU(i[s]);new Uint16Array(t.buffer,e,1)[0]=o,e+=2;break}case"32uint":new Uint32Array(t.buffer,e,1)[0]=i[s],e+=4;break;case"32sint":new Int32Array(t.buffer,e,1)[0]=i[s],e+=4;break;case"32float":new Float32Array(t.buffer,e,1)[0]=i[s],e+=4}return i}const Vp={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class An{constructor(){this.id=An._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,n){if(e){n(Af.instance);for(const r of e)r instanceof Array?this.searchBlock(r,n):r.search(n);n(Cf.instance)}}constEvaluate(e,n){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}An._id=0;class Af extends An{}Af.instance=new Af;class Cf extends An{}Cf.instance=new Cf;const AS=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class tt extends An{constructor(){super()}}class El extends tt{constructor(e,n,r,i,s,o){super(),this.calls=new Set,this.name=e,this.args=n,this.returnType=r,this.body=i,this.startLine=s,this.endLine=o}get astNodeType(){return"function"}search(e){if(this.attributes)for(const n of this.attributes)e(n);e(this);for(const n of this.args)e(n);this.searchBlock(this.body,e)}}class XU extends tt{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class CS extends tt{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class hm extends tt{constructor(e,n){super(),this.body=e,this.loopId=n}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class RS extends tt{constructor(e,n,r,i){super(),this.init=e,this.condition=n,this.increment=r,this.body=i}get astNodeType(){return"for"}search(e){var n,r,i;(n=this.init)===null||n===void 0||n.search(e),(r=this.condition)===null||r===void 0||r.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}}class kr extends tt{constructor(e,n,r,i,s){super(),this.attributes=null,this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"var"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}class P_ extends tt{constructor(e,n,r){super(),this.attributes=null,this.name=e,this.type=n,this.value=r}get astNodeType(){return"override"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}}class al extends tt{constructor(e,n,r,i,s){super(),this.attributes=null,this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"let"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}class Uu extends tt{constructor(e,n,r,i,s){super(),this.attributes=null,this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"const"}constEvaluate(e,n){return this.value.constEvaluate(e,n)}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}var oo,qa,q,z;(t=>{t.increment="++",t.decrement="--"})(oo||(oo={})),(t=>{t.parse=function(e){const n=e;if(n=="parse")throw new Error("Invalid value for IncrementOperator");return t[n]}})(oo||(oo={}));class IS extends tt{constructor(e,n){super(),this.operator=e,this.variable=n}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(t=>{t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="})(qa||(qa={})),(t=>{t.parse=function(e){const n=e;if(n=="parse")throw new Error("Invalid value for AssignOperator");return n}})(qa||(qa={}));class kS extends tt{constructor(e,n,r){super(),this.operator=e,this.variable=n,this.value=r}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class M_ extends tt{constructor(e,n){super(),this.name=e,this.args=n}get astNodeType(){return"call"}isBuiltin(){return AS.has(this.name)}search(e){for(const n of this.args)n.search(e);e(this)}}class PS extends tt{constructor(e,n){super(),this.body=e,this.continuing=n}get astNodeType(){return"loop"}}class MS extends tt{constructor(e,n){super(),this.condition=e,this.cases=n}get astNodeType(){return"switch"}search(e){e(this);for(const n of this.cases)n.search(e)}}class NS extends tt{constructor(e,n,r,i){super(),this.condition=e,this.body=n,this.elseif=r,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class OS extends tt{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}}class YU extends tt{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class qU extends tt{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class DS extends tt{constructor(e,n){super(),this.severity=e,this.rule=n}get astNodeType(){return"diagnostic"}}class N_ extends tt{constructor(e,n){super(),this.name=e,this.type=n}get astNodeType(){return"alias"}}class KU extends tt{constructor(){super()}get astNodeType(){return"discard"}}class FS extends tt{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class LS extends tt{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class re extends tt{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let n=e[0];if(n.name==="f32")return n;for(let r=1;r<e.length;++r){const i=re._priority.get(n.name);re._priority.get(e[r].name)<i&&(n=e[r])}return n.name==="x32"?re.i32:n}getTypeName(){return this.name}}re.x32=new re("x32"),re.f32=new re("f32"),re.i32=new re("i32"),re.u32=new re("u32"),re.f16=new re("f16"),re.bool=new re("bool"),re.void=new re("void"),re._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class Fw extends re{constructor(e){super(e)}}class Ar extends re{constructor(e,n,r,i){super(e),this.members=n,this.startLine=r,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let n=0;n<this.members.length;n++)if(this.members[n].name==e)return n;return-1}search(e){for(const n of this.members)e(n)}}class $ extends re{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}$.vec2f=new $("vec2",re.f32,null),$.vec3f=new $("vec3",re.f32,null),$.vec4f=new $("vec4",re.f32,null),$.vec2i=new $("vec2",re.i32,null),$.vec3i=new $("vec3",re.i32,null),$.vec4i=new $("vec4",re.i32,null),$.vec2u=new $("vec2",re.u32,null),$.vec3u=new $("vec3",re.u32,null),$.vec4u=new $("vec4",re.u32,null),$.vec2h=new $("vec2",re.f16,null),$.vec3h=new $("vec3",re.f16,null),$.vec4h=new $("vec4",re.f16,null),$.vec2b=new $("vec2",re.bool,null),$.vec3b=new $("vec3",re.bool,null),$.vec4b=new $("vec4",re.bool,null),$.mat2x2f=new $("mat2x2",re.f32,null),$.mat2x3f=new $("mat2x3",re.f32,null),$.mat2x4f=new $("mat2x4",re.f32,null),$.mat3x2f=new $("mat3x2",re.f32,null),$.mat3x3f=new $("mat3x3",re.f32,null),$.mat3x4f=new $("mat3x4",re.f32,null),$.mat4x2f=new $("mat4x2",re.f32,null),$.mat4x3f=new $("mat4x3",re.f32,null),$.mat4x4f=new $("mat4x4",re.f32,null),$.mat2x2h=new $("mat2x2",re.f16,null),$.mat2x3h=new $("mat2x3",re.f16,null),$.mat2x4h=new $("mat2x4",re.f16,null),$.mat3x2h=new $("mat3x2",re.f16,null),$.mat3x3h=new $("mat3x3",re.f16,null),$.mat3x4h=new $("mat3x4",re.f16,null),$.mat4x2h=new $("mat4x2",re.f16,null),$.mat4x3h=new $("mat4x3",re.f16,null),$.mat4x4h=new $("mat4x4",re.f16,null),$.mat2x2i=new $("mat2x2",re.i32,null),$.mat2x3i=new $("mat2x3",re.i32,null),$.mat2x4i=new $("mat2x4",re.i32,null),$.mat3x2i=new $("mat3x2",re.i32,null),$.mat3x3i=new $("mat3x3",re.i32,null),$.mat3x4i=new $("mat3x4",re.i32,null),$.mat4x2i=new $("mat4x2",re.i32,null),$.mat4x3i=new $("mat4x3",re.i32,null),$.mat4x4i=new $("mat4x4",re.i32,null),$.mat2x2u=new $("mat2x2",re.u32,null),$.mat2x3u=new $("mat2x3",re.u32,null),$.mat2x4u=new $("mat2x4",re.u32,null),$.mat3x2u=new $("mat3x2",re.u32,null),$.mat3x3u=new $("mat3x3",re.u32,null),$.mat3x4u=new $("mat3x4",re.u32,null),$.mat4x2u=new $("mat4x2",re.u32,null),$.mat4x3u=new $("mat4x3",re.u32,null),$.mat4x4u=new $("mat4x4",re.u32,null);class ju extends re{constructor(e,n,r,i){super(e),this.storage=n,this.type=r,this.access=i}get astNodeType(){return"pointer"}}class ll extends re{constructor(e,n,r,i){super(e),this.attributes=n,this.format=r,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class Ka extends re{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return"sampler"}}class zn extends An{constructor(){super(),this.postfix=null}}class fs extends zn{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class Zn extends zn{constructor(e,n){super(),this.type=e,this.args=n}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const n of this.args)n.search(e)}constEvaluate(e,n){return n&&(n[0]=this.type),e.evalExpression(this,e.context)}}class O_ extends zn{constructor(e,n){super(),this.cachedReturnValue=null,this.name=e,this.args=n}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return AS.has(this.name)}constEvaluate(e,n){return e.evalExpression(this,e.context)}search(e){for(const n of this.args)n.search(e);e(this)}}class sn extends zn{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,n){return e.evalExpression(this,e.context)}}class BS extends zn{constructor(e,n){super(),this.name=e,this.initializer=n}get astNodeType(){return"constExpr"}constEvaluate(e,n){if(this.initializer){const r=e.evalExpression(this.initializer,e.context);return r!==null&&this.postfix?r.getSubData(e,this.postfix,e.context):r}return null}search(e){this.initializer.search(e)}}class vt extends zn{constructor(e,n){super(),this.value=e,this.type=n}get astNodeType(){return"literalExpr"}constEvaluate(e,n){return n!==void 0&&(n[0]=this.type),this.value}get isScalar(){return this.value instanceof j}get isVector(){return this.value instanceof N||this.value instanceof Ce}get scalarValue(){return this.value instanceof j?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof N||this.value instanceof Ce?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class US extends zn{constructor(e,n){super(),this.type=e,this.value=n}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class Io extends zn{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class jS extends zn{constructor(){super()}}class gt extends jS{constructor(e,n){super(),this.operator=e,this.right=n}get astNodeType(){return"unaryOp"}constEvaluate(e,n){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class Dn extends jS{constructor(e,n,r){super(),this.operator=e,this.left=n,this.right=r}get astNodeType(){return"binaryOp"}_getPromotedType(e,n){return e.name===n.name?e:e.name==="f32"||n.name==="f32"?re.f32:e.name==="u32"||n.name==="u32"?re.u32:re.i32}constEvaluate(e,n){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class zS extends An{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class zu extends zn{constructor(){super()}get astNodeType(){return"default"}}class VS extends zS{constructor(e,n){super(n),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class $S extends zS{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class Lw extends An{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return"argument"}}class ZU extends An{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class Bw extends An{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return"member"}}class WS extends An{constructor(e,n){super(),this.name=e,this.value=n}get astNodeType(){return"attribute"}}class En{constructor(e,n){this.parent=null,this.typeInfo=e,this.parent=n,this.id=En._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,n,r,i){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,n,r){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}}En._id=0;class dm extends En{constructor(){super(new wn("void",null),null)}toString(){return"void"}}dm.void=new dm;class Zs extends En{constructor(e){super(new fm("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,n,r,i){this.reference.setDataValue(e,n,r,i)}getSubData(e,n,r){return n?this.reference.getSubData(e,n,r):this}toString(){return`&${this.reference.toString()}`}}class j extends En{constructor(e,n,r=null){super(n,r),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!=0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",n)}clone(){if(this.data instanceof Float32Array)return new j(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new j(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new j(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,n,r,i){if(r)return void console.error("SetDataValue: Scalar data does not support postfix",r);if(!(n instanceof j))return void console.error("SetDataValue: Invalid value",n);let s=n.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?s=Math.floor(s):this.typeInfo.name==="bool"&&(s=s?1:0),this.data[0]=s}getSubData(e,n,r){return n?(console.error("getSubData: Scalar data does not support postfix",n),null):this}toString(){return`${this.value}`}}function QU(t,e,n){const r=e.length;return r===2?n==="f32"?new N(new Float32Array(e),t.getTypeInfo("vec2f")):n==="i32"||n==="bool"?new N(new Int32Array(e),t.getTypeInfo("vec2i")):n==="u32"?new N(new Uint32Array(e),t.getTypeInfo("vec2u")):n==="f16"?new N(new Float32Array(e),t.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${n}`),null):r===3?n==="f32"?new N(new Float32Array(e),t.getTypeInfo("vec3f")):n==="i32"||n==="bool"?new N(new Int32Array(e),t.getTypeInfo("vec3i")):n==="u32"?new N(new Uint32Array(e),t.getTypeInfo("vec3u")):n==="f16"?new N(new Float32Array(e),t.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${n}`),null):r===4?n==="f32"?new N(new Float32Array(e),t.getTypeInfo("vec4f")):n==="i32"||n==="bool"?new N(new Int32Array(e),t.getTypeInfo("vec4i")):n==="u32"?new N(new Uint32Array(e),t.getTypeInfo("vec4u")):n==="f16"?new N(new Float32Array(e),t.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${n}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}class N extends En{constructor(e,n,r=null){if(super(n,r),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const i=this.typeInfo.name;i==="vec2f"||i==="vec3f"||i==="vec4f"?this.data=new Float32Array(e):i==="vec2i"||i==="vec3i"||i==="vec4i"?this.data=new Int32Array(e):i==="vec2u"||i==="vec3u"||i==="vec4u"?this.data=new Uint32Array(e):i==="vec2h"||i==="vec3h"||i==="vec4h"?this.data=new Float32Array(e):i==="vec2b"||i==="vec3b"||i==="vec4b"?this.data=new Int32Array(e):i==="vec2"||i==="vec3"||i==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${i}`)}}clone(){if(this.data instanceof Float32Array)return new N(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new N(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new N(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,n,r,i){r instanceof fs?console.error("TODO: Set vector postfix"):n instanceof N?this.data=n.data:console.error("SetDataValue: Invalid value",n)}getSubData(e,n,r){if(n===null)return this;let i=e.getTypeInfo("f32");if(this.typeInfo instanceof us)i=this.typeInfo.format||i;else{const o=this.typeInfo.name;o==="vec2f"||o==="vec3f"||o==="vec4f"?i=e.getTypeInfo("f32"):o==="vec2i"||o==="vec3i"||o==="vec4i"?i=e.getTypeInfo("i32"):o==="vec2b"||o==="vec3b"||o==="vec4b"?i=e.getTypeInfo("bool"):o==="vec2u"||o==="vec3u"||o==="vec4u"?i=e.getTypeInfo("u32"):o==="vec2h"||o==="vec3h"||o==="vec4h"?i=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${o}`)}let s=this;for(;n!==null&&s!==null;){if(n instanceof Io){const o=n.index;let a=-1;if(o instanceof vt){if(!(o.value instanceof j))return console.error(`GetSubData: Invalid array index ${o.value}`),null;a=o.value.value}else{const u=e.evalExpression(o,r);if(!(u instanceof j))return console.error("GetSubData: Unknown index type",o),null;a=u.value}if(a<0||a>=s.data.length)return console.error("GetSubData: Index out of range",a),null;if(s.data instanceof Float32Array){const u=new Float32Array(s.data.buffer,s.data.byteOffset+4*a,1);return new j(u,i)}if(s.data instanceof Int32Array){const u=new Int32Array(s.data.buffer,s.data.byteOffset+4*a,1);return new j(u,i)}if(s.data instanceof Uint32Array){const u=new Uint32Array(s.data.buffer,s.data.byteOffset+4*a,1);return new j(u,i)}throw"GetSubData: Invalid data type"}if(!(n instanceof fs))return console.error("GetSubData: Unknown postfix",n),null;{const o=n.value.toLowerCase();if(o.length===1){let u=0;if(o==="x"||o==="r")u=0;else if(o==="y"||o==="g")u=1;else if(o==="z"||o==="b")u=2;else{if(o!=="w"&&o!=="a")return console.error(`GetSubData: Unknown member ${o}`),null;u=3}if(this.data instanceof Float32Array){let f=new Float32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new j(f,i,this)}if(this.data instanceof Int32Array){let f=new Int32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new j(f,i,this)}if(this.data instanceof Uint32Array){let f=new Uint32Array(this.data.buffer,this.data.byteOffset+4*u,1);return new j(f,i,this)}}const a=[];for(const u of o)u==="x"||u==="r"?a.push(this.data[0]):u==="y"||u==="g"?a.push(this.data[1]):u==="z"||u==="b"?a.push(this.data[2]):u==="w"||u==="a"?a.push(this.data[3]):console.error(`GetDataValue: Unknown member ${u}`);s=QU(e,a,i.name)}n=n.postfix}return s}toString(){let e=`${this.data[0]}`;for(let n=1;n<this.data.length;++n)e+=`, ${this.data[n]}`;return e}}class Ce extends En{constructor(e,n,r=null){super(n,r),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new Ce(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,n,r,i){r instanceof fs?console.error("TODO: Set matrix postfix"):n instanceof Ce?this.data=n.data:console.error("SetDataValue: Invalid value",n)}getSubData(e,n,r){if(n===null)return this;const i=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof us)this.typeInfo.format;else if(i.endsWith("f"))e.getTypeInfo("f32");else if(i.endsWith("i"))e.getTypeInfo("i32");else if(i.endsWith("u"))e.getTypeInfo("u32");else{if(!i.endsWith("h"))return console.error(`GetDataValue: Unknown type ${i}`),null;e.getTypeInfo("f16")}if(n instanceof Io){const s=n.index;let o=-1;if(s instanceof vt){if(!(s.value instanceof j))return console.error(`GetDataValue: Invalid array index ${s.value}`),null;o=s.value.value}else{const f=e.evalExpression(s,r);if(!(f instanceof j))return console.error("GetDataValue: Unknown index type",s),null;o=f.value}if(o<0||o>=this.data.length)return console.error("GetDataValue: Index out of range",o),null;const a=i.endsWith("h")?"h":"f";let u;if(i==="mat2x2"||i==="mat2x2f"||i==="mat2x2h"||i==="mat3x2"||i==="mat3x2f"||i==="mat3x2h"||i==="mat4x2"||i==="mat4x2f"||i==="mat4x2h")u=new N(new Float32Array(this.data.buffer,this.data.byteOffset+2*o*4,2),e.getTypeInfo(`vec2${a}`));else if(i==="mat2x3"||i==="mat2x3f"||i==="mat2x3h"||i==="mat3x3"||i==="mat3x3f"||i==="mat3x3h"||i==="mat4x3"||i==="mat4x3f"||i==="mat4x3h")u=new N(new Float32Array(this.data.buffer,this.data.byteOffset+3*o*4,3),e.getTypeInfo(`vec3${a}`));else{if(i!=="mat2x4"&&i!=="mat2x4f"&&i!=="mat2x4h"&&i!=="mat3x4"&&i!=="mat3x4f"&&i!=="mat3x4h"&&i!=="mat4x4"&&i!=="mat4x4f"&&i!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${i}`),null;u=new N(new Float32Array(this.data.buffer,this.data.byteOffset+4*o*4,4),e.getTypeInfo(`vec4${a}`))}return n.postfix?u.getSubData(e,n.postfix,r):u}return console.error("GetDataValue: Invalid postfix",n),null}toString(){let e=`${this.data[0]}`;for(let n=1;n<this.data.length;++n)e+=`, ${this.data[n]}`;return e}}class ct extends En{constructor(e,n,r=0,i=null){super(n,i),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=r}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new ct(e.buffer,this.typeInfo,0,null)}setDataValue(e,n,r,i){if(n===null)return void console.log("setDataValue: NULL data.");let s=this.offset,o=this.typeInfo;for(;r;){if(r instanceof Io)if(o instanceof vi){const a=r.index;if(a instanceof vt){if(!(a.value instanceof j))return void console.error(`SetDataValue: Invalid index type ${a.value}`);s+=a.value.value*o.stride}else{const u=e.evalExpression(a,i);if(!(u instanceof j))return void console.error("SetDataValue: Unknown index type",a);s+=u.value*o.stride}o=o.format}else console.error(`SetDataValue: Type ${o.getTypeName()} is not an array`);else{if(!(r instanceof fs))return void console.error("SetDataValue: Unknown postfix type",r);{const a=r.value;if(o instanceof gi){let u=!1;for(const f of o.members)if(f.name===a){s+=f.offset,o=f.type,u=!0;break}if(!u)return void console.error(`SetDataValue: Member ${a} not found`)}else if(o instanceof wn){const u=o.getTypeName();let f=0;if(a==="x"||a==="r")f=0;else if(a==="y"||a==="g")f=1;else if(a==="z"||a==="b")f=2;else{if(a!=="w"&&a!=="a")return void console.error(`SetDataValue: Unknown member ${a}`);f=3}if(!(n instanceof j))return void console.error("SetDataValue: Invalid value",n);const h=n.value;return u==="vec2f"?void(new Float32Array(this.buffer,s,2)[f]=h):u==="vec3f"?void(new Float32Array(this.buffer,s,3)[f]=h):u==="vec4f"?void(new Float32Array(this.buffer,s,4)[f]=h):u==="vec2i"?void(new Int32Array(this.buffer,s,2)[f]=h):u==="vec3i"?void(new Int32Array(this.buffer,s,3)[f]=h):u==="vec4i"?void(new Int32Array(this.buffer,s,4)[f]=h):u==="vec2u"?void(new Uint32Array(this.buffer,s,2)[f]=h):u==="vec3u"?void(new Uint32Array(this.buffer,s,3)[f]=h):u==="vec4u"?void(new Uint32Array(this.buffer,s,4)[f]=h):void console.error(`SetDataValue: Type ${u} is not a struct`)}}}r=r.postfix}this.setData(e,n,o,s,i)}setData(e,n,r,i,s){const o=r.getTypeName();if(o!=="f32"&&o!=="f16")if(o!=="i32"&&o!=="atomic<i32>"&&o!=="x32")if(o!=="u32"&&o!=="atomic<u32>")if(o!=="bool")if(o!=="vec2f"&&o!=="vec2h")if(o!=="vec3f"&&o!=="vec3h")if(o!=="vec4f"&&o!=="vec4h")if(o!=="vec2i")if(o!=="vec3i")if(o!=="vec4i")if(o!=="vec2u")if(o!=="vec3u")if(o!=="vec4u")if(o!=="vec2b")if(o!=="vec3b")if(o!=="vec4b")if(o!=="mat2x2f"&&o!=="mat2x2h")if(o!=="mat2x3f"&&o!=="mat2x3h")if(o!=="mat2x4f"&&o!=="mat2x4h")if(o!=="mat3x2f"&&o!=="mat3x2h")if(o!=="mat3x3f"&&o!=="mat3x3h")if(o!=="mat3x4f"&&o!=="mat3x4h")if(o!=="mat4x2f"&&o!=="mat4x2h")if(o!=="mat4x3f"&&o!=="mat4x3h")if(o!=="mat4x4f"&&o!=="mat4x4h")if(n instanceof ct){if(r===n.typeInfo)return void new Uint8Array(this.buffer,i,n.buffer.byteLength).set(new Uint8Array(n.buffer));console.error("SetDataValue: Type mismatch",o,n.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${o}`);else{const a=new Float32Array(this.buffer,i,16);n instanceof Ce?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7],a[8]=n.data[8],a[9]=n.data[9],a[10]=n.data[10],a[11]=n.data[11],a[12]=n.data[12],a[13]=n.data[13],a[14]=n.data[14],a[15]=n.data[15]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15])}else{const a=new Float32Array(this.buffer,i,12);n instanceof Ce?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7],a[8]=n.data[8],a[9]=n.data[9],a[10]=n.data[10],a[11]=n.data[11]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11])}else{const a=new Float32Array(this.buffer,i,8);n instanceof Ce?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7])}else{const a=new Float32Array(this.buffer,i,12);n instanceof Ce?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7],a[8]=n.data[8],a[9]=n.data[9],a[10]=n.data[10],a[11]=n.data[11]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11])}else{const a=new Float32Array(this.buffer,i,9);n instanceof Ce?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7],a[8]=n.data[8]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[8]=n[8])}else{const a=new Float32Array(this.buffer,i,6);n instanceof Ce?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5])}else{const a=new Float32Array(this.buffer,i,8);n instanceof Ce?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5],a[6]=n.data[6],a[7]=n.data[7]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7])}else{const a=new Float32Array(this.buffer,i,6);n instanceof Ce?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3],a[4]=n.data[4],a[5]=n.data[5]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[4]=n[4],a[5]=n[5])}else{const a=new Float32Array(this.buffer,i,4);n instanceof Ce?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3])}else{const a=new Uint32Array(this.buffer,i,4);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3])}else{const a=new Uint32Array(this.buffer,i,3);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2]):(a[0]=n[0],a[1]=n[1],a[2]=n[2])}else{const a=new Uint32Array(this.buffer,i,2);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1]):(a[0]=n[0],a[1]=n[1])}else{const a=new Uint32Array(this.buffer,i,4);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3])}else{const a=new Uint32Array(this.buffer,i,3);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2]):(a[0]=n[0],a[1]=n[1],a[2]=n[2])}else{const a=new Uint32Array(this.buffer,i,2);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1]):(a[0]=n[0],a[1]=n[1])}else{const a=new Int32Array(this.buffer,i,4);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3])}else{const a=new Int32Array(this.buffer,i,3);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2]):(a[0]=n[0],a[1]=n[1],a[2]=n[2])}else{const a=new Int32Array(this.buffer,i,2);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1]):(a[0]=n[0],a[1]=n[1])}else{const a=new Float32Array(this.buffer,i,4);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2],a[3]=n.data[3]):(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3])}else{const a=new Float32Array(this.buffer,i,3);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1],a[2]=n.data[2]):(a[0]=n[0],a[1]=n[1],a[2]=n[2])}else{const a=new Float32Array(this.buffer,i,2);n instanceof N?(a[0]=n.data[0],a[1]=n.data[1]):(a[0]=n[0],a[1]=n[1])}else n instanceof j&&(new Int32Array(this.buffer,i,1)[0]=n.value);else n instanceof j&&(new Uint32Array(this.buffer,i,1)[0]=n.value);else n instanceof j&&(new Int32Array(this.buffer,i,1)[0]=n.value);else n instanceof j&&(new Float32Array(this.buffer,i,1)[0]=n.value)}getSubData(e,n,r){var i,s,o;if(n===null)return this;let a=this.offset,u=this.typeInfo;for(;n;){if(n instanceof Io){const h=n.index,p=h instanceof zn?e.evalExpression(h,r):h;let g=0;if(p instanceof j?g=p.value:typeof p=="number"?g=p:console.error("GetDataValue: Invalid index type",h),u instanceof vi)a+=g*u.stride,u=u.format;else{const _=u.getTypeName();_==="mat4x4"||_==="mat4x4f"||_==="mat4x4h"?(a+=16*g,u=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${u.getTypeName()} is not an array`)}}else{if(!(n instanceof fs))return console.error("GetDataValue: Unknown postfix type",n),null;{const h=n.value;if(u instanceof gi){let p=!1;for(const g of u.members)if(g.name===h){a+=g.offset,u=g.type,p=!0;break}if(!p)return console.error(`GetDataValue: Member ${h} not found`),null}else if(u instanceof wn){const p=u.getTypeName();if(p==="vec2f"||p==="vec3f"||p==="vec4f"||p==="vec2i"||p==="vec3i"||p==="vec4i"||p==="vec2u"||p==="vec3u"||p==="vec4u"||p==="vec2b"||p==="vec3b"||p==="vec4b"||p==="vec2h"||p==="vec3h"||p==="vec4h"||p==="vec2"||p==="vec3"||p==="vec4"){if(h.length>0&&h.length<5){let g="f";const _=[];for(let v=0;v<h.length;++v){const w=h[v].toLowerCase();let x=0;if(w==="x"||w==="r")x=0;else if(w==="y"||w==="g")x=1;else if(w==="z"||w==="b")x=2;else{if(w!=="w"&&w!=="a")return console.error(`Unknown member ${h}`),null;x=3}if(h.length===1){if(p.endsWith("f"))return this.buffer.byteLength<a+4*x+4?(console.log("Insufficient buffer data"),null):new j(new Float32Array(this.buffer,a+4*x,1),e.getTypeInfo("f32"),this);if(p.endsWith("h"))return new j(new Float32Array(this.buffer,a+4*x,1),e.getTypeInfo("f16"),this);if(p.endsWith("i"))return new j(new Int32Array(this.buffer,a+4*x,1),e.getTypeInfo("i32"),this);if(p.endsWith("b"))return new j(new Int32Array(this.buffer,a+4*x,1),e.getTypeInfo("bool"),this);if(p.endsWith("u"))return new j(new Uint32Array(this.buffer,a+4*x,1),e.getTypeInfo("i32"),this)}if(p==="vec2f")_.push(new Float32Array(this.buffer,a,2)[x]);else if(p==="vec3f"){if(a+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const T=new Float32Array(this.buffer,a,3);_.push(T[x])}else if(p==="vec4f")_.push(new Float32Array(this.buffer,a,4)[x]);else if(p==="vec2i")g="i",_.push(new Int32Array(this.buffer,a,2)[x]);else if(p==="vec3i")g="i",_.push(new Int32Array(this.buffer,a,3)[x]);else if(p==="vec4i")g="i",_.push(new Int32Array(this.buffer,a,4)[x]);else if(p==="vec2u"){g="u";const T=new Uint32Array(this.buffer,a,2);_.push(T[x])}else p==="vec3u"?(g="u",_.push(new Uint32Array(this.buffer,a,3)[x])):p==="vec4u"&&(g="u",_.push(new Uint32Array(this.buffer,a,4)[x]))}return _.length===2?u=e.getTypeInfo(`vec2${g}`):_.length===3?u=e.getTypeInfo(`vec3${g}`):_.length===4?u=e.getTypeInfo(`vec4${g}`):console.error(`GetDataValue: Invalid vector length ${_.length}`),new N(_,u,null)}return console.error(`GetDataValue: Unknown member ${h}`),null}return console.error(`GetDataValue: Type ${p} is not a struct`),null}}}n=n.postfix}const f=u.getTypeName();return f==="f32"?new j(new Float32Array(this.buffer,a,1),u,this):f==="i32"?new j(new Int32Array(this.buffer,a,1),u,this):f==="u32"?new j(new Uint32Array(this.buffer,a,1),u,this):f==="vec2f"?new N(new Float32Array(this.buffer,a,2),u,this):f==="vec3f"?new N(new Float32Array(this.buffer,a,3),u,this):f==="vec4f"?new N(new Float32Array(this.buffer,a,4),u,this):f==="vec2i"?new N(new Int32Array(this.buffer,a,2),u,this):f==="vec3i"?new N(new Int32Array(this.buffer,a,3),u,this):f==="vec4i"?new N(new Int32Array(this.buffer,a,4),u,this):f==="vec2u"?new N(new Uint32Array(this.buffer,a,2),u,this):f==="vec3u"?new N(new Uint32Array(this.buffer,a,3),u,this):f==="vec4u"?new N(new Uint32Array(this.buffer,a,4),u,this):u instanceof us&&u.name==="atomic"?((i=u.format)===null||i===void 0?void 0:i.name)==="u32"?new j(new Uint32Array(this.buffer,a,1)[0],u.format,this):((s=u.format)===null||s===void 0?void 0:s.name)==="i32"?new j(new Int32Array(this.buffer,a,1)[0],u.format,this):(console.error(`GetDataValue: Invalid atomic format ${(o=u.format)===null||o===void 0?void 0:o.name}`),null):new ct(this.buffer,u,a,this)}toString(){let e="";if(this.typeInfo instanceof vi)if(this.typeInfo.format.name==="f32"){const n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}`;for(let r=1;r<n.length;++r)e+=`, ${n[r]}`}else if(this.typeInfo.format.name==="i32"){const n=new Int32Array(this.buffer,this.offset);e=`[${n[0]}`;for(let r=1;r<n.length;++r)e+=`, ${n[r]}`}else if(this.typeInfo.format.name==="u32"){const n=new Uint32Array(this.buffer,this.offset);e=`[${n[0]}`;for(let r=1;r<n.length;++r)e+=`, ${n[r]}`}else if(this.typeInfo.format.name==="vec2f"){const n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}, ${n[1]}]`;for(let r=1;r<n.length/2;++r)e+=`, [${n[2*r]}, ${n[2*r+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}, ${n[1]}, ${n[2]}]`;for(let r=4;r<n.length;r+=4)e+=`, [${n[r]}, ${n[r+1]}, ${n[r+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const n=new Float32Array(this.buffer,this.offset);e=`[${n[0]}, ${n[1]}, ${n[2]}, ${n[3]}]`;for(let r=4;r<n.length;r+=4)e+=`, [${n[r]}, ${n[r+1]}, ${n[r+2]}, ${n[r+3]}]`}else e="[...]";else this.typeInfo instanceof gi?e+="{...}":e="[...]";return e}}class Cr extends En{constructor(e,n,r,i){super(n,null),this.data=e,this.descriptor=r,this.view=i}clone(){return new Cr(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,n;const r=this.descriptor.size;return r instanceof Array&&r.length>0?(e=r[0])!==null&&e!==void 0?e:0:r instanceof Object&&(n=r.width)!==null&&n!==void 0?n:0}get height(){var e,n;const r=this.descriptor.size;return r instanceof Array&&r.length>1?(e=r[1])!==null&&e!==void 0?e:0:r instanceof Object&&(n=r.height)!==null&&n!==void 0?n:0}get depthOrArrayLayers(){var e,n;const r=this.descriptor.size;return r instanceof Array&&r.length>2?(e=r[2])!==null&&e!==void 0?e:0:r instanceof Object&&(n=r.depthOrArrayLayers)!==null&&n!==void 0?n:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const n=[this.width,this.height,this.depthOrArrayLayers];for(let r=0;r<n.length;++r)n[r]=Math.max(1,n[r]>>e);return n}get texelByteSize(){const e=this.format,n=Vp[e];return n?n.isDepthStencil?4:n.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,n=Vp[e];return!!n&&n.isDepthStencil}getGpuSize(){const e=this.format,n=Vp[e],r=this.width;if(!e||r<=0||!n)return-1;const i=this.height,s=this.depthOrArrayLayers,o=this.dimension;return r/n.blockWidth*(o==="1d"?1:i/n.blockHeight)*n.bytesPerBlock*s}getPixel(e,n,r=0,i=0){const s=this.texelByteSize,o=this.bytesPerRow,a=this.height,u=this.data[i];return HU(new Uint8Array(u),e,n,r,i,a,o,s,this.format)}setPixel(e,n,r,i,s){const o=this.texelByteSize,a=this.bytesPerRow,u=this.height,f=this.data[i];(function(h,p,g,_,v,w,x,T,A,E){const R=_*(x>>=v)*(w>>=v)+g*x+p*T;switch(A){case"r8unorm":return void ze(h,R,"8unorm",1,E);case"r8snorm":return void ze(h,R,"8snorm",1,E);case"r8uint":return void ze(h,R,"8uint",1,E);case"r8sint":return void ze(h,R,"8sint",1,E);case"rg8unorm":return void ze(h,R,"8unorm",2,E);case"rg8snorm":return void ze(h,R,"8snorm",2,E);case"rg8uint":return void ze(h,R,"8uint",2,E);case"rg8sint":return void ze(h,R,"8sint",2,E);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void ze(h,R,"8unorm",4,E);case"rgba8snorm":return void ze(h,R,"8snorm",4,E);case"rgba8uint":return void ze(h,R,"8uint",4,E);case"rgba8sint":return void ze(h,R,"8sint",4,E);case"r16uint":return void ze(h,R,"16uint",1,E);case"r16sint":return void ze(h,R,"16sint",1,E);case"r16float":return void ze(h,R,"16float",1,E);case"rg16uint":return void ze(h,R,"16uint",2,E);case"rg16sint":return void ze(h,R,"16sint",2,E);case"rg16float":return void ze(h,R,"16float",2,E);case"rgba16uint":return void ze(h,R,"16uint",4,E);case"rgba16sint":return void ze(h,R,"16sint",4,E);case"rgba16float":return void ze(h,R,"16float",4,E);case"r32uint":return void ze(h,R,"32uint",1,E);case"r32sint":return void ze(h,R,"32sint",1,E);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void ze(h,R,"32float",1,E);case"rg32uint":return void ze(h,R,"32uint",2,E);case"rg32sint":return void ze(h,R,"32sint",2,E);case"rg32float":return void ze(h,R,"32float",2,E);case"rgba32uint":return void ze(h,R,"32uint",4,E);case"rgba32sint":return void ze(h,R,"32sint",4,E);case"rgba32float":return void ze(h,R,"32float",4,E);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(f),e,n,r,i,u,a,o,this.format,s)}}(t=>{t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"})(z||(z={}));class V{constructor(e,n,r){this.name=e,this.type=n,this.rule=r}toString(){return this.name}}class I{}q=I,I.none=new V("",z.reserved,""),I.eof=new V("EOF",z.token,""),I.reserved={asm:new V("asm",z.reserved,"asm"),bf16:new V("bf16",z.reserved,"bf16"),do:new V("do",z.reserved,"do"),enum:new V("enum",z.reserved,"enum"),f16:new V("f16",z.reserved,"f16"),f64:new V("f64",z.reserved,"f64"),handle:new V("handle",z.reserved,"handle"),i8:new V("i8",z.reserved,"i8"),i16:new V("i16",z.reserved,"i16"),i64:new V("i64",z.reserved,"i64"),mat:new V("mat",z.reserved,"mat"),premerge:new V("premerge",z.reserved,"premerge"),regardless:new V("regardless",z.reserved,"regardless"),typedef:new V("typedef",z.reserved,"typedef"),u8:new V("u8",z.reserved,"u8"),u16:new V("u16",z.reserved,"u16"),u64:new V("u64",z.reserved,"u64"),unless:new V("unless",z.reserved,"unless"),using:new V("using",z.reserved,"using"),vec:new V("vec",z.reserved,"vec"),void:new V("void",z.reserved,"void")},I.keywords={array:new V("array",z.keyword,"array"),atomic:new V("atomic",z.keyword,"atomic"),bool:new V("bool",z.keyword,"bool"),f32:new V("f32",z.keyword,"f32"),i32:new V("i32",z.keyword,"i32"),mat2x2:new V("mat2x2",z.keyword,"mat2x2"),mat2x3:new V("mat2x3",z.keyword,"mat2x3"),mat2x4:new V("mat2x4",z.keyword,"mat2x4"),mat3x2:new V("mat3x2",z.keyword,"mat3x2"),mat3x3:new V("mat3x3",z.keyword,"mat3x3"),mat3x4:new V("mat3x4",z.keyword,"mat3x4"),mat4x2:new V("mat4x2",z.keyword,"mat4x2"),mat4x3:new V("mat4x3",z.keyword,"mat4x3"),mat4x4:new V("mat4x4",z.keyword,"mat4x4"),ptr:new V("ptr",z.keyword,"ptr"),sampler:new V("sampler",z.keyword,"sampler"),sampler_comparison:new V("sampler_comparison",z.keyword,"sampler_comparison"),struct:new V("struct",z.keyword,"struct"),texture_1d:new V("texture_1d",z.keyword,"texture_1d"),texture_2d:new V("texture_2d",z.keyword,"texture_2d"),texture_2d_array:new V("texture_2d_array",z.keyword,"texture_2d_array"),texture_3d:new V("texture_3d",z.keyword,"texture_3d"),texture_cube:new V("texture_cube",z.keyword,"texture_cube"),texture_cube_array:new V("texture_cube_array",z.keyword,"texture_cube_array"),texture_multisampled_2d:new V("texture_multisampled_2d",z.keyword,"texture_multisampled_2d"),texture_storage_1d:new V("texture_storage_1d",z.keyword,"texture_storage_1d"),texture_storage_2d:new V("texture_storage_2d",z.keyword,"texture_storage_2d"),texture_storage_2d_array:new V("texture_storage_2d_array",z.keyword,"texture_storage_2d_array"),texture_storage_3d:new V("texture_storage_3d",z.keyword,"texture_storage_3d"),texture_depth_2d:new V("texture_depth_2d",z.keyword,"texture_depth_2d"),texture_depth_2d_array:new V("texture_depth_2d_array",z.keyword,"texture_depth_2d_array"),texture_depth_cube:new V("texture_depth_cube",z.keyword,"texture_depth_cube"),texture_depth_cube_array:new V("texture_depth_cube_array",z.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new V("texture_depth_multisampled_2d",z.keyword,"texture_depth_multisampled_2d"),texture_external:new V("texture_external",z.keyword,"texture_external"),u32:new V("u32",z.keyword,"u32"),vec2:new V("vec2",z.keyword,"vec2"),vec3:new V("vec3",z.keyword,"vec3"),vec4:new V("vec4",z.keyword,"vec4"),bitcast:new V("bitcast",z.keyword,"bitcast"),block:new V("block",z.keyword,"block"),break:new V("break",z.keyword,"break"),case:new V("case",z.keyword,"case"),continue:new V("continue",z.keyword,"continue"),continuing:new V("continuing",z.keyword,"continuing"),default:new V("default",z.keyword,"default"),diagnostic:new V("diagnostic",z.keyword,"diagnostic"),discard:new V("discard",z.keyword,"discard"),else:new V("else",z.keyword,"else"),enable:new V("enable",z.keyword,"enable"),fallthrough:new V("fallthrough",z.keyword,"fallthrough"),false:new V("false",z.keyword,"false"),fn:new V("fn",z.keyword,"fn"),for:new V("for",z.keyword,"for"),function:new V("function",z.keyword,"function"),if:new V("if",z.keyword,"if"),let:new V("let",z.keyword,"let"),const:new V("const",z.keyword,"const"),loop:new V("loop",z.keyword,"loop"),while:new V("while",z.keyword,"while"),private:new V("private",z.keyword,"private"),read:new V("read",z.keyword,"read"),read_write:new V("read_write",z.keyword,"read_write"),return:new V("return",z.keyword,"return"),requires:new V("requires",z.keyword,"requires"),storage:new V("storage",z.keyword,"storage"),switch:new V("switch",z.keyword,"switch"),true:new V("true",z.keyword,"true"),alias:new V("alias",z.keyword,"alias"),type:new V("type",z.keyword,"type"),uniform:new V("uniform",z.keyword,"uniform"),var:new V("var",z.keyword,"var"),override:new V("override",z.keyword,"override"),workgroup:new V("workgroup",z.keyword,"workgroup"),write:new V("write",z.keyword,"write"),r8unorm:new V("r8unorm",z.keyword,"r8unorm"),r8snorm:new V("r8snorm",z.keyword,"r8snorm"),r8uint:new V("r8uint",z.keyword,"r8uint"),r8sint:new V("r8sint",z.keyword,"r8sint"),r16uint:new V("r16uint",z.keyword,"r16uint"),r16sint:new V("r16sint",z.keyword,"r16sint"),r16float:new V("r16float",z.keyword,"r16float"),rg8unorm:new V("rg8unorm",z.keyword,"rg8unorm"),rg8snorm:new V("rg8snorm",z.keyword,"rg8snorm"),rg8uint:new V("rg8uint",z.keyword,"rg8uint"),rg8sint:new V("rg8sint",z.keyword,"rg8sint"),r32uint:new V("r32uint",z.keyword,"r32uint"),r32sint:new V("r32sint",z.keyword,"r32sint"),r32float:new V("r32float",z.keyword,"r32float"),rg16uint:new V("rg16uint",z.keyword,"rg16uint"),rg16sint:new V("rg16sint",z.keyword,"rg16sint"),rg16float:new V("rg16float",z.keyword,"rg16float"),rgba8unorm:new V("rgba8unorm",z.keyword,"rgba8unorm"),rgba8unorm_srgb:new V("rgba8unorm_srgb",z.keyword,"rgba8unorm_srgb"),rgba8snorm:new V("rgba8snorm",z.keyword,"rgba8snorm"),rgba8uint:new V("rgba8uint",z.keyword,"rgba8uint"),rgba8sint:new V("rgba8sint",z.keyword,"rgba8sint"),bgra8unorm:new V("bgra8unorm",z.keyword,"bgra8unorm"),bgra8unorm_srgb:new V("bgra8unorm_srgb",z.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new V("rgb10a2unorm",z.keyword,"rgb10a2unorm"),rg11b10float:new V("rg11b10float",z.keyword,"rg11b10float"),rg32uint:new V("rg32uint",z.keyword,"rg32uint"),rg32sint:new V("rg32sint",z.keyword,"rg32sint"),rg32float:new V("rg32float",z.keyword,"rg32float"),rgba16uint:new V("rgba16uint",z.keyword,"rgba16uint"),rgba16sint:new V("rgba16sint",z.keyword,"rgba16sint"),rgba16float:new V("rgba16float",z.keyword,"rgba16float"),rgba32uint:new V("rgba32uint",z.keyword,"rgba32uint"),rgba32sint:new V("rgba32sint",z.keyword,"rgba32sint"),rgba32float:new V("rgba32float",z.keyword,"rgba32float"),static_assert:new V("static_assert",z.keyword,"static_assert")},I.tokens={decimal_float_literal:new V("decimal_float_literal",z.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new V("hex_float_literal",z.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new V("int_literal",z.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new V("uint_literal",z.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new V("name",z.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new V("ident",z.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new V("and",z.token,"&"),and_and:new V("and_and",z.token,"&&"),arrow:new V("arrow ",z.token,"->"),attr:new V("attr",z.token,"@"),forward_slash:new V("forward_slash",z.token,"/"),bang:new V("bang",z.token,"!"),bracket_left:new V("bracket_left",z.token,"["),bracket_right:new V("bracket_right",z.token,"]"),brace_left:new V("brace_left",z.token,"{"),brace_right:new V("brace_right",z.token,"}"),colon:new V("colon",z.token,":"),comma:new V("comma",z.token,","),equal:new V("equal",z.token,"="),equal_equal:new V("equal_equal",z.token,"=="),not_equal:new V("not_equal",z.token,"!="),greater_than:new V("greater_than",z.token,">"),greater_than_equal:new V("greater_than_equal",z.token,">="),shift_right:new V("shift_right",z.token,">>"),less_than:new V("less_than",z.token,"<"),less_than_equal:new V("less_than_equal",z.token,"<="),shift_left:new V("shift_left",z.token,"<<"),modulo:new V("modulo",z.token,"%"),minus:new V("minus",z.token,"-"),minus_minus:new V("minus_minus",z.token,"--"),period:new V("period",z.token,"."),plus:new V("plus",z.token,"+"),plus_plus:new V("plus_plus",z.token,"++"),or:new V("or",z.token,"|"),or_or:new V("or_or",z.token,"||"),paren_left:new V("paren_left",z.token,"("),paren_right:new V("paren_right",z.token,")"),semicolon:new V("semicolon",z.token,";"),star:new V("star",z.token,"*"),tilde:new V("tilde",z.token,"~"),underscore:new V("underscore",z.token,"_"),xor:new V("xor",z.token,"^"),plus_equal:new V("plus_equal",z.token,"+="),minus_equal:new V("minus_equal",z.token,"-="),times_equal:new V("times_equal",z.token,"*="),division_equal:new V("division_equal",z.token,"/="),modulo_equal:new V("modulo_equal",z.token,"%="),and_equal:new V("and_equal",z.token,"&="),or_equal:new V("or_equal",z.token,"|="),xor_equal:new V("xor_equal",z.token,"^="),shift_right_equal:new V("shift_right_equal",z.token,">>="),shift_left_equal:new V("shift_left_equal",z.token,"<<=")},I.simpleTokens={"@":q.tokens.attr,"{":q.tokens.brace_left,"}":q.tokens.brace_right,":":q.tokens.colon,",":q.tokens.comma,"(":q.tokens.paren_left,")":q.tokens.paren_right,";":q.tokens.semicolon},I.literalTokens={"&":q.tokens.and,"&&":q.tokens.and_and,"->":q.tokens.arrow,"/":q.tokens.forward_slash,"!":q.tokens.bang,"[":q.tokens.bracket_left,"]":q.tokens.bracket_right,"=":q.tokens.equal,"==":q.tokens.equal_equal,"!=":q.tokens.not_equal,">":q.tokens.greater_than,">=":q.tokens.greater_than_equal,">>":q.tokens.shift_right,"<":q.tokens.less_than,"<=":q.tokens.less_than_equal,"<<":q.tokens.shift_left,"%":q.tokens.modulo,"-":q.tokens.minus,"--":q.tokens.minus_minus,".":q.tokens.period,"+":q.tokens.plus,"++":q.tokens.plus_plus,"|":q.tokens.or,"||":q.tokens.or_or,"*":q.tokens.star,"~":q.tokens.tilde,_:q.tokens.underscore,"^":q.tokens.xor,"+=":q.tokens.plus_equal,"-=":q.tokens.minus_equal,"*=":q.tokens.times_equal,"/=":q.tokens.division_equal,"%=":q.tokens.modulo_equal,"&=":q.tokens.and_equal,"|=":q.tokens.or_equal,"^=":q.tokens.xor_equal,">>=":q.tokens.shift_right_equal,"<<=":q.tokens.shift_left_equal},I.regexTokens={decimal_float_literal:q.tokens.decimal_float_literal,hex_float_literal:q.tokens.hex_float_literal,int_literal:q.tokens.int_literal,uint_literal:q.tokens.uint_literal,ident:q.tokens.ident},I.storage_class=[q.keywords.function,q.keywords.private,q.keywords.workgroup,q.keywords.uniform,q.keywords.storage],I.access_mode=[q.keywords.read,q.keywords.write,q.keywords.read_write],I.sampler_type=[q.keywords.sampler,q.keywords.sampler_comparison],I.sampled_texture_type=[q.keywords.texture_1d,q.keywords.texture_2d,q.keywords.texture_2d_array,q.keywords.texture_3d,q.keywords.texture_cube,q.keywords.texture_cube_array],I.multisampled_texture_type=[q.keywords.texture_multisampled_2d],I.storage_texture_type=[q.keywords.texture_storage_1d,q.keywords.texture_storage_2d,q.keywords.texture_storage_2d_array,q.keywords.texture_storage_3d],I.depth_texture_type=[q.keywords.texture_depth_2d,q.keywords.texture_depth_2d_array,q.keywords.texture_depth_cube,q.keywords.texture_depth_cube_array,q.keywords.texture_depth_multisampled_2d],I.texture_external_type=[q.keywords.texture_external],I.any_texture_type=[...q.sampled_texture_type,...q.multisampled_texture_type,...q.storage_texture_type,...q.depth_texture_type,...q.texture_external_type],I.texel_format=[q.keywords.r8unorm,q.keywords.r8snorm,q.keywords.r8uint,q.keywords.r8sint,q.keywords.r16uint,q.keywords.r16sint,q.keywords.r16float,q.keywords.rg8unorm,q.keywords.rg8snorm,q.keywords.rg8uint,q.keywords.rg8sint,q.keywords.r32uint,q.keywords.r32sint,q.keywords.r32float,q.keywords.rg16uint,q.keywords.rg16sint,q.keywords.rg16float,q.keywords.rgba8unorm,q.keywords.rgba8unorm_srgb,q.keywords.rgba8snorm,q.keywords.rgba8uint,q.keywords.rgba8sint,q.keywords.bgra8unorm,q.keywords.bgra8unorm_srgb,q.keywords.rgb10a2unorm,q.keywords.rg11b10float,q.keywords.rg32uint,q.keywords.rg32sint,q.keywords.rg32float,q.keywords.rgba16uint,q.keywords.rgba16sint,q.keywords.rgba16float,q.keywords.rgba32uint,q.keywords.rgba32sint,q.keywords.rgba32float],I.const_literal=[q.tokens.int_literal,q.tokens.uint_literal,q.tokens.decimal_float_literal,q.tokens.hex_float_literal,q.keywords.true,q.keywords.false],I.literal_or_ident=[q.tokens.ident,q.tokens.int_literal,q.tokens.uint_literal,q.tokens.decimal_float_literal,q.tokens.hex_float_literal,q.tokens.name],I.element_count_expression=[q.tokens.int_literal,q.tokens.uint_literal,q.tokens.ident],I.template_types=[q.keywords.vec2,q.keywords.vec3,q.keywords.vec4,q.keywords.mat2x2,q.keywords.mat2x3,q.keywords.mat2x4,q.keywords.mat3x2,q.keywords.mat3x3,q.keywords.mat3x4,q.keywords.mat4x2,q.keywords.mat4x3,q.keywords.mat4x4,q.keywords.atomic,q.keywords.bitcast,...q.any_texture_type],I.attribute_name=[q.tokens.ident,q.keywords.block,q.keywords.diagnostic],I.assignment_operators=[q.tokens.equal,q.tokens.plus_equal,q.tokens.minus_equal,q.tokens.times_equal,q.tokens.division_equal,q.tokens.modulo_equal,q.tokens.and_equal,q.tokens.or_equal,q.tokens.xor_equal,q.tokens.shift_right_equal,q.tokens.shift_left_equal],I.increment_operators=[q.tokens.plus_plus,q.tokens.minus_minus];class Uw{constructor(e,n,r,i,s){this.type=e,this.lexeme=n,this.line=r,this.start=i,this.end=s}toString(){return this.lexeme}isTemplateType(){return I.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==I.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class JU{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new Uw(I.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let o=1;for(;o>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),o--,o==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),o++)}return!0}}const n=I.simpleTokens[e];if(n)return this._addToken(n),!0;let r=I.none;const i=this._isAlpha(e),s=e==="_";if(this._isAlphaNumeric(e)){let o=this._peekAhead();for(;this._isAlphaNumeric(o);)e+=this._advance(),o=this._peekAhead()}if(i){const o=I.keywords[e];if(o)return this._addToken(o),!0}if(i||s)return this._addToken(I.tokens.ident),!0;for(;;){let o=this._findType(e);const a=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(a=="=")return this._current++,e+=a,this._addToken(I.tokens.minus_equal),!0;if(a=="-")return this._current++,e+=a,this._addToken(I.tokens.minus_minus),!0;const u=this._tokens.length-1;if((I.literal_or_ident.indexOf(this._tokens[u].type)!=-1||this._tokens[u].type==I.tokens.paren_right)&&a!=">")return this._addToken(o),!0}if(e==">"&&(a==">"||a=="=")){let u=!1,f=this._tokens.length-1;for(let h=0;h<5&&f>=0&&I.assignment_operators.indexOf(this._tokens[f].type)===-1;++h,--f)if(this._tokens[f].type===I.tokens.less_than){f>0&&this._tokens[f-1].isArrayOrTemplateType()&&(u=!0);break}if(u)return this._addToken(o),!0}if(o===I.none){let u=e,f=0;const h=2;for(let p=0;p<h;++p)if(u+=this._peekAhead(p),o=this._findType(u),o!==I.none){f=p;break}if(o===I.none)return r!==I.none&&(this._current--,this._addToken(r),!0);e=u,this._current+=f+1}if(r=o,this._isAtEnd())break;e+=this._advance()}return r!==I.none&&(this._addToken(r),!0)}_findType(e){for(const r in I.regexTokens){const i=I.regexTokens[r];if(this._match(e,i.rule))return i}return I.literalTokens[e]||I.none}_match(e,n){const r=n.exec(e);return r&&r.index==0&&r[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let n=this._source[this._current];return e=e||0,e++,this._current+=e,n}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const n=this._source.substring(this._start,this._current);this._tokens.push(new Uw(e,n,this._line,this._start,this._current))}}function me(t){return Array.isArray(t)||t?.buffer instanceof ArrayBuffer}const Rf=new Float32Array(1),GU=new Uint32Array(Rf.buffer),ej=new Uint32Array(Rf.buffer),If=new Int32Array(1),tj=new Float32Array(If.buffer),nj=new Uint32Array(If.buffer),kf=new Uint32Array(1),rj=new Float32Array(kf.buffer),ij=new Int32Array(kf.buffer);function jw(t,e,n){if(e===n)return t;if(e==="f32"){if(n==="i32"||n==="x32")return Rf[0]=t,GU[0];if(n==="u32")return Rf[0]=t,ej[0]}else if(e==="i32"||e==="x32"){if(n==="f32")return If[0]=t,tj[0];if(n==="u32")return If[0]=t,nj[0]}else if(e==="u32"){if(n==="f32")return kf[0]=t,rj[0];if(n==="i32"||n==="x32")return kf[0]=t,ij[0]}return console.error(`Unsupported cast from ${e} to ${n}`),t}class sj{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class vu{constructor(e,n){this.align=e,this.size=n}}class ir{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new VU,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const n of e)n instanceof El&&this._functions.set(n.name,new sj(n));for(const n of e)if(n instanceof Ar){const r=this.getTypeInfo(n,null);r instanceof gi&&this.structs.push(r)}for(const n of e)if(n instanceof N_)this.aliases.push(this._getAliasInfo(n));else if(n instanceof P_){const r=n,i=this._getAttributeNum(r.attributes,"id",0),s=r.type!=null?this.getTypeInfo(r.type,r.attributes):null;this.overrides.push(new UU(r.name,s,r.attributes,i))}else if(this._isUniformVar(n)){const r=n,i=this._getAttributeNum(r.attributes,"group",0),s=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=new yu(r.name,o,i,s,r.attributes,di.Uniform,r.access);a.access||(a.access="read"),this.uniforms.push(a)}else if(this._isStorageVar(n)){const r=n,i=this._getAttributeNum(r.attributes,"group",0),s=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=this._isStorageTexture(o),u=new yu(r.name,o,i,s,r.attributes,a?di.StorageTexture:di.Storage,r.access);u.access||(u.access="read"),this.storage.push(u)}else if(this._isTextureVar(n)){const r=n,i=this._getAttributeNum(r.attributes,"group",0),s=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=this._isStorageTexture(o),u=new yu(r.name,o,i,s,r.attributes,a?di.StorageTexture:di.Texture,r.access);u.access||(u.access="read"),a?this.storage.push(u):this.textures.push(u)}else if(this._isSamplerVar(n)){const r=n,i=this._getAttributeNum(r.attributes,"group",0),s=this._getAttributeNum(r.attributes,"binding",0),o=this.getTypeInfo(r.type,r.attributes),a=new yu(r.name,o,i,s,r.attributes,di.Sampler,r.access);this.samplers.push(a)}for(const n of e)if(n instanceof El){const r=this._getAttribute(n,"vertex"),i=this._getAttribute(n,"fragment"),s=this._getAttribute(n,"compute"),o=r||i||s,a=new zU(n.name,o?.name,n.attributes);a.attributes=n.attributes,a.startLine=n.startLine,a.endLine=n.endLine,this.functions.push(a),this._functions.get(n.name).info=a,o&&(this._functions.get(n.name).inUse=!0,a.inUse=!0,a.resources=this._findResources(n,!!o),a.inputs=this._getInputs(n.args),a.outputs=this._getOutputs(n.returnType),this.entry[o.name].push(a)),a.arguments=n.args.map(u=>new jU(u.name,this.getTypeInfo(u.type,u.attributes),u.attributes)),a.returnType=n.returnType?this.getTypeInfo(n.returnType,n.attributes):null}for(const n of this._functions.values())n.info&&(n.info.inUse=n.inUse,this._addCalls(n.node,n.info.calls));for(const n of this._functions.values())n.node.search(r=>{var i,s,o;if(r instanceof WS){if(r.value)if(me(r.value))for(const a of r.value)for(const u of this.overrides)a===u.name&&((i=n.info)===null||i===void 0||i.overrides.push(u));else for(const a of this.overrides)r.value===a.name&&((s=n.info)===null||s===void 0||s.overrides.push(a))}else if(r instanceof sn)for(const a of this.overrides)r.name===a.name&&((o=n.info)===null||o===void 0||o.overrides.push(a))});for(const n of this.uniforms)this._markStructsInUse(n.type);for(const n of this.storage)this._markStructsInUse(n.type)}getStructInfo(e){for(const n of this.structs)if(n.name==e)return n;return null}getOverrideInfo(e){for(const n of this.overrides)if(n.name==e)return n;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const n of e.members)this._markStructsInUse(n.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const n=this._getAlias(e.name);n&&this._markStructsInUse(n)}}_addCalls(e,n){var r;for(const i of e.calls){const s=(r=this._functions.get(i.name))===null||r===void 0?void 0:r.info;s&&n.add(s)}}findResource(e,n,r){if(r){for(const i of this.entry.compute)if(i.name===r){for(const s of i.resources)if(s.group==e&&s.binding==n)return s}for(const i of this.entry.vertex)if(i.name===r){for(const s of i.resources)if(s.group==e&&s.binding==n)return s}for(const i of this.entry.fragment)if(i.name===r){for(const s of i.resources)if(s.group==e&&s.binding==n)return s}}for(const i of this.uniforms)if(i.group==e&&i.binding==n)return i;for(const i of this.storage)if(i.group==e&&i.binding==n)return i;for(const i of this.textures)if(i.group==e&&i.binding==n)return i;for(const i of this.samplers)if(i.group==e&&i.binding==n)return i;return null}_findResource(e){for(const n of this.uniforms)if(n.name==e)return n;for(const n of this.storage)if(n.name==e)return n;for(const n of this.textures)if(n.name==e)return n;for(const n of this.samplers)if(n.name==e)return n;return null}_markStructsFromAST(e){const n=this.getTypeInfo(e,null);this._markStructsInUse(n)}_findResources(e,n){const r=[],i=this,s=[];return e.search(o=>{if(o instanceof Af)s.push({});else if(o instanceof Cf)s.pop();else if(o instanceof kr){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof Zn){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type)}else if(o instanceof al){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof sn){const a=o;if(s.length>0&&s[s.length-1][a.name])return;const u=i._findResource(a.name);u&&r.push(u)}else if(o instanceof O_){const a=o,u=i._functions.get(a.name);u&&(n&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=i._findResources(u.node,n)),r.push(...u.resources))}else if(o instanceof M_){const a=o,u=i._functions.get(a.name);u&&(n&&(u.inUse=!0),e.calls.add(u.node),u.resources===null&&(u.resources=i._findResources(u.node,n)),r.push(...u.resources))}}),[...new Map(r.map(o=>[o.name,o])).values()]}getBindGroups(){const e=[];function n(r,i){r>=e.length&&(e.length=r+1),e[r]===void 0&&(e[r]=[]),i>=e[r].length&&(e[r].length=i+1)}for(const r of this.uniforms)n(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.storage)n(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.textures)n(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.samplers)n(r.group,r.binding),e[r.group][r.binding]=r;return e}_getOutputs(e,n=void 0){if(n===void 0&&(n=[]),e instanceof Ar)this._getStructOutputs(e,n);else{const r=this._getOutputInfo(e);r!==null&&n.push(r)}return n}_getStructOutputs(e,n){for(const r of e.members)if(r.type instanceof Ar)this._getStructOutputs(r.type,n);else{const i=this._getAttribute(r,"location")||this._getAttribute(r,"builtin");if(i!==null){const s=this.getTypeInfo(r.type,r.type.attributes),o=this._parseInt(i.value),a=new Ow(r.name,s,i.name,o);n.push(a)}}}_getOutputInfo(e){const n=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(n!==null){const r=this.getTypeInfo(e,e.attributes),i=this._parseInt(n.value);return new Ow("",r,n.name,i)}return null}_getInputs(e,n=void 0){n===void 0&&(n=[]);for(const r of e)if(r.type instanceof Ar)this._getStructInputs(r.type,n);else{const i=this._getInputInfo(r);i!==null&&n.push(i)}return n}_getStructInputs(e,n){for(const r of e.members)if(r.type instanceof Ar)this._getStructInputs(r.type,n);else{const i=this._getInputInfo(r);i!==null&&n.push(i)}}_getInputInfo(e){const n=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(n!==null){const r=this._getAttribute(e,"interpolation"),i=this.getTypeInfo(e.type,e.attributes),s=this._parseInt(n.value),o=new BU(e.name,i,n.name,s);return r!==null&&(o.interpolation=this._parseString(r.value)),o}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const n=parseInt(e);return isNaN(n)?e:n}_getAlias(e){for(const n of this.aliases)if(n.name==e)return n.type;return null}_getAliasInfo(e){return new LU(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const n of this.structs)if(n.name==e)return n;for(const n of this.aliases)if(n.name==e)return n.type;return null}getTypeInfo(e,n=null){if(this._types.has(e))return this._types.get(e);if(e instanceof ju){const i=e.type?this.getTypeInfo(e.type,e.attributes):null,s=new fm(e.name,i,n);return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof ll){const i=e,s=i.format?this.getTypeInfo(i.format,i.attributes):null,o=new vi(i.name,n);return o.format=s,o.count=i.count,this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof Ar){const i=e,s=new gi(i.name,n);s.startLine=i.startLine,s.endLine=i.endLine;for(const o of i.members){const a=this.getTypeInfo(o.type,o.attributes);s.members.push(new Nw(o.name,a,o.attributes))}return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof Ka){const i=e,s=i.format instanceof re,o=i.format?s?this.getTypeInfo(i.format,null):new wn(i.format,null):null,a=new us(i.name,o,n,i.access);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof $){const i=e,s=i.format?this.getTypeInfo(i.format,null):null,o=new us(i.name,s,n,i.access);return this._types.set(e,o),this._updateTypeInfo(o),o}const r=new wn(e.name,n);return this._types.set(e,r),this._updateTypeInfo(r),r}_updateTypeInfo(e){var n,r,i;const s=this._getTypeSize(e);if(e.size=(n=s?.size)!==null&&n!==void 0?n:0,e instanceof vi&&e.format){const o=this._getTypeSize(e.format);e.stride=Math.max((r=o?.size)!==null&&r!==void 0?r:0,(i=o?.align)!==null&&i!==void 0?i:0),this._updateTypeInfo(e.format)}e instanceof fm&&this._updateTypeInfo(e.format),e instanceof gi&&this._updateStructInfo(e)}_updateStructInfo(e){var n;let r=0,i=0,s=0,o=0;for(let a=0,u=e.members.length;a<u;++a){const f=e.members[a],h=this._getTypeSize(f);if(!h)continue;(n=this._getAlias(f.type.name))!==null&&n!==void 0||f.type;const p=h.align,g=h.size;r=this._roundUp(p,r+i),i=g,s=r,o=Math.max(o,p),f.offset=r,f.size=g,this._updateTypeInfo(f.type)}e.size=this._roundUp(o,s+i),e.align=o}_getTypeSize(e){var n,r;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),s=this._getAttributeNum(e.attributes,"align",0);if(e instanceof Nw&&(e=e.type),e instanceof wn){const o=this._getAlias(e.name);o!==null&&(e=o)}{const o=ir._typeInfo[e.name];if(o!==void 0){const a=((n=e.format)===null||n===void 0?void 0:n.name)==="f16"?2:1;return new vu(Math.max(s,o.align/a),Math.max(i,o.size/a))}}{const o=ir._typeInfo[e.name.substring(0,e.name.length-1)];if(o){const a=e.name[e.name.length-1]==="h"?2:1;return new vu(Math.max(s,o.align/a),Math.max(i,o.size/a))}}if(e instanceof vi){let o=e,a=8,u=8;const f=this._getTypeSize(o.format);return f!==null&&(u=f.size,a=f.align),u=o.count*this._getAttributeNum((r=e?.attributes)!==null&&r!==void 0?r:null,"stride",this._roundUp(a,u)),i&&(u=i),new vu(Math.max(s,a),Math.max(i,u))}if(e instanceof gi){let o=0,a=0,u=0,f=0,h=0;for(const p of e.members){const g=this._getTypeSize(p.type);g!==null&&(o=Math.max(g.align,o),u=this._roundUp(g.align,u+f),f=g.size,h=u)}return a=this._roundUp(o,h+f),new vu(Math.max(s,o),Math.max(i,a))}return null}_isUniformVar(e){return e instanceof kr&&e.storage=="uniform"}_isStorageVar(e){return e instanceof kr&&e.storage=="storage"}_isTextureVar(e){return e instanceof kr&&e.type!==null&&ir._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof kr&&e.type!==null&&ir._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,n){const r=e;if(!r||!r.attributes)return null;const i=r.attributes;for(let s of i)if(s.name==n)return s;return null}_getAttributeNum(e,n,r){if(e===null)return r;for(let i of e)if(i.name==n){let s=i!==null&&i.value!==null?i.value:r;return s instanceof Array&&(s=s[0]),typeof s=="number"?s:typeof s=="string"?parseInt(s):r}return r}_roundUp(e,n){return Math.ceil(n/e)*e}}ir._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},ir._textureTypes=I.any_texture_type.map(t=>t.name),ir._samplerTypes=I.sampler_type.map(t=>t.name);let D_=0;class F_{constructor(e,n,r){this.id=D_++,this.name=e,this.value=n,this.node=r}clone(){return new F_(this.name,this.value,this.node)}}class L_{constructor(e){this.id=D_++,this.name=e.name,this.node=e}clone(){return new L_(this.node)}}class B_{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=D_++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var n;return this.variables.has(e)?(n=this.variables.get(e))!==null&&n!==void 0?n:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var n;return this.functions.has(e)?(n=this.functions.get(e))!==null&&n!==void 0?n:null:this.parent?this.parent.getFunction(e):null}createVariable(e,n,r){this.variables.set(e,new F_(e,n,r??null))}setVariable(e,n,r){const i=this.getVariable(e);i!==null?i.value=n:this.createVariable(e,n,r)}getVariableValue(e){var n;const r=this.getVariable(e);return(n=r?.value)!==null&&n!==void 0?n:null}clone(){return new B_(this)}}class oj{evalExpression(e,n){return null}getTypeInfo(e){return null}getVariableName(e,n){return""}}class aj{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,n){const r=this.exec.evalExpression(e.args[0],n);let i=!0;if(r instanceof N)return r.data.forEach(s=>{s||(i=!1)}),new j(i?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N){const i=r.data.some(s=>s);return new j(i?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,n){const r=this.exec.evalExpression(e.args[2],n);if(!(r instanceof j))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return r.value?this.exec.evalExpression(e.args[1],n):this.exec.evalExpression(e.args[0],n)}ArrayLength(e,n){let r=e.args[0];r instanceof gt&&(r=r.right);const i=this.exec.evalExpression(r,n);if(i instanceof ct&&i.typeInfo.size===0){const s=i.typeInfo,o=i.buffer.byteLength/s.stride;return new j(o,this.getTypeInfo("u32"))}return new j(i.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.abs(s)),r.typeInfo);const i=r;return new j(Math.abs(i.value),i.typeInfo)}Acos(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.acos(s)),r.typeInfo);const i=r;return new j(Math.acos(i.value),r.typeInfo)}Acosh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.acosh(s)),r.typeInfo);const i=r;return new j(Math.acosh(i.value),r.typeInfo)}Asin(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.asin(s)),r.typeInfo);const i=r;return new j(Math.asin(i.value),r.typeInfo)}Asinh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.asinh(s)),r.typeInfo);const i=r;return new j(Math.asinh(i.value),r.typeInfo)}Atan(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.atan(s)),r.typeInfo);const i=r;return new j(Math.atan(i.value),r.typeInfo)}Atanh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.atanh(s)),r.typeInfo);const i=r;return new j(Math.atanh(i.value),r.typeInfo)}Atan2(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof N&&i instanceof N)return new N(r.data.map((a,u)=>Math.atan2(a,i.data[u])),r.typeInfo);const s=r,o=i;return new j(Math.atan2(s.value,o.value),r.typeInfo)}Ceil(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.ceil(s)),r.typeInfo);const i=r;return new j(Math.ceil(i.value),r.typeInfo)}_clamp(e,n,r){return Math.min(Math.max(e,n),r)}Clamp(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(r instanceof N&&i instanceof N&&s instanceof N)return new N(r.data.map((f,h)=>this._clamp(f,i.data[h],s.data[h])),r.typeInfo);const o=r,a=i,u=s;return new j(this._clamp(o.value,a.value,u.value),r.typeInfo)}Cos(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.cos(s)),r.typeInfo);const i=r;return new j(Math.cos(i.value),r.typeInfo)}Cosh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.cosh(s)),r.typeInfo);const i=r;return new j(Math.cos(i.value),r.typeInfo)}CountLeadingZeros(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.clz32(s)),r.typeInfo);const i=r;return new j(Math.clz32(i.value),r.typeInfo)}_countOneBits(e){let n=0;for(;e!==0;)1&e&&n++,e>>=1;return n}CountOneBits(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>this._countOneBits(s)),r.typeInfo);const i=r;return new j(this._countOneBits(i.value),r.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let n=0;for(;!(1&e);)e>>=1,n++;return n}CountTrailingZeros(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>this._countTrailingZeros(s)),r.typeInfo);const i=r;return new j(this._countTrailingZeros(i.value),r.typeInfo)}Cross(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof N&&i instanceof N){if(r.data.length!==3||i.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const s=r.data,o=i.data;return new N([s[1]*o[2]-o[1]*s[2],s[2]*o[0]-o[2]*s[0],s[0]*o[1]-o[0]*s[1]],r.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,n){const r=this.exec.evalExpression(e.args[0],n),i=180/Math.PI;return r instanceof N?new N(r.data.map(s=>s*i),r.typeInfo):new j(r.value*i,this.getTypeInfo("f32"))}Determinant(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof Ce){const i=r.data,s=r.typeInfo.getTypeName(),o=s.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(s==="mat2x2"||s==="mat2x2f"||s==="mat2x2h")return new j(i[0]*i[3]-i[1]*i[2],o);if(s==="mat2x3"||s==="mat2x3f"||s==="mat2x3h")return new j(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),o);if(s==="mat2x4"||s==="mat2x4f"||s==="mat2x4h")console.error(`TODO: Determinant for ${s}`);else if(s==="mat3x2"||s==="mat3x2f"||s==="mat3x2h")console.error(`TODO: Determinant for ${s}`);else{if(s==="mat3x3"||s==="mat3x3f"||s==="mat3x3h")return new j(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),o);s==="mat3x4"||s==="mat3x4f"||s==="mat3x4h"||s==="mat4x2"||s==="mat4x2f"||s==="mat4x2h"||s==="mat4x3"||s==="mat4x3f"||s==="mat4x3h"?console.error(`TODO: Determinant for ${s}`):s!=="mat4x4"&&s!=="mat4x4f"&&s!=="mat4x4h"||console.error(`TODO: Determinant for ${s}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof N&&i instanceof N){let a=0;for(let u=0;u<r.data.length;++u)a+=(r.data[u]-i.data[u])*(r.data[u]-i.data[u]);return new j(Math.sqrt(a),this.getTypeInfo("f32"))}const s=r,o=i;return new j(Math.abs(s.value-o.value),r.typeInfo)}_dot(e,n){let r=0;for(let i=0;i<e.length;++i)r+=n[i]*e[i];return r}Dot(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);return r instanceof N&&i instanceof N?new j(this._dot(r.data,i.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,n){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,n){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.exp(s)),r.typeInfo);const i=r;return new j(Math.exp(i.value),r.typeInfo)}Exp2(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.pow(2,s)),r.typeInfo);const i=r;return new j(Math.pow(2,i.value),r.typeInfo)}ExtractBits(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(i.typeInfo.name!=="u32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(s.typeInfo.name!=="u32"&&s.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const o=i.value,a=s.value;if(r instanceof N)return new N(r.data.map(f=>f>>o&(1<<a)-1),r.typeInfo);if(r.typeInfo.name!=="i32"&&r.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const u=r.value;return new j(u>>o&(1<<a)-1,this.getTypeInfo("i32"))}FaceForward(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(r instanceof N&&i instanceof N&&s instanceof N){const o=this._dot(i.data,s.data);return new N(o<0?Array.from(r.data):r.data.map(a=>-a),r.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>this._firstLeadingBit(s)),r.typeInfo);const i=r;return new j(this._firstLeadingBit(i.value),r.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>this._firstTrailingBit(s)),r.typeInfo);const i=r;return new j(this._firstTrailingBit(i.value),r.typeInfo)}Floor(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.floor(s)),r.typeInfo);const i=r;return new j(Math.floor(i.value),r.typeInfo)}Fma(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(r instanceof N&&i instanceof N&&s instanceof N)return r.data.length!==i.data.length||r.data.length!==s.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new N(r.data.map((f,h)=>f*i.data[h]+s.data[h]),r.typeInfo);const o=r,a=i,u=s;return new j(o.value*a.value+u.value,o.typeInfo)}Fract(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>s-Math.floor(s)),r.typeInfo);const i=r;return new j(i.value-Math.floor(i.value),r.typeInfo)}Frexp(e,n){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n),o=this.exec.evalExpression(e.args[3],n);if(s.typeInfo.name!=="u32"&&s.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const a=s.value,u=(1<<o.value)-1<<a,f=~u;if(r instanceof N&&i instanceof N)return new N(r.data.map((g,_)=>g&f|i.data[_]<<a&u),r.typeInfo);const h=r.value,p=i.value;return new j(h&f|p<<a&u,r.typeInfo)}InverseSqrt(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>1/Math.sqrt(s)),r.typeInfo);const i=r;return new j(1/Math.sqrt(i.value),r.typeInfo)}Ldexp(e,n){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N){let s=0;return r.data.forEach(o=>{s+=o*o}),new j(Math.sqrt(s),this.getTypeInfo("f32"))}const i=r;return new j(Math.abs(i.value),r.typeInfo)}Log(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.log(s)),r.typeInfo);const i=r;return new j(Math.log(i.value),r.typeInfo)}Log2(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.log2(s)),r.typeInfo);const i=r;return new j(Math.log2(i.value),r.typeInfo)}Max(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof N&&i instanceof N)return new N(r.data.map((a,u)=>Math.max(a,i.data[u])),r.typeInfo);const s=r,o=i;return new j(Math.max(s.value,o.value),r.typeInfo)}Min(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof N&&i instanceof N)return new N(r.data.map((a,u)=>Math.min(a,i.data[u])),r.typeInfo);const s=r,o=i;return new j(Math.min(s.value,o.value),r.typeInfo)}Mix(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(r instanceof N&&i instanceof N&&s instanceof N)return new N(r.data.map((u,f)=>r.data[f]*(1-s.data[f])+i.data[f]*s.data[f]),r.typeInfo);const o=i,a=s;return new j(r.value*(1-a.value)+o.value*a.value,r.typeInfo)}Modf(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof N&&i instanceof N)return new N(r.data.map((o,a)=>o%i.data[a]),r.typeInfo);const s=i;return new j(r.value%s.value,r.typeInfo)}Normalize(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N){const i=this.Length(e,n).value;return new N(r.data.map(s=>s/i),r.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof N&&i instanceof N)return new N(r.data.map((a,u)=>Math.pow(a,i.data[u])),r.typeInfo);const s=r,o=i;return new j(Math.pow(s.value,o.value),r.typeInfo)}QuantizeToF16(e,n){const r=this.exec.evalExpression(e.args[0],n);return r instanceof N?new N(r.data.map(i=>i),r.typeInfo):new j(r.value,r.typeInfo)}Radians(e,n){const r=this.exec.evalExpression(e.args[0],n);return r instanceof N?new N(r.data.map(i=>i*Math.PI/180),r.typeInfo):new j(r.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(r instanceof N&&i instanceof N){const s=this._dot(r.data,i.data);return new N(r.data.map((o,a)=>o-2*s*i.data[a]),r.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,n){let r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(r instanceof N&&i instanceof N&&s instanceof j){const o=this._dot(i.data,r.data);return new N(r.data.map((a,u)=>{const f=1-s.value*s.value*(1-o*o);if(f<0)return 0;const h=Math.sqrt(f);return s.value*a-(s.value*o+h)*i.data[u]}),r.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,n){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.round(s)),r.typeInfo);const i=r;return new j(Math.round(i.value),r.typeInfo)}Saturate(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.min(Math.max(s,0),1)),r.typeInfo);const i=r;return new j(Math.min(Math.max(i.value,0),1),r.typeInfo)}Sign(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.sign(s)),r.typeInfo);const i=r;return new j(Math.sign(i.value),r.typeInfo)}Sin(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.sin(s)),r.typeInfo);const i=r;return new j(Math.sin(i.value),r.typeInfo)}Sinh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.sinh(s)),r.typeInfo);const i=r;return new j(Math.sinh(i.value),r.typeInfo)}_smoothstep(e,n,r){const i=Math.min(Math.max((r-e)/(n-e),0),1);return i*i*(3-2*i)}SmoothStep(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n),s=this.exec.evalExpression(e.args[2],n);if(s instanceof N&&r instanceof N&&i instanceof N)return new N(s.data.map((f,h)=>this._smoothstep(r.data[h],i.data[h],f)),s.typeInfo);const o=r,a=i,u=s;return new j(this._smoothstep(o.value,a.value,u.value),s.typeInfo)}Sqrt(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.sqrt(s)),r.typeInfo);const i=r;return new j(Math.sqrt(i.value),r.typeInfo)}Step(e,n){const r=this.exec.evalExpression(e.args[0],n),i=this.exec.evalExpression(e.args[1],n);if(i instanceof N&&r instanceof N)return new N(i.data.map((o,a)=>o<r.data[a]?0:1),i.typeInfo);const s=r;return new j(i.value<s.value?0:1,s.typeInfo)}Tan(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.tan(s)),r.typeInfo);const i=r;return new j(Math.tan(i.value),r.typeInfo)}Tanh(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.tanh(s)),r.typeInfo);const i=r;return new j(Math.tanh(i.value),r.typeInfo)}_getTransposeType(e){const n=e.getTypeName();return n==="mat2x2f"||n==="mat2x2h"?e:n==="mat2x3f"?this.getTypeInfo("mat3x2f"):n==="mat2x3h"?this.getTypeInfo("mat3x2h"):n==="mat2x4f"?this.getTypeInfo("mat4x2f"):n==="mat2x4h"?this.getTypeInfo("mat4x2h"):n==="mat3x2f"?this.getTypeInfo("mat2x3f"):n==="mat3x2h"?this.getTypeInfo("mat2x3h"):n==="mat3x3f"||n==="mat3x3h"?e:n==="mat3x4f"?this.getTypeInfo("mat4x3f"):n==="mat3x4h"?this.getTypeInfo("mat4x3h"):n==="mat4x2f"?this.getTypeInfo("mat2x4f"):n==="mat4x2h"?this.getTypeInfo("mat2x4h"):n==="mat4x3f"?this.getTypeInfo("mat3x4f"):n==="mat4x3h"?this.getTypeInfo("mat3x4h"):(n==="mat4x4f"||n==="mat4x4h"||console.error(`Invalid matrix type ${n}`),e)}Transpose(e,n){const r=this.exec.evalExpression(e.args[0],n);if(!(r instanceof Ce))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const i=this._getTransposeType(r.typeInfo);if(r.typeInfo.name==="mat2x2"||r.typeInfo.name==="mat2x2f"||r.typeInfo.name==="mat2x2h"){const s=r.data;return new Ce([s[0],s[2],s[1],s[3]],i)}if(r.typeInfo.name==="mat2x3"||r.typeInfo.name==="mat2x3f"||r.typeInfo.name==="mat2x3h"){const s=r.data;return new Ce([s[0],s[3],s[6],s[1],s[4],s[7]],i)}if(r.typeInfo.name==="mat2x4"||r.typeInfo.name==="mat2x4f"||r.typeInfo.name==="mat2x4h"){const s=r.data;return new Ce([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13]],i)}if(r.typeInfo.name==="mat3x2"||r.typeInfo.name==="mat3x2f"||r.typeInfo.name==="mat3x2h"){const s=r.data;return new Ce([s[0],s[3],s[1],s[4],s[2],s[5]],i)}if(r.typeInfo.name==="mat3x3"||r.typeInfo.name==="mat3x3f"||r.typeInfo.name==="mat3x3h"){const s=r.data;return new Ce([s[0],s[3],s[6],s[1],s[4],s[7],s[2],s[5],s[8]],i)}if(r.typeInfo.name==="mat3x4"||r.typeInfo.name==="mat3x4f"||r.typeInfo.name==="mat3x4h"){const s=r.data;return new Ce([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14]],i)}if(r.typeInfo.name==="mat4x2"||r.typeInfo.name==="mat4x2f"||r.typeInfo.name==="mat4x2h"){const s=r.data;return new Ce([s[0],s[4],s[1],s[5],s[2],s[6]],i)}if(r.typeInfo.name==="mat4x3"||r.typeInfo.name==="mat4x3f"||r.typeInfo.name==="mat4x3h"){const s=r.data;return new Ce([s[0],s[4],s[8],s[1],s[5],s[9],s[2],s[6],s[10]],i)}if(r.typeInfo.name==="mat4x4"||r.typeInfo.name==="mat4x4f"||r.typeInfo.name==="mat4x4h"){const s=r.data;return new Ce([s[0],s[4],s[8],s[12],s[1],s[5],s[9],s[13],s[2],s[6],s[10],s[14],s[3],s[7],s[11],s[15]],i)}return console.error(`Invalid matrix type ${r.typeInfo.name}`),null}Trunc(e,n){const r=this.exec.evalExpression(e.args[0],n);if(r instanceof N)return new N(r.data.map(s=>Math.trunc(s)),r.typeInfo);const i=r;return new j(Math.trunc(i.value),r.typeInfo)}Dpdx(e,n){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,n){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,n){return console.error("TODO: dpdxFine"),null}Dpdy(e,n){return console.error("TODO: dpdy"),null}DpdyCoarse(e,n){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,n){return console.error("TODO: dpdyFine"),null}Fwidth(e,n){return console.error("TODO: fwidth"),null}FwidthCoarse(e,n){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,n){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,n){const r=e.args[0],i=e.args.length>1?this.exec.evalExpression(e.args[1],n).value:0;if(r instanceof sn){const s=r.name,o=n.getVariableValue(s);if(o instanceof Cr){if(i<0||i>=o.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const a=o.getMipLevelSize(i),u=o.dimension;return u==="1d"?new j(a[0],this.getTypeInfo("u32")):u==="3d"?new N(a,this.getTypeInfo("vec3u")):u==="2d"?new N(a.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${u} not found. Line ${e.line}`),null)}return console.error(`Texture ${s} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,n){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,n){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,n){const r=e.args[0],i=this.exec.evalExpression(e.args[1],n),s=e.args.length>2?this.exec.evalExpression(e.args[2],n).value:0;if(!(i instanceof N)||i.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(r instanceof sn){const o=r.name,a=n.getVariableValue(o);if(a instanceof Cr){const u=Math.floor(i.data[0]),f=Math.floor(i.data[1]);if(u<0||u>=a.width||f<0||f>=a.height)return console.error(`Texture ${o} out of bounds. Line ${e.line}`),null;const h=a.getPixel(u,f,0,s);return h===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new N(h,this.getTypeInfo("vec4f"))}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,n){const r=e.args[0];if(r instanceof sn){const i=r.name,s=n.getVariableValue(i);return s instanceof Cr?new j(s.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,n){const r=e.args[0];if(r instanceof sn){const i=r.name,s=n.getVariableValue(i);return s instanceof Cr?new j(s.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,n){const r=e.args[0];if(r instanceof sn){const i=r.name,s=n.getVariableValue(i);return s instanceof Cr?new j(s.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,n){return console.error("TODO: textureSample"),null}TextureSampleBias(e,n){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,n){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,n){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,n){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,n){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,n){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,n){const r=e.args[0],i=this.exec.evalExpression(e.args[1],n),s=e.args.length===4?this.exec.evalExpression(e.args[2],n).value:0,o=e.args.length===4?this.exec.evalExpression(e.args[3],n).data:this.exec.evalExpression(e.args[2],n).data;if(o.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(i instanceof N)||i.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(r instanceof sn){const a=r.name,u=n.getVariableValue(a);if(u instanceof Cr){const f=u.getMipLevelSize(0),h=Math.floor(i.data[0]),p=Math.floor(i.data[1]);return h<0||h>=f[0]||p<0||p>=f[1]?(console.error(`Texture ${a} out of bounds. Line ${e.line}`),null):(u.setPixel(h,p,0,s,Array.from(o)),null)}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,n){let r=e.args[0];r instanceof gt&&(r=r.right);const i=this.exec.getVariableName(r,n);return n.getVariable(i).value.getSubData(this.exec,r.postfix,n)}AtomicStore(e,n){let r=e.args[0];r instanceof gt&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),u=s.value.getSubData(this.exec,r.postfix,n);return u instanceof j&&a instanceof j&&(u.value=a.value),s.value instanceof ct&&s.value.setDataValue(this.exec,u,r.postfix,n),null}AtomicAdd(e,n){let r=e.args[0];r instanceof gt&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),u=s.value.getSubData(this.exec,r.postfix,n),f=new j(u.value,u.typeInfo);return u instanceof j&&a instanceof j&&(u.value+=a.value),s.value instanceof ct&&s.value.setDataValue(this.exec,u,r.postfix,n),f}AtomicSub(e,n){let r=e.args[0];r instanceof gt&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),u=s.value.getSubData(this.exec,r.postfix,n),f=new j(u.value,u.typeInfo);return u instanceof j&&a instanceof j&&(u.value-=a.value),s.value instanceof ct&&s.value.setDataValue(this.exec,u,r.postfix,n),f}AtomicMax(e,n){let r=e.args[0];r instanceof gt&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),u=s.value.getSubData(this.exec,r.postfix,n),f=new j(u.value,u.typeInfo);return u instanceof j&&a instanceof j&&(u.value=Math.max(u.value,a.value)),s.value instanceof ct&&s.value.setDataValue(this.exec,u,r.postfix,n),f}AtomicMin(e,n){let r=e.args[0];r instanceof gt&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),u=s.value.getSubData(this.exec,r.postfix,n),f=new j(u.value,u.typeInfo);return u instanceof j&&a instanceof j&&(u.value=Math.min(u.value,a.value)),s.value instanceof ct&&s.value.setDataValue(this.exec,u,r.postfix,n),f}AtomicAnd(e,n){let r=e.args[0];r instanceof gt&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),u=s.value.getSubData(this.exec,r.postfix,n),f=new j(u.value,u.typeInfo);return u instanceof j&&a instanceof j&&(u.value=u.value&a.value),s.value instanceof ct&&s.value.setDataValue(this.exec,u,r.postfix,n),f}AtomicOr(e,n){let r=e.args[0];r instanceof gt&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),u=s.value.getSubData(this.exec,r.postfix,n),f=new j(u.value,u.typeInfo);return u instanceof j&&a instanceof j&&(u.value=u.value|a.value),s.value instanceof ct&&s.value.setDataValue(this.exec,u,r.postfix,n),f}AtomicXor(e,n){let r=e.args[0];r instanceof gt&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),u=s.value.getSubData(this.exec,r.postfix,n),f=new j(u.value,u.typeInfo);return u instanceof j&&a instanceof j&&(u.value=u.value^a.value),s.value instanceof ct&&s.value.setDataValue(this.exec,u,r.postfix,n),f}AtomicExchange(e,n){let r=e.args[0];r instanceof gt&&(r=r.right);const i=this.exec.getVariableName(r,n),s=n.getVariable(i);let o=e.args[1];const a=this.exec.evalExpression(o,n),u=s.value.getSubData(this.exec,r.postfix,n),f=new j(u.value,u.typeInfo);return u instanceof j&&a instanceof j&&(u.value=a.value),s.value instanceof ct&&s.value.setDataValue(this.exec,u,r.postfix,n),f}AtomicCompareExchangeWeak(e,n){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,n){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,n){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,n){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,n){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,n){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,n){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,n){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,n){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,n){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,n){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,n){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,n){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,n){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,n){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,n){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,n){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,n){return null}TextureBarrier(e,n){return null}WorkgroupBarrier(e,n){return null}WorkgroupUniformLoad(e,n){return null}SubgroupAdd(e,n){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,n){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,n){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,n){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,n){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,n){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,n){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,n){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,n){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,n){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,n){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,n){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,n){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,n){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,n){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,n){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,n){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,n){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,n){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,n){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,n){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,n){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,n){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,n){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,n){return console.error("TODO: quadSwapY"),null}}const $p={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},zt={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class Dt extends oj{constructor(e,n){var r;super(),this.ast=e??[],this.reflection=new ir,this.reflection.updateAST(this.ast),this.context=(r=n?.clone())!==null&&r!==void 0?r:new B_,this.builtins=new aj(this),this.typeInfo={bool:this.getTypeInfo(re.bool),i32:this.getTypeInfo(re.i32),u32:this.getTypeInfo(re.u32),f32:this.getTypeInfo(re.f32),f16:this.getTypeInfo(re.f16),vec2f:this.getTypeInfo($.vec2f),vec2u:this.getTypeInfo($.vec2u),vec2i:this.getTypeInfo($.vec2i),vec2h:this.getTypeInfo($.vec2h),vec3f:this.getTypeInfo($.vec3f),vec3u:this.getTypeInfo($.vec3u),vec3i:this.getTypeInfo($.vec3i),vec3h:this.getTypeInfo($.vec3h),vec4f:this.getTypeInfo($.vec4f),vec4u:this.getTypeInfo($.vec4u),vec4i:this.getTypeInfo($.vec4i),vec4h:this.getTypeInfo($.vec4h),mat2x2f:this.getTypeInfo($.mat2x2f),mat2x3f:this.getTypeInfo($.mat2x3f),mat2x4f:this.getTypeInfo($.mat2x4f),mat3x2f:this.getTypeInfo($.mat3x2f),mat3x3f:this.getTypeInfo($.mat3x3f),mat3x4f:this.getTypeInfo($.mat3x4f),mat4x2f:this.getTypeInfo($.mat4x2f),mat4x3f:this.getTypeInfo($.mat4x3f),mat4x4f:this.getTypeInfo($.mat4x4f)}}getVariableValue(e){var n,r;const i=(r=(n=this.context.getVariable(e))===null||n===void 0?void 0:n.value)!==null&&r!==void 0?r:null;if(i===null)return null;if(i instanceof j)return i.value;if(i instanceof N||i instanceof Ce)return Array.from(i.data);if(i instanceof ct&&i.typeInfo instanceof vi){if(i.typeInfo.format.name==="u32")return Array.from(new Uint32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="i32")return Array.from(new Int32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="f32")return Array.from(new Float32Array(i.buffer,i.offset,i.typeInfo.count))}return console.error(`Unsupported return variable type ${i.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,n,r,i){const s=this.context.clone();(i=i??{}).constants&&this._setOverrides(i.constants,s),this._execStatements(this.ast,s);const o=s.getFunction(e);if(!o)return void console.error(`Function ${e} not found`);if(typeof n=="number")n=[n,1,1];else{if(n.length===0)return void console.error("Invalid dispatch count");n.length===1?n=[n[0],1,1]:n.length===2?n=[n[0],n[1],1]:n.length>3&&(n=[n[0],n[1],n[2]])}const a=n[0],u=n[1],f=n[2],h=this.getTypeInfo("vec3u");s.setVariable("@num_workgroups",new N(n,h));for(const p in r)for(const g in r[p]){const _=r[p][g];s.variables.forEach(v=>{var w;const x=v.node;if(x?.attributes){let T=null,A=null;for(const E of x.attributes)E.name==="binding"?T=E.value:E.name==="group"&&(A=E.value);if(g==T&&p==A)if(_.texture!==void 0&&_.descriptor!==void 0){const E=new Cr(_.texture,this.getTypeInfo(x.type),_.descriptor,(w=_.texture.view)!==null&&w!==void 0?w:null);v.value=E}else _.uniform!==void 0?v.value=new ct(_.uniform,this.getTypeInfo(x.type)):v.value=new ct(_,this.getTypeInfo(x.type))}})}for(let p=0;p<f;++p)for(let g=0;g<u;++g)for(let _=0;_<a;++_)s.setVariable("@workgroup_id",new N([_,g,p],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(o,[_,g,p],s)}execStatement(e,n){if(e instanceof OS)return this.evalExpression(e.value,n);if(e instanceof FS){if(e.condition){const r=this.evalExpression(e.condition,n);if(!(r instanceof j))throw new Error("Invalid break-if condition");if(!r.value)return null}return Dt._breakObj}if(e instanceof LS)return Dt._continueObj;if(e instanceof al)this._let(e,n);else if(e instanceof kr)this._var(e,n);else if(e instanceof Uu)this._const(e,n);else if(e instanceof El)this._function(e,n);else{if(e instanceof NS)return this._if(e,n);if(e instanceof MS)return this._switch(e,n);if(e instanceof RS)return this._for(e,n);if(e instanceof CS)return this._while(e,n);if(e instanceof PS)return this._loop(e,n);if(e instanceof hm){const r=n.clone();return r.currentFunctionName=n.currentFunctionName,this._execStatements(e.body,r)}if(e instanceof kS)this._assign(e,n);else if(e instanceof IS)this._increment(e,n);else{if(e instanceof Ar)return null;if(e instanceof P_){const r=e.name;n.getVariable(r)===null&&n.setVariable(r,new j(0,this.getTypeInfo("u32")))}else if(e instanceof M_)this._call(e,n);else{if(e instanceof DS||e instanceof N_)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,n){return e instanceof Dn?this._evalBinaryOp(e,n):e instanceof vt?this._evalLiteral(e,n):e instanceof sn?this._evalVariable(e,n):e instanceof O_?this._evalCall(e,n):e instanceof Zn?this._evalCreate(e,n):e instanceof BS?this._evalConst(e,n):e instanceof US?this._evalBitcast(e,n):e instanceof gt?this._evalUnaryOp(e,n):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var n;if(e instanceof re){const i=this.reflection.getTypeInfo(e);if(i!==null)return i}let r=(n=this.typeInfo[e])!==null&&n!==void 0?n:null;return r!==null||(r=this.reflection.getTypeInfoByName(e)),r}_setOverrides(e,n){for(const r in e){const i=e[r],s=this.reflection.getOverrideInfo(r);s!==null?(s.type===null&&(s.type=this.getTypeInfo("u32")),s.type.name==="u32"||s.type.name==="i32"||s.type.name==="f32"||s.type.name==="f16"?n.setVariable(r,new j(i,s.type)):s.type.name==="bool"?n.setVariable(r,new j(i?1:0,s.type)):s.type.name==="vec2"||s.type.name==="vec3"||s.type.name==="vec4"||s.type.name==="vec2f"||s.type.name==="vec3f"||s.type.name==="vec4f"||s.type.name==="vec2i"||s.type.name==="vec3i"||s.type.name==="vec4i"||s.type.name==="vec2u"||s.type.name==="vec3u"||s.type.name==="vec4u"||s.type.name==="vec2h"||s.type.name==="vec3h"||s.type.name==="vec4h"?n.setVariable(r,new N(i,s.type)):console.error(`Invalid constant type for ${r}`)):console.error(`Override ${r} does not exist in the shader.`)}}_dispatchWorkgroup(e,n,r){const i=[1,1,1];for(const h of e.node.attributes)if(h.name==="workgroup_size"){if(h.value.length>0){const p=r.getVariableValue(h.value[0]);i[0]=p instanceof j?p.value:parseInt(h.value[0])}if(h.value.length>1){const p=r.getVariableValue(h.value[1]);i[1]=p instanceof j?p.value:parseInt(h.value[1])}if(h.value.length>2){const p=r.getVariableValue(h.value[2]);i[2]=p instanceof j?p.value:parseInt(h.value[2])}}const s=this.getTypeInfo("vec3u"),o=this.getTypeInfo("u32");r.setVariable("@workgroup_size",new N(i,s));const a=i[0],u=i[1],f=i[2];for(let h=0,p=0;h<f;++h)for(let g=0;g<u;++g)for(let _=0;_<a;++_,++p){const v=[_,g,h],w=[_+n[0]*i[0],g+n[1]*i[1],h+n[2]*i[2]];r.setVariable("@local_invocation_id",new N(v,s)),r.setVariable("@global_invocation_id",new N(w,s)),r.setVariable("@local_invocation_index",new j(p,o)),this._dispatchExec(e,r)}}_dispatchExec(e,n){for(const r of e.node.args)for(const i of r.attributes)if(i.name==="builtin"){const s=`@${i.value}`,o=n.getVariable(s);o!==void 0&&n.variables.set(r.name,o)}this._execStatements(e.node.body,n)}getVariableName(e,n){for(;e instanceof gt;)e=e.right;return e instanceof sn?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,n){for(const r of e){if(r instanceof Array){const s=n.clone(),o=this._execStatements(r,s);if(o)return o;continue}const i=this.execStatement(r,n);if(i)return i}return null}_call(e,n){const r=n.clone();r.currentFunctionName=e.name;const i=n.getFunction(e.name);if(i){for(let s=0;s<i.node.args.length;++s){const o=i.node.args[s],a=this.evalExpression(e.args[s],r);r.setVariable(o.name,a,o)}this._execStatements(i.node.body,r)}else e.isBuiltin?this._callBuiltinFunction(e,r):this.getTypeInfo(e.name)&&this._evalCreate(e,n)}_increment(e,n){const r=this.getVariableName(e.variable,n),i=n.getVariable(r);i?e.operator==="++"?i.value instanceof j?i.value.value++:console.error(`Variable ${r} is not a scalar. Line ${e.line}`):e.operator==="--"?i.value instanceof j?i.value.value--:console.error(`Variable ${r} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${r} not found. Line ${e.line}`)}_getVariableData(e,n){if(e instanceof sn){const r=this.getVariableName(e,n),i=n.getVariable(r);return i===null?(console.error(`Variable ${r} not found. Line ${e.line}`),null):i.value.getSubData(this,e.postfix,n)}if(e instanceof gt){if(e.operator==="*"){const r=this._getVariableData(e.right,n);return r instanceof Zs?r.reference.getSubData(this,e.postfix,n):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const r=this._getVariableData(e.right,n);return new Zs(r)}}return null}_assign(e,n){let r=null,i="<var>",s=null;if(e.variable instanceof gt){const u=this._getVariableData(e.variable,n),f=this.evalExpression(e.value,n),h=e.operator;if(h==="="){if(u instanceof j||u instanceof N||u instanceof Ce){if(f instanceof j||f instanceof N||f instanceof Ce&&u.data.length===f.data.length)return void u.data.set(f.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(u instanceof ct&&f instanceof ct&&u.buffer.byteLength-u.offset>=f.buffer.byteLength-f.offset)return void(u.buffer.byteLength%4==0?new Uint32Array(u.buffer,u.offset,u.typeInfo.size/4).set(new Uint32Array(f.buffer,f.offset,f.typeInfo.size/4)):new Uint8Array(u.buffer,u.offset,u.typeInfo.size).set(new Uint8Array(f.buffer,f.offset,f.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(h==="+=")return u instanceof j||u instanceof N||u instanceof Ce?f instanceof j||f instanceof N||f instanceof Ce?void u.data.set(f.data.map((p,g)=>u.data[g]+p)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(h==="-=")return(u instanceof j||u instanceof N||u instanceof Ce)&&(f instanceof j||f instanceof N||f instanceof Ce)?void u.data.set(f.data.map((p,g)=>u.data[g]-p)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof gt){if(e.variable.operator==="*"){i=this.getVariableName(e.variable.right,n);const u=n.getVariable(i);if(!(u&&u.value instanceof Zs))return void console.error(`Variable ${i} is not a pointer. Line ${e.line}`);r=u.value.reference;let f=e.variable.postfix;if(!f){let h=e.variable.right;for(;h instanceof gt;){if(h.postfix){f=h.postfix;break}h=h.right}}f&&(r=r.getSubData(this,f,n))}}else{s=e.variable.postfix,i=this.getVariableName(e.variable,n);const u=n.getVariable(i);if(u===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);r=u.value}if(r instanceof Zs&&(r=r.reference),r===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);const o=this.evalExpression(e.value,n),a=e.operator;if(a==="=")if(r instanceof ct)r.setDataValue(this,o,s,n);else if(s){if(!(r instanceof N||r instanceof Ce))return void console.error(`Variable ${i} is not a vector or matrix. Line ${e.line}`);if(s instanceof Io){const u=this.evalExpression(s.index,n).value;if(r instanceof N){if(!(o instanceof j))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[u]=o.value}else{if(!(r instanceof Ce))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const f=this.evalExpression(s.index,n).value;if(f<0)return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(o instanceof N))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const h=r.typeInfo.getTypeName();if(h==="mat2x2"||h==="mat2x2f"||h==="mat2x2h"){if(!(f<2&&o.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*f]=o.data[0],r.data[2*f+1]=o.data[1]}else if(h==="mat2x3"||h==="mat2x3f"||h==="mat2x3h"){if(!(f<2&&o.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*f]=o.data[0],r.data[3*f+1]=o.data[1],r.data[3*f+2]=o.data[2]}else if(h==="mat2x4"||h==="mat2x4f"||h==="mat2x4h"){if(!(f<2&&o.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*f]=o.data[0],r.data[4*f+1]=o.data[1],r.data[4*f+2]=o.data[2],r.data[4*f+3]=o.data[3]}else if(h==="mat3x2"||h==="mat3x2f"||h==="mat3x2h"){if(!(f<3&&o.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*f]=o.data[0],r.data[2*f+1]=o.data[1]}else if(h==="mat3x3"||h==="mat3x3f"||h==="mat3x3h"){if(!(f<3&&o.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*f]=o.data[0],r.data[3*f+1]=o.data[1],r.data[3*f+2]=o.data[2]}else if(h==="mat3x4"||h==="mat3x4f"||h==="mat3x4h"){if(!(f<3&&o.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*f]=o.data[0],r.data[4*f+1]=o.data[1],r.data[4*f+2]=o.data[2],r.data[4*f+3]=o.data[3]}else if(h==="mat4x2"||h==="mat4x2f"||h==="mat4x2h"){if(!(f<4&&o.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*f]=o.data[0],r.data[2*f+1]=o.data[1]}else if(h==="mat4x3"||h==="mat4x3f"||h==="mat4x3h"){if(!(f<4&&o.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*f]=o.data[0],r.data[3*f+1]=o.data[1],r.data[3*f+2]=o.data[2]}else{if(h!=="mat4x4"&&h!=="mat4x4f"&&h!=="mat4x4h")return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(f<4&&o.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*f]=o.data[0],r.data[4*f+1]=o.data[1],r.data[4*f+2]=o.data[2],r.data[4*f+3]=o.data[3]}}}}}else if(s instanceof fs){const u=s.value;if(!(r instanceof N))return void console.error(`Invalid assignment to ${u}. Variable ${i} is not a vector. Line ${e.line}`);if(o instanceof j){if(u.length>1)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);if(u==="x")r.data[0]=o.value;else if(u==="y"){if(r.data.length<2)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);r.data[1]=o.value}else if(u==="z"){if(r.data.length<3)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);r.data[2]=o.value}else if(u==="w"){if(r.data.length<4)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);r.data[3]=o.value}}else{if(!(o instanceof N))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(u.length!==o.data.length)return void console.error(`Invalid assignment to ${u} for variable ${i}. Line ${e.line}`);for(let f=0;f<u.length;++f){const h=u[f];if(h==="x"||h==="r")r.data[0]=o.data[f];else if(h==="y"||h==="g"){if(o.data.length<2)return void console.error(`Invalid assignment to ${h} for variable ${i}. Line ${e.line}`);r.data[1]=o.data[f]}else if(h==="z"||h==="b"){if(o.data.length<3)return void console.error(`Invalid assignment to ${h} for variable ${i}. Line ${e.line}`);r.data[2]=o.data[f]}else{if(h!=="w"&&h!=="a")return void console.error(`Invalid assignment to ${h} for variable ${i}. Line ${e.line}`);if(o.data.length<4)return void console.error(`Invalid assignment to ${h} for variable ${i}. Line ${e.line}`);r.data[3]=o.data[f]}}}}}else r instanceof j&&o instanceof j?r.value=o.value:r instanceof N&&o instanceof N||r instanceof Ce&&o instanceof Ce?r.data.set(o.data):console.error(`Invalid assignment to ${i}. Line ${e.line}`);else{const u=r.getSubData(this,s,n);if(u instanceof N&&o instanceof j){const f=u.data,h=o.value;if(a==="+=")for(let p=0;p<f.length;++p)f[p]+=h;else if(a==="-=")for(let p=0;p<f.length;++p)f[p]-=h;else if(a==="*=")for(let p=0;p<f.length;++p)f[p]*=h;else if(a==="/=")for(let p=0;p<f.length;++p)f[p]/=h;else if(a==="%=")for(let p=0;p<f.length;++p)f[p]%=h;else if(a==="&=")for(let p=0;p<f.length;++p)f[p]&=h;else if(a==="|=")for(let p=0;p<f.length;++p)f[p]|=h;else if(a==="^=")for(let p=0;p<f.length;++p)f[p]^=h;else if(a==="<<=")for(let p=0;p<f.length;++p)f[p]<<=h;else if(a===">>=")for(let p=0;p<f.length;++p)f[p]>>=h;else console.error(`Invalid operator ${a}. Line ${e.line}`)}else if(u instanceof N&&o instanceof N){const f=u.data,h=o.data;if(f.length!==h.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(a==="+=")for(let p=0;p<f.length;++p)f[p]+=h[p];else if(a==="-=")for(let p=0;p<f.length;++p)f[p]-=h[p];else if(a==="*=")for(let p=0;p<f.length;++p)f[p]*=h[p];else if(a==="/=")for(let p=0;p<f.length;++p)f[p]/=h[p];else if(a==="%=")for(let p=0;p<f.length;++p)f[p]%=h[p];else if(a==="&=")for(let p=0;p<f.length;++p)f[p]&=h[p];else if(a==="|=")for(let p=0;p<f.length;++p)f[p]|=h[p];else if(a==="^=")for(let p=0;p<f.length;++p)f[p]^=h[p];else if(a==="<<=")for(let p=0;p<f.length;++p)f[p]<<=h[p];else if(a===">>=")for(let p=0;p<f.length;++p)f[p]>>=h[p];else console.error(`Invalid operator ${a}. Line ${e.line}`)}else{if(!(u instanceof j&&o instanceof j))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);a==="+="?u.value+=o.value:a==="-="?u.value-=o.value:a==="*="?u.value*=o.value:a==="/="?u.value/=o.value:a==="%="?u.value%=o.value:a==="&="?u.value&=o.value:a==="|="?u.value|=o.value:a==="^="?u.value^=o.value:a==="<<="?u.value<<=o.value:a===">>="?u.value>>=o.value:console.error(`Invalid operator ${a}. Line ${e.line}`)}r instanceof ct&&r.setDataValue(this,u,s,n)}}_function(e,n){const r=new L_(e);n.functions.set(e.name,r)}_const(e,n){let r=null;e.value!==null&&(r=this.evalExpression(e.value,n)),n.createVariable(e.name,r,e)}_let(e,n){let r=null;if(e.value!==null){if(r=this.evalExpression(e.value,n),r===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof gt||(r=r.clone())}else{const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||i==="array"){const s=new Zn(e.type,[]);r=this._evalCreate(s,n)}}n.createVariable(e.name,r,e)}_var(e,n){let r=null;if(e.value!==null){if(r=this.evalExpression(e.value,n),r===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof gt||(r=r.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||e.type instanceof ll||e.type instanceof Ar||e.type instanceof $){const s=new Zn(e.type,[]);r=this._evalCreate(s,n)}}n.createVariable(e.name,r,e)}_switch(e,n){n=n.clone();const r=this.evalExpression(e.condition,n);if(!(r instanceof j))return console.error(`Invalid if condition. Line ${e.line}`),null;let i=null;for(const s of e.cases)if(s instanceof VS)for(const o of s.selectors){if(o instanceof zu){i=s;continue}const a=this.evalExpression(o,n);if(!(a instanceof j))return console.error(`Invalid case selector. Line ${e.line}`),null;if(a.value===r.value)return this._execStatements(s.body,n)}else s instanceof $S&&(i=s);return i?this._execStatements(i.body,n):null}_if(e,n){n=n.clone();const r=this.evalExpression(e.condition,n);if(!(r instanceof j))return console.error(`Invalid if condition. Line ${e.line}`),null;if(r.value)return this._execStatements(e.body,n);for(const i of e.elseif){const s=this.evalExpression(i.condition,n);if(!(s instanceof j))return console.error(`Invalid if condition. Line ${e.line}`),null;if(s.value)return this._execStatements(i.body,n)}return e.else?this._execStatements(e.else,n):null}_getScalarValue(e){return e instanceof j?e.value:(console.error("Expected scalar value.",e),0)}_for(e,n){for(n=n.clone(),this.execStatement(e.init,n);this._getScalarValue(this.evalExpression(e.condition,n));){const r=this._execStatements(e.body,n);if(r===Dt._breakObj)break;if(r!==null&&r!==Dt._continueObj)return r;this.execStatement(e.increment,n)}return null}_loop(e,n){for(n=n.clone();;){const r=this._execStatements(e.body,n);if(r===Dt._breakObj)break;if(r===Dt._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,n)===Dt._breakObj)break}else if(r!==null)return r}return null}_while(e,n){for(n=n.clone();this._getScalarValue(this.evalExpression(e.condition,n));){const r=this._execStatements(e.body,n);if(r===Dt._breakObj)break;if(r!==Dt._continueObj&&r!==null)return r}return null}_evalBitcast(e,n){const r=this.evalExpression(e.value,n),i=e.type;if(r instanceof j){const s=jw(r.value,r.typeInfo.name,i.name);return new j(s,this.getTypeInfo(i))}if(r instanceof N){const s=r.typeInfo.getTypeName();let o="";if(s.endsWith("f"))o="f32";else if(s.endsWith("i"))o="i32";else if(s.endsWith("u"))o="u32";else if(s.endsWith("b"))o="bool";else{if(!s.endsWith("h"))return console.error(`Unknown vector type ${s}. Line ${e.line}`),null;o="f16"}const a=i.getTypeName();let u="";if(a.endsWith("f"))u="f32";else if(a.endsWith("i"))u="i32";else if(a.endsWith("u"))u="u32";else if(a.endsWith("b"))u="bool";else{if(!a.endsWith("h"))return console.error(`Unknown vector type ${u}. Line ${e.line}`),null;u="f16"}const f=function(h,p,g){if(p===g)return h;const _=new Array(h.length);for(let v=0;v<h.length;v++)_[v]=jw(h[v],p,g);return _}(Array.from(r.data),o,u);return new N(f,this.getTypeInfo(i))}return console.error(`TODO: bitcast for ${r.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,n){return n.getVariableValue(e.name).clone().getSubData(this,e.postfix,n)}_evalCreate(e,n){var r;if(e instanceof Zn){if(e.type===null)return dm.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,n);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,n);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,n)}}const i=e instanceof Zn?e.type.name:e.name,s=e instanceof Zn?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(s===null)return console.error(`Unknown type ${i}. Line ${e.line}`),null;if(s.size===0)return null;const o=new ct(new ArrayBuffer(s.size),s,0);if(s instanceof gi){if(e.args)for(let a=0;a<e.args.length;++a){const u=s.members[a],f=e.args[a],h=this.evalExpression(f,n);o.setData(this,h,u.type,u.offset,n)}}else if(s instanceof vi){let a=0;if(e.args)for(let u=0;u<e.args.length;++u){const f=e.args[u],h=this.evalExpression(f,n);s.format===null&&(((r=h.typeInfo)===null||r===void 0?void 0:r.name)==="x32"?s.format=this.getTypeInfo("i32"):s.format=h.typeInfo),o.setData(this,h,s.format,a,n),a+=s.stride}}else console.error(`Unknown type "${i}". Line ${e.line}`);return e instanceof Zn?o.getSubData(this,e.postfix,n):o}_evalLiteral(e,n){const r=this.getTypeInfo(e.type),i=r.name;return i==="x32"||i==="u32"||i==="f32"||i==="f16"||i==="i32"||i==="bool"?new j(e.scalarValue,r):i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"?this._callConstructorVec(e,n):i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"?this._callConstructorMatrix(e,n):e.value}_evalVariable(e,n){const r=n.getVariableValue(e.name);return r===null?r:r.getSubData(this,e.postfix,n)}_maxFormatTypeInfo(e){let n=e[0];if(n.name==="f32")return n;for(let r=1;r<e.length;++r){const i=Dt._priority.get(n.name);Dt._priority.get(e[r].name)<i&&(n=e[r])}return n.name==="x32"?this.getTypeInfo("i32"):n}_evalUnaryOp(e,n){const r=this.evalExpression(e.right,n);if(e.operator==="&")return new Zs(r);if(e.operator==="*")return r instanceof Zs?r.reference.getSubData(this,e.postfix,n):(console.error(`Invalid dereference. Line ${e.line}`),null);const i=r instanceof j?r.value:r instanceof N?Array.from(r.data):null;switch(e.operator){case"+":{if(me(i)){const a=i.map((u,f)=>+u);return new N(a,r.typeInfo)}const s=i,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new j(+s,o)}case"-":{if(me(i)){const a=i.map((u,f)=>-u);return new N(a,r.typeInfo)}const s=i,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new j(-s,o)}case"!":{if(me(i)){const a=i.map((u,f)=>u?0:1);return new N(a,r.typeInfo)}const s=i,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new j(s?0:1,o)}case"~":{if(me(i)){const a=i.map((u,f)=>~u);return new N(a,r.typeInfo)}const s=i,o=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new j(~s,o)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,n){const r=this.evalExpression(e.left,n),i=this.evalExpression(e.right,n),s=r instanceof j?r.value:r instanceof N||r instanceof Ce?Array.from(r.data):null,o=i instanceof j?i.value:i instanceof N||i instanceof Ce?Array.from(i.data):null;switch(e.operator){case"+":{if(me(s)&&me(o)){const h=s,p=o;if(h.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const g=h.map((_,v)=>_+p[v]);return new N(g,r.typeInfo)}if(me(s)){const h=o,p=s.map((g,_)=>g+h);return new N(p,r.typeInfo)}if(me(o)){const h=s,p=o.map((g,_)=>h+g);return new N(p,i.typeInfo)}const a=s,u=o,f=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new j(a+u,f)}case"-":{if(me(s)&&me(o)){const h=s,p=o;if(h.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const g=h.map((_,v)=>_-p[v]);return new N(g,r.typeInfo)}if(me(s)){const h=o,p=s.map((g,_)=>g-h);return new N(p,r.typeInfo)}if(me(o)){const h=s,p=o.map((g,_)=>h-g);return new N(p,i.typeInfo)}const a=s,u=o,f=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new j(a-u,f)}case"*":{if(me(s)&&me(o)){const h=s,p=o;if(r instanceof Ce&&i instanceof Ce){const g=function(x,T,A,E){if(zt[T.name]===void 0||zt[E.name]===void 0)return null;const R=zt[T.name][0],k=zt[T.name][1],M=zt[E.name][0];if(R!==zt[E.name][1])return null;const L=new Array(M*k);for(let W=0;W<k;W++)for(let H=0;H<M;H++){let X=0;for(let B=0;B<R;B++)X+=x[B*k+W]*A[H*R+B];L[W*M+H]=X}return L}(h,r.typeInfo,p,i.typeInfo);if(g===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const _=zt[i.typeInfo.name][0],v=zt[r.typeInfo.name][1],w=this.getTypeInfo(`mat${_}x${v}f`);return new Ce(g,w)}if(r instanceof Ce&&i instanceof N){const g=function(_,v,w,x){if(zt[v.name]===void 0||$p[x.name]===void 0)return null;const T=zt[v.name][0],A=zt[v.name][1];if(T!==w.length)return null;const E=new Array(A);for(let R=0;R<A;R++){let k=0;for(let M=0;M<T;M++)k+=_[M*A+R]*w[M];E[R]=k}return E}(h,r.typeInfo,p,i.typeInfo);return g===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new N(g,i.typeInfo)}if(r instanceof N&&i instanceof Ce){const g=function(_,v,w,x){if($p[v.name]===void 0||zt[x.name]===void 0)return null;const T=zt[x.name][0],A=zt[x.name][1];if(A!==_.length)return null;const E=[];for(let R=0;R<T;R++){let k=0;for(let M=0;M<A;M++)k+=_[M]*w[M*T+R];E[R]=k}return E}(h,r.typeInfo,p,i.typeInfo);return g===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new N(g,r.typeInfo)}{if(h.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const g=h.map((_,v)=>_*p[v]);return new N(g,r.typeInfo)}}if(me(s)){const h=o,p=s.map((g,_)=>g*h);return r instanceof Ce?new Ce(p,r.typeInfo):new N(p,r.typeInfo)}if(me(o)){const h=s,p=o.map((g,_)=>h*g);return i instanceof Ce?new Ce(p,i.typeInfo):new N(p,i.typeInfo)}const a=s,u=o,f=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new j(a*u,f)}case"%":{if(me(s)&&me(o)){const h=s,p=o;if(h.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const g=h.map((_,v)=>_%p[v]);return new N(g,r.typeInfo)}if(me(s)){const h=o,p=s.map((g,_)=>g%h);return new N(p,r.typeInfo)}if(me(o)){const h=s,p=o.map((g,_)=>h%g);return new N(p,i.typeInfo)}const a=s,u=o,f=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new j(a%u,f)}case"/":{if(me(s)&&me(o)){const h=s,p=o;if(h.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const g=h.map((_,v)=>_/p[v]);return new N(g,r.typeInfo)}if(me(s)){const h=o,p=s.map((g,_)=>g/h);return new N(p,r.typeInfo)}if(me(o)){const h=s,p=o.map((g,_)=>h/g);return new N(p,i.typeInfo)}const a=s,u=o,f=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new j(a/u,f)}case"&":{if(me(s)&&me(o)){const h=s,p=o;if(h.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const g=h.map((_,v)=>_&p[v]);return new N(g,r.typeInfo)}if(me(s)){const h=o,p=s.map((g,_)=>g&h);return new N(p,r.typeInfo)}if(me(o)){const h=s,p=o.map((g,_)=>h&g);return new N(p,i.typeInfo)}const a=s,u=o,f=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new j(a&u,f)}case"|":{if(me(s)&&me(o)){const h=s,p=o;if(h.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const g=h.map((_,v)=>_|p[v]);return new N(g,r.typeInfo)}if(me(s)){const h=o,p=s.map((g,_)=>g|h);return new N(p,r.typeInfo)}if(me(o)){const h=s,p=o.map((g,_)=>h|g);return new N(p,i.typeInfo)}const a=s,u=o,f=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new j(a|u,f)}case"^":{if(me(s)&&me(o)){const h=s,p=o;if(h.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const g=h.map((_,v)=>_^p[v]);return new N(g,r.typeInfo)}if(me(s)){const h=o,p=s.map((g,_)=>g^h);return new N(p,r.typeInfo)}if(me(o)){const h=s,p=o.map((g,_)=>h^g);return new N(p,i.typeInfo)}const a=s,u=o,f=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new j(a^u,f)}case"<<":{if(me(s)&&me(o)){const h=s,p=o;if(h.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const g=h.map((_,v)=>_<<p[v]);return new N(g,r.typeInfo)}if(me(s)){const h=o,p=s.map((g,_)=>g<<h);return new N(p,r.typeInfo)}if(me(o)){const h=s,p=o.map((g,_)=>h<<g);return new N(p,i.typeInfo)}const a=s,u=o,f=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new j(a<<u,f)}case">>":{if(me(s)&&me(o)){const h=s,p=o;if(h.length!==p.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const g=h.map((_,v)=>_>>p[v]);return new N(g,r.typeInfo)}if(me(s)){const h=o,p=s.map((g,_)=>g>>h);return new N(p,r.typeInfo)}if(me(o)){const h=s,p=o.map((g,_)=>h>>g);return new N(p,i.typeInfo)}const a=s,u=o,f=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new j(a>>u,f)}case">":if(me(s)&&me(o)){const a=s,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((h,p)=>h>u[p]?1:0);return new N(f,r.typeInfo)}if(me(s)){const a=o,u=s.map((f,h)=>f>a?1:0);return new N(u,r.typeInfo)}if(me(o)){const a=s,u=o.map((f,h)=>a>f?1:0);return new N(u,i.typeInfo)}return new j(s>o?1:0,this.getTypeInfo("bool"));case"<":if(me(s)&&me(o)){const a=s,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((h,p)=>h<u[p]?1:0);return new N(f,r.typeInfo)}if(me(s)){const a=o,u=s.map((f,h)=>f<a?1:0);return new N(u,r.typeInfo)}if(me(o)){const a=s,u=o.map((f,h)=>a<f?1:0);return new N(u,i.typeInfo)}return new j(s<o?1:0,this.getTypeInfo("bool"));case"==":if(me(s)&&me(o)){const a=s,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((h,p)=>h===u[p]?1:0);return new N(f,r.typeInfo)}if(me(s)){const a=o,u=s.map((f,h)=>f==a?1:0);return new N(u,r.typeInfo)}if(me(o)){const a=s,u=o.map((f,h)=>a==f?1:0);return new N(u,i.typeInfo)}return new j(s===o?1:0,this.getTypeInfo("bool"));case"!=":if(me(s)&&me(o)){const a=s,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((h,p)=>h!==u[p]?1:0);return new N(f,r.typeInfo)}if(me(s)){const a=o,u=s.map((f,h)=>f!==a?1:0);return new N(u,r.typeInfo)}if(me(o)){const a=s,u=o.map((f,h)=>a!==f?1:0);return new N(u,i.typeInfo)}return new j(s!==o?1:0,this.getTypeInfo("bool"));case">=":if(me(s)&&me(o)){const a=s,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((h,p)=>h>=u[p]?1:0);return new N(f,r.typeInfo)}if(me(s)){const a=o,u=s.map((f,h)=>f>=a?1:0);return new N(u,r.typeInfo)}if(me(o)){const a=s,u=o.map((f,h)=>a>=f?1:0);return new N(u,i.typeInfo)}return new j(s>=o?1:0,this.getTypeInfo("bool"));case"<=":if(me(s)&&me(o)){const a=s,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((h,p)=>h<=u[p]?1:0);return new N(f,r.typeInfo)}if(me(s)){const a=o,u=s.map((f,h)=>f<=a?1:0);return new N(u,r.typeInfo)}if(me(o)){const a=s,u=o.map((f,h)=>a<=f?1:0);return new N(u,i.typeInfo)}return new j(s<=o?1:0,this.getTypeInfo("bool"));case"&&":if(me(s)&&me(o)){const a=s,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((h,p)=>h&&u[p]?1:0);return new N(f,r.typeInfo)}if(me(s)){const a=o,u=s.map((f,h)=>f&&a?1:0);return new N(u,r.typeInfo)}if(me(o)){const a=s,u=o.map((f,h)=>a&&f?1:0);return new N(u,i.typeInfo)}return new j(s&&o?1:0,this.getTypeInfo("bool"));case"||":if(me(s)&&me(o)){const a=s,u=o;if(a.length!==u.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const f=a.map((h,p)=>h||u[p]?1:0);return new N(f,r.typeInfo)}if(me(s)){const a=o,u=s.map((f,h)=>f||a?1:0);return new N(u,r.typeInfo)}if(me(o)){const a=s,u=o.map((f,h)=>a||f?1:0);return new N(u,i.typeInfo)}return new j(s||o?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,n){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const r=n.clone();r.currentFunctionName=e.name;const i=n.getFunction(e.name);if(!i)return e.isBuiltin?this._callBuiltinFunction(e,r):this.getTypeInfo(e.name)?this._evalCreate(e,n):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let s=0;s<i.node.args.length;++s){const o=i.node.args[s],a=this.evalExpression(e.args[s],r);r.createVariable(o.name,a,o)}return this._execStatements(i.node.body,r)}_callBuiltinFunction(e,n){switch(e.name){case"all":return this.builtins.All(e,n);case"any":return this.builtins.Any(e,n);case"select":return this.builtins.Select(e,n);case"arrayLength":return this.builtins.ArrayLength(e,n);case"abs":return this.builtins.Abs(e,n);case"acos":return this.builtins.Acos(e,n);case"acosh":return this.builtins.Acosh(e,n);case"asin":return this.builtins.Asin(e,n);case"asinh":return this.builtins.Asinh(e,n);case"atan":return this.builtins.Atan(e,n);case"atanh":return this.builtins.Atanh(e,n);case"atan2":return this.builtins.Atan2(e,n);case"ceil":return this.builtins.Ceil(e,n);case"clamp":return this.builtins.Clamp(e,n);case"cos":return this.builtins.Cos(e,n);case"cosh":return this.builtins.Cosh(e,n);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,n);case"countOneBits":return this.builtins.CountOneBits(e,n);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,n);case"cross":return this.builtins.Cross(e,n);case"degrees":return this.builtins.Degrees(e,n);case"determinant":return this.builtins.Determinant(e,n);case"distance":return this.builtins.Distance(e,n);case"dot":return this.builtins.Dot(e,n);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,n);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,n);case"exp":return this.builtins.Exp(e,n);case"exp2":return this.builtins.Exp2(e,n);case"extractBits":return this.builtins.ExtractBits(e,n);case"faceForward":return this.builtins.FaceForward(e,n);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,n);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,n);case"floor":return this.builtins.Floor(e,n);case"fma":return this.builtins.Fma(e,n);case"fract":return this.builtins.Fract(e,n);case"frexp":return this.builtins.Frexp(e,n);case"insertBits":return this.builtins.InsertBits(e,n);case"inverseSqrt":return this.builtins.InverseSqrt(e,n);case"ldexp":return this.builtins.Ldexp(e,n);case"length":return this.builtins.Length(e,n);case"log":return this.builtins.Log(e,n);case"log2":return this.builtins.Log2(e,n);case"max":return this.builtins.Max(e,n);case"min":return this.builtins.Min(e,n);case"mix":return this.builtins.Mix(e,n);case"modf":return this.builtins.Modf(e,n);case"normalize":return this.builtins.Normalize(e,n);case"pow":return this.builtins.Pow(e,n);case"quantizeToF16":return this.builtins.QuantizeToF16(e,n);case"radians":return this.builtins.Radians(e,n);case"reflect":return this.builtins.Reflect(e,n);case"refract":return this.builtins.Refract(e,n);case"reverseBits":return this.builtins.ReverseBits(e,n);case"round":return this.builtins.Round(e,n);case"saturate":return this.builtins.Saturate(e,n);case"sign":return this.builtins.Sign(e,n);case"sin":return this.builtins.Sin(e,n);case"sinh":return this.builtins.Sinh(e,n);case"smoothStep":return this.builtins.SmoothStep(e,n);case"sqrt":return this.builtins.Sqrt(e,n);case"step":return this.builtins.Step(e,n);case"tan":return this.builtins.Tan(e,n);case"tanh":return this.builtins.Tanh(e,n);case"transpose":return this.builtins.Transpose(e,n);case"trunc":return this.builtins.Trunc(e,n);case"dpdx":return this.builtins.Dpdx(e,n);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,n);case"dpdxFine":return this.builtins.DpdxFine(e,n);case"dpdy":return this.builtins.Dpdy(e,n);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,n);case"dpdyFine":return this.builtins.DpdyFine(e,n);case"fwidth":return this.builtins.Fwidth(e,n);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,n);case"fwidthFine":return this.builtins.FwidthFine(e,n);case"textureDimensions":return this.builtins.TextureDimensions(e,n);case"textureGather":return this.builtins.TextureGather(e,n);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,n);case"textureLoad":return this.builtins.TextureLoad(e,n);case"textureNumLayers":return this.builtins.TextureNumLayers(e,n);case"textureNumLevels":return this.builtins.TextureNumLevels(e,n);case"textureNumSamples":return this.builtins.TextureNumSamples(e,n);case"textureSample":return this.builtins.TextureSample(e,n);case"textureSampleBias":return this.builtins.TextureSampleBias(e,n);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,n);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,n);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,n);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,n);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,n);case"textureStore":return this.builtins.TextureStore(e,n);case"atomicLoad":return this.builtins.AtomicLoad(e,n);case"atomicStore":return this.builtins.AtomicStore(e,n);case"atomicAdd":return this.builtins.AtomicAdd(e,n);case"atomicSub":return this.builtins.AtomicSub(e,n);case"atomicMax":return this.builtins.AtomicMax(e,n);case"atomicMin":return this.builtins.AtomicMin(e,n);case"atomicAnd":return this.builtins.AtomicAnd(e,n);case"atomicOr":return this.builtins.AtomicOr(e,n);case"atomicXor":return this.builtins.AtomicXor(e,n);case"atomicExchange":return this.builtins.AtomicExchange(e,n);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,n);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,n);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,n);case"pack4xI8":return this.builtins.Pack4xI8(e,n);case"pack4xU8":return this.builtins.Pack4xU8(e,n);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,n);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,n);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,n);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,n);case"pack2x16float":return this.builtins.Pack2x16float(e,n);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,n);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,n);case"unpack4xI8":return this.builtins.Unpack4xI8(e,n);case"unpack4xU8":return this.builtins.Unpack4xU8(e,n);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,n);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,n);case"unpack2x16float":return this.builtins.Unpack2x16float(e,n);case"storageBarrier":return this.builtins.StorageBarrier(e,n);case"textureBarrier":return this.builtins.TextureBarrier(e,n);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,n);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,n);case"subgroupAdd":return this.builtins.SubgroupAdd(e,n);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,n);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,n);case"subgroupAll":return this.builtins.SubgroupAll(e,n);case"subgroupAnd":return this.builtins.SubgroupAnd(e,n);case"subgroupAny":return this.builtins.SubgroupAny(e,n);case"subgroupBallot":return this.builtins.SubgroupBallot(e,n);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,n);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,n);case"subgroupElect":return this.builtins.SubgroupElect(e,n);case"subgroupMax":return this.builtins.SubgroupMax(e,n);case"subgroupMin":return this.builtins.SubgroupMin(e,n);case"subgroupMul":return this.builtins.SubgroupMul(e,n);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,n);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,n);case"subgroupOr":return this.builtins.SubgroupOr(e,n);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,n);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,n);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,n);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,n);case"subgroupXor":return this.builtins.SubgroupXor(e,n);case"quadBroadcast":return this.builtins.QuadBroadcast(e,n);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,n);case"quadSwapX":return this.builtins.QuadSwapX(e,n);case"quadSwapY":return this.builtins.QuadSwapY(e,n)}const r=n.getFunction(e.name);if(r){const i=n.clone();for(let s=0;s<r.node.args.length;++s){const o=r.node.args[s],a=this.evalExpression(e.args[s],i);i.setVariable(o.name,a,o)}return this._execStatements(r.node.body,i)}return null}_callConstructorValue(e,n){if(!e.args||e.args.length===0)return new j(0,this.getTypeInfo(e.type));const r=this.evalExpression(e.args[0],n);return r.typeInfo=this.getTypeInfo(e.type),r.getSubData(this,e.postfix,n).clone()}_callConstructorVec(e,n){const r=this.getTypeInfo(e.type),i=e.type.getTypeName(),s=$p[i];if(s===void 0)return console.error(`Invalid vec constructor ${i}. Line ${e.line}`),null;const o=[];if(e instanceof vt)if(e.isVector){const a=e.vectorValue;for(const u of a)o.push(u)}else o.push(e.scalarValue);else if(e.args)for(const a of e.args){const u=this.evalExpression(a,n);if(u instanceof N){const f=u.data;for(let h=0;h<f.length;++h){let p=f[h];o.push(p)}}else if(u instanceof j){let f=u.value;o.push(f)}}if(e.type instanceof $&&e.type.format===null&&(e.type.format=$.f32),o.length===0){const a=new Array(s).fill(0);return new N(a,r).getSubData(this,e.postfix,n)}if(o.length===1)for(;o.length<s;)o.push(o[0]);return o.length<s?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new N(o.length>s?o.slice(0,s):o,r).getSubData(this,e.postfix,n)}_callConstructorMatrix(e,n){const r=this.getTypeInfo(e.type),i=e.type.getTypeName(),s=zt[i];if(s===void 0)return console.error(`Invalid matrix constructor ${i}. Line ${e.line}`),null;const o=[];if(e instanceof vt)if(e.isVector){const a=e.vectorValue;for(const u of a)o.push(u)}else o.push(e.scalarValue);else if(e.args)for(const a of e.args){const u=this.evalExpression(a,n);u instanceof N?o.push(...u.data):u instanceof j?o.push(u.value):u instanceof Ce&&o.push(...u.data)}if(r instanceof us&&r.format===null&&(r.format=this.getTypeInfo("f32")),o.length===0){const a=new Array(s[2]).fill(0);return new Ce(a,r).getSubData(this,e.postfix,n)}return o.length!==s[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new Ce(o,r).getSubData(this,e.postfix,n)}}Dt._breakObj=new En(new wn("BREAK",null),null),Dt._continueObj=new En(new wn("CONTINUE",null),null),Dt._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class lj{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class cj{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new lj,this._exec=new Dt,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const n=[];for(;!this._isAtEnd();){const r=this._global_decl_or_directive();if(!r)break;n.push(r)}if(this._deferArrayCountEval.length>0){for(const r of this._deferArrayCountEval){const i=r.arrayType,s=r.countNode;if(s instanceof sn){const o=s.name,a=this._context.constants.get(o);if(a)try{const u=a.constEvaluate(this._exec);i.count=u}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const r of n)r.search(i=>{i instanceof Bw||i instanceof ju?i.type=this._forwardType(i.type):i instanceof ll?i.format=this._forwardType(i.format):i instanceof kr||i instanceof al||i instanceof Uu?i.type=this._forwardType(i.type):i instanceof El?i.returnType=this._forwardType(i.returnType):i instanceof Lw&&(i.type=this._forwardType(i.type))});return n}_forwardType(e){if(e instanceof Fw){const n=this._getType(e.name);if(n)return n}else e instanceof ju?e.type=this._forwardType(e.type):e instanceof ll&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const n=new JU(e);this._tokens=n.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,n){return e.line=n??this._currentLine,e}_error(e,n){return{token:e,message:n,toString:()=>`${n}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==I.eof}_match(e){if(e instanceof V)return!!this._check(e)&&(this._advance(),!0);for(let n=0,r=e.length;n<r;++n){const i=e[n];if(this._check(i))return this._advance(),!0}return!1}_consume(e,n){if(this._check(e))return this._advance();throw this._error(this._peek(),`${n}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const n=this._peek();if(e instanceof Array){const r=n.type;let i=!1;for(const s of e){if(r===s)return!0;s===I.tokens.name&&(i=!0)}if(i){const s=I.tokens.name.rule.exec(n.lexeme);if(s&&s.index==0&&s[0]==n.lexeme)return!0}return!1}if(n.type===e)return!0;if(e===I.tokens.name){const r=I.tokens.name.rule.exec(n.lexeme);return r&&r.index==0&&r[0]==n.lexeme}return!1}_advance(){var e,n;return this._currentLine=(n=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&n!==void 0?n:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(I.tokens.semicolon)&&!this._isAtEnd(););if(this._match(I.keywords.alias)){const n=this._type_alias();return this._consume(I.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([n]),n}if(this._match(I.keywords.diagnostic)){const n=this._diagnostic();return this._consume(I.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([n]),n}if(this._match(I.keywords.requires)){const n=this._requires_directive();return this._consume(I.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([n]),n}if(this._match(I.keywords.enable)){const n=this._enable_directive();return this._consume(I.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([n]),n}const e=this._attribute();if(this._check(I.keywords.var)){const n=this._global_variable_decl();return n!=null&&(n.attributes=e),this._consume(I.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([n]),n}if(this._check(I.keywords.override)){const n=this._override_variable_decl();return n!=null&&(n.attributes=e),this._consume(I.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([n]),n}if(this._check(I.keywords.let)){const n=this._global_let_decl();return n!=null&&(n.attributes=e),this._consume(I.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([n]),n}if(this._check(I.keywords.const)){const n=this._global_const_decl();return n!=null&&(n.attributes=e),this._consume(I.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([n]),n}if(this._check(I.keywords.struct)){const n=this._struct_decl();return n!=null&&(n.attributes=e),this._exec.reflection.updateAST([n]),n}if(this._check(I.keywords.fn)){const n=this._function_decl();return n!=null&&(n.attributes=e),this._exec.reflection.updateAST([n]),n}return null}_function_decl(){if(!this._match(I.keywords.fn))return null;const e=this._currentLine,n=this._consume(I.tokens.ident,"Expected function name.").toString();this._consume(I.tokens.paren_left,"Expected '(' for function arguments.");const r=[];if(!this._check(I.tokens.paren_right))do{if(this._check(I.tokens.paren_right))break;const a=this._attribute(),u=this._consume(I.tokens.name,"Expected argument name.").toString();this._consume(I.tokens.colon,"Expected ':' for argument type.");const f=this._attribute(),h=this._type_decl();h!=null&&(h.attributes=f,r.push(this._updateNode(new Lw(u,h,a))))}while(this._match(I.tokens.comma));this._consume(I.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(I.tokens.arrow)){const a=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=a)}const s=this._compound_statement(),o=this._currentLine;return this._updateNode(new El(n,r,i,s,e,o),e)}_compound_statement(){const e=[];for(this._consume(I.tokens.brace_left,"Expected '{' for block.");!this._check(I.tokens.brace_right);){const n=this._statement();n!==null&&e.push(n)}return this._consume(I.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(I.tokens.semicolon)&&!this._isAtEnd(););if(this._check(I.tokens.attr)&&this._attribute(),this._check(I.keywords.if))return this._if_statement();if(this._check(I.keywords.switch))return this._switch_statement();if(this._check(I.keywords.loop))return this._loop_statement();if(this._check(I.keywords.for))return this._for_statement();if(this._check(I.keywords.while))return this._while_statement();if(this._check(I.keywords.continuing))return this._continuing_statement();if(this._check(I.keywords.static_assert))return this._static_assert_statement();if(this._check(I.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(I.keywords.return))e=this._return_statement();else if(this._check([I.keywords.var,I.keywords.let,I.keywords.const]))e=this._variable_statement();else if(this._match(I.keywords.discard))e=this._updateNode(new KU);else if(this._match(I.keywords.break)){const n=this._updateNode(new FS);if(this._currentLoop.length>0){const r=this._currentLoop[this._currentLoop.length-1];n.loopId=r.id}e=n,this._check(I.keywords.if)&&(this._advance(),n.condition=this._optional_paren_expression())}else if(this._match(I.keywords.continue)){const n=this._updateNode(new LS);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${n.line}`);{const r=this._currentLoop[this._currentLoop.length-1];n.loopId=r.id}e=n}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(I.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(I.keywords.static_assert))return null;const e=this._currentLine,n=this._optional_paren_expression();return this._updateNode(new XU(n),e)}_while_statement(){if(!this._match(I.keywords.while))return null;const e=this._updateNode(new CS(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(I.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(I.keywords.continuing))return null;const n=this._currentLine,r=this._compound_statement();return this._updateNode(new hm(r,e),n)}_for_statement(){if(!this._match(I.keywords.for))return null;this._consume(I.tokens.paren_left,"Expected '('.");const e=this._updateNode(new RS(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(I.tokens.semicolon)?null:this._for_init(),this._consume(I.tokens.semicolon,"Expected ';'."),e.condition=this._check(I.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(I.tokens.semicolon,"Expected ';'."),e.increment=this._check(I.tokens.paren_right)?null:this._for_increment(),this._consume(I.tokens.paren_right,"Expected ')'."),this._check(I.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(I.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let n=null;return this._match(I.tokens.equal)&&(n=this._short_circuit_or_expression()),this._updateNode(new kr(e.name,e.type,e.storage,e.access,n),e.line)}if(this._match(I.keywords.let)){const e=this._currentLine,n=this._consume(I.tokens.name,"Expected name for let.").toString();let r=null;if(this._match(I.tokens.colon)){const s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}this._consume(I.tokens.equal,"Expected '=' for let.");const i=this._short_circuit_or_expression();return this._updateNode(new al(n,r,null,null,i),e)}if(this._match(I.keywords.const)){const e=this._currentLine,n=this._consume(I.tokens.name,"Expected name for const.").toString();let r=null;if(this._match(I.tokens.colon)){const s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}this._consume(I.tokens.equal,"Expected '=' for const.");const i=this._short_circuit_or_expression();return r===null&&i instanceof vt&&(r=i.type),this._updateNode(new Uu(n,r,null,null,i),e)}return null}_increment_decrement_statement(){const e=this._current,n=this._unary_expression();if(n==null)return null;if(!this._check(I.increment_operators))return this._current=e,null;const r=this._consume(I.increment_operators,"Expected increment operator");return this._updateNode(new IS(r.type===I.tokens.plus_plus?oo.increment:oo.decrement,n))}_assignment_statement(){let e=null;const n=this._currentLine;if(this._check(I.tokens.brace_right))return null;let r=this._match(I.tokens.underscore);if(r||(e=this._unary_expression()),!r&&e==null)return null;const i=this._consume(I.assignment_operators,"Expected assignment operator."),s=this._short_circuit_or_expression();return this._updateNode(new kS(qa.parse(i.lexeme),e,s),n)}_func_call_statement(){if(!this._check(I.tokens.ident))return null;const e=this._currentLine,n=this._current,r=this._consume(I.tokens.ident,"Expected function name."),i=this._argument_expression_list();return i===null?(this._current=n,null):this._updateNode(new M_(r.lexeme,i),e)}_loop_statement(){if(!this._match(I.keywords.loop))return null;this._check(I.tokens.attr)&&this._attribute(),this._consume(I.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new PS([],null));this._currentLoop.push(e);let n=this._statement();for(;n!==null;){if(Array.isArray(n))for(let r of n)e.body.push(r);else e.body.push(n);if(n instanceof hm){e.continuing=n;break}n=this._statement()}return this._currentLoop.pop(),this._consume(I.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(I.keywords.switch))return null;const e=this._updateNode(new MS(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(I.tokens.attr)&&this._attribute(),this._consume(I.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(I.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let n=!1;for(;this._check([I.keywords.default,I.keywords.case]);){if(this._match(I.keywords.case)){const r=this._case_selectors();for(const s of r)if(s instanceof zu){if(n)throw this._error(this._previous(),"Multiple default cases in switch statement.");n=!0;break}this._match(I.tokens.colon),this._check(I.tokens.attr)&&this._attribute(),this._consume(I.tokens.brace_left,"Exected '{' for switch case.");const i=this._case_body();this._consume(I.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new VS(r,i)))}if(this._match(I.keywords.default)){if(n)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(I.tokens.colon),this._check(I.tokens.attr)&&this._attribute(),this._consume(I.tokens.brace_left,"Exected '{' for switch default.");const r=this._case_body();this._consume(I.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new $S(r)))}}return e}_case_selectors(){const e=[];for(this._match(I.keywords.default)?e.push(this._updateNode(new zu)):e.push(this._shift_expression());this._match(I.tokens.comma);)this._match(I.keywords.default)?e.push(this._updateNode(new zu)):e.push(this._shift_expression());return e}_case_body(){if(this._match(I.keywords.fallthrough))return this._consume(I.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const n=this._case_body();return n.length==0?e:[...e,n[0]]}_if_statement(){if(!this._match(I.keywords.if))return null;const e=this._currentLine,n=this._optional_paren_expression();this._check(I.tokens.attr)&&this._attribute();const r=this._compound_statement();let i=[];this._match_elseif()&&(this._check(I.tokens.attr)&&this._attribute(),i=this._elseif_statement(i));let s=null;return this._match(I.keywords.else)&&(this._check(I.tokens.attr)&&this._attribute(),s=this._compound_statement()),this._updateNode(new NS(n,r,i,s),e)}_match_elseif(){return this._tokens[this._current].type===I.keywords.else&&this._tokens[this._current+1].type===I.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const n=this._optional_paren_expression(),r=this._compound_statement();return e.push(this._updateNode(new ZU(n,r))),this._match_elseif()&&(this._check(I.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(I.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new OS(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(I.tokens.or_or);)e=this._updateNode(new Dn(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(I.tokens.and_and);)e=this._updateNode(new Dn(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(I.tokens.or);)e=this._updateNode(new Dn(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(I.tokens.xor);)e=this._updateNode(new Dn(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(I.tokens.and);)e=this._updateNode(new Dn(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([I.tokens.equal_equal,I.tokens.not_equal])?this._updateNode(new Dn(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([I.tokens.less_than,I.tokens.greater_than,I.tokens.less_than_equal,I.tokens.greater_than_equal]);)e=this._updateNode(new Dn(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([I.tokens.shift_left,I.tokens.shift_right]);)e=this._updateNode(new Dn(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([I.tokens.plus,I.tokens.minus]);)e=this._updateNode(new Dn(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([I.tokens.star,I.tokens.forward_slash,I.tokens.modulo]);)e=this._updateNode(new Dn(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([I.tokens.minus,I.tokens.bang,I.tokens.tilde,I.tokens.star,I.tokens.and])?this._updateNode(new gt(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),n=this._postfix_expression();return n&&(e.postfix=n),e}_postfix_expression(){if(this._match(I.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(I.tokens.bracket_right,"Expected ']'.");const n=this._updateNode(new Io(e)),r=this._postfix_expression();return r&&(n.postfix=r),n}if(this._match(I.tokens.period)){const e=this._consume(I.tokens.name,"Expected member name."),n=this._postfix_expression(),r=this._updateNode(new fs(e.lexeme));return n&&(r.postfix=n),r}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const n=this._getStruct(e);if(n!==null)return n;switch(e){case"void":return re.void;case"bool":return re.bool;case"i32":return re.i32;case"u32":return re.u32;case"f32":return re.f32;case"f16":return re.f16;case"vec2f":return $.vec2f;case"vec3f":return $.vec3f;case"vec4f":return $.vec4f;case"vec2i":return $.vec2i;case"vec3i":return $.vec3i;case"vec4i":return $.vec4i;case"vec2u":return $.vec2u;case"vec3u":return $.vec3u;case"vec4u":return $.vec4u;case"vec2h":return $.vec2h;case"vec3h":return $.vec3h;case"vec4h":return $.vec4h;case"mat2x2f":return $.mat2x2f;case"mat2x3f":return $.mat2x3f;case"mat2x4f":return $.mat2x4f;case"mat3x2f":return $.mat3x2f;case"mat3x3f":return $.mat3x3f;case"mat3x4f":return $.mat3x4f;case"mat4x2f":return $.mat4x2f;case"mat4x3f":return $.mat4x3f;case"mat4x4f":return $.mat4x4f;case"mat2x2h":return $.mat2x2h;case"mat2x3h":return $.mat2x3h;case"mat2x4h":return $.mat2x4h;case"mat3x2h":return $.mat3x2h;case"mat3x3h":return $.mat3x3h;case"mat3x4h":return $.mat3x4h;case"mat4x2h":return $.mat4x2h;case"mat4x3h":return $.mat4x3h;case"mat4x4h":return $.mat4x4h;case"mat2x2i":return $.mat2x2i;case"mat2x3i":return $.mat2x3i;case"mat2x4i":return $.mat2x4i;case"mat3x2i":return $.mat3x2i;case"mat3x3i":return $.mat3x3i;case"mat3x4i":return $.mat3x4i;case"mat4x2i":return $.mat4x2i;case"mat4x3i":return $.mat4x3i;case"mat4x4i":return $.mat4x4i;case"mat2x2u":return $.mat2x2u;case"mat2x3u":return $.mat2x3u;case"mat2x4u":return $.mat2x4u;case"mat3x2u":return $.mat3x2u;case"mat3x3u":return $.mat3x3u;case"mat3x4u":return $.mat3x4u;case"mat4x2u":return $.mat4x2u;case"mat4x3u":return $.mat4x3u;case"mat4x4u":return $.mat4x4u}return null}_validateTypeRange(e,n){if(n.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(n.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(I.tokens.ident)){const r=this._previous().toString();if(this._check(I.tokens.paren_left)){const i=this._argument_expression_list(),s=this._getType(r);return s!==null?this._updateNode(new Zn(s,i)):this._updateNode(new O_(r,i))}if(this._context.constants.has(r)){const i=this._context.constants.get(r);return this._updateNode(new BS(r,i.value))}return this._updateNode(new sn(r))}if(this._match(I.tokens.int_literal)){const r=this._previous().toString();let i=r.endsWith("i")||r.endsWith("i")?re.i32:r.endsWith("u")||r.endsWith("U")?re.u32:re.x32;const s=parseInt(r);return this._validateTypeRange(s,i),this._updateNode(new vt(new j(s,this._exec.getTypeInfo(i)),i))}if(this._match(I.tokens.uint_literal)){const r=parseInt(this._previous().toString());return this._validateTypeRange(r,re.u32),this._updateNode(new vt(new j(r,this._exec.getTypeInfo(re.u32)),re.u32))}if(this._match([I.tokens.decimal_float_literal,I.tokens.hex_float_literal])){let r=this._previous().toString(),i=r.endsWith("h");i&&(r=r.substring(0,r.length-1));const s=parseFloat(r);this._validateTypeRange(s,i?re.f16:re.f32);const o=i?re.f16:re.f32;return this._updateNode(new vt(new j(s,this._exec.getTypeInfo(o)),o))}if(this._match([I.keywords.true,I.keywords.false])){let r=this._previous().toString()===I.keywords.true.rule;return this._updateNode(new vt(new j(r?1:0,this._exec.getTypeInfo(re.bool)),re.bool))}if(this._check(I.tokens.paren_left))return this._paren_expression();if(this._match(I.keywords.bitcast)){this._consume(I.tokens.less_than,"Expected '<'.");const r=this._type_decl();this._consume(I.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return this._updateNode(new US(r,i))}const e=this._type_decl(),n=this._argument_expression_list();return this._updateNode(new Zn(e,n))}_argument_expression_list(){if(!this._match(I.tokens.paren_left))return null;const e=[];do{if(this._check(I.tokens.paren_right))break;const n=this._short_circuit_or_expression();e.push(n)}while(this._match(I.tokens.comma));return this._consume(I.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(I.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(I.tokens.paren_right),e}_paren_expression(){this._consume(I.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(I.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(I.keywords.struct))return null;const e=this._currentLine,n=this._consume(I.tokens.ident,"Expected name for struct.").toString();this._consume(I.tokens.brace_left,"Expected '{' for struct body.");const r=[];for(;!this._check(I.tokens.brace_right);){const o=this._attribute(),a=this._consume(I.tokens.name,"Expected variable name.").toString();this._consume(I.tokens.colon,"Expected ':' for struct member type.");const u=this._attribute(),f=this._type_decl();f!=null&&(f.attributes=u),this._check(I.tokens.brace_right)?this._match(I.tokens.comma):this._consume(I.tokens.comma,"Expected ',' for struct member."),r.push(this._updateNode(new Bw(a,f,o)))}this._consume(I.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,s=this._updateNode(new Ar(n,r,e,i),e);return this._context.structs.set(n,s),s}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(I.tokens.equal)){const n=this._const_expression();e.value=n}if(e.type!==null&&e.value instanceof vt){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof vt&&(e.type=e.value.type.name==="x32"?re.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(I.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(I.keywords.const))return null;const n=this._consume(I.tokens.name,"Expected variable name"),r=this._currentLine;let i=null;if(this._match(I.tokens.colon)){const u=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=u)}let s=null;this._consume(I.tokens.equal,"const declarations require an assignment");const o=this._short_circuit_or_expression();try{let u=[re.f32],f=o.constEvaluate(this._exec,u);f instanceof j&&this._validateTypeRange(f.value,u[0]),u[0]instanceof $&&u[0].format===null&&f.typeInfo instanceof us&&f.typeInfo.format!==null&&(f.typeInfo.format.name==="f16"?u[0].format=re.f16:f.typeInfo.format.name==="f32"?u[0].format=re.f32:f.typeInfo.format.name==="i32"?u[0].format=re.i32:f.typeInfo.format.name==="u32"?u[0].format=re.u32:f.typeInfo.format.name==="bool"?u[0].format=re.bool:console.error(`TODO: impelement template format type ${f.typeInfo.format.name}`)),s=this._updateNode(new vt(f,u[0])),this._exec.context.setVariable(n.toString(),f)}catch{s=o}if(i!==null&&s instanceof vt){if(s.type.name!=="x32"&&i.getTypeName()!==s.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${s.type.name} to ${i.name}. Line:${this._currentLine}`);s.type=i,s.isScalar&&this._validateTypeRange(s.scalarValue,s.type)}else i===null&&s instanceof vt&&(i=(e=s?.type)!==null&&e!==void 0?e:re.f32,i===re.x32&&(i=re.i32));const a=this._updateNode(new Uu(n.toString(),i,"","",s),r);return this._context.constants.set(a.name,a),a}_global_let_decl(){if(!this._match(I.keywords.let))return null;const e=this._currentLine,n=this._consume(I.tokens.name,"Expected variable name");let r=null;if(this._match(I.tokens.colon)){const s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}let i=null;if(this._match(I.tokens.equal)&&(i=this._const_expression()),r!==null&&i instanceof vt){if(i.type.name!=="x32"&&r.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${r.name}. Line:${this._currentLine}`);i.type=r}else r===null&&i instanceof vt&&(r=i.type.name==="x32"?re.i32:i.type);return i instanceof vt&&i.isScalar&&this._validateTypeRange(i.scalarValue,r),this._updateNode(new al(n.toString(),r,"","",i),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(I.keywords.var))return null;const e=this._currentLine;let n="",r="";this._match(I.tokens.less_than)&&(n=this._consume(I.storage_class,"Expected storage_class.").toString(),this._match(I.tokens.comma)&&(r=this._consume(I.access_mode,"Expected access_mode.").toString()),this._consume(I.tokens.greater_than,"Expected '>'."));const i=this._consume(I.tokens.name,"Expected variable name");let s=null;if(this._match(I.tokens.colon)){const o=this._attribute();s=this._type_decl(),s!=null&&(s.attributes=o)}return this._updateNode(new kr(i.toString(),s,n,r,null),e)}_override_decl(){if(!this._match(I.keywords.override))return null;const e=this._consume(I.tokens.name,"Expected variable name");let n=null;if(this._match(I.tokens.colon)){const r=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=r)}return this._updateNode(new P_(e.toString(),n,null))}_diagnostic(){this._consume(I.tokens.paren_left,"Expected '('");const e=this._consume(I.tokens.ident,"Expected severity control name.");this._consume(I.tokens.comma,"Expected ','");let n=this._consume(I.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(I.tokens.period)&&(n+=`.${this._consume(I.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(I.tokens.paren_right,"Expected ')'"),this._updateNode(new DS(e.toString(),n))}_enable_directive(){const e=this._consume(I.tokens.ident,"identity expected.");return this._updateNode(new YU(e.toString()))}_requires_directive(){const e=[this._consume(I.tokens.ident,"identity expected.").toString()];for(;this._match(I.tokens.comma);){const n=this._consume(I.tokens.ident,"identity expected.");e.push(n.toString())}return this._updateNode(new qU(e))}_type_alias(){const e=this._consume(I.tokens.ident,"identity expected.");this._consume(I.tokens.equal,"Expected '=' for type alias.");let n=this._type_decl();if(n===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);const r=this._updateNode(new N_(e.toString(),n));return this._context.aliases.set(r.name,r),r}_type_decl(){if(this._check([I.tokens.ident,...I.texel_format,I.keywords.bool,I.keywords.f32,I.keywords.i32,I.keywords.u32])){const r=this._advance().toString();if(this._context.structs.has(r))return this._context.structs.get(r);if(this._context.aliases.has(r))return this._context.aliases.get(r).type;if(!this._getType(r)){const i=this._updateNode(new Fw(r));return this._forwardTypeCount++,i}return this._updateNode(new re(r))}let e=this._texture_sampler_types();if(e)return e;if(this._check(I.template_types)){let r=this._advance().toString(),i=null,s=null;return this._match(I.tokens.less_than)&&(i=this._type_decl(),s=null,this._match(I.tokens.comma)&&(s=this._consume(I.access_mode,"Expected access_mode for pointer").toString()),this._consume(I.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new $(r,i,s))}if(this._match(I.keywords.ptr)){let r=this._previous().toString();this._consume(I.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(I.storage_class,"Expected storage_class for pointer");this._consume(I.tokens.comma,"Expected ',' for pointer.");const s=this._type_decl();let o=null;return this._match(I.tokens.comma)&&(o=this._consume(I.access_mode,"Expected access_mode for pointer").toString()),this._consume(I.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new ju(r,i.toString(),s,o))}const n=this._attribute();if(this._match(I.keywords.array)){let r=null,i=-1;const s=this._previous();let o=null;if(this._match(I.tokens.less_than)){r=this._type_decl(),this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let u="";if(this._match(I.tokens.comma)){o=this._shift_expression();try{u=o.constEvaluate(this._exec).toString(),o=null}catch{u="1"}}this._consume(I.tokens.greater_than,"Expected '>' for array."),i=u?parseInt(u):0}const a=this._updateNode(new ll(s.toString(),n,r,i));return o&&this._deferArrayCountEval.push({arrayType:a,countNode:o}),a}return null}_texture_sampler_types(){if(this._match(I.sampler_type))return this._updateNode(new Ka(this._previous().toString(),null,null));if(this._match(I.depth_texture_type))return this._updateNode(new Ka(this._previous().toString(),null,null));if(this._match(I.sampled_texture_type)||this._match(I.multisampled_texture_type)){const e=this._previous();this._consume(I.tokens.less_than,"Expected '<' for sampler type.");const n=this._type_decl();return this._consume(I.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new Ka(e.toString(),n,null))}if(this._match(I.storage_texture_type)){const e=this._previous();this._consume(I.tokens.less_than,"Expected '<' for sampler type.");const n=this._consume(I.texel_format,"Invalid texel format.").toString();this._consume(I.tokens.comma,"Expected ',' after texel format.");const r=this._consume(I.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(I.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new Ka(e.toString(),n,r))}return null}_attribute(){let e=[];for(;this._match(I.tokens.attr);){const n=this._consume(I.attribute_name,"Expected attribute name"),r=this._updateNode(new WS(n.toString(),null));if(this._match(I.tokens.paren_left)){if(r.value=this._consume(I.literal_or_ident,"Expected attribute value").toString(),this._check(I.tokens.comma)){this._advance();do{const i=this._consume(I.literal_or_ident,"Expected attribute value").toString();r.value instanceof Array||(r.value=[r.value]),r.value.push(i)}while(this._match(I.tokens.comma))}this._consume(I.tokens.paren_right,"Expected ')'")}e.push(r)}return e.length==0?null:e}}class uj extends ir{constructor(e){super(),e&&this.update(e)}update(e){const n=new cj().parse(e);this.updateAST(n)}}function fj(t){const e={attributes:[],bindings:[]};let n;try{n=hj(t)}catch(s){return he.error(s.message)(),e}for(const s of n.uniforms){const o=[];for(const a of s.type?.members||[])o.push({name:a.name,type:zw(a.type)});e.bindings.push({type:"uniform",name:s.name,group:s.group,location:s.binding,members:o})}for(const s of n.textures)e.bindings.push({type:"texture",name:s.name,group:s.group,location:s.binding});for(const s of n.samplers)e.bindings.push({type:"sampler",name:s.name,group:s.group,location:s.binding});const r=n.entry.vertex[0],i=r?.inputs.length||0;for(let s=0;s<i;s++){const o=r.inputs[s];if(o.locationType==="location"){const a=zw(o.type);e.attributes.push({name:o.name,location:Number(o.location),type:a})}}return e}function zw(t){return t.format?`${t.name}<${t.format.name}>`:t.name}function hj(t){try{return new uj(t)}catch(e){if(e instanceof Error)throw e;let n="WGSL parse error";throw typeof e=="object"&&e?.message&&(n+=`: ${e.message} `),typeof e=="object"&&e?.token&&(n+=e.token.line||""),new Error(n,{cause:e})}}const dj={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...dj}};const xn=globalThis.mathgl.config;function pj(t,{precision:e=xn.precision}={}){return t=gj(t),`${parseFloat(t.toPrecision(e))}`}function ko(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function mi(t,e,n){return _j(t,r=>Math.max(e,Math.min(n,r)))}function Pf(t,e,n){return ko(t)?t.map((r,i)=>Pf(r,e[i],n)):n*e+(1-n)*t}function Al(t,e,n){const r=xn.EPSILON;try{if(t===e)return!0;if(ko(t)&&ko(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Al(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=xn.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{xn.EPSILON=r}}function gj(t){return Math.round(t/xn.EPSILON)*xn.EPSILON}function mj(t){return t.clone?t.clone():new Array(t.length)}function _j(t,e,n){if(ko(t)){const r=t;n=n||mj(r);for(let i=0;i<n.length&&i<r.length;++i){const s=typeof t=="number"?t:t[i];n[i]=e(s,i,n)}return n}return e(t)}class HS extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:ko(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(xn)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+pj(this[r],e);return`${e.printTypes?this.constructor.name:""}[${n}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Al(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i],o=typeof n=="number"?n:n[i];this[i]=s+r*(o-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(xn.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function yj(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function rn(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function Wp(t,e,n=""){if(xn.debug&&!yj(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}function Vw(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}class vj extends HS{get x(){return this[0]}set x(e){this[0]=rn(e)}get y(){return this[1]}set y(e){this[1]=rn(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return rn(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return rn(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Vw(e>=0&&e<this.ELEMENTS,"index is out of range"),rn(this[e])}setComponent(e,n){return Vw(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}const Vu=1e-6;let Po=typeof Float32Array<"u"?Float32Array:Array;function bj(){const t=new Po(2);return Po!=Float32Array&&(t[0]=0,t[1]=0),t}function $w(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function wj(t,e){return t[0]=-e[0],t[1]=-e[1],t}function XS(t,e,n,r){const i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function xj(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){const t=bj();return function(e,n,r,i,s,o){let a,u;for(n||(n=2),r||(r=0),i?u=Math.min(i*n+r,e.length):u=e.length,a=r;a<u;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function Tj(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function YS(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function Sj(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function Ej(){const t=new Po(3);return Po!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Aj(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Cj(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Rj(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ij(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],u=n[2];return t[0]=i*u-s*a,t[1]=s*o-r*u,t[2]=r*a-i*o,t}function qS(t,e,n){const r=e[0],i=e[1],s=e[2];let o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function kj(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function Pj(t,e,n){const r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],u=e[1],f=e[2];let h=i*f-s*u,p=s*a-r*f,g=r*u-i*a,_=i*g-s*p,v=s*h-r*g,w=r*p-i*h;const x=o*2;return h*=x,p*=x,g*=x,_*=2,v*=2,w*=2,t[0]=a+h+_,t[1]=u+p+v,t[2]=f+g+w,t}function Mj(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Nj(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Oj(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Dj(t,e){const n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt((n*n+r*r+i*i)*(s*s+o*o+a*a)),f=u&&Rj(t,e)/u;return Math.acos(Math.min(Math.max(f,-1),1))}const Fj=Aj;(function(){const t=Ej();return function(e,n,r,i,s,o){let a,u;for(n||(n=3),r||(r=0),i?u=Math.min(i*n+r,e.length):u=e.length,a=r;a<u;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const Hp=[0,0,0];let bu;class lr extends vj{static get ZERO(){return bu||(bu=new lr(0,0,0),Object.freeze(bu)),bu}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&ko(e)?this.copy(e):(xn.debug&&(rn(e),rn(n),rn(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return xn.debug&&(rn(e.x),rn(e.y),rn(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=rn(e)}angle(e){return Dj(this,e)}cross(e){return Ij(this,this,e),this.check()}rotateX({radians:e,origin:n=Hp}){return Mj(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Hp}){return Nj(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Hp}){return Oj(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return qS(this,this,e),this.check()}transformAsVector(e){return YS(this,this,e),this.check()}transformByMatrix3(e){return kj(this,this,e),this.check()}transformByMatrix2(e){return Sj(this,this,e),this.check()}transformByQuaternion(e){return Pj(this,this,e),this.check()}}class Lj extends HS{toString(){let e="[";if(xn.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+n]}`}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=` ${this[n]}`}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=rn(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function Bj(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Uj(t,e){if(t===e){const n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function pm(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],u=e[6],f=e[7],h=e[8],p=e[9],g=e[10],_=e[11],v=e[12],w=e[13],x=e[14],T=e[15],A=n*a-r*o,E=n*u-i*o,R=n*f-s*o,k=r*u-i*a,M=r*f-s*a,L=i*f-s*u,W=h*w-p*v,H=h*x-g*v,X=h*T-_*v,B=p*x-g*w,te=p*T-_*w,ie=g*T-_*x;let se=A*ie-E*te+R*B+k*X-M*H+L*W;return se?(se=1/se,t[0]=(a*ie-u*te+f*B)*se,t[1]=(i*te-r*ie-s*B)*se,t[2]=(w*L-x*M+T*k)*se,t[3]=(g*M-p*L-_*k)*se,t[4]=(u*X-o*ie-f*H)*se,t[5]=(n*ie-i*X+s*H)*se,t[6]=(x*R-v*L-T*E)*se,t[7]=(h*L-g*R+_*E)*se,t[8]=(o*te-a*X+f*W)*se,t[9]=(r*X-n*te-s*W)*se,t[10]=(v*M-w*R+T*A)*se,t[11]=(p*R-h*M-_*A)*se,t[12]=(a*H-o*B-u*W)*se,t[13]=(n*B-r*H+i*W)*se,t[14]=(w*E-v*k-x*A)*se,t[15]=(h*k-p*E+g*A)*se,t):null}function jj(t){const e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],u=t[7],f=t[8],h=t[9],p=t[10],g=t[11],_=t[12],v=t[13],w=t[14],x=t[15],T=e*o-n*s,A=e*a-r*s,E=n*a-r*o,R=f*v-h*_,k=f*w-p*_,M=h*w-p*v,L=e*M-n*k+r*R,W=s*M-o*k+a*R,H=f*E-h*A+p*T,X=_*E-v*A+w*T;return u*L-i*W+x*H-g*X}function es(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],u=e[5],f=e[6],h=e[7],p=e[8],g=e[9],_=e[10],v=e[11],w=e[12],x=e[13],T=e[14],A=e[15];let E=n[0],R=n[1],k=n[2],M=n[3];return t[0]=E*r+R*a+k*p+M*w,t[1]=E*i+R*u+k*g+M*x,t[2]=E*s+R*f+k*_+M*T,t[3]=E*o+R*h+k*v+M*A,E=n[4],R=n[5],k=n[6],M=n[7],t[4]=E*r+R*a+k*p+M*w,t[5]=E*i+R*u+k*g+M*x,t[6]=E*s+R*f+k*_+M*T,t[7]=E*o+R*h+k*v+M*A,E=n[8],R=n[9],k=n[10],M=n[11],t[8]=E*r+R*a+k*p+M*w,t[9]=E*i+R*u+k*g+M*x,t[10]=E*s+R*f+k*_+M*T,t[11]=E*o+R*h+k*v+M*A,E=n[12],R=n[13],k=n[14],M=n[15],t[12]=E*r+R*a+k*p+M*w,t[13]=E*i+R*u+k*g+M*x,t[14]=E*s+R*f+k*_+M*T,t[15]=E*o+R*h+k*v+M*A,t}function Mf(t,e,n){const r=n[0],i=n[1],s=n[2];let o,a,u,f,h,p,g,_,v,w,x,T;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],u=e[2],f=e[3],h=e[4],p=e[5],g=e[6],_=e[7],v=e[8],w=e[9],x=e[10],T=e[11],t[0]=o,t[1]=a,t[2]=u,t[3]=f,t[4]=h,t[5]=p,t[6]=g,t[7]=_,t[8]=v,t[9]=w,t[10]=x,t[11]=T,t[12]=o*r+h*i+v*s+e[12],t[13]=a*r+p*i+w*s+e[13],t[14]=u*r+g*i+x*s+e[14],t[15]=f*r+_*i+T*s+e[15]),t}function U_(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function zj(t,e,n,r){let i=r[0],s=r[1],o=r[2],a=Math.sqrt(i*i+s*s+o*o),u,f,h,p,g,_,v,w,x,T,A,E,R,k,M,L,W,H,X,B,te,ie,se,G;return a<Vu?null:(a=1/a,i*=a,s*=a,o*=a,f=Math.sin(n),u=Math.cos(n),h=1-u,p=e[0],g=e[1],_=e[2],v=e[3],w=e[4],x=e[5],T=e[6],A=e[7],E=e[8],R=e[9],k=e[10],M=e[11],L=i*i*h+u,W=s*i*h+o*f,H=o*i*h-s*f,X=i*s*h-o*f,B=s*s*h+u,te=o*s*h+i*f,ie=i*o*h+s*f,se=s*o*h-i*f,G=o*o*h+u,t[0]=p*L+w*W+E*H,t[1]=g*L+x*W+R*H,t[2]=_*L+T*W+k*H,t[3]=v*L+A*W+M*H,t[4]=p*X+w*B+E*te,t[5]=g*X+x*B+R*te,t[6]=_*X+T*B+k*te,t[7]=v*X+A*B+M*te,t[8]=p*ie+w*se+E*G,t[9]=g*ie+x*se+R*G,t[10]=_*ie+T*se+k*G,t[11]=v*ie+A*se+M*G,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function KS(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],u=e[7],f=e[8],h=e[9],p=e[10],g=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+f*r,t[5]=o*i+h*r,t[6]=a*i+p*r,t[7]=u*i+g*r,t[8]=f*i-s*r,t[9]=h*i-o*r,t[10]=p*i-a*r,t[11]=g*i-u*r,t}function Vj(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],u=e[3],f=e[8],h=e[9],p=e[10],g=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-f*r,t[1]=o*i-h*r,t[2]=a*i-p*r,t[3]=u*i-g*r,t[8]=s*r+f*i,t[9]=o*r+h*i,t[10]=a*r+p*i,t[11]=u*r+g*i,t}function ZS(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],u=e[3],f=e[4],h=e[5],p=e[6],g=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+f*r,t[1]=o*i+h*r,t[2]=a*i+p*r,t[3]=u*i+g*r,t[4]=f*i-s*r,t[5]=h*i-o*r,t[6]=p*i-a*r,t[7]=g*i-u*r,t}function $j(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,u=i+i,f=n*o,h=r*o,p=r*a,g=i*o,_=i*a,v=i*u,w=s*o,x=s*a,T=s*u;return t[0]=1-p-v,t[1]=h+T,t[2]=g-x,t[3]=0,t[4]=h-T,t[5]=1-f-v,t[6]=_+w,t[7]=0,t[8]=g+x,t[9]=_-w,t[10]=1-f-p,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Wj(t,e,n,r,i,s,o){const a=1/(n-e),u=1/(i-r),f=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*u,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*u,t[10]=(o+s)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*f,t[15]=0,t}function Hj(t,e,n,r,i){const s=1/Math.tan(e/2);if(t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){const o=1/(r-i);t[10]=(i+r)*o,t[14]=2*i*r*o}else t[10]=-1,t[14]=-2*r;return t}const Xj=Hj;function Yj(t,e,n,r,i,s,o){const a=1/(e-n),u=1/(r-i),f=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*u,t[14]=(o+s)*f,t[15]=1,t}const qj=Yj;function Kj(t,e,n,r){let i,s,o,a,u,f,h,p,g,_;const v=e[0],w=e[1],x=e[2],T=r[0],A=r[1],E=r[2],R=n[0],k=n[1],M=n[2];return Math.abs(v-R)<Vu&&Math.abs(w-k)<Vu&&Math.abs(x-M)<Vu?Bj(t):(p=v-R,g=w-k,_=x-M,i=1/Math.sqrt(p*p+g*g+_*_),p*=i,g*=i,_*=i,s=A*_-E*g,o=E*p-T*_,a=T*g-A*p,i=Math.sqrt(s*s+o*o+a*a),i?(i=1/i,s*=i,o*=i,a*=i):(s=0,o=0,a=0),u=g*a-_*o,f=_*s-p*a,h=p*o-g*s,i=Math.sqrt(u*u+f*f+h*h),i?(i=1/i,u*=i,f*=i,h*=i):(u=0,f=0,h=0),t[0]=s,t[1]=u,t[2]=p,t[3]=0,t[4]=o,t[5]=f,t[6]=g,t[7]=0,t[8]=a,t[9]=h,t[10]=_,t[11]=0,t[12]=-(s*v+o*w+a*x),t[13]=-(u*v+f*w+h*x),t[14]=-(p*v+g*w+_*x),t[15]=1,t)}function Zj(){const t=new Po(4);return Po!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Qj(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Vl(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}(function(){const t=Zj();return function(e,n,r,i,s,o){let a,u;for(n||(n=4),r||(r=0),i?u=Math.min(i*n+r,e.length):u=e.length,a=r;a<u;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var gm;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(gm||(gm={}));const Jj=45*Math.PI/180,Gj=1,Xp=.1,Yp=500,e9=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class cr extends Lj{static get IDENTITY(){return n9()}static get ZERO(){return t9()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return gm}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,u,f,h,p,g,_,v,w,x){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=u,this[8]=f,this[9]=h,this[10]=p,this[11]=g,this[12]=_,this[13]=v,this[14]=w,this[15]=x,this.check()}setRowMajor(e,n,r,i,s,o,a,u,f,h,p,g,_,v,w,x){return this[0]=e,this[1]=s,this[2]=f,this[3]=_,this[4]=n,this[5]=o,this[6]=h,this[7]=v,this[8]=r,this[9]=a,this[10]=p,this[11]=w,this[12]=i,this[13]=u,this[14]=g,this[15]=x,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(e9)}fromObject(e){return this.check()}fromQuaternion(e){return $j(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=Xp,far:a=Yp}=e;return a===1/0?r9(this,n,r,i,s,o):Wj(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return Kj(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=Xp,far:a=Yp}=e;return qj(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=Jj,aspect:r=Gj,focalDistance:i=1,near:s=Xp,far:o=Yp}=e;Ww(n);const a=n/2,u=i*Math.tan(a),f=u*r;return this.ortho({left:-f,right:f,bottom:-u,top:u,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return Ww(n),Xj(this,n,r,i,s),this.check()}determinant(){return jj(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return Uj(this,this),this.check()}invert(){return pm(this,this),this.check()}multiplyLeft(e){return es(this,e,this),this.check()}multiplyRight(e){return es(this,this,e),this.check()}rotateX(e){return KS(this,this,e),this.check()}rotateY(e){return Vj(this,this,e),this.check()}rotateZ(e){return ZS(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return zj(this,this,e,n),this.check()}scale(e){return U_(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Mf(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Vl(n||[-0,-0,-0,-0],e,this),Wp(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=xj(n||[-0,-0],e,this);break;case 3:i=qS(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Wp(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=Tj(n||[-0,-0],e,this);break;case 3:r=YS(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Wp(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let wu,xu;function t9(){return wu||(wu=new cr([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(wu)),wu}function n9(){return xu||(xu=new cr,Object.freeze(xu)),xu}function Ww(t){if(t>Math.PI*2)throw Error("expected radians")}function r9(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),u=(n+e)/(n-e),f=(i+r)/(i-r),h=-1,p=-1,g=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=u,t[9]=f,t[10]=h,t[11]=p,t[12]=0,t[13]=0,t[14]=g,t[15]=0,t}function QS(t,e=[],n=0){const r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}function i9(t){return t-Math.fround(t)}function s9(t){const e=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=n*4+r;QS(t[r*4+n],e,i*2)}return e}const o9=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,a9={name:"fp32",vs:o9},l9=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,c9={ONE:1},u9={name:"fp64arithmetic",vs:l9,defaultUniforms:c9,uniformTypes:{ONE:"f32"},fp64ify:QS,fp64LowPart:i9,fp64ifyMatrix4:s9},f9=[0,1,1,1],h9=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,d9=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,Hw={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:f9},vs:h9,fs:d9,getUniforms:p9};function p9(t={},e){const n={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)n.isHighlightActive=!1;else{n.isHighlightActive=!0;const r=t.highlightedObjectColor.slice(0,3);n.highlightedObjectColor=r}if(t.highlightColor){const r=Array.from(t.highlightColor,i=>i/255);Number.isFinite(r[3])||(r[3]=1),n.highlightColor=r}return t.isActive!==void 0&&(n.isActive=!!t.isActive,n.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(n.useFloatColors=!!t.useFloatColors),n}const Xw=`precision highp int;

// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  vec3 color;
};

struct PointLight {
  vec3 color;
  vec3 position;
  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform lightingUniforms {
  int enabled;
  int lightType;

  int directionalLightCount;
  int pointLightCount;

  vec3 ambientColor;

  vec3 lightColor0;
  vec3 lightPosition0;
  vec3 lightDirection0;
  vec3 lightAttenuation0;

  vec3 lightColor1;
  vec3 lightPosition1;
  vec3 lightDirection1;
  vec3 lightAttenuation1;

  vec3 lightColor2;
  vec3 lightPosition2;
  vec3 lightDirection2;
  vec3 lightAttenuation2;
} lighting;

PointLight lighting_getPointLight(int index) {
  switch (index) {
    case 0:
      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);
    case 1:
      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);
    case 2:
    default:  
      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);
  }
}

DirectionalLight lighting_getDirectionalLight(int index) {
  switch (index) {
    case 0:
      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);
    case 1:
      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);
    case 2:
    default:   
      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);
  }
} 

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

// #endif
`,g9=`// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  color: vec3<f32>,
};

struct PointLight {
  color: vec3<f32>,
  position: vec3<f32>,
  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  color: vec3<f32>,
  direction: vec3<f32>,
};

struct lightingUniforms {
  enabled: i32,
  pointLightCount: i32,
  directionalLightCount: i32,

  ambientColor: vec3<f32>,

  // TODO - support multiple lights by uncommenting arrays below
  lightType: i32,
  lightColor: vec3<f32>,
  lightDirection: vec3<f32>,
  lightPosition: vec3<f32>,
  lightAttenuation: vec3<f32>,

  // AmbientLight ambientLight;
  // PointLight pointLight[MAX_LIGHTS];
  // DirectionalLight directionalLight[MAX_LIGHTS];
};

// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)
@binding(1) @group(0) var<uniform> lighting : lightingUniforms;

fn lighting_getPointLight(index: i32) -> PointLight {
  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);
}

fn lighting_getDirectionalLight(index: i32) -> DirectionalLight {
  return DirectionalLight(lighting.lightColor, lighting.lightDirection);
} 

fn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}
`,JS=3,m9=255;var Cl;(function(t){t[t.POINT=0]="POINT",t[t.DIRECTIONAL=1]="DIRECTIONAL"})(Cl||(Cl={}));const cl={props:{},uniforms:{},name:"lighting",defines:{MAX_LIGHTS:JS},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientLightColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:Cl.POINT,directionalLightCount:0,pointLightCount:0,ambientLightColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:g9,vs:Xw,fs:Xw,getUniforms:_9};function _9(t,e={}){if(t=t&&{...t},!t)return{...cl.defaultUniforms};t.lights&&(t={...t,...v9(t.lights),lights:void 0});const{ambientLight:n,pointLights:r,directionalLights:i}=t||{};if(!(n||r&&r.length>0||i&&i.length>0))return{...cl.defaultUniforms,enabled:0};const o={...cl.defaultUniforms,...e,...y9({ambientLight:n,pointLights:r,directionalLights:i})};return t.enabled!==void 0&&(o.enabled=t.enabled?1:0),o}function y9({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){const r={};r.ambientLightColor=qp(t);let i=0;for(const s of e){r.lightType=Cl.POINT;const o=i;r[`lightColor${o}`]=qp(s),r[`lightPosition${o}`]=s.position,r[`lightAttenuation${o}`]=s.attenuation||[1,0,0],i++}for(const s of n){r.lightType=Cl.DIRECTIONAL;const o=i;r[`lightColor${o}`]=qp(s),r[`lightDirection${o}`]=s.direction,i++}return i>JS&&he.warn("MAX_LIGHTS exceeded")(),r.directionalLightCount=n.length,r.pointLightCount=e.length,r}function v9(t){const e={pointLights:[],directionalLights:[]};for(const n of t||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights?.push(n);break;case"point":e.pointLights?.push(n);break}return e}function qp(t={}){const{color:e=[0,0,0],intensity:n=1}=t;return e.map(r=>r*n/m9)}const GS=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;
`,eE=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
  vec3 halfway_direction = normalize(light_direction + view_direction);
  float lambertian = dot(light_direction, normal_worldspace);
  float specular = 0.0;
  if (lambertian > 0.0) {
    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  vec3 view_direction = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  for (int i = 0; i < lighting.pointLightCount; i++) {
    PointLight pointLight = lighting_getPointLight(i);
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);
  }

  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);
  for (int i = lighting.pointLightCount; i < totalLights; i++) {
    DirectionalLight directionalLight = lighting_getDirectionalLight(i);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
}
`,tE=`struct phongMaterialUniforms {
  ambient: f32,
  diffuse: f32,
  shininess: f32,
  specularColor: vec3<f32>,
};

@binding(2) @group(0) var<uniform> phongMaterial : phongMaterialUniforms;

fn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {
  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);
  var lambertian: f32 = dot(light_direction, normal_worldspace);
  var specular: f32 = 0.0;
  if (lambertian > 0.0) {
    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, phongMaterial.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * phongMaterial.diffuse * surfaceColor + specular * phongMaterial.specularColor) * color;
}

fn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {
  var lightColor: vec3<f32> = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);
  lightColor = phongMaterial.ambient * surfaceColor * lighting.ambientColor;

  if (lighting.lightType == 0) {
    let pointLight: PointLight  = lighting_getPointLight(0);
    let light_position_worldspace: vec3<f32> = pointLight.position;
    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  } else if (lighting.lightType == 1) {
    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
  /*
  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.pointLightCount) {
      break;
    }
    PointLight pointLight = lighting.pointLight[i];
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  }

  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.directionalLightCount) {
      break;
    }
    DirectionalLight directionalLight = lighting.directionalLight[i];
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  */
}

fn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{
  var lightColor = vec3<f32>(0, 0, 0);
  let surfaceColor = vec3<f32>(0, 0, 0);

  if (lighting.enabled == 0) {
    let view_direction = normalize(cameraPosition - position_worldspace);

    switch (lighting.lightType) {
      case 0, default: {
        let pointLight: PointLight = lighting_getPointLight(0);
        let light_position_worldspace: vec3<f32> = pointLight.position;
        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
      }
      case 1: {
        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
      }
    }
  }
  return lightColor;
}
`,nE={props:{},name:"gouraudMaterial",vs:eE.replace("phongMaterial","gouraudMaterial"),fs:GS.replace("phongMaterial","gouraudMaterial"),source:tE.replaceAll("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:1},dependencies:[cl],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){const e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(n=>n/255)),{...nE.defaultUniforms,...e}}},rE={name:"phongMaterial",dependencies:[cl],source:tE,vs:GS,fs:eE,defines:{LIGHTING_FRAGMENT:1},uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(t){const e={...t};return e.specularColor&&(e.specularColor=e.specularColor.map(n=>n/255)),{...rE.defaultUniforms,...e}}},Yw=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,b9={name:"layer",vs:Yw,fs:Yw,getUniforms:t=>({opacity:Math.pow(t.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},w9=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,iE="#define SMOOTH_EDGE_RADIUS 0.5",x9=`${iE}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,T9=`${iE}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,sE={name:"geometry",source:w9,vs:x9,fs:T9},S9=25;var mt;(function(t){t[t.Start=1]="Start",t[t.Move=2]="Move",t[t.End=4]="End",t[t.Cancel=8]="Cancel"})(mt||(mt={}));var bt;(function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.Up=4]="Up",t[t.Down=8]="Down",t[t.Horizontal=3]="Horizontal",t[t.Vertical=12]="Vertical",t[t.All=15]="All"})(bt||(bt={}));var Pe;(function(t){t[t.Possible=1]="Possible",t[t.Began=2]="Began",t[t.Changed=4]="Changed",t[t.Ended=8]="Ended",t[t.Recognized=8]="Recognized",t[t.Cancelled=16]="Cancelled",t[t.Failed=32]="Failed"})(Pe||(Pe={}));const E9="compute",A9="auto",mm="manipulation",$u="none",_m="pan-x",ym="pan-y";function C9(t){if(t.includes($u))return $u;const e=t.includes(_m),n=t.includes(ym);return e&&n?$u:e||n?e?_m:ym:t.includes(mm)?mm:A9}class R9{constructor(e,n){this.actions="",this.manager=e,this.set(n)}set(e){e===E9&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const n of this.manager.recognizers)n.options.enable&&(e=e.concat(n.getTouchAction()));return C9(e.join(" "))}}function Nf(t){return t.trim().split(/\s+/g)}function Kp(t,e,n){if(t)for(const r of Nf(e))t.addEventListener(r,n,!1)}function Zp(t,e,n){if(t)for(const r of Nf(e))t.removeEventListener(r,n,!1)}function qw(t){return(t.ownerDocument||t).defaultView}function I9(t,e){let n=t;for(;n;){if(n===e)return!0;n=n.parentNode}return!1}function oE(t){const e=t.length;if(e===1)return{x:Math.round(t[0].clientX),y:Math.round(t[0].clientY)};let n=0,r=0,i=0;for(;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:Math.round(n/e),y:Math.round(r/e)}}function Kw(t){const e=[];let n=0;for(;n<t.pointers.length;)e[n]={clientX:Math.round(t.pointers[n].clientX),clientY:Math.round(t.pointers[n].clientY)},n++;return{timeStamp:Date.now(),pointers:e,center:oE(e),deltaX:t.deltaX,deltaY:t.deltaY}}function aE(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function Zw(t,e){const n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.sqrt(n*n+r*r)}function k9(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.atan2(r,n)*180/Math.PI}function Qw(t,e){const n=e.clientX-t.clientX,r=e.clientY-t.clientY;return Math.atan2(r,n)*180/Math.PI}function lE(t,e){return t===e?bt.None:Math.abs(t)>=Math.abs(e)?t<0?bt.Left:bt.Right:e<0?bt.Up:bt.Down}function P9(t,e){const n=e.center;let r=t.offsetDelta,i=t.prevDelta;const s=t.prevInput;return(e.eventType===mt.Start||s?.eventType===mt.End)&&(i=t.prevDelta={x:s?.deltaX||0,y:s?.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),{deltaX:i.x+(n.x-r.x),deltaY:i.y+(n.y-r.y)}}function cE(t,e,n){return{x:e/t||0,y:n/t||0}}function M9(t,e){return Zw(e[0],e[1])/Zw(t[0],t[1])}function N9(t,e){return Qw(e[1],e[0])-Qw(t[1],t[0])}function O9(t,e){const n=t.lastInterval||e,r=e.timeStamp-n.timeStamp;let i,s,o,a;if(e.eventType!==mt.Cancel&&(r>S9||n.velocity===void 0)){const u=e.deltaX-n.deltaX,f=e.deltaY-n.deltaY,h=cE(r,u,f);s=h.x,o=h.y,i=Math.abs(h.x)>Math.abs(h.y)?h.x:h.y,a=lE(u,f),t.lastInterval=e}else i=n.velocity,s=n.velocityX,o=n.velocityY,a=n.direction;e.velocity=i,e.velocityX=s,e.velocityY=o,e.direction=a}function D9(t,e){const{session:n}=t,{pointers:r}=e,{length:i}=r;n.firstInput||(n.firstInput=Kw(e)),i>1&&!n.firstMultiple?n.firstMultiple=Kw(e):i===1&&(n.firstMultiple=!1);const{firstInput:s,firstMultiple:o}=n,a=o?o.center:s.center,u=e.center=oE(r);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=k9(a,u),e.distance=aE(a,u);const{deltaX:f,deltaY:h}=P9(n,e);e.deltaX=f,e.deltaY=h,e.offsetDirection=lE(e.deltaX,e.deltaY);const p=cE(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=p.x,e.overallVelocityY=p.y,e.overallVelocity=Math.abs(p.x)>Math.abs(p.y)?p.x:p.y,e.scale=o?M9(o.pointers,r):1,e.rotation=o?N9(o.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length;let g=t.element;return I9(e.srcEvent.target,g)&&(g=e.srcEvent.target),e.target=g,O9(n,e),e}function F9(t,e,n){const r=n.pointers.length,i=n.changedPointers.length,s=e&mt.Start&&r-i===0,o=e&(mt.End|mt.Cancel)&&r-i===0;n.isFirst=!!s,n.isFinal=!!o,s&&(t.session={}),n.eventType=e;const a=D9(t,n);t.emit("hammer.input",a),t.recognize(a),t.session.prevInput=a}let L9=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=n=>{this.manager.options.enable&&this.handler(n)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,n){F9(this.manager,e,n)}init(){Kp(this.element,this.evEl,this.domHandler),Kp(this.target,this.evTarget,this.domHandler),Kp(qw(this.element),this.evWin,this.domHandler)}destroy(){Zp(this.element,this.evEl,this.domHandler),Zp(this.target,this.evTarget,this.domHandler),Zp(qw(this.element),this.evWin,this.domHandler)}};const B9={pointerdown:mt.Start,pointermove:mt.Move,pointerup:mt.End,pointercancel:mt.Cancel,pointerout:mt.Cancel},U9="pointerdown",j9="pointermove pointerup pointercancel";class z9 extends L9{constructor(e){super(e),this.evEl=U9,this.evWin=j9,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:n}=this;let r=!1;const i=B9[e.type],s=e.pointerType,o=s==="touch";let a=n.findIndex(u=>u.pointerId===e.pointerId);i&mt.Start&&(e.buttons||o)?a<0&&(n.push(e),a=n.length-1):i&(mt.End|mt.Cancel)&&(r=!0),!(a<0)&&(n[a]=e,this.callback(i,{pointers:n,changedPointers:[e],eventType:i,pointerType:s,srcEvent:e}),r&&n.splice(a,1))}}const V9=["","webkit","Moz","MS","ms","o"];function $9(t,e){const n=e[0].toUpperCase()+e.slice(1);for(const r of V9){const i=r?r+n:e;if(i in t)return i}}const W9=1,Jw=2,Gw={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class H9{constructor(e,n){this.options={...Gw,...n,cssProps:{...Gw.cssProps,...n.cssProps},inputTarget:n.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new z9(this),this.touchAction=new R9(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?Jw:W9}recognize(e){const{session:n}=this;if(n.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let r;const{recognizers:i}=this;let{curRecognizer:s}=n;(!s||s&&s.state&Pe.Recognized)&&(s=n.curRecognizer=null);let o=0;for(;o<i.length;)r=i[o],n.stopped!==Jw&&(!s||r===s||r.canRecognizeWith(s))?r.recognize(e):r.reset(),!s&&r.state&(Pe.Began|Pe.Changed|Pe.Ended)&&(s=n.curRecognizer=r),o++}get(e){const{recognizers:n}=this;for(let r=0;r<n.length;r++)if(n[r].options.event===e)return n[r];return null}add(e){if(Array.isArray(e)){for(const r of e)this.add(r);return this}const n=this.get(e.options.event);return n&&this.remove(n),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const r of e)this.remove(r);return this}const n=typeof e=="string"?this.get(e):e;if(n){const{recognizers:r}=this,i=r.indexOf(n);i!==-1&&(r.splice(i,1),this.touchAction.update())}return this}on(e,n){if(!e||!n)return;const{handlers:r}=this;for(const i of Nf(e))r[i]=r[i]||[],r[i].push(n)}off(e,n){if(!e)return;const{handlers:r}=this;for(const i of Nf(e))n?r[i]&&r[i].splice(r[i].indexOf(n),1):delete r[i]}emit(e,n){const r=this.handlers[e]&&this.handlers[e].slice();if(!r||!r.length)return;const i=n;i.type=e,i.preventDefault=function(){n.srcEvent.preventDefault()};let s=0;for(;s<r.length;)r[s](i),s++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:n}=this;if(n){for(const[r,i]of Object.entries(this.options.cssProps)){const s=$9(n.style,r);e?(this.oldCssProps[s]=n.style[s],n.style[s]=i):n.style[s]=this.oldCssProps[s]||""}e||(this.oldCssProps={})}}}let X9=1;function Y9(){return X9++}function ex(t){return t&Pe.Cancelled?"cancel":t&Pe.Ended?"end":t&Pe.Changed?"move":t&Pe.Began?"start":""}class uE{constructor(e){this.options=e,this.id=Y9(),this.state=Pe.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const i of e)this.recognizeWith(i);return this}let n;if(typeof e=="string"){if(n=this.manager.get(e),!n)throw new Error(`Cannot find recognizer ${e}`)}else n=e;const{simultaneous:r}=this;return r[n.id]||(r[n.id]=n,n.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const r of e)this.dropRecognizeWith(r);return this}let n;return typeof e=="string"?n=this.manager.get(e):n=e,n&&delete this.simultaneous[n.id],this}requireFailure(e){if(Array.isArray(e)){for(const i of e)this.requireFailure(i);return this}let n;if(typeof e=="string"){if(n=this.manager.get(e),!n)throw new Error(`Cannot find recognizer ${e}`)}else n=e;const{requireFail:r}=this;return r.indexOf(n)===-1&&(r.push(n),n.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const r of e)this.dropRequireFailure(r);return this}let n;if(typeof e=="string"?n=this.manager.get(e):n=e,n){const r=this.requireFail.indexOf(n);r>-1&&this.requireFail.splice(r,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;const{state:n}=this;n<Pe.Ended&&this.manager.emit(this.options.event+ex(n),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),n>=Pe.Ended&&this.manager.emit(this.options.event+ex(n),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Pe.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Pe.Failed|Pe.Possible)))return!1;e++}return!0}recognize(e){const n={...e};if(!this.options.enable){this.reset(),this.state=Pe.Failed;return}this.state&(Pe.Recognized|Pe.Cancelled|Pe.Failed)&&(this.state=Pe.Possible),this.state=this.process(n),this.state&(Pe.Began|Pe.Changed|Pe.Ended|Pe.Cancelled)&&this.tryEmit(n)}getEventNames(){return[this.options.event]}reset(){}}class fE extends uE{attrTest(e){const n=this.options.pointers;return n===0||e.pointers.length===n}process(e){const{state:n}=this,{eventType:r}=e,i=n&(Pe.Began|Pe.Changed),s=this.attrTest(e);return i&&(r&mt.Cancel||!s)?n|Pe.Cancelled:i||s?r&mt.End?n|Pe.Ended:n&Pe.Began?n|Pe.Changed:Pe.Began:Pe.Failed}}class tx extends uE{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[mm]}process(e){const{options:n}=this,r=e.pointers.length===n.pointers,i=e.distance<n.threshold,s=e.deltaTime<n.time;if(this.reset(),e.eventType&mt.Start&&this.count===0)return this.failTimeout();if(i&&s&&r){if(e.eventType!==mt.End)return this.failTimeout();const o=this.pTime?e.timeStamp-this.pTime<n.interval:!0,a=!this.pCenter||aE(this.pCenter,e.center)<n.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!a||!o?this.count=1:this.count+=1,this._input=e,this.count%n.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Pe.Recognized,this.tryEmit(this._input)},n.interval),Pe.Began):Pe.Recognized}return Pe.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Pe.Failed},this.options.interval),Pe.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Pe.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const q9=["","start","move","end","cancel","up","down","left","right"];class nx extends fE{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:bt.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,n=[];return e&bt.Horizontal&&n.push(ym),e&bt.Vertical&&n.push(_m),n}getEventNames(){return q9.map(e=>this.options.event+e)}directionTest(e){const{options:n}=this;let r=!0,{distance:i}=e,{direction:s}=e;const o=e.deltaX,a=e.deltaY;return s&n.direction||(n.direction&bt.Horizontal?(s=o===0?bt.None:o<0?bt.Left:bt.Right,r=o!==this.pX,i=Math.abs(e.deltaX)):(s=a===0?bt.None:a<0?bt.Up:bt.Down,r=a!==this.pY,i=Math.abs(e.deltaY))),e.direction=s,r&&i>n.threshold&&!!(s&n.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&Pe.Began)||!(this.state&Pe.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const n=bt[e.direction].toLowerCase();n&&(e.additionalEvent=this.options.event+n),super.emit(e)}}const K9=["","start","move","end","cancel","in","out"];class Z9 extends fE{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[$u]}getEventNames(){return K9.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&Pe.Began))}emit(e){if(e.scale!==1){const n=e.scale<1?"in":"out";e.additionalEvent=this.options.event+n}super.emit(e)}}class ch{constructor(e,n,r){this.element=e,this.callback=n,this.options=r}}const Q9=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",J9=Q9.indexOf("firefox")!==-1,rx=4.000244140625,G9=40,e7=.25;class t7 extends ch{constructor(e,n,r){super(e,n,{enable:!0,...r}),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;globalThis.WheelEvent&&(J9&&i.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(s/=globalThis.devicePixelRatio),i.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(s*=G9)),s!==0&&s%rx===0&&(s=Math.floor(s/rx)),i.shiftKey&&s&&(s=s*e7),this.callback({type:"wheel",center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,n){e==="wheel"&&(this.options.enable=n)}}const ix=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class n7 extends ch{constructor(e,n,r){super(e,n,{enable:!0,...r}),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,ix.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){ix.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){switch(e){case"pointermove":this.enableMoveEvent=n;break;case"pointerover":this.enableOverEvent=n;break;case"pointerout":this.enableOutEvent=n;break;case"pointerenter":this.enableEnterEvent=n;break;case"pointerleave":this.enableLeaveEvent=n;break}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const sx=["keydown","keyup"];class r7 extends ch{constructor(e,n,r){super(e,n,{enable:!0,tabIndex:0,...r}),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:"keydown",srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:"keyup",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",sx.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){sx.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e==="keydown"&&(this.enableDownEvent=n),e==="keyup"&&(this.enableUpEvent=n)}}class i7 extends ch{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e==="contextmenu"&&(this.options.enable=n)}}const ox=1,vm=2,ax=4,s7={pointerdown:ox,pointermove:vm,pointerup:ax,mousedown:ox,mousemove:vm,mouseup:ax},o7=0,a7=1,l7=2,c7=1,u7=2,f7=4;function h7(t){const e=s7[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r}=t.srcEvent;let i=!1,s=!1,o=!1;return e===vm?(i=!!(n&c7),s=!!(n&f7),o=!!(n&u7)):(i=r===o7,s=r===a7,o=r===l7),{leftButton:i,middleButton:s,rightButton:o}}function d7(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const p7={srcElement:"root",priority:0};class g7{constructor(e,n){this.handleEvent=r=>{if(this.isEmpty())return;const i=this._normalizeEvent(r);let s=r.srcEvent.target;for(;s&&s!==i.rootElement;){if(this._emit(i,s),i.handled)return;s=s.parentNode}this._emit(i,"root")},this.eventManager=e,this.recognizerName=n,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this,u={...p7,...r};let f=a.get(u.srcElement);f||(f=[],a.set(u.srcElement,f));const h={type:e,handler:n,srcElement:u.srcElement,priority:u.priority};i&&(h.once=!0),s&&(h.passive=!0),o.push(h),this._active=this._active||!h.passive;let p=f.length-1;for(;p>=0&&!(f[p].priority>=h.priority);)p--;f.splice(p+1,0,h)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let u=0;u<r.length;u++){const{type:f,handler:h,once:p}=r[u];if(h({...e,type:f,stopPropagation:s,stopImmediatePropagation:o}),p&&a.push(r[u]),i)break}for(let u=0;u<a.length;u++){const{type:f,handler:h}=a[u];this.remove(f,h)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...h7(e),...d7(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}function m7(t){if("recognizer"in t)return t;let e;const n=Array.isArray(t)?[...t]:[t];if(typeof n[0]=="function"){const r=n.shift(),i=n.shift()||{};e=new r(i)}else e=n.shift();return{recognizer:e,recognizeWith:typeof n[0]=="string"?[n[0]]:n[0],requireFailure:typeof n[1]=="string"?[n[1]]:n[1]}}class _7{constructor(e=null,n={}){if(this._onBasicInput=r=>{this.manager.emit(r.srcEvent.type,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...n},this.events=new Map,this.element=e,!!e){this.manager=new H9(e,this.options);for(const r of this.options.recognizers){const{recognizer:i,recognizeWith:s,requireFailure:o}=m7(r);this.manager.add(i),s&&i.recognizeWith(s),o&&i.requireFailure(o)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new t7(e,this._onOtherEvent,{enable:!1}),this.moveInput=new n7(e,this._onOtherEvent,{enable:!1}),this.keyInput=new r7(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new i7(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);i&&(i.set({enable:n}),r.touchAction.update()),this.wheelInput?.enableEventType(e,n),this.moveInput?.enableEventType(e,n),this.keyInput?.enableEventType(e,n),this.contextmenuInput?.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const[f,h]of Object.entries(e))this._addEventHandler(f,h,r,i,s);return}const{manager:o,events:a}=this;if(!o)return;let u=a.get(e);if(!u){const f=this._getRecognizerName(e)||e;u=new g7(this,f),a.set(e,u),o&&o.on(e,u.handleEvent)}u.add(e,n,r,i,s),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const[s,o]of Object.entries(e))this._removeEventHandler(s,o);return}const{events:r}=this,i=r.get(e);if(i&&(i.remove(e,n),i.isEmpty())){const{recognizerName:s}=i;let o=!1;for(const a of r.values())if(a.recognizerName===s&&!a.isEmpty()){o=!0;break}o||this._toggleRecognizer(s,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(n=>n.getEventNames().includes(e))?.options.event}}const Fe={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Fe,"IDENTITY",{get:()=>(Ve.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const vn={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Mo={common:0,meters:1,pixels:2},bm={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},lx={multipan:[nx,{threshold:10,direction:bt.Vertical,pointers:2}],pinch:[Z9,{},null,["multipan"]],pan:[nx,{threshold:1},["pinch"],["multipan"]],dblclick:[tx,{event:"dblclick",taps:2}],click:[tx,{event:"click"},null,["dblclick"]]};function y7(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function $l(t){let e={},n;return r=>{for(const i in r)if(!y7(r[i],e[i])){n=t(r),e=r;break}return n}}const cx=[0,0,0,0],v7=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],hE=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b7=[0,0,0],dE=[0,0,0],w7=$l(S7);function pE(t,e,n=dE){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===Fe.LNGLAT_OFFSETS||e===Fe.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case vn.WEB_MERCATOR:(e===Fe.LNGLAT||e===Fe.CARTESIAN)&&(i=[0,0,0],s=!1);break;case vn.WEB_MERCATOR_AUTO_OFFSET:e===Fe.LNGLAT?r=i:e===Fe.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case vn.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case vn.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function x7(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=cx,u=cx,f=t.cameraPosition;const{geospatialOrigin:h,shaderCoordinateOrigin:p,offsetMode:g}=pE(t,e,n);return g&&(u=t.projectPosition(h||p),f=[f[0]-u[0],f[1]-u[1],f[2]-u[2]],u[3]=1,a=Vl([],u,o),s=r||s,o=es([],i,s),o=es([],o,v7)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:u,cameraPosCommon:f,shaderCoordinateOrigin:p,geospatialOrigin:h}}function T7({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Fe.DEFAULT,coordinateOrigin:i=dE,autoWrapLongitude:s=!1}){r===Fe.DEFAULT&&(r=t.isGeospatial?Fe.LNGLAT:Fe.CARTESIAN);const o=w7({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.wrapLongitude=s,o.modelMatrix=n||hE,o}function S7({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:u,geospatialOrigin:f}=x7(t,n,r),h=t.getDistanceScales(),p=[t.width*e,t.height*e],g=Vl([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,_={coordinateSystem:n,projectionMode:t.projectionMode,coordinateOrigin:u,commonOrigin:o.slice(0,3),center:i,pseudoMeters:!!t._pseudoMeters,viewportSize:p,devicePixelRatio:e,focalDistance:g,commonUnitsPerMeter:h.unitsPerMeter,commonUnitsPerWorldUnit:h.unitsPerMeter,commonUnitsPerWorldUnit2:b7,scale:t.scale,wrapLongitude:!1,viewProjectionMatrix:s,modelMatrix:hE,cameraPosition:a};if(f){const v=t.getDistanceScales(f);switch(n){case Fe.METER_OFFSETS:_.commonUnitsPerWorldUnit=v.unitsPerMeter,_.commonUnitsPerWorldUnit2=v.unitsPerMeter2;break;case Fe.LNGLAT:case Fe.LNGLAT_OFFSETS:t._pseudoMeters||(_.commonUnitsPerMeter=v.unitsPerMeter),_.commonUnitsPerWorldUnit=v.unitsPerDegree,_.commonUnitsPerWorldUnit2=v.unitsPerDegree2;break;case Fe.CARTESIAN:_.commonUnitsPerWorldUnit=[1,1,v.unitsPerMeter[2]],_.commonUnitsPerWorldUnit2=[0,0,v.unitsPerMeter2[2]];break}}return _}const E7=Object.keys(Fe).map(t=>`const COORDINATE_SYSTEM_${t}: i32 = ${Fe[t]};`).join(""),A7=Object.keys(vn).map(t=>`const PROJECTION_MODE_${t}: i32 = ${vn[t]};`).join(""),C7=Object.keys(Mo).map(t=>`const UNIT_${t.toUpperCase()}: i32 = ${Mo[t]};`).join(""),R7=`${E7}
${A7}
${C7}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,I7=`${R7}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the z‑axis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`,k7=Object.keys(Fe).map(t=>`const int COORDINATE_SYSTEM_${t} = ${Fe[t]};`).join(""),P7=Object.keys(vn).map(t=>`const int PROJECTION_MODE_${t} = ${vn[t]};`).join(""),M7=Object.keys(Mo).map(t=>`const int UNIT_${t.toUpperCase()} = ${Mo[t]};`).join(""),N7=`${k7}
${P7}
${M7}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`,O7={};function D7(t=O7){return"viewport"in t?T7(t):{}}const j_={name:"project",dependencies:[a9,sE],source:I7,vs:N7,getUniforms:D7,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},F7=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,L7=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,uh={name:"project32",dependencies:[j_],source:F7,vs:L7};function B7(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function _o(t,e){const n=Vl([],e,t);return Qj(n,n,1/n[3]),n}function ux(t,e){const n=t%e;return n<0?e+n:n}function wm(t,e,n){return t<e?e:t>n?n:t}function U7(t){return Math.log(t)*Math.LOG2E}const z_=Math.log2||U7;function Fr(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Bn=Math.PI,gE=Bn/4,Tn=Bn/180,xm=180/Bn,No=512,Of=4003e4,Tu=85.051129,j7=1.5;function z7(t){return z_(t)}function Df(t){const[e,n]=t;Fr(Number.isFinite(e)),Fr(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Tn,i=n*Tn,s=No*(r+Bn)/(2*Bn),o=No*(Bn+Math.log(Math.tan(gE+i*.5)))/(2*Bn);return[s,o]}function Oo(t){const[e,n]=t,r=e/No*(2*Bn)-Bn,i=2*(Math.atan(Math.exp(n/No*(2*Bn)-Bn))-gE);return[r*xm,i*xm]}function V7(t){const{latitude:e}=t;Fr(Number.isFinite(e));const n=Math.cos(e*Tn);return z7(Of*n)-9}function Qp(t){const e=Math.cos(t*Tn);return No/Of/e}function Tm(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;Fr(Number.isFinite(e)&&Number.isFinite(n));const i=No,s=Math.cos(e*Tn),o=i/360,a=o/s,u=i/Of/s,f={unitsPerMeter:[u,u,u],metersPerUnit:[1/u,1/u,1/u],unitsPerDegree:[o,a,u],degreesPerUnit:[1/o,1/a,1/u]};if(r){const h=Tn*Math.tan(e*Tn)/s,p=o*h/2,g=i/Of*h,_=g/a*u;f.unitsPerDegree2=[0,p,g],f.unitsPerMeter2=[_,0,_]}return f}function mE(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:u,unitsPerMeter2:f}=Tm({longitude:n,latitude:r,highPrecision:!0}),h=Df(t);h[0]+=s*(u[0]+f[0]*o),h[1]+=o*(u[1]+f[1]*o);const p=Oo(h),g=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[p[0],p[1],g]:p}function $7(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=B7();Mf(a,a,[0,0,-i]),KS(a,a,-n*Tn),ZS(a,a,r*Tn);const u=s/e;return U_(a,a,[u,u,u]),o&&Mf(a,a,Cj([],o)),a}function W7(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:u=1,farZMultiplier:f=1}=t;let{fovy:h=Ff(j7)}=t;r!==void 0&&(h=Ff(r));const p=h*Tn,g=i*Tn,_=_E(h);let v=_;o&&(v+=o[2]*a/Math.cos(g)/n);const w=p*(.5+(s?s[1]:0)/n),x=Math.sin(w)*v/Math.sin(wm(Math.PI/2-g-w,.01,Math.PI-.01)),T=Math.sin(g)*x+v,A=v*10,E=Math.min(T*f,A);return{fov:p,aspect:e/n,focalDistance:_,near:u,far:E}}function Ff(t){return 2*Math.atan(.5/t)*xm}function _E(t){return .5/Math.tan(.5*t*Tn)}function yE(t,e){const[n,r,i=0]=t;return Fr(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),_o(e,[n,r,i,1])}function V_(t,e,n=0){const[r,i,s]=t;if(Fr(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return _o(e,[r,i,s,1]);const o=_o(e,[r,i,0,1]),a=_o(e,[r,i,1,1]),u=o[2],f=a[2],h=u===f?0:((n||0)-u)/(f-u);return XS([],o,a,h)}function H7(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,u],[f,h]]=r,p=X7(t.padding),g=Df([a,wm(h,-Tu,Tu)]),_=Df([f,wm(u,-Tu,Tu)]),v=[Math.max(Math.abs(_[0]-g[0]),i),Math.max(Math.abs(_[1]-g[1]),i)],w=[e-p.left-p.right-Math.abs(o[0])*2,n-p.top-p.bottom-Math.abs(o[1])*2];Fr(w[0]>0&&w[1]>0);const x=w[0]/v[0],T=w[1]/v[1],A=(p.right-p.left)/2/x,E=(p.top-p.bottom)/2/T,R=[(_[0]+g[0])/2+A,(_[1]+g[1])/2+E],k=Oo(R),M=Math.min(s,z_(Math.abs(Math.min(x,T))));return Fr(Number.isFinite(M)),{longitude:k[0],latitude:k[1],zoom:M}}function X7(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Fr(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const fx=Math.PI/180;function Y7(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let u,f;const h=t.fovy?.5*t.fovy*fx:Math.atan(.5/t.altitude),p=(90-t.pitch)*fx;return h>p-.01?(u=hx(t,0,e),f=hx(t,n,e)):(u=i([0,0],s),f=i([n,0],s)),[o,a,f,u]}function hx(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=_o(r,[e,0,1,1]),s=_o(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),u=XS([],i,s,a),f=Oo(u);return f.push(n),f}const dx=512;function q7(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=ux(i+180,360)-180),(a<-180||a>180)&&(a=ux(a+180,360)-180);const u=z_(n/dx);if(o<=u)o=u,s=0;else{const f=n/2/Math.pow(2,o),h=Oo([0,f])[1];if(s<h)s=h;else{const p=Oo([0,dx-f])[1];s>p&&(s=p)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const vE=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,K7=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,Z7=`
${vE}
${K7}
`,Q7=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,J7=`
${vE}
${Q7}
`,G7=$l(iz),ez=$l(sz),tz=[0,0,0,1],nz=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function rz(t,e){const[n,r,i]=t,s=V_([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function iz({viewport:t,center:e}){return new cr(t.viewProjectionMatrix).invert().transform(e)}function sz({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>rz(o,r));for(const o of e){const a=o.clone().translate(new lr(t.center).negate()),u=s.map(h=>a.transform(h)),f=new cr().ortho({left:Math.min(...u.map(h=>h[0])),right:Math.max(...u.map(h=>h[0])),bottom:Math.min(...u.map(h=>h[1])),top:Math.max(...u.map(h=>h[1])),near:Math.min(...u.map(h=>-h[2])),far:Math.max(...u.map(h=>-h[2]))});n.push(f.multiplyRight(o))}return n}function oz(t){const{shadowEnabled:e=!0,project:n}=t;if(!e||!n||!t.shadowMatrices||!t.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};const r=j_.getUniforms(n),i=G7({viewport:n.viewport,center:r.center}),s=[],o=ez({shadowMatrices:t.shadowMatrices,viewport:n.viewport}).slice();for(let u=0;u<t.shadowMatrices.length;u++){const f=o[u],h=f.clone().translate(new lr(n.viewport.center).negate());r.coordinateSystem===Fe.LNGLAT&&r.projectionMode===vn.WEB_MERCATOR?(o[u]=h,s[u]=i):(o[u]=f.clone().multiplyRight(nz),s[u]=h.transform(i))}const a={drawShadowMap:!!t.drawToShadowMap,useShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,color:t.shadowColor||tz,lightId:t.shadowLightId||0,lightCount:t.shadowMatrices.length,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};for(let u=0;u<o.length;u++)a[`viewProjectionMatrix${u}`]=o[u],a[`projectCenter${u}`]=s[u];for(let u=0;u<2;u++)a[`shadow_uShadowMap${u}`]=t.shadowMaps&&t.shadowMaps[u]||t.dummyShadowMap;return a}const px={name:"shadow",dependencies:[j_],vs:Z7,fs:J7,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:oz,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},az={...Hw,defaultUniforms:{...Hw.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},lz=[sE],cz=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],uz=[];function fz(t){const e=Zi.getDefaultShaderAssembler();for(const r of lz)e.addDefaultModule(r);const n=t==="glsl"?cz:uz;for(const r of n)e.addShaderHook(r);return e}const hz=[255,255,255],dz=1;let pz=0;class bE{constructor(e={}){this.type="ambient";const{color:n=hz}=e,{intensity:r=dz}=e;this.id=e.id||`ambient-${pz++}`,this.color=n,this.intensity=r}}const gz=[255,255,255],mz=1,_z=[0,0,-1];let yz=0;class gx{constructor(e={}){this.type="directional";const{color:n=gz}=e,{intensity:r=mz}=e,{direction:i=_z}=e,{_shadow:s=!1}=e;this.id=e.id||`directional-${yz++}`,this.color=n,this.intensity=r,this.type="directional",this.direction=new lr(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class vz{constructor(e,n={id:"pass"}){const{id:r}=n;this.id=r,this.device=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class $_ extends vz{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[n,r]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,s=e.clearColor??(i?[0,0,0,0]:!1),o=i?1:!1,a=i?0:!1,u=e.colorMask??15,f={viewport:[0,0,n,r]};e.colorMask&&(f.colorMask=u),e.scissorRect&&(f.scissorRect=e.scissorRect);const h=this.device.beginRenderPass({framebuffer:e.target,parameters:f,clearColor:s,clearDepth:o,clearStencil:a});try{return this._drawLayers(h,e)}finally{h.end(),this.device.submit()}}_drawLayers(e,n){const{target:r,shaderModuleProps:i,viewports:s,views:o,onViewportActive:a,clearStack:u=!0}=n;n.pass=n.pass||"unknown",u&&(this._lastRenderIndex=-1);const f=[];for(const h of s){const p=o&&o[h.id];a?.(h);const g=this._getDrawLayerParams(h,n),_=h.subViewports||[h];for(const v of _){const w=this._drawLayersInViewport(e,{target:r,shaderModuleProps:i,viewport:v,view:p,pass:n.pass,layers:n.layers},g);f.push(w)}}return f}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,shaderModuleProps:u},f=!1){const h=[],p=wE(this._lastRenderIndex+1),g={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},_={};for(let v=0;v<n.length;v++){const w=n[v],x=this._shouldDrawLayer(w,g,s,_),T={shouldDrawLayer:x};x&&!f&&(T.shouldDrawLayer=!0,T.layerRenderIndex=p(w,x),T.shaderModuleProps=this._getShaderModuleProps(w,a,r,u),T.layerParameters={...w.context.deck?.props.parameters,...this.getLayerParameters(w,v,e)}),h[v]=T}return h}_drawLayersInViewport(e,{layers:n,shaderModuleProps:r,pass:i,target:s,viewport:o,view:a},u){const f=bz(this.device,{shaderModuleProps:r,target:s,viewport:o});if(a&&a.props.clear){const p=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;this.device.beginRenderPass({framebuffer:s,parameters:{viewport:f,scissorRect:f},clearColor:p.color?[0,0,0,0]:!1,clearDepth:p.depth?1:!1}).end()}const h={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:f});for(let p=0;p<n.length;p++){const g=n[p],_=u[p],{shouldDrawLayer:v}=_;if(v&&g.props.pickable&&h.pickableCount++,g.isComposite&&h.compositeCount++,g.isDrawable&&_.shouldDrawLayer){const{layerRenderIndex:w,shaderModuleProps:x,layerParameters:T}=_;h.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,w),x.project&&(x.project.viewport=o),g.context.renderPass=e;try{g._drawLayer({renderPass:e,shaderModuleProps:x,uniforms:{layerIndex:w},parameters:T})}catch(A){g.raiseError(A,`drawing ${g} to ${i}`)}}}return h}shouldDrawLayer(e){return!0}getShaderModuleProps(e,n,r){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getShaderModuleProps(e,n,r,i){const s=this.device.canvasContext.cssToDeviceRatio(),o=e.internalState?.propsInTransition||e.props,a={layer:o,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:s,modelMatrix:o.modelMatrix,coordinateSystem:o.coordinateSystem,coordinateOrigin:o.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(n)for(const u of n)mx(a,u.getShaderModuleProps?.(e,a));return mx(a,this.getShaderModuleProps(e,n,a),i)}}function wE(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,u=i.parent&&i.parent.id;let f;if(u&&!(u in e)&&r(i.parent,!1),u in n){const h=n[u]=n[u]||wE(e[u],e);f=h(i,s),n[a]=h}else Number.isFinite(o)?(f=o+(e[u]||0),n[a]=null):f=t;return s&&f>=t&&(t=f+1),e[a]=f,f};return r}function bz(t,{shaderModuleProps:e,target:n,viewport:r}){const i=e?.project?.devicePixelRatio??t.canvasContext.cssToDeviceRatio(),[,s]=t.canvasContext.getDrawingBufferSize(),o=n?n.height:s,a=r;return[a.x*i,o-(a.y+a.height)*i,a.width*i,a.height*i]}function mx(t,...e){for(const n of e)if(n)for(const r in n)t[r]?Object.assign(t[r],n[r]):t[r]=n[r];return t}class wz extends $_{constructor(e,n){super(e,n);const r=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},mipmaps:!0}),i=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[r],depthStencilAttachment:i})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const n=this.fbo,r=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],s=i.width*r,o=i.height*r,a=[1,1,1,1];(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,clearColor:a,target:n,pass:"shadow"})}getLayerParameters(e,n,r){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,n,r){return{shadow:{project:r.project,drawToShadowMap:!0}}}}const xz={color:[255,255,255],intensity:1},_x=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Tz=[0,0,0,200/255];class W_{constructor(e={}){this.id="lighting-effect",this.shadowColor=Tz,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:n,deck:r}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(n),r._addDefaultShaderModule(px),this.dummyShadowMap=n.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s,shaderModuleProps:{shadow:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,n){const r=this.shadow?{project:n.project,shadowMaps:this.shadowPasses.map(o=>o.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},i={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(o=>o.getProjectedLight({layer:e})),pointLights:this.pointLights.map(o=>o.getProjectedLight({layer:e}))},s=e.props.material;return{shadow:r,lighting:i,phongMaterial:s,gouraudMaterial:s}}cleanup(e){for(const n of this.shadowPasses)n.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(px))}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new cr().lookAt({eye:new lr(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new wz(e);this.shadowPasses[n]=r}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new bE(xz),this.directionalLights.push(new gx(_x[0]),new gx(_x[1])))}}class Sz{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:u}){const f=i||e&&e.constructor||Float32Array,h=n*r+s;if(ArrayBuffer.isView(e)){if(h<=e.length)return e;if(h*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new f(e.buffer,0,h)}let p=1/0;u&&(p=u*r+s);const g=this._allocate(f,h,a,p);return e&&o?g.set(e):a||g.fill(0,0,4),this._release(e),g}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,u=o.findIndex(f=>f.byteLength>=a);if(u>=0){const f=new e(o.splice(u,1)[0],0,s);return r&&f.fill(0),f}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const Rl=new Sz;function Za(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Ez(t){return[t[12],t[13],t[14]]}function Az(t){return{left:Qs(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Qs(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Qs(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Qs(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Qs(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Qs(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const yx=new lr;function Qs(t,e,n,r){yx.set(t,e,n);const i=yx.len();return{distance:r/i,normal:new lr(-t/i,-e/i,-n/i)}}function Cz(t){return t-Math.fround(t)}let Fa;function Jp(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Fa=Rl.allocate(Fa,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let u=0;u<n;u++){const f=t[o++];Fa[a+u]=f,Fa[a+u+n]=Cz(f)}a+=n*2}return Fa.subarray(0,s*n*2)}function Rz(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const Iz=Math.PI/180,kz=Za(),vx=[0,0,0],Pz={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function Mz({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const u=t/e,f=n?new cr().orthographic({fovy:r,aspect:u,focalDistance:i,near:o,far:a}):new cr().perspective({fovy:r,aspect:u,near:o,far:a});if(s){const{left:h=0,right:p=0,top:g=0,bottom:_=0}=s,v=mi((h+t-p)/2,0,t)-t/2,w=mi((g+e-_)/2,0,e)-e/2;f[8]-=v*2/t,f[9]+=w*2/e}return f}class zo{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||Pz,this.focalDistance=e.focalDistance||1,this.position=e.position||vx,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?vn.WEB_MERCATOR:vn.WEB_MERCATOR_AUTO_OFFSET:vn.IDENTITY}equals(e){return e instanceof zo?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Al(e.projectionMatrix,this.projectionMatrix)&&Al(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=yE(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,u=r&&r*this.distanceScales.unitsPerMeter[2],f=V_([i,a,o],this.pixelUnprojectionMatrix,u),[h,p,g]=this.unprojectPosition(f);return Number.isFinite(o)?[h,p,g]:Number.isFinite(r)?[h,p,r]:[h,p]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=Df(e);return n[1]=mi(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Oo(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e&&this.isGeospatial?Tm({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,Az(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=V7({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Tm({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=vx;if(s&&(a=o?new cr(o).transformAsVector(s,[]):s),this.isGeospatial){const u=this.projectPosition([n,r,0]);this.center=new lr(a).scale(this.distanceScales.unitsPerMeter).add(u)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=kz,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:u=1e3,padding:f=null,focalDistance:h=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new cr().multiplyRight(n).translate(new lr(this.center).negate()),this.projectionMatrix=r||Mz({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*Iz,focalDistance:h,padding:f,near:a,far:u});const p=Za();es(p,p,this.projectionMatrix),es(p,p,this.viewMatrix),this.viewProjectionMatrix=p,this.viewMatrixInverse=pm([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=Ez(this.viewMatrixInverse);const g=Za(),_=Za();U_(g,g,[this.width/2,-this.height/2,1]),Mf(g,g,[1,-1,0]),es(_,g,this.viewProjectionMatrix),this.pixelProjectionMatrix=_,this.pixelUnprojectionMatrix=pm(Za(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Ve.warn("Pixel project matrix not invertible")()}}zo.displayName="Viewport";class Do extends zo{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:u=1.01,nearZ:f,farZ:h,orthographic:p=!1,projectionMatrix:g,repeat:_=!1,worldOffset:v=0,position:w,padding:x,legacyMeterSizes:T=!1}=e;let{width:A,height:E,altitude:R=1.5}=e;const k=Math.pow(2,i);A=A||1,E=E||1;let M,L=null;if(g)R=g[5]/2,M=Ff(R);else{e.fovy?(M=e.fovy,R=_E(M)):M=Ff(R);let H;if(x){const{top:X=0,bottom:B=0}=x;H=[0,mi((X+E-B)/2,0,E)-E/2]}L=W7({width:A,height:E,scale:k,center:w&&[0,0,w[2]*Qp(n)],offset:H,pitch:s,fovy:M,nearZMultiplier:a,farZMultiplier:u}),Number.isFinite(f)&&(L.near=f),Number.isFinite(h)&&(L.far=h)}let W=$7({height:E,pitch:s,bearing:o,scale:k,altitude:R});v&&(W=new cr().translate([512*v,0,0]).multiplyLeft(W)),super({...e,width:A,height:E,viewMatrix:W,longitude:r,latitude:n,zoom:i,...L,fovy:M,focalDistance:R}),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=R,this.fovy=M,this.orthographic=p,this._subViewports=_?[]:null,this._pseudoMeters=T,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new Do({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Qp(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Qp(r);return[n,r,i]}addMetersToLngLat(e,n){return mE(e,n)}panByPosition(e,n){const r=V_(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=$w([],i,wj([],r)),o=$w([],this.center,s),[a,u]=this.unprojectFlat(o);return{longitude:a,latitude:u}}getBounds(e={}){const n=Y7(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=H7({width:r,height:i,bounds:e,...n});return new Do({width:r,height:i,longitude:s,latitude:o,zoom:a})}}Do.displayName="WebMercatorViewport";const bx=[0,0,0];function Gp(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Do){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function Nz(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===Fe.DEFAULT&&(i=e.isGeospatial?Fe.LNGLAT:Fe.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function xE(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,u=0]=t;switch(n&&([o,a,u]=Vl([],[o,a,u,1],n)),r){case Fe.LNGLAT:return Gp([o,a,u],e,s);case Fe.LNGLAT_OFFSETS:return Gp([o+i[0],a+i[1],u+(i[2]||0)],e,s);case Fe.METER_OFFSETS:return Gp(mE(i,[o,a,u]),e,s);case Fe.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],u+i[2]]:e.projectPosition([o,a,u])}}function TE(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=Nz(e),{autoOffset:u=!0}=e,{geospatialOrigin:f=bx,shaderCoordinateOrigin:h=bx,offsetMode:p=!1}=u?pE(n,r,i):{},g=xE(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:p});if(p){const _=n.projectPosition(f||h);Fj(g,g,_)}return g}const Oz=[255,255,255],Dz=1,Fz=[1,0,0],Lz=[0,0,1];let Bz=0;class SE{constructor(e={}){this.type="point";const{color:n=Oz}=e,{intensity:r=Dz}=e,{position:i=Lz}=e;this.id=e.id||`point-${Bz++}`,this.color=n,this.intensity=r,this.type="point",this.position=i,this.attenuation=Uz(e),this.projectedLight={...this}}getProjectedLight({layer:e}){const{projectedLight:n}=this,r=e.context.viewport,{coordinateSystem:i,coordinateOrigin:s}=e.props,o=TE(this.position,{viewport:r,coordinateSystem:i,coordinateOrigin:s,fromCoordinateSystem:r.isGeospatial?Fe.LNGLAT:Fe.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return n.color=this.color,n.intensity=this.intensity,n.position=o,n}}function Uz(t){return t.attenuation?t.attenuation:Fz}let jz=1,zz=1;class EE{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=jz++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=zz++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}function Vz(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function $z(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}let Wz=0;const Hz={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:t=>console.error(t),stats:um.stats.get(`animation-loop-${Wz++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class Xz{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...Hz,...e},e=this.props,!e.device)throw new Error("No device provided");const{useDevicePixels:n=!0}=this.props;this.stats=e.stats||new rh({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:n}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(e){if(this.props.onError(e),this._error=Error(),this.device?.canvasContext?.canvas instanceof HTMLCanvasElement){const r=document.createElement("h1");r.innerHTML=e.message,r.style.position="absolute",r.style.top="20%",r.style.left="10px",r.style.color="black",r.style.backgroundColor="red",document.body.appendChild(r)}}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const n=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(n),n}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=Vz(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&($z(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.canvasContext?.canvas;if(!this.device||!e)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:e,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,n]=this.device?.canvasContext?.getPixelSize()||[1,1];let r=1;const i=this.device?.canvasContext?.canvas;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}const eg={};function fh(t="id"){eg[t]=eg[t]||1;const e=eg[t]++;return`${t}-${e}`}class wx{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||fh("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&Ke.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function Yz(t,e){if(e instanceof wx)return e;const n=qz(t,e),{attributes:r,bufferLayout:i}=Kz(t,e);return new wx({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:n,attributes:r})}function qz(t,e){if(!e.indices)return;const n=e.indices.value;return t.createBuffer({usage:Ke.INDEX,data:n})}function Kz(t,e){const n=[],r={};for(const[s,o]of Object.entries(e.attributes)){let a=s;switch(s){case"POSITION":a="positions";break;case"NORMAL":a="normals";break;case"TEXCOORD_0":a="texCoords";break;case"COLOR_0":a="colors";break}if(o){r[a]=t.createBuffer({data:o.value,id:`${s}-buffer`});const{value:u,size:f,normalized:h}=o;n.push({name:a,format:DU(u,f,h)})}}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:r,bufferLayout:n,vertexCount:i}}class H_{static defaultProps={...Ro.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new H_(e),e._lumaData.defaultPipelineFactory}device;destroyPolicy;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createRenderPipeline(e){const n={...Ro.defaultProps,...e},r=this._hashRenderPipeline(n);if(!this._renderPipelineCache[r]){const i=this.device.createRenderPipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=r,this._renderPipelineCache[r]={pipeline:i,useCount:0}}return this._renderPipelineCache[r].useCount++,this._renderPipelineCache[r].pipeline}createComputePipeline(e){const n={...Sf.defaultProps,...e},r=this._hashComputePipeline(n);if(!this._computePipelineCache[r]){const i=this.device.createComputePipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=r,this._computePipelineCache[r]={pipeline:i,useCount:0}}return this._computePipelineCache[r].useCount++,this._computePipelineCache[r].pipeline}release(e){const n=e.hash,r=e instanceof Sf?this._computePipelineCache:this._renderPipelineCache;r[n].useCount--,r[n].useCount===0&&this.destroyPolicy==="unused"&&(r[n].pipeline.destroy(),delete r[n])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const n=e.vs?this._getHash(e.vs.source):0,r=e.fs?this._getHash(e.fs.source):0,i="-",s=this._getHash(JSON.stringify(e.bufferLayout));switch(this.device.type){case"webgl":return`${n}/${r}V${i}BL${s}`;default:const o=this._getHash(JSON.stringify(e.parameters));return`${n}/${r}V${i}T${e.topology}P${o}BL${s}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}class X_{static defaultProps={...ah.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new X_(e),e._lumaData.defaultShaderFactory}device;destroyPolicy;_cache={};constructor(e){this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}createShader(e){const n=this._hashShader(e);let r=this._cache[n];if(!r){const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[n]=r={shader:i,useCount:0}}return r.useCount++,r.shader}release(e){const n=this._hashShader(e),r=this._cache[n];r&&(r.useCount--,r.useCount===0&&this.destroyPolicy==="unused"&&(delete this._cache[n],r.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}}function Zz(t,e){const n={},r="Values";if(t.attributes.length===0&&!t.varyings?.length)return{"No attributes or varyings":{[r]:"N/A"}};for(const i of t.attributes)if(i){const s=`${i.location} ${i.name}: ${i.type}`;n[`in ${s}`]={[r]:i.stepMode||"vertex"}}for(const i of t.varyings||[]){const s=`${i.location} ${i.name}`;n[`out ${s}`]={[r]:JSON.stringify(i)}}return n}let St=null,tg=null;function Qz(t,{id:e,minimap:n,opaque:r,top:i="0",left:s="0",rgbaScale:o=1}){St||(St=document.createElement("canvas"),St.id=e,St.title=e,St.style.zIndex="100",St.style.position="absolute",St.style.top=i,St.style.left=s,St.style.border="blue 5px solid",St.style.transform="scaleY(-1)",document.body.appendChild(St),tg=St.getContext("2d")),(St.width!==t.width||St.height!==t.height)&&(St.width=t.width/2,St.height=t.height/2,St.style.width="400px",St.style.height="400px");const a=t.device.readPixelsToArrayWebGL(t),u=tg?.createImageData(t.width,t.height);if(u){for(let h=0;h<a.length;h+=4)u.data[0+h+0]=a[h+0]*o,u.data[0+h+1]=a[h+1]*o,u.data[0+h+2]=a[h+2]*o,u.data[0+h+3]=r?255:a[h+3]*o;tg?.putImageData(u,0,0)}}function Sm(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Sm(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!Sm(t[s],e[s],n-1))return!1;return!0}return!1}function Jz(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Gz(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number":!1}function AE(t){return Jz(t)||Gz(t)}function eV(t){return AE(t)||typeof t=="number"||typeof t=="boolean"}function CE(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(n=>{const r=t[n];eV(r)?e.uniforms[n]=r:e.bindings[n]=r}),e}class tV{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,n){Object.assign(this.options,n);const r=x_(Object.values(e).filter(i=>i.dependencies));for(const i of r)e[i.name]=i;he.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[i,s]of Object.entries(e))this._addModule(s),s.name&&i!==s.name&&!this.options.disableWarnings&&he.warn(`Module name: ${i} vs ${s.name}`)()}destroy(){}setProps(e){for(const n of Object.keys(e)){const r=n,i=e[r]||{},s=this.modules[r];if(!s){this.options.disableWarnings||he.warn(`Module ${n} not found`)();continue}const o=this.moduleUniforms[r],a=this.moduleBindings[r],u=s.getUniforms?.(i,o)||i,{uniforms:f,bindings:h}=CE(u);this.moduleUniforms[r]={...o,...f},this.moduleBindings[r]={...a,...h}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const n of Object.values(this.moduleBindings))Object.assign(e,n);return e}getDebugTable(){const e={};for(const[n,r]of Object.entries(this.moduleUniforms))for(const[i,s]of Object.entries(r))e[`${n}.${i}`]={type:this.modules[n].uniformTypes?.[i],value:String(s)};return e}_addModule(e){const n=e.name;this.moduleUniforms[n]=e.defaultUniforms||{},this.moduleBindings[n]={}}}let nV="";async function rV(t,e){const n=new Image;return n.crossOrigin="anonymous",n.src=t.startsWith("http")?t:nV+t,await n.decode(),e?await createImageBitmap(n,e):await createImageBitmap(n)}class ng{device;id;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,n){this.device=e,this.id=n.id||fh("async-texture"),typeof n?.data=="string"&&n.dimension==="2d"&&(n={...n,data:rV(n.data)}),this.ready=new Promise((r,i)=>{this.resolveReady=()=>{this.isReady=!0,r()},this.rejectReady=i}),this.initAsync(n)}async initAsync(e){const n=e.data;let r;try{r=await RE(n)}catch(s){this.rejectReady(s)}if(this.destroyed)return;const i={...e,data:r};this.texture=this.device.createTexture(i),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0,this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const n=this.texture;this.texture=n.clone(e),n.destroy()}return!0}}async function RE(t){if(t=await t,Array.isArray(t))return await Promise.all(t.map(RE));if(t&&typeof t=="object"&&t.constructor===Object){const e=t,n=await Promise.all(Object.values(e)),r=Object.keys(e),i={};for(let s=0;s<r.length;s++)i[r[s]]=n[s];return i}return t}const Wi=2,iV=1e4;class Lr{static defaultProps={...Ro.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Zi.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,n){this.props={...Lr.defaultProps,...n},n=this.props,this.id=n.id||fh("model"),this.device=e,Object.assign(this.userData,n.userData);const r=Object.fromEntries(this.props.modules?.map(u=>[u.name,u])||[]),i=n.shaderInputs||new tV(r,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(i);const s=oV(e),o=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){const{source:u,getUniforms:f}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:s,...this.props,modules:o});this.source=u,this._getModuleUniforms=f,this.props.shaderLayout||=fj(this.source)}else{const{vs:u,fs:f,getUniforms:h}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:s,...this.props,modules:o});this.vs=u,this.fs=f,this._getModuleUniforms=h}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,n.geometry&&this.setGeometry(n.geometry),this.pipelineFactory=n.pipelineFactory||H_.getDefaultPipelineFactory(this.device),this.shaderFactory=n.shaderFactory||X_.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in n&&(this.isInstanced=n.isInstanced),n.instanceCount&&this.setInstanceCount(n.instanceCount),n.vertexCount&&this.setVertexCount(n.vertexCount),n.indexBuffer&&this.setIndexBuffer(n.indexBuffer),n.attributes&&this.setAttributes(n.attributes),n.constantAttributes&&this.setConstantAttributes(n.constantAttributes),n.bindings&&this.setBindings(n.bindings),n.uniforms&&this.setUniformsWebGL(n.uniforms),n.moduleSettings&&this.updateModuleSettingsWebGL(n.moduleSettings),n.transformFeedback&&(this.transformFeedback=n.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const n=this._areBindingsLoading();if(n)return he.info(Wi,`>>> DRAWING ABORTED ${this.id}: ${n} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let r;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const i=this._getBindings();this.pipeline.setBindings(i,{disableWarnings:this.props.disableWarnings}),Em(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:s}=this.vertexArray,o=s?s.byteLength/(s.indexType==="uint32"?4:2):void 0;r=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:o,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),r?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",r}setGeometry(e){this._gpuGeometry?.destroy();const n=e&&Yz(this.device,e);if(n){this.setTopology(n.topology||"triangle-list");const r=new zp(this.bufferLayout);this.bufferLayout=r.mergeBufferLayouts(n.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(n)}this._gpuGeometry=n}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const n=new zp(this.bufferLayout);this.bufferLayout=this._gpuGeometry?n.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){Sm(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new OU(this.shaderInputs.modules);for(const[n,r]of Object.entries(this.shaderInputs.modules))if(sV(r)){const i=this._uniformStore.getManagedUniformBuffer(this.device,n);this.bindings[`${n}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,n){const r=n?.disableWarnings??this.props.disableWarnings;e.indices&&he.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=FU(this.pipeline.shaderLayout,this.bufferLayout);const i=new zp(this.bufferLayout);for(const[s,o]of Object.entries(e)){const a=i.getBufferLayout(s);if(!a){r||he.warn(`Model(${this.id}): Missing layout for buffer "${s}".`)();continue}const u=i.getAttributeNamesForBuffer(a);let f=!1;for(const h of u){const p=this._attributeInfos[h];if(p){const g=this.device.type==="webgpu"?i.getBufferIndex(p.bufferName):p.location;this.vertexArray.setBuffer(g,o),f=!0}}!f&&!r&&he.warn(`Model(${this.id}): Ignoring buffer "${o.id}" for unknown attribute "${s}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,n){for(const[r,i]of Object.entries(e)){const s=this._attributeInfos[r];s?this.vertexArray.setConstantWebGL(s.location,i):(n?.disableWarnings??this.props.disableWarnings)||he.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${r}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){this.setUniformsWebGL(e)}setUniformsWebGL(e){Em(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL(e){const{bindings:n,uniforms:r}=CE(this._getModuleUniforms(e));Object.assign(this.bindings,n),Object.assign(this.uniforms,r),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof ng&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[n,r]of Object.entries(this.bindings))r instanceof ng?r.isReady&&(e[n]=r.texture):e[n]=r;return e}_getBindingsUpdateTimestamp(){let e=0;for(const n of Object.values(this.bindings))n instanceof oh?e=Math.max(e,n.texture.updateTimestamp):n instanceof Ke||n instanceof He?e=Math.max(e,n.updateTimestamp):n instanceof ng?e=n.texture?Math.max(e,n.texture.updateTimestamp):1/0:n instanceof Sl||(e=Math.max(e,n.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const n={...e.attributes};for(const[r]of Object.entries(n))!this.pipeline.shaderLayout.attributes.find(i=>i.name===r)&&r!=="positions"&&delete n[r];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(n,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,n=null;this.pipeline&&(he.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,n=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const r=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let i=null;this.source?i=r:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:r,fs:i}),this._attributeInfos=bS(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),n&&this.shaderFactory.release(n)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=he.level>3?0:iV;he.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,he.group(Wi,`>>> DRAWING MODEL ${this.id}`,{collapsed:he.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=Zz(this.pipeline.shaderLayout,this.id);he.table(Wi,e)();const n=this.shaderInputs.getDebugTable();for(const[i,s]of Object.entries(this.uniforms))n[i]={value:s};he.table(Wi,n)();const r=this._getAttributeDebugTable();he.table(Wi,this._attributeInfos)(),he.table(Wi,r)(),he.groupEnd(Wi)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const n=this.device.props.debugFramebuffers;if(this._drawCount++,!n)return;const r=e.props.framebuffer;r&&Qz(r,{id:r.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[n,r]of Object.entries(this._attributeInfos)){const i=this.vertexArray.attributes[r.location];e[r.location]={name:n,type:r.shaderType,values:i?this._getBufferOrConstantValues(i,r.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:n}=this.vertexArray,r=n.indexType==="uint32"?new Uint32Array(n.debugData):new Uint16Array(n.debugData);e.indices={name:"indices",type:n.indexType,values:r.toString()}}return e}_getBufferOrConstantValues(e,n){const r=TS(n);return(e instanceof Ke?new r(e.debugData):e).toString()}}function sV(t){return!!(t.uniformTypes&&!Em(t.uniformTypes))}function oV(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function Em(t){for(const e in t)return!1;return!0}class hs{device;model;transformFeedback;static defaultProps={...Lr.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return e?.info?.type==="webgl"}constructor(e,n=hs.defaultProps){if(!hs.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new Lr(this.device,{id:n.id||"buffer-transform-model",fs:n.fs||hS(),topology:n.topology||"point-list",varyings:n.outputs||n.varyings,...n}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:n.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const n=this.device.beginRenderPass(e);this.model.draw(n),n.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const n=this.getBuffer(e);if(!n)throw new Error("BufferTransform#getBuffer");if(n instanceof Ke)return n.readAsync();const{buffer:r,byteOffset:i=0,byteLength:s=r.byteLength}=n;return r.readAsync(i,s)}}const aV="transform_output";class xx{device;model;sampler;currentIndex=0;samplerTextureMap=null;bindings=[];resources={};constructor(e,n){this.device=e,this.sampler=e.createSampler({addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",minFilter:"nearest",magFilter:"nearest",mipmapFilter:"nearest"}),this.model=new Lr(this.device,{id:n.id||"texture-transform-model",fs:n.fs||hS({input:n.targetTextureVarying,inputChannels:n.targetTextureChannels,output:aV}),vertexCount:n.vertexCount,...n}),this._initialize(n),Object.seal(this)}destroy(){this.model.destroy();for(const e of this.bindings)e.framebuffer?.destroy()}delete(){this.destroy()}run(e){const{framebuffer:n}=this.bindings[this.currentIndex],r=this.device.beginRenderPass({framebuffer:n,...e});this.model.draw(r),r.end()}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}_initialize(e){this._updateBindings(e)}_updateBindings(e){this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e)}_updateBinding(e,{sourceBuffers:n,sourceTextures:r,targetTexture:i}){if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,n),i){e.targetTexture=i;const{width:s,height:o}=i;e.framebuffer&&e.framebuffer.destroy(),e.framebuffer=this.device.createFramebuffer({id:"transform-framebuffer",width:s,height:o,colorAttachments:[i]}),e.framebuffer.resize({width:s,height:o})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].sampler=this.sampler}}class lV{id;topology;vertexCount;indices;attributes;userData={};constructor(e){const{attributes:n={},indices:r=null,vertexCount:i=null}=e;this.id=e.id||fh("geometry"),this.topology=e.topology,r&&(this.indices=ArrayBuffer.isView(r)?{value:r,size:1}:r),this.attributes={};for(const[s,o]of Object.entries(n)){const a=ArrayBuffer.isView(o)?{value:o}:o;if(!ArrayBuffer.isView(a.value))throw new Error(`${this._print(s)}: must be typed array or object with value as typed array`);if((s==="POSITION"||s==="positions")&&!a.size&&(a.size=3),s==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=a}else this.attributes[s]=a}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,n){return this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i of Object.values(e)){const{value:s,size:o,constant:a}=i;!a&&s&&o!==void 0&&o>=1&&(r=Math.min(r,s.length/o))}return r}}const cV={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class IE extends $_{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:u,width:f,height:h},cullRect:p,effects:g,pass:_="picking",pickZ:v,shaderModuleProps:w}){this.pickZ=v;const x=this._resetColorEncoder(v),T=[a,u,f,h],A=super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:p,effects:g?.filter(R=>R.useInPicking),pass:_,isPicking:!0,shaderModuleProps:w,clearColor:[0,0,0,0],colorMask:15,scissorRect:T});return this._colorEncoderState=null,{decodePickingColor:x&&fV.bind(null,x),stats:A}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getShaderModuleProps(e,n,r){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:o}=e.props;return!this._colorEncoderState||o.includes("terrain")?i.blend=!1:s&&o.includes("draw")&&(Object.assign(i,cV),i.blend=!0,i.blendColor=uV(this._colorEncoderState,e,r)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function uV(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(Ve.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function fV(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const to={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Lf=Symbol.for("component"),bi=Symbol.for("propTypes"),rg=Symbol.for("deprecatedProps"),yo=Symbol.for("asyncPropDefaults"),ds=Symbol.for("asyncPropOriginal"),_i=Symbol.for("asyncPropResolved");function Y_(t,e=()=>!0){return Array.isArray(t)?kE(t,e,[]):e(t)?[t]:[]}function kE(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?kE(i,e,n):e(i)&&n.push(i)}return n}function hV({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class dV{constructor(e,n,r){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=wf(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class pV{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new dV(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{};let a=o[n];const u=a&&a.resourceId&&this._resources[a.resourceId];u&&(u.unsubscribe(a),this.prune()),r&&(a?(a.onChange=i,a.resourceId=r.id):a={onChange:i,resourceId:r.id},o[n]=a,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const gV="layerManager.setLayers",mV="layerManager.activateViewport";class _V{constructor(e,n){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=a=>{Ft(mV,this,a),a&&(this.context.viewport=a)};const{deck:r,stats:i,viewport:s,timeline:o}=n||{};this.layers=[],this.resourceManager=new pV({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:r,shaderAssembler:fz(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[b9],renderPass:void 0,stats:i||new rh({id:"deck.gl"}),viewport:s||new zo({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new EE,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Ft(gV,this,n,e),this._lastRenderedLayers=e;const r=Y_(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:n}=this.context;n.find(r=>r.name===e.name)||(n.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:n}=this.context,r=n.findIndex(i=>i.name===e.name);r>=0&&(n.splice(r,1),this._defaultShaderModulesChanged=!0)}_handleError(e,n,r){r.raiseError(n,`${e} of ${r}`)}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?Ve.warn(`Multiple old layers with same id ${o.id}`)():r[o.id]=o;if(this._defaultShaderModulesChanged){for(const o of e)o.setNeedsUpdate(),o.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s=`Uniform transition in ${o}`;break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&Ve.warn(`Multiple new layers with same id ${i.id}`)(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=to.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=to.MATCHED,n!==e&&(e.lifecycle=to.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=to.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=to.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Kt(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Kt(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!Kt(t[s],e[s],n-1))return!1;return!0}return!1}class yV{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Y_(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Kt(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Ve.warn("missing `viewState` or `initialViewState`")()}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>this.getView(e.id)?.makeViewport({viewState:s,width:this.width,height:this.height})})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let u=n[s.id];const f=!!s.controller;f&&!u&&(r=!0),(r||!f)&&u&&(u.finalize(),u=null),this.controllers[s.id]=this._updateController(s,o,a,u),a&&this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const vV=/([0-9]+\.?[0-9]*)(%|px)/;function ci(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=vV.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error(`Could not parse position string ${t}`)}}function ui(t,e){return t.relative?Math.round(t.position*e):t.position}class Fo{constructor(e){const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null}=e;this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=ci(r),this._y=ci(i),this._width=ci(s),this._height=ci(o),this._padding=a&&{left:ci(a.left||0),right:ci(a.right||0),top:ci(a.top||0),bottom:ci(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&Kt(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});if(!i.height||!i.width)return null;const s=this.getViewportType(r);return new s({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:ui(this._x,e),y:ui(this._y,n),width:ui(this._width,e),height:ui(this._height,n)};return this._padding&&(r.padding={left:ui(this._padding.left,e),top:ui(this._padding.top,n),right:ui(this._padding.right,e),bottom:ui(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class hh{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:e,settings:n}=this;this._handle=e.addChannel({delay:e.getTime(),duration:n.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Tx=()=>{},Am={BREAK:1,SNAP_TO_END:2,IGNORE:3},bV=t=>t,wV=Am.BREAK;class xV{constructor(e){this._onTransitionUpdate=n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:u}}=n,f=u(r/a),h=i.interpolateProps(s,o,f);this.propsInTransition=this.getControllerState({...this.props,...h}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new hh(e.timeline),this.onViewStateChange=e.onViewStateChange||Tx,this.onStateChange=e.onStateChange||Tx}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===Am.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Am.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const u={duration:o,easing:n.transitionEasing||bV,interpolator:s,interruption:n.transitionInterruption||wV,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(u),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(n)}}}function Lt(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class TV{constructor(e){const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Al(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Lt(Number.isFinite(r)||Array.isArray(r),`${n} is required for transition`)})}}const SV=["longitude","latitude","zoom","bearing","pitch"],EV=["longitude","latitude","zoom"];class PE extends TV{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:SV,required:EV},super(r.transitionProps),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),u=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(u),aroundPosition:u,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Pf(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Pf(e.around,n.around,r)))}return i}}const fi={transitionDuration:0},AV=300,Su=t=>1-(1-t)*(1-t),Js={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},Hi={};class CV{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new xV({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return n?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?AV:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:u=!1,keyboard:f=!0}=e,h=!!this.onViewStateChange;this.toggleEvents(Js.WHEEL,h&&r),this.toggleEvents(Js.PAN,h),this.toggleEvents(Js.PINCH,h&&(a||u)),this.toggleEvents(Js.MULTI_PAN,h&&u),this.toggleEvents(Js.DOUBLE_CLICK,h&&o),this.toggleEvents(Js.KEYBOARD,h&&f),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=u,this.keyboard=f}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,fi,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,fi,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Su},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,fi,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Su},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,fi,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,fi,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Su},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Hi._startPinchRotation=e.rotation,Hi._lastPinchEvent=e,this.updateViewport(r,fi,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Hi._startPinchRotation-r})}return this.updateViewport(n,fi,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Hi._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Hi;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),u=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:u}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Su},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Hi._startPinchRotation=null,Hi._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let u;const f={};switch(e.srcEvent.code){case"Minus":u=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),f.isZooming=!0;break;case"Equal":u=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),f.isZooming=!0;break;case"ArrowLeft":n?(u=a.rotateLeft(s),f.isRotating=!0):(u=a.moveLeft(i),f.isPanning=!0);break;case"ArrowRight":n?(u=a.rotateRight(s),f.isRotating=!0):(u=a.moveRight(i),f.isPanning=!0);break;case"ArrowUp":n?(u=a.rotateUp(o),f.isRotating=!0):(u=a.moveUp(i),f.isPanning=!0);break;case"ArrowDown":n?(u=a.rotateDown(o),f.isRotating=!0):(u=a.moveDown(i),f.isPanning=!0);break;default:return!1}return this.updateViewport(u,this._getTransitionProps(),f),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?fi:e?{...n,transitionInterpolator:new PE({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class RV{constructor(e,n){this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const Sx=5,IV=1.2;class kV extends RV{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:u=0,altitude:f=1.5,position:h=[0,0,0],maxZoom:p=20,minZoom:g=0,maxPitch:_=60,minPitch:v=0,startPanLngLat:w,startZoomLngLat:x,startRotatePos:T,startBearing:A,startPitch:E,startZoom:R,normalize:k=!0}=e;Lt(Number.isFinite(s)),Lt(Number.isFinite(i)),Lt(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:u,altitude:f,maxZoom:p,minZoom:g,maxPitch:_,minPitch:v,normalize:k,position:h},{startPanLngLat:w,startZoomLngLat:x,startRotatePos:T,startBearing:A,startPitch:E,startZoom:R}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let u=i+Math.log2(r);u=mi(u,a,o);const f=this.makeViewport({...this.getViewportProps(),zoom:u});return this._getUpdatedState({zoom:u,...f.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=mi(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=mi(a,o,s);const{normalize:u=!0}=e;return u&&Object.assign(e,q7(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],u=n[1],{width:f,height:h}=this.getViewportProps(),p=s/f;let g=0;o>0?Math.abs(h-u)>Sx&&(g=o/(u-h)*IV):o<0&&u>Sx&&(g=1-a/u),g=mi(g,-1,1);const{minPitch:_,maxPitch:v}=this.getViewportProps(),w=i+180*p;let x=r;return g>0?x=r+g*(v-r):g<0&&(x=r-g*(_-r)),{pitch:x,bearing:w}}}class PV extends CV{constructor(){super(...arguments),this.ControllerState=kV,this.transition={transitionDuration:300,transitionInterpolator:new PE({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class ME extends Fo{constructor(e={}){super(e)}getViewportType(){return Do}get ControllerType(){return PV}}ME.displayName="MapView";const MV=new W_;function NV(t,e){const n=t.order??1/0,r=e.order??1/0;return n-r}class OV{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>NV(i,e)>0);r<0?n.push(e):n.splice(r,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Kt(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];let o=i;s&&s!==i?s.setProps?(s.setProps(i.props),o=s):s.cleanup(this._context):s||i.setup(this._context),r.push(o),delete n[i.id]}for(const i in n)n[i].cleanup(this._context);this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof W_)||this._resolvedEffects.push(MV),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class DV extends $_{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const FV="deckRenderer.renderLayers";class LV{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new DV(e),this.pickLayersPass=new IE(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target;this.lastPostProcessEffect&&(r.clearColor=[0,0,0,0],r.clearCanvas=!0);const s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,Ft(FV,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,n=this.device.canvasContext.getDrawingBufferSize();e.length===0&&[0,1].map(r=>{const i=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${r}`,colorAttachments:[i]}))});for(const r of e)r.resize(n)}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1]};for(const s of e)if(s.postRender){i.target=s.id===this.lastPostProcessEffect?n.target:void 0;const o=s.postRender(i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const BV={pickedColor:null,pickedObjectIndex:-1};function UV({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:u,height:f}=s;let h=i*i,p=-1,g=0;for(let _=0;_<f;_++){const v=_+a-r,w=v*v;if(w>h)g+=4*u;else for(let x=0;x<u;x++){if(t[g+3]-1>=0){const A=x+o-n,E=A*A+w;E<=h&&(h=E,p=g)}g+=4}}if(p>=0){const _=t.slice(p,p+4),v=e(_);if(v){const w=Math.floor(p/4/u),x=p/4-w*u;return{...v,pickedColor:_,pickedX:o+x,pickedY:a+w}}Ve.error("Picked non-existent layer. Is picking buffer corrupt?")()}return BV}function jV({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):Ve.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function NE({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=VV(t?.pickedViewports||e,{x:r,y:i}));let a;if(o){const u=[r-o.x,i-o.y];s!==void 0&&(u[2]=s),a=o.unproject(u)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function zV(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,u=o?[o]:[];if(r==="hover"){const p=n.index,g=n.layerId,_=o?o.props.id:null;if(_!==g||a!==p){if(_!==g){const v=i.find(w=>w.props.id===g);v&&u.unshift(v)}n.layerId=_,n.index=a,n.info=null}}const f=NE(t),h=new Map;return h.set(null,f),u.forEach(p=>{let g={...f};p===o&&(g.color=s,g.index=a,g.picked=!0),g=OE({layer:p,info:g,mode:r});const _=g.layer;p===o&&r==="hover"&&(n.info=g),h.set(_.id,g),r==="hover"&&_.updateAutoHighlight(g)}),h}function OE({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function VV(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class $V{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new IE(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,u=o?r.find(g=>g.id===o):null,f=a&&i.find(g=>g.id===a)||i[0],h=f&&f.unproject([e-f.x,n-f.y]);return{...s,...{x:e,y:n,viewport:f,coordinate:h,layer:u}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const n=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=n}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:u="query",unproject3D:f,onViewportActive:h,effects:p}){const g=this.device.canvasContext.cssToDeviceRatio(),_=this._getPickable(e);if(!_||r.length===0)return{result:[],emptyInfo:NE({viewports:r,x:i,y:s,pixelRatio:g})};this._resizeBuffer();const v=this.device.canvasContext.cssToDevicePixels([i,s],!0),w=[v.x+Math.floor(v.width/2),v.y+Math.floor(v.height/2)],x=Math.round(o*g),{width:T,height:A}=this.pickingFBO,E=this._getPickingRect({deviceX:w[0],deviceY:w[1],deviceRadius:x,deviceWidth:T,deviceHeight:A}),R={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let k;const M=[],L=new Set;for(let W=0;W<a;W++){let H;if(E){const B=this._drawAndSample({layers:_,views:n,viewports:r,onViewportActive:h,deviceRect:E,cullRect:R,effects:p,pass:`picking:${u}`});H=UV({...B,deviceX:w[0],deviceY:w[1],deviceRadius:x,deviceRect:E})}else H={pickedColor:null,pickedObjectIndex:-1};let X;if(H.pickedLayer&&f&&this.depthFBO){const{pickedColors:B}=this._drawAndSample({layers:[H.pickedLayer],views:n,viewports:r,onViewportActive:h,deviceRect:{x:H.pickedX,y:H.pickedY,width:1,height:1},cullRect:R,effects:p,pass:`picking:${u}:z`},!0);B[3]&&(X=B[0])}H.pickedLayer&&W+1<a&&(L.add(H.pickedLayer),H.pickedLayer.disablePickingIndex(H.pickedObjectIndex)),k=zV({pickInfo:H,lastPickedInfo:this.lastPickedInfo,mode:u,layers:_,viewports:r,x:i,y:s,z:X,pixelRatio:g});for(const B of k.values())B.layer&&M.push(B);if(!H.pickedColor)break}for(const W of L)W.restorePickingColors();return{result:M,emptyInfo:k.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:u="query",maxObjects:f=null,onViewportActive:h,effects:p}){const g=this._getPickable(e);if(!g||r.length===0)return[];this._resizeBuffer();const _=this.device.canvasContext.cssToDeviceRatio(),v=this.device.canvasContext.cssToDevicePixels([i,s],!0),w=v.x,x=v.y+v.height,T=this.device.canvasContext.cssToDevicePixels([i+o,s+a],!0),A=T.x+T.width,E=T.y,R={x:w,y:E,width:A-w,height:x-E},k=this._drawAndSample({layers:g,views:n,viewports:r,onViewportActive:h,deviceRect:R,cullRect:{x:i,y:s,width:o,height:a},effects:p,pass:`picking:${u}`}),M=jV(k),L=new Map,W=[],H=Number.isFinite(f);for(let X=0;X<M.length&&!(H&&W.length>=f);X++){const B=M[X];let te={color:B.pickedColor,layer:null,index:B.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:_};te=OE({layer:B.pickedLayer,info:te,mode:u});const ie=te.layer.id;L.has(ie)||L.set(ie,new Set);const se=L.get(ie),G=te.object??te.index;se.has(G)||(se.add(G),W.push(te))}return W}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:u},f=!1){const h=f?this.depthFBO:this.pickingFBO,p={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:h,deviceRect:s,cullRect:o,effects:a,pass:u,pickZ:f,preRenderStats:{},isPicking:!0};for(const A of a)A.useInPicking&&(p.preRenderStats[A.id]=A.preRender(p));const{decodePickingColor:g}=this.pickLayersPass.render(p),{x:_,y:v,width:w,height:x}=s,T=new(f?Float32Array:Uint8Array)(w*x*4);return this.device.readPixelsToArrayWebGL(h,{sourceX:_,sourceY:v,sourceWidth:w,sourceHeight:x,target:T}),{pickedColors:T,decodePickingColor:g}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),u=Math.min(i,e+r+1)-o,f=Math.min(s,n+r+1)-a;return u<=0||f<=0?null:{x:o,y:a,width:u,height:f}}}const WV={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},HV="top-left",Ex="__root";class XV{constructor({deck:e,parentElement:n}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,this.parentElement=n}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!Kt(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(n=>n.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const n={};for(const r of this.resolvedWidgets)n[r.id]=r;this.resolvedWidgets.length=0;for(const r of this.defaultWidgets)n[r.id]=null,this.resolvedWidgets.push(r);for(let r of e){const i=n[r.id];i?i.viewId!==r.viewId||i.placement!==r.placement?(this._remove(i),this._add(r)):r!==i&&(i.setProps(r.props),r=i):this._add(r),n[r.id]=null,this.resolvedWidgets.push(r)}for(const r in n){const i=n[r];i&&this._remove(i)}this.widgets=e}_add(e){const{viewId:n=null,placement:r=HV}=e,i=e.onAdd({deck:this.deck,viewId:n});i&&this._getContainer(n,r).append(i),e._element=i}_remove(e){e.onRemove?.(),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,n){const r=e||Ex;let i=this.containers[r];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",this.parentElement?.append(i),this.containers[r]=i);let s=i.querySelector(`.${n}`);return s||(s=document.createElement("div"),s.className=n,s.style.position="absolute",s.style.zIndex="2",Object.assign(s.style,WV[n]),i.append(s)),s}_updateContainers(){const e=this.deck.width,n=this.deck.height;for(const r in this.containers){const i=this.lastViewports[r]||null,s=r===Ex||i,o=this.containers[r];s?(o.style.display="block",o.style.left=`${i?i.x:0}px`,o.style.top=`${i?i.y:0}px`,o.style.width=`${i?i.width:e}px`,o.style.height=`${i?i.height:n}px`):o.style.display="none"}}onRedraw({viewports:e,layers:n}){const r=e.reduce((i,s)=>(i[s.id]=s,i),{});for(const i of this.getWidgets()){const{viewId:s}=i;if(s){const o=r[s];o&&(i.onViewportChange&&i.onViewportChange(o),i.onRedraw?.({viewports:[o],layers:n}))}else{if(i.onViewportChange)for(const o of e)i.onViewportChange(o);i.onRedraw?.({viewports:e,layers:n})}}this.lastViewports=r,this._updateContainers()}onHover(e,n){for(const r of this.getWidgets()){const{viewId:i}=r;(!i||i===e.viewport?.id)&&r.onHover?.(e,n)}}onEvent(e,n){const r=bm[n.type];if(r)for(const i of this.getWidgets()){const{viewId:s}=i;(!s||s===e.viewport?.id)&&i[r]?.(e,n)}}}const YV={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class qV{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:e}){const n=document.createElement("div");return n.className="deck-tooltip",Object.assign(n.style,YV),this.deck=e,this.element=n,n}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:n}=this,r=n&&n.props.getTooltip;if(!r)return;const i=r(e);this.lastViewport=e.viewport,this.setTooltip(i,e.x,e.y)}setTooltip(e,n,r){const i=this.element;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${n}px, ${r}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}var ao;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(ao||(ao={}));const q_={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},pt=(t,e,n)=>e?t.enable(n):t.disable(n),Ax=(t,e,n)=>t.hint(n,e),en=(t,e,n)=>t.pixelStorei(n,e),Cx=(t,e,n)=>{const r=n===36006?36009:36008;return t.bindFramebuffer(r,e)},La=(t,e,n)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];t.bindBuffer(i,e)};function ig(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}const KV={3042:pt,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:pt,2885:(t,e)=>t.cullFace(e),2929:pt,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:pt,35723:Ax,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>t.bindTransformFeedback?.(36386,e),34229:(t,e)=>t.bindVertexArray(e),36006:Cx,36010:Cx,34964:La,36662:La,36663:La,35053:La,35055:La,2886:(t,e)=>t.frontFace(e),33170:Ax,2849:(t,e)=>t.lineWidth(e),32823:pt,32824:"polygonOffset",10752:"polygonOffset",35977:pt,32926:pt,32928:pt,32938:"sampleCoverage",32939:"sampleCoverage",3089:pt,3088:(t,e)=>t.scissor(...e),2960:pt,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:pt,10754:pt,12288:pt,12289:pt,12290:pt,12291:pt,12292:pt,12293:pt,12294:pt,12295:pt,3333:en,3317:en,37440:en,37441:en,37443:en,3330:en,3332:en,3331:en,3314:en,32878:en,3316:en,3315:en,32877:en,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{const n=typeof e=="number"?[e,e]:e;t.blendEquationSeparate(...n)},blendFunc:(t,e)=>{const n=e?.length===2?[...e,...e]:e;t.blendFuncSeparate(...n)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(e[0],e[1]||!1),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=ig(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=ig(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=ig(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function lt(t,e,n){return e[t]!==void 0?e[t]:n[t]}const ZV={blendEquation:(t,e,n)=>t.blendEquationSeparate(lt(32777,e,n),lt(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(lt(32969,e,n),lt(32968,e,n),lt(32971,e,n),lt(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(lt(32824,e,n),lt(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(lt(32938,e,n),lt(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,lt(2962,e,n),lt(2967,e,n),lt(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,lt(34816,e,n),lt(36003,e,n),lt(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,lt(2964,e,n),lt(2965,e,n),lt(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,lt(34817,e,n),lt(34818,e,n),lt(34819,e,n))},Rx={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,n)=>t({36007:n}),bindTransformFeedback:(t,e,n)=>t({36389:n}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},bindBuffer:(t,e,n)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return r?t({[r]:n}):{valueChanged:!0}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},Kn=(t,e)=>t.isEnabled(e),Ix={3042:Kn,2884:Kn,2929:Kn,3024:Kn,32823:Kn,32926:Kn,32928:Kn,3089:Kn,2960:Kn,35977:Kn},QV=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function Vo(t,e){if(GV(e))return;const n={};for(const i in e){const s=Number(i),o=KV[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=ZV[i];s(t,e,r)}}function DE(t,e=q_){if(typeof e=="number"){const i=e,s=Ix[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=Ix[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function JV(t){Vo(t,q_)}function GV(t){for(const e in t)return!1;return!0}function e$(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}class ts{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,n){this.gl=e,this.log=n?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];Vo(this.gl,e),this.stateStack.pop()}trackState(e,n){if(this.cache=n.copyState?DE(e):Object.assign({},q_),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,n$(e);for(const r in Rx){const i=Rx[r];t$(e,r,i)}kx(e,"getParameter"),kx(e,"isEnabled")}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const s in e){const o=e[s],a=this.cache[s];e$(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function kx(t,e){const n=t[e].bind(t);t[e]=function(i){if(i===void 0||QV.has(i))return n(i);const s=ts.get(t);return i in s.cache||(s.cache[i]=n(i)),s.enable?s.cache[i]:n(i)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function t$(t,e,n){if(!t[e])return;const r=t[e].bind(t);t[e]=function(...s){const o=ts.get(t),{valueChanged:a,oldValue:u}=n(o._updateCache,...s);return a&&r(...s),u},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function n$(t){const e=t.useProgram.bind(t);t.useProgram=function(r){const i=ts.get(t);i.program!==r&&(e(r),i.program=r)}}function r$(t,e,n){let r="";const i={preserveDrawingBuffer:!0,...n};let s=null;if(s||=t.getContext("webgl2",i),i.failIfMajorPerformanceCaveat&&(r||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),!s&&!n.failIfMajorPerformanceCaveat&&(i.failIfMajorPerformanceCaveat=!1,s=t.getContext("webgl2",i),s.luma||={},s.luma.softwareRenderer=!0),s||(s=t.getContext("webgl",{}),s&&(s=null,r||="Your browser only supports WebGL1")),!s)throw r||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${r}`);const{onContextLost:o,onContextRestored:a}=e;return t.addEventListener("webglcontextlost",u=>o(u),!1),t.addEventListener("webglcontextrestored",u=>a(u),!1),s.luma||={},s}function Lo(t,e,n){return n[e]===void 0&&(n[e]=t.getExtension(e)||null),n[e]}function i$(t,e){const n=t.getParameter(7936),r=t.getParameter(7937);Lo(t,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,s=t.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),o=t.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),a=s||n,u=o||r,f=t.getParameter(7938),h=FE(a,u),p=s$(a,u),g=o$(a,u);return{type:"webgl",gpu:h,gpuType:g,gpuBackend:p,vendor:a,renderer:u,version:f,shadingLanguage:"glsl",shadingLanguageVersion:300}}function FE(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function s$(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?"opengl":"unknown"}function o$(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(FE(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function LE(t){switch(t){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}const Qa="WEBGL_compressed_texture_s3tc",Ja="WEBGL_compressed_texture_s3tc_srgb",lo="EXT_texture_compression_rgtc",co="EXT_texture_compression_bptc",a$="WEBGL_compressed_texture_etc",l$="WEBGL_compressed_texture_astc",c$="WEBGL_compressed_texture_etc1",u$="WEBGL_compressed_texture_pvrtc",f$="WEBGL_compressed_texture_atc",Px="EXT_texture_norm16",Mx="EXT_render_snorm",h$="EXT_color_buffer_float",K_={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[Mx],"norm16-renderable-webgl":[Px],"snorm16-renderable-webgl":[Px,Mx],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[Qa,Ja,lo,co],"texture-compression-bc5-webgl":[lo],"texture-compression-bc7-webgl":[co],"texture-compression-etc2":[a$],"texture-compression-astc":[l$],"texture-compression-etc1-webgl":[c$],"texture-compression-pvrtc-webgl":[u$],"texture-compression-atc-webgl":[f$]};function d$(t){return t in K_}function p$(t,e,n){return(K_[e]||[]).every(i=>Lo(t,i,n))}const Z_={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:h$,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:Qa},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:Ja},"bc1-rgba-unorm":{gl:33777,x:Qa},"bc1-rgba-unorm-srgb":{gl:35916,x:Ja},"bc2-rgba-unorm":{gl:33778,x:Qa},"bc2-rgba-unorm-srgb":{gl:35918,x:Ja},"bc3-rgba-unorm":{gl:33779,x:Qa},"bc3-rgba-unorm-srgb":{gl:35919,x:Ja},"bc4-r-unorm":{gl:36283,x:lo},"bc4-r-snorm":{gl:36284,x:lo},"bc5-rg-unorm":{gl:36285,x:lo},"bc5-rg-snorm":{gl:36286,x:lo},"bc6h-rgb-ufloat":{gl:36495,x:co},"bc6h-rgb-float":{gl:36494,x:co},"bc7-rgba-unorm":{gl:36492,x:co},"bc7-rgba-unorm-srgb":{gl:36493,x:co},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function g$(t,e,n){let r=e.create;const i=Z_[e.format];return i?.gl===void 0&&(r=!1),i?.x&&(r=r&&!!Lo(t,i.x,n)),{format:e.format,create:r&&e.create,render:r&&e.render,filter:r&&e.filter,blend:r&&e.blend,store:r&&e.store}}function BE(t){const e=Z_[t],n=y$(t),r=T_(t);return{internalFormat:n,format:e?.dataFormat||_$(r.channels,r.integer,r.normalized,n),type:r.dataType?LE(r.dataType):e?.types?.[0]||5121,compressed:r.compressed||!1}}function m$(t){switch(T_(t).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${t}`)}}function _$(t,e,n,r){if(r===6408||r===6407)return r;switch(t){case"r":return e&&!n?36244:6403;case"rg":return e&&!n?33320:33319;case"rgb":return e&&!n?36248:6407;case"rgba":return e&&!n?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function y$(t){const n=Z_[t]?.gl;if(n===void 0)throw new Error(`Unsupported texture format ${t}`);return n}const Nx={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class v$ extends G8{gl;extensions;testedFeatures=new Set;constructor(e,n,r){super([],r),this.gl=e,this.extensions=n,Lo(e,"EXT_color_buffer_float",n)}*[Symbol.iterator](){const e=this.getFeatures();for(const n of e)this.has(n)&&(yield n);return[]}has(e){return this.disabledFeatures?.[e]?!1:(this.testedFeatures.has(e)||(this.testedFeatures.add(e),d$(e)&&p$(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(n=>n!=="polygon-mode-webgl");for(const n of e)this.has(n)}getFeatures(){return[...Object.keys(Nx),...Object.keys(K_)]}getWebGLFeature(e){const n=Nx[e];return typeof n=="string"?!!Lo(this.gl,n,this.extensions):!!n}}class b$ extends J8{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return this.limits[e]===void 0&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class ul extends lh{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,n){super(e,n);const r=n.handle===null;this.device=e,this.gl=e.gl,this.handle=this.props.handle||r?this.props.handle:this.gl.createFramebuffer(),r||(e.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let n=0;n<this.colorAttachments.length;++n){const r=this.colorAttachments[n];if(r){const i=36064+n;this._attachTextureView(i,r)}}if(this.depthStencilAttachment){const n=m$(this.depthStencilAttachment.props.format);this._attachTextureView(n,this.depthStencilAttachment)}if(this.device.props.debug){const n=this.gl.checkFramebufferStatus(36160);if(n!==36053)throw new Error(`Framebuffer ${x$(n)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,n){const{gl:r}=this.device,{texture:i}=n,s=n.props.baseMipLevel,o=n.props.baseArrayLayer;switch(r.bindTexture(i.glTarget,i.handle),i.glTarget){case 35866:case 32879:r.framebufferTextureLayer(36160,e,i.handle,s,o);break;case 34067:const a=w$(o);r.framebufferTexture2D(36160,e,a,i.handle,s);break;case 3553:r.framebufferTexture2D(36160,e,3553,i.handle,s);break;default:throw new Error("Illegal texture type")}r.bindTexture(i.glTarget,null)}}function w$(t){return t<34069?t+34069:t}function x$(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}class T$ extends S_{device;format="rgba8unorm";depthStencilFormat="depth24plus";presentationSize;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,n){super(n),this.device=e,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new ul(this.device,{handle:null}),this._framebuffer}update(){const e=this.getPixelSize();(e[0]!==this.presentationSize[0]||e[1]!==this.presentationSize[1])&&(this.presentationSize=e,this.resize())}resize(e){if(this.device.gl&&this.canvas){const n=this.getDevicePixelRatio(e?.useDevicePixels);this.setDevicePixelRatio(n,e);return}}commit(){}}async function UE(t,e){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",t),new Promise((i,s)=>{r.onload=i,r.onerror=o=>s(new Error(`Unable to load script '${t}': ${o}`)),n.appendChild(r)})}const S$=1;let tn=null,Ox=!1;const Q_={debugSpectorJS:he.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function E$(t){if(!globalThis.SPECTOR)try{await UE(t.debugSpectorJSUrl||Q_.debugSpectorJSUrl)}catch(e){he.warn(String(e))}}function A$(t){if(t={...Q_,...t},!t.debugSpectorJS)return null;if(!tn&&globalThis.SPECTOR&&!globalThis.luma?.spector){he.probe(S$,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;tn=new e,globalThis.luma&&(globalThis.luma.spector=tn)}if(!tn)return null;if(Ox||(Ox=!0,tn.spyCanvases(),tn?.onCaptureStarted.add(e=>he.info("Spector capture started:",e)()),tn?.onCapture.add(e=>{he.info("Spector capture complete:",e)(),tn?.getResultUI(),tn?.resultView.display(),tn?.resultView.addCapture(e)})),t.gl){const e=t.gl,n=e.device;tn?.startCapture(t.gl,500),e.device=n,new Promise(r=>setTimeout(r,2e3)).then(r=>{he.info("Spector capture stopped after 2 seconds")(),tn?.stopCapture()})}return tn}const C$="https://unpkg.com/webgl-debug@2.0.1/index.js";function jE(t){return t.luma=t.luma||{},t.luma}async function R$(){gs()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await UE(C$))}function I$(t,e={}){return e.debugWebGL||e.traceWebGL?P$(t,e):k$(t)}function k$(t){const e=jE(t);return e.realContext?e.realContext:t}function P$(t,e){if(!globalThis.WebGLDebugUtils)return he.warn("webgl-debug not loaded")(),t;const n=jE(t);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...ao,...t});const r=globalThis.WebGLDebugUtils.makeDebugContext(t,M$.bind(null,e),N$.bind(null,e));for(const o in ao)!(o in r)&&typeof ao[o]=="number"&&(r[o]=ao[o]);class i{}Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.setPrototypeOf(i,r);const s=Object.create(i);return n.realContext=t,n.debugContext=s,s.debug=!0,s}function Dx(t,e){e=Array.from(e).map(r=>r===void 0?"undefined":r);let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return n=`${n.slice(0,100)}${n.length>100?"...":""}`,`gl.${t}(${n})`}function M$(t,e,n,r){r=Array.from(r).map(a=>a===void 0?"undefined":a);const i=globalThis.WebGLDebugUtils.glEnumToString(e),s=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,r),o=`${i} in gl.${n}(${s})`;he.error(o)();debugger}function N$(t,e,n){let r="";he.level>=1&&(r=Dx(e,n),t.traceWebGL&&he.log(1,r)());for(const i of n)if(i===void 0){r=r||Dx(e,n);debugger}}const sg={};function O$(t="id"){sg[t]=sg[t]||1;const e=sg[t]++;return`${t}-${e}`}class fl extends Ke{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor(e,n={}){super(e,n),this.device=e,this.gl=this.device.gl;const r=typeof n=="object"?n.handle:void 0;this.handle=r||this.gl.createBuffer(),e.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=D$(this.props.usage),this.glUsage=F$(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,n.data?this._initWithData(n.data,n.byteOffset,n.byteLength):this._initWithByteLength(n.byteLength||0)}_initWithData(e,n=0,r=e.byteLength+n){const i=this.glTarget;this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.glUsage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.bytesUsed=r,this.byteLength=r,this._setDebugData(e,n,r),this.trackAllocatedMemory(r)}_initWithByteLength(e){let n=e;e===0&&(n=new Float32Array(0));const r=this.glTarget;return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.glUsage),this.gl.bindBuffer(r,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(e,n=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,n,e),this.gl.bindBuffer(36663,null),this._setDebugData(e,n,e.byteLength)}async readAsync(e=0,n){return this.readSyncWebGL(e,n)}readSyncWebGL(e=0,n){n=n??this.byteLength-e;const r=new Uint8Array(n),i=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,r,i,n),this.gl.bindBuffer(36662,null),this._setDebugData(r,e,n),r}}function D$(t){return t&Ke.INDEX?34963:t&Ke.VERTEX?34962:t&Ke.UNIFORM?35345:34962}function F$(t){return t&Ke.INDEX||t&Ke.VERTEX?35044:t&Ke.UNIFORM?35048:35044}function L$(t){const e=t.split(/\r?\n/),n=[];for(const r of e){if(r.length<=1)continue;const i=r.split(":");if(i.length===2){const[p,g]=i;n.push({message:g.trim(),type:Fx(p),lineNum:0,linePos:0});continue}const[s,o,a,...u]=i;let f=parseInt(a,10);isNaN(f)&&(f=0);let h=parseInt(o,10);isNaN(h)&&(h=0),n.push({message:u.join(":").trim(),type:Fx(s),lineNum:f,linePos:h})}return n}function Fx(t){const e=["warning","error","info"],n=t.toLowerCase();return e.includes(n)?n:"info"}class B$ extends ah{device;handle;constructor(e,n){switch(super(e,n),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>this.compilationStatus)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?L$(e):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es
${e}`;const{gl:n}=this.device;if(n.shaderSource(this.handle,e),n.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}he.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),he.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const e=async i=>await new Promise(s=>setTimeout(s,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:r}=this.device;for(;;){if(r.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function U$(t,e,n,r){if($$(e))return r(t);const i=t;i.pushState();try{return j$(t,e),Vo(i.gl,n),r(t)}finally{i.popState()}}function j$(t,e){const n=t,{gl:r}=n;if(e.cullMode)switch(e.cullMode){case"none":r.disable(2884);break;case"front":r.enable(2884),r.cullFace(1028);break;case"back":r.enable(2884),r.cullFace(1029);break}if(e.frontFace&&r.frontFace(ns("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&r.enable(34383),e.depthBias!==void 0&&(r.enable(32823),r.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){const s=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,o=ns("provokingVertex",e.provokingVertex,{first:36429,last:36430});s?.provokingVertexWEBGL(o)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){const s=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,o=ns("polygonMode",e.polygonMode,{fill:6914,line:6913});s?.polygonModeWEBGL(1028,o),s?.polygonModeWEBGL(1029,o)}e.polygonOffsetLine&&r.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&r.enable(12288),e.clipDistance1&&r.enable(12289),e.clipDistance2&&r.enable(12290),e.clipDistance3&&r.enable(12291),e.clipDistance4&&r.enable(12292),e.clipDistance5&&r.enable(12293),e.clipDistance6&&r.enable(12294),e.clipDistance7&&r.enable(12295)),e.depthWriteEnabled!==void 0&&r.depthMask(V$("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?r.enable(2929):r.disable(2929),r.depthFunc(Cm("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;r.stencilMaskSeparate(1028,i),r.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&he.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,s=Cm("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,s,0,i),r.stencilFuncSeparate(1029,s,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=og("stencilPassOperation",e.stencilPassOperation),s=og("stencilFailOperation",e.stencilFailOperation),o=og("stencilDepthFailOperation",e.stencilDepthFailOperation);r.stencilOpSeparate(1028,s,o,i),r.stencilOpSeparate(1029,s,o,i)}switch(e.blend){case!0:r.enable(3042);break;case!1:r.disable(3042);break}if(e.blendColorOperation||e.blendAlphaOperation){const i=Lx("blendColorOperation",e.blendColorOperation||"add"),s=Lx("blendAlphaOperation",e.blendAlphaOperation||"add");r.blendEquationSeparate(i,s);const o=Eu("blendColorSrcFactor",e.blendColorSrcFactor||"one"),a=Eu("blendColorDstFactor",e.blendColorDstFactor||"zero"),u=Eu("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),f=Eu("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");r.blendFuncSeparate(o,a,u,f)}}function Cm(t,e){return ns(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function og(t,e){return ns(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function Lx(t,e){return ns(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function Eu(t,e){return ns(t,e,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function z$(t,e){return`Illegal parameter ${e} for ${t}`}function ns(t,e,n){if(!(e in n))throw new Error(z$(t,e));return n[e]}function V$(t,e){return e}function $$(t){let e=!0;for(const n in t){e=!1;break}return e}function zE(t){const e={};return t.addressModeU&&(e[10242]=ag(t.addressModeU)),t.addressModeV&&(e[10243]=ag(t.addressModeV)),t.addressModeW&&(e[32882]=ag(t.addressModeW)),t.magFilter&&(e[10240]=Rm(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=W$(t.minFilter||"linear",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type==="comparison-sampler"&&(e[34892]=34894),t.compare&&(e[34893]=Cm("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function ag(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function Rm(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}function W$(t,e="none"){if(!e)return Rm(t);switch(e){case"none":return Rm(t);case"nearest":return t==="nearest"?9984:9986;case"linear":return t==="nearest"?9985:9987}}class Im extends Sl{device;handle;parameters;constructor(e,n){super(e,n),this.device=e,this.parameters=zE(n),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[n,r]of Object.entries(e)){const i=Number(n);switch(i){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,i,r);break;default:this.device.gl.samplerParameteri(this.handle,i,r);break}}}}class uo extends oh{device;gl;handle;texture;constructor(e,n){super(e,{...He.defaultProps,...n}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=n.texture}}const H$="Failed to deduce GL constant from typed array";function X$(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(H$)}}function Y$(t,e){const{clamped:n=!0}=e||{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function VE(t){switch(t){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function q$(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function Bf(t,e,n){if(K$(e))return n(t);const{nocatch:r=!0}=e,i=ts.get(t);i.push(),Vo(t,e);let s;if(r)s=n(t),i.pop();else try{s=n(t)}finally{i.pop()}return s}function K$(t){for(const e in t)return!1;return!0}function Z$(t,e,n){const{dimension:r,width:i,height:s,depth:o=0}=n,{glInternalFormat:a}=n,u=n.glTarget;switch(r){case"2d-array":case"3d":t.texStorage3D(u,e,a,i,s,o);break;default:t.texStorage2D(u,e,a,i,s)}}function Bx(t,e,n,r){const{width:i,height:s}=r,{dimension:o,depth:a=0,mipLevel:u=0}=r,{x:f=0,y:h=0,z:p=0}=r,{glFormat:g,glType:_}=r,v=$E(r.glTarget,o,a),w=r.flipY?{37440:!0}:{};Bf(t,w,()=>{switch(o){case"2d-array":case"3d":t.bindTexture(v,e),t.texSubImage3D(v,u,f,h,p,i,s,a,g,_,n),t.bindTexture(v,null);break;case"2d":case"cube":t.bindTexture(v,e),t.texSubImage2D(v,u,f,h,i,s,g,_,n),t.bindTexture(v,null);break;default:throw new Error(o)}})}function Ux(t,e,n){const{dimension:r,width:i,height:s,depth:o=0,mipLevel:a=0,byteOffset:u=0}=n,{x:f=0,y:h=0,z:p=0}=n,{glFormat:g,glType:_,compressed:v}=n,w=$E(n.glTarget,r,o);switch(r){case"2d-array":case"3d":v?t.compressedTexSubImage3D(w,a,f,h,p,i,s,o,g,e,u):t.texSubImage3D(w,a,f,h,p,i,s,o,g,_,e,u);break;case"2d":case"cube":v?t.compressedTexSubImage2D(w,a,f,h,i,s,g,e,u):t.texSubImage2D(w,a,f,h,i,s,g,_,e,u);break;default:throw new Error(r)}}function Q$(t){switch(t){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(t)}function $E(t,e,n){return e==="cube"?34069+n:t}function J$(t,e){const{sourceX:n=0,sourceY:r=0,sourceAttachment:i=0}=e||{};let{target:s=null,sourceWidth:o,sourceHeight:a,sourceDepth:u,sourceFormat:f,sourceType:h}=e||{};const{framebuffer:p,deleteFramebuffer:g}=WE(t),{gl:_,handle:v}=p;o||=p.width,a||=p.height;const w=p.colorAttachments[i]?.texture;if(!w)throw new Error(`Invalid framebuffer attachment ${i}`);u=w?.depth||1,f||=w?.glFormat||6408,h||=w?.glType||5121,s=tW(s,h,f,o,a),h=h||X$(s);const x=_.bindFramebuffer(36160,v);return _.readBuffer(36064+i),_.readPixels(n,r,o,a,f,h,s),_.readBuffer(36064),_.bindFramebuffer(36160,x||null),g&&p.destroy(),s}function G$(t,e){const{target:n,sourceX:r=0,sourceY:i=0,sourceFormat:s=6408,targetByteOffset:o=0}=e||{};let{sourceWidth:a,sourceHeight:u,sourceType:f}=e||{};const{framebuffer:h,deleteFramebuffer:p}=WE(t);a=a||h.width,u=u||h.height;const g=h;f=f||5121;let _=n;if(!_){const w=VE(s),x=q$(f),T=o+a*u*w*x;_=g.device.createBuffer({byteLength:T})}const v=t.device.createCommandEncoder();return v.copyTextureToBuffer({sourceTexture:t,width:a,height:u,origin:[r,i],destinationBuffer:_,byteOffset:o}),v.destroy(),p&&h.destroy(),_}function WE(t){return t instanceof lh?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:eW(t),deleteFramebuffer:!0}}function eW(t,e){const{device:n,width:r,height:i,id:s}=t;return n.createFramebuffer({...e,id:`framebuffer-for-${s}`,width:r,height:i,colorAttachments:[t]})}function tW(t,e,n,r,i,s){if(t)return t;e||=5121;const o=Y$(e,{clamped:!1}),a=VE(n);return new o(r*i*a)}class hl extends He{device;gl;handle;sampler=void 0;view=void 0;mipmaps;compressed;glTarget;glFormat;glType;glInternalFormat;textureUnit=0;constructor(e,n){super(e,n);const r={...this.props};r.data=n.data,this.device=e,this.gl=this.device.gl,this.glTarget=Q$(this.props.dimension);const i=BE(this.props.format);this.glInternalFormat=i.internalFormat,this.glFormat=i.format,this.glType=i.type,this.compressed=i.compressed,this.mipmaps=!!this.props.mipmaps,this._initialize(r),Object.seal(this)}_initialize(e){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:e.data});let{width:n,height:r}=e;if(!n||!r){const i=He.getTextureDataSize(e.data);n=i?.width||1,r=i?.height||1}if(this.width=n,this.height=r,this.depth=e.depth,this.setSampler(e.sampler),this.view=new uo(this.device,{...this.props,texture:this}),this.bind(),Z$(this.gl,this.mipLevels,this),e.data)switch(e.dimension){case"1d":this.setTexture1DData(e.data);break;case"2d":this.setTexture2DData(e.data);break;case"3d":this.setTexture3DData(e.data);break;case"cube":this.setTextureCubeData(e.data);break;case"2d-array":this.setTextureArrayData(e.data);break;case"cube-array":this.setTextureCubeArrayData(e.data);break;default:throw new Error(e.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new uo(this.device,{...e,texture:this})}setSampler(e={}){let n;e instanceof Im?(this.sampler=e,n=e.props):(this.sampler=new Im(this.device,e),n=e);const r=zE(n);this._setSamplerParameters(r)}generateMipmap(e){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(he.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!e?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(r){he.warn(`Error generating mipmap for ${this}: ${r.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(e){const n=He.getExternalImageSize(e.image),r={...He.defaultCopyExternalImageOptions,...n,...e},{image:i,depth:s,mipLevel:o,x:a,y:u,z:f,flipY:h}=r;let{width:p,height:g}=r;const{dimension:_,glTarget:v,glFormat:w,glInternalFormat:x,glType:T}=this;if(p=Math.min(p,this.width-a),g=Math.min(g,this.height-u),e.sourceX||e.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return Bx(this.device.gl,this.handle,i,{dimension:_,mipLevel:o,x:a,y:u,z:f,width:p,height:g,depth:s,glFormat:w,glType:T,glTarget:v,flipY:h}),{width:r.width,height:r.height}}setTexture1DData(e){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(e,n=0){this.bind();const r=He.normalizeTextureData(e,this);r.length>1&&this.props.mipmaps!==!1&&he.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let i=0;i<r.length;i++){const s=r[i];this._setMipLevel(n,i,s)}this.unbind()}setTexture3DData(e){if(this.props.dimension!=="3d")throw new Error(this.id);ArrayBuffer.isView(e)&&(this.bind(),Ux(this.device.gl,e,this),this.unbind())}setTextureCubeData(e,n=0){if(this.props.dimension!=="cube")throw new Error(this.id);for(const r of He.CubeFaces)this.setTextureCubeFaceData(e[r],r)}setTextureArrayData(e){throw this.props.dimension!=="2d-array"?new Error(this.id):new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(e){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(e,n,r=0){Array.isArray(e)&&e.length>1&&this.props.mipmaps!==!1&&he.warn(`${this.id} has mipmap and multiple LODs.`)();const i=He.CubeFaces.indexOf(n);this.setTexture2DData(e,i)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:o,format:a=6408,type:u=5121}=e,{gl:f}=this,h=s||o;this.bind(),h instanceof Promise?h.then(p=>this.setImageDataForFace(Object.assign({},e,{face:n,data:p,pixels:p}))):this.width||this.height?f.texImage2D(n,0,a,r,i,0,a,u,h):f.texImage2D(n,0,a,a,u,h)}_getImageDataMap(e){for(let n=0;n<He.CubeFaces.length;++n){const r=He.CubeFaces[n];e[r]&&(e[34069+n]=e[r],delete e[r])}return e}_setSamplerParameters(e){he.log(1,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[n,r]of Object.entries(e)){const i=Number(n),s=r;switch(i){case 33082:case 33083:this.gl.texParameterf(this.glTarget,i,s);break;case 10241:this.gl.texParameteri(this.glTarget,i,s);break;case 10242:case 10243:this.gl.texParameteri(this.glTarget,i,s);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,i,s);break;default:this.gl.texParameteri(this.glTarget,i,s);break}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(e,n,r,i=this.glTarget){if(He.isExternalImage(r)){Bx(this.device.gl,this.handle,r,{...this,depth:e,mipLevel:n,glTarget:i,flipY:this.props.flipY});return}if(He.isTextureLevelData(r)){Ux(this.device.gl,r.data,{...this,depth:e,mipLevel:n,glTarget:i});return}throw new Error("Texture: invalid image data")}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(e){const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.glTarget,this.handle),e}unbind(e){const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.glTarget,null),e}}const nW=[1,2,4,8];class rW extends Xi{device;glParameters;constructor(e,n){super(e,n),this.device=e;let r;if(!n?.parameters?.viewport)if(n?.framebuffer){const{width:s,height:o}=n.framebuffer;r=[0,0,s,o]}else{const[s,o]=e.getCanvasContext().getDrawingBufferSize();r=[0,0,s,o]}if(this.device.pushState(),this.setParameters({viewport:r,...this.props.parameters}),this.props.framebuffer?.handle)if(this.props.framebuffer){const s=this.props.framebuffer.colorAttachments.map((o,a)=>36064+a);this.device.gl.drawBuffers(s)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){const n={...this.glParameters};n.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(n.depthMask=!this.props.depthReadOnly),n.stencilMask=this.props.stencilReadOnly?0:1,n[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(n.viewport=e.viewport.slice(0,4),n.depthRange=[e.viewport[4],e.viewport[5]]):n.viewport=e.viewport),e.scissorRect&&(n.scissorTest=!0,n.scissor=e.scissorRect),e.blendConstant&&(n.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),e[2967]=e.stencilReference),e.colorMask&&(n.colorMask=nW.map(r=>!!(r&e.colorMask))),this.glParameters=n,Vo(this.device.gl,n)}beginOcclusionQuery(e){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){const e={...this.glParameters};let n=0;this.props.clearColors&&this.props.clearColors.forEach((r,i)=>{r&&this.clearColorBuffer(i,r)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(n|=16384,e.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(n|=256,e.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(n|=1024,e.clearStencil=this.props.clearStencil),n!==0&&Bf(this.device.gl,e,()=>{this.device.gl.clear(n)})}clearColorBuffer(e=0,n=[0,0,0,0]){Bf(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(n.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,n);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,n);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,n);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}function iW(t){return sW.includes(t)}const sW=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],HE={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function XE(t){const e=HE[t];if(!e)throw new Error("uniform");const[n,r,,i]=e;return{format:i,components:r,glType:n}}function oW(t){const e=HE[t];if(!e)throw new Error("attribute");const[,n,,r,i]=e;return{attributeType:r,vertexFormat:i,components:n}}function aW(t,e){const n={attributes:[],bindings:[]};n.attributes=lW(t,e);const r=fW(t,e);for(const a of r){const u=a.uniforms.map(f=>({name:f.name,format:f.format,byteOffset:f.byteOffset,byteStride:f.byteStride,arrayLength:f.arrayLength}));n.bindings.push({type:"uniform",name:a.name,group:0,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:u})}const i=uW(t,e);let s=0;for(const a of i)if(iW(a.type)){const{viewDimension:u,sampleType:f}=dW(a.type);n.bindings.push({type:"texture",name:a.name,group:0,location:s,viewDimension:u,sampleType:f}),a.textureUnit=s,s+=1}i.length&&(n.uniforms=i);const o=cW(t,e);return o?.length&&(n.varyings=o),n}function lW(t,e){const n=[],r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){const s=t.getActiveAttrib(e,i);if(!s)throw new Error("activeInfo");const{name:o,type:a}=s,u=t.getAttribLocation(e,o);if(u>=0){const{attributeType:f}=oW(a),h=/instance/i.test(o)?"instance":"vertex";n.push({name:o,location:u,stepMode:h,type:f})}}return n.sort((i,s)=>i.location-s.location),n}function cW(t,e){const n=[],r=t.getProgramParameter(e,35971);for(let i=0;i<r;i++){const s=t.getTransformFeedbackVarying(e,i);if(!s)throw new Error("activeInfo");const{name:o,type:a,size:u}=s,{glType:f,components:h}=XE(a),p={location:i,name:o,type:f,size:u*h};n.push(p)}return n.sort((i,s)=>i.location-s.location),n}function uW(t,e){const n=[],r=t.getProgramParameter(e,35718);for(let i=0;i<r;i++){const s=t.getActiveUniform(e,i);if(!s)throw new Error("activeInfo");const{name:o,size:a,type:u}=s,{name:f,isArray:h}=pW(o);let p=t.getUniformLocation(e,f);const g={location:p,name:f,size:a,type:u,isArray:h};if(n.push(g),g.size>1)for(let _=0;_<g.size;_++){const v=`${f}[${_}]`;p=t.getUniformLocation(e,v);const w={...g,name:v,location:p};n.push(w)}}return n}function fW(t,e){const n=(s,o)=>t.getActiveUniformBlockParameter(e,s,o),r=[],i=t.getProgramParameter(e,35382);for(let s=0;s<i;s++){const o={name:t.getActiveUniformBlockName(e,s)||"",location:n(s,35391),byteLength:n(s,35392),vertex:n(s,35396),fragment:n(s,35398),uniformCount:n(s,35394),uniforms:[]},a=n(s,35395)||[],u=t.getActiveUniforms(e,a,35383),f=t.getActiveUniforms(e,a,35384),h=t.getActiveUniforms(e,a,35387),p=t.getActiveUniforms(e,a,35388);for(let g=0;g<o.uniformCount;++g){const _=t.getActiveUniform(e,a[g]);if(!_)throw new Error("activeInfo");o.uniforms.push({name:_.name,format:XE(u[g]).format,type:u[g],arrayLength:f[g],byteOffset:h[g],byteStride:p[g]})}r.push(o)}return r.sort((s,o)=>s.location-o.location),r}const hW={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function dW(t){const e=hW[t];if(!e)throw new Error("sampler");const[n,r]=e;return{viewDimension:n,sampleType:r}}function pW(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const n=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!n||n.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:n[1],length:n[2]?1:0,isArray:!!n[2]}}function gW(t,e,n,r){const i=t;let s=r;s===!0&&(s=1),s===!1&&(s=0);const o=typeof s=="number"?[s]:s;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof r!="number")throw new Error("samplers must be set to integers");return t.uniform1i(e,r);case 5126:return t.uniform1fv(e,o);case 35664:return t.uniform2fv(e,o);case 35665:return t.uniform3fv(e,o);case 35666:return t.uniform4fv(e,o);case 5124:return t.uniform1iv(e,o);case 35667:return t.uniform2iv(e,o);case 35668:return t.uniform3iv(e,o);case 35669:return t.uniform4iv(e,o);case 35670:return t.uniform1iv(e,o);case 35671:return t.uniform2iv(e,o);case 35672:return t.uniform3iv(e,o);case 35673:return t.uniform4iv(e,o);case 5125:return i.uniform1uiv(e,o,1);case 36294:return i.uniform2uiv(e,o,2);case 36295:return i.uniform3uiv(e,o,3);case 36296:return i.uniform4uiv(e,o,4);case 35674:return t.uniformMatrix2fv(e,!1,o);case 35675:return t.uniformMatrix3fv(e,!1,o);case 35676:return t.uniformMatrix4fv(e,!1,o);case 35685:return i.uniformMatrix2x3fv(e,!1,o);case 35686:return i.uniformMatrix2x4fv(e,!1,o);case 35687:return i.uniformMatrix3x2fv(e,!1,o);case 35688:return i.uniformMatrix3x4fv(e,!1,o);case 35689:return i.uniformMatrix4x2fv(e,!1,o);case 35690:return i.uniformMatrix4x3fv(e,!1,o)}throw new Error("Illegal uniform")}function mW(t){return AE(t)!==null||typeof t=="number"||typeof t=="boolean"}function _W(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(n=>{const r=t[n];mW(r)?e.uniforms[n]=r:e.bindings[n]=r}),e}function yW(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(t)}}function vW(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(t)}}const jx=4;class bW extends Ro{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(e,n){super(e,n),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=n.vs,this.fs=n.fs;const{varyings:r,bufferMode:i=35981}=n;r&&r.length>0&&(this.varyings=r,this.device.gl.transformFeedbackVaryings(this.handle,r,i)),this._linkShaders(),he.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=aW(this.device.gl,this.handle),he.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=wW(this.introspectedLayout,n.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(e,n){for(const[r,i]of Object.entries(e)){const s=this.shaderLayout.bindings.find(o=>o.name===r)||this.shaderLayout.bindings.find(o=>o.name===`${r}Uniforms`);if(!s){const o=this.shaderLayout.bindings.map(a=>`"${a.name}"`).join(", ");n?.disableWarnings||he.warn(`No binding "${r}" in render pipeline "${this.id}", expected one of ${o}`,i)();continue}switch(i||he.warn(`Unsetting binding "${r}" in render pipeline "${this.id}"`)(),s.type){case"uniform":if(!(i instanceof fl)&&!(i.buffer instanceof fl))throw new Error("buffer value");break;case"texture":if(!(i instanceof uo||i instanceof hl||i instanceof ul))throw new Error("texture value");break;case"sampler":he.warn(`Ignoring sampler ${r}`)();break;default:throw new Error(s.type)}this.bindings[r]=i}}draw(e){const{renderPass:n,parameters:r=this.props.parameters,topology:i=this.props.topology,vertexArray:s,vertexCount:o,instanceCount:a,isInstanced:u=!1,firstVertex:f=0,transformFeedback:h}=e,p=yW(i),g=!!s.indexBuffer,_=s.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return he.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return he.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),s.bindBeforeRender(n),h&&h.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const v=n;return U$(this.device,r,v.glParameters,()=>{g&&u?this.device.gl.drawElementsInstanced(p,o||0,_,f,a||0):g?this.device.gl.drawElements(p,o||0,_,f):u?this.device.gl.drawArraysInstanced(p,f,o||0,a||0):this.device.gl.drawArrays(p,f,o||0),h&&h.end()}),s.unbindAfterRender(n),!0}setUniformsWebGL(e){const{bindings:n}=_W(e);Object.keys(n).forEach(r=>{he.warn(`Unsupported value "${JSON.stringify(n[r])}" used in setUniforms() for key ${r}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,e)}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),he.time(jx,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),he.timeEnd(jx,`linkProgram for ${this.id}`)(),he.level,!this.device.features.has("compilation-status-async-webgl")){const r=this._getLinkStatus();this._reportLinkStatus(r);return}he.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),he.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const n=this._getLinkStatus();this._reportLinkStatus(n)}async _reportLinkStatus(e){switch(e){case"success":return;default:switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then(()=>this.vs.debugShader());break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then(()=>this.fs.debugShader());break}const n=this.device.gl.getProgramInfoLog(this.handle);throw new Error(`Error during ${e}: ${n}`)}}_getLinkStatus(){const{gl:e}=this.device;return e.getProgramParameter(this.handle,35714)?(e.validateProgram(this.handle),e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){const e=async i=>await new Promise(s=>setTimeout(s,i));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:r}=this.device;for(;;){if(r.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const n of this.shaderLayout.bindings)!this.bindings[n.name]&&!this.bindings[n.name.replace(/Uniforms$/,"")]&&(he.warn(`Binding ${n.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:e}=this.device;e.useProgram(this.handle);let n=0,r=0;for(const i of this.shaderLayout.bindings){const s=this.bindings[i.name]||this.bindings[i.name.replace(/Uniforms$/,"")];if(!s)throw new Error(`No value for binding ${i.name} in ${this.id}`);switch(i.type){case"uniform":const{name:o}=i,a=e.getUniformBlockIndex(this.handle,o);if(a===4294967295)throw new Error(`Invalid uniform block name ${o}`);e.uniformBlockBinding(this.handle,r,a),s instanceof fl?e.bindBufferBase(35345,r,s.handle):e.bindBufferRange(35345,r,s.buffer.handle,s.offset||0,s.size||s.buffer.byteLength-s.offset),r+=1;break;case"texture":if(!(s instanceof uo||s instanceof hl||s instanceof ul))throw new Error("texture");let u;if(s instanceof uo)u=s.texture;else if(s instanceof hl)u=s;else if(s instanceof ul&&s.colorAttachments[0]instanceof uo)he.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),u=s.colorAttachments[0].texture;else throw new Error("No texture");e.activeTexture(33984+n),e.bindTexture(u.glTarget,u.handle),n+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${i.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:n,location:r,type:i,textureUnit:s}=e,o=this.uniforms[n]??s;o!==void 0&&gW(this.device.gl,r,i,o)}}}function wW(t,e){const n={...t,attributes:t.attributes.map(r=>({...r}))};for(const r of e?.attributes||[]){const i=n.attributes.find(s=>s.name===r.name);i?(i.type=r.type||i.type,i.stepMode=r.stepMode||i.stepMode):he.warn(`shader layout attribute ${r.name} not present in shader`)}return n}class xW extends A_{device;commands=[];constructor(e){super(e,{}),this.device=e}submitCommands(e=this.commands){for(const n of e)switch(n.name){case"copy-buffer-to-buffer":TW(this.device,n.options);break;case"copy-buffer-to-texture":SW(this.device,n.options);break;case"copy-texture-to-buffer":EW(this.device,n.options);break;case"copy-texture-to-texture":AW(this.device,n.options);break;default:throw new Error(n.name)}}}function TW(t,e){const n=e.sourceBuffer,r=e.destinationBuffer;t.gl.bindBuffer(36662,n.handle),t.gl.bindBuffer(36663,r.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function SW(t,e){throw new Error("Not implemented")}function EW(t,e){const{sourceTexture:n,mipLevel:r=0,aspect:i="all",width:s=e.sourceTexture.width,height:o=e.sourceTexture.height,depthOrArrayLayers:a=0,origin:u=[0,0],destinationBuffer:f,byteOffset:h=0,bytesPerRow:p,rowsPerImage:g}=e;if(i!=="all")throw new Error("aspect not supported in WebGL");if(r!==0||a!==0||p||g)throw new Error("not implemented");const{framebuffer:_,destroyFramebuffer:v}=YE(n);let w;try{const x=f,T=s||_.width,A=o||_.height,E=BE(_.colorAttachments[0].texture.props.format),R=E.format,k=E.type;t.gl.bindBuffer(35051,x.handle),w=t.gl.bindFramebuffer(36160,_.handle),t.gl.readPixels(u[0],u[1],T,A,R,k,h)}finally{t.gl.bindBuffer(35051,null),w!==void 0&&t.gl.bindFramebuffer(36160,w),v&&_.destroy()}}function AW(t,e){const{sourceTexture:n,destinationMipLevel:r=0,origin:i=[0,0],destinationOrigin:s=[0,0],destinationTexture:o}=e;let{width:a=e.destinationTexture.width,height:u=e.destinationTexture.height}=e;const{framebuffer:f,destroyFramebuffer:h}=YE(n),[p,g]=i,[_,v,w]=s,x=t.gl.bindFramebuffer(36160,f.handle);let T=null,A;if(o instanceof hl)T=o,a=Number.isFinite(a)?a:T.width,u=Number.isFinite(u)?u:T.height,T.bind(0),A=T.glTarget;else throw new Error("invalid destination");switch(A){case 3553:case 34067:t.gl.copyTexSubImage2D(A,r,_,v,p,g,a,u);break;case 35866:case 32879:t.gl.copyTexSubImage3D(A,r,_,v,w,p,g,a,u);break}T&&T.unbind(),t.gl.bindFramebuffer(36160,x),h&&f.destroy()}function YE(t){if(t instanceof He){const{width:e,height:n,id:r}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${r}`,width:e,height:n,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}class CW extends E_{device;commandBuffer;constructor(e,n){super(e,n),this.device=e,this.commandBuffer=new xW(e)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,n,r){}}function RW(t){const{target:e,source:n,start:r=0,count:i=1}=t,s=n.length,o=i*s;let a=0;for(let u=r;a<s;a++)e[u++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return t.target}class J_ extends C_{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return OL()==="Chrome"}constructor(e,n){super(e,n),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const n=e;if(n&&n.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,n?n.handle:null),this.indexBuffer=n,this.device.gl.bindVertexArray(null)}setBuffer(e,n){const r=n;if(r.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:i,type:s,stride:o,offset:a,normalized:u,integer:f,divisor:h}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,r.handle),f?this.device.gl.vertexAttribIPointer(e,i,s,o,a):this.device.gl.vertexAttribPointer(e,i,s,u,o,a),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,h||0),this.attributes[e]=r,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,n){this._enable(e,!1),this.attributes[e]=n}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const n=this.attributes[e];ArrayBuffer.isView(n)&&this.device.setConstantAttributeWebGL(e,n)}}_getAccessor(e){const n=this.attributeInfos[e];if(!n)throw new Error(`Unknown attribute location ${e}`);const r=LE(n.bufferDataType);return{size:n.bufferComponents,type:r,stride:n.byteStride,offset:n.byteOffset,normalized:n.normalized,integer:n.integer,divisor:n.stepMode==="instance"?1:0}}_enable(e,n=!0){const i=J_.isConstantAttributeZeroSupported(this.device)||e!==0;(n||i)&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),n?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,n){const r=IW(n),i=r.byteLength*e,s=r.length*e;if(this.buffer&&i!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${i} !== ${this.buffer.byteLength}.`);let o=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:i}),o=o||!kW(r,this.bufferValue),o){const a=RU(n.constructor,s);RW({target:a,source:r,start:0,count:s}),this.buffer.write(a),this.bufferValue=n}return this.buffer}}function IW(t){return Array.isArray(t)?new Float32Array(t):t}function kW(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}class PW extends R_{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,n){super(e,n),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,n.buffers&&this.setBuffers(n.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(vW(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])})}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteLength:s,byteOffset:o}=this._getBufferRange(n);if(r<0){this.unusedBuffers[e]=i,he.warn(`${this.id} unusedBuffers varying buffer ${e}`)();return}this.buffers[r]={buffer:i,byteLength:s,byteOffset:o},this.bindOnUse||this._bindBuffer(r,i,o,s)}getBuffer(e){if(zx(e))return this.buffers[e]||null;const n=this._getVaryingIndex(e);return n>=0?this.buffers[n]:null}bind(e=this.handle){if(typeof e!="function")return this.gl.bindTransformFeedback(36386,e),this;let n;return this._bound?n=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,n=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),n}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof fl)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:n,byteOffset:r=0,byteLength:i=e.buffer.byteLength}=e;return{buffer:n,byteOffset:r,byteLength:i}}_getVaryingIndex(e){if(zx(e))return Number(e);for(const n of this.layout.varyings)if(e===n.name)return n.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:n,byteLength:r,byteOffset:i}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),n,i,r)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,n,r=0,i){const s=n&&n.handle;!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i)}}function zx(t){return typeof t=="number"?Number.isInteger(t):/^\d+$/.test(t)}class MW extends I_{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,n){if(super(e,n),this.device=e,n.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}}class fo extends yi{type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;constructor(e){super({...e,id:e.id||O$("webgl-device")});const n=yi._getCanvasContextProps(e);if(!n)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let r=n.canvas?.gl?.device;if(r)throw new Error(`WebGL context already attached to device ${r.id}`);this.canvasContext=new T$(this,n),this.lost=new Promise(h=>{this._resolveContextLost=h});const i={...e.webgl};n.alphaMode==="premultiplied"&&(i.premultipliedAlpha=!0),e.powerPreference!==void 0&&(i.powerPreference=e.powerPreference);const o=this.props._handle||r$(this.canvasContext.canvas,{onContextLost:h=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:h=>console.log("WebGL context restored")},i);if(!o)throw new Error("WebGL context creation failed");if(r=o.device,r){if(e._reuseDevices)return he.log(1,`Not creating a new Device, instead returning a reference to Device ${r.id} already attached to WebGL context`,r)(),r._reused=!0,r;throw new Error(`WebGL context already attached to device ${r.id}`)}this.handle=o,this.gl=o,this.spectorJS=A$({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=i$(this.gl,this._extensions),this.limits=new b$(this.gl),this.features=new v$(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),n.autoResize!==!1&&this.canvasContext.resize(),new ts(this.gl,{log:(...h)=>he.log(1,...h)()}).trackState(this.gl,{copyState:!1});const u=e.debugWebGL||e.debug,f=e.debugWebGL;u&&(this.gl=I$(this.gl,{debugWebGL:u,traceWebGL:f}),he.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(he.level=Math.max(he.level,1)))}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const n=this._normalizeBufferProps(e);return new fl(this,n)}createTexture(e){return new hl(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new Im(this,e)}createShader(e){return new B$(this,e)}createFramebuffer(e){return new ul(this,e)}createVertexArray(e){return new J_(this,e)}createTransformFeedback(e){return new PW(this,e)}createQuerySet(e){return new MW(this,e)}createRenderPipeline(e){return new bW(this,e)}beginRenderPass(e){return new rW(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(e={}){return new CW(this,e)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(e,n){return J$(e,n)}readPixelsToBufferWebGL(e,n){return G$(e,n)}setParametersWebGL(e){Vo(this.gl,e)}getParametersWebGL(e){return DE(this.gl,e)}withParametersWebGL(e,n){return Bf(this.gl,e,n)}resetWebGL(){he.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),JV(this.gl)}_getDeviceSpecificTextureFormatCapabilities(e){return g$(this.gl,e,this._extensions)}loseDevice(){let e=!1;const r=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return r&&(e=!0,r.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){ts.get(this.gl).push()}popState(){ts.get(this.gl).pop()}setSpectorMetadata(e,n){e.__SPECTOR_Metadata=n}getGLKey(e,n){const r=Number(e);for(const i in this.gl)if(this.gl[i]===r)return`GL.${i}`;return n?.emptyIfUnknown?"":String(e)}getGLKeys(e){const n={emptyIfUnknown:!0};return Object.entries(e).reduce((r,[i,s])=>(r[`${i}:${this.getGLKey(i,n)}`]=`${s}:${this.getGLKey(s,n)}`,r),{})}_constants;setConstantAttributeWebGL(e,n){const r=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(r).fill(null);const i=this._constants[e];switch(i&&FW(i,n)&&he.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=n,n.constructor){case Float32Array:NW(this,e,n);break;case Int32Array:OW(this,e,n);break;case Uint32Array:DW(this,e,n);break;default:throw new Error("constant")}}getExtension(e){return Lo(this.gl,e,this._extensions),this._extensions}}function NW(t,e,n){switch(n.length){case 1:t.gl.vertexAttrib1fv(e,n);break;case 2:t.gl.vertexAttrib2fv(e,n);break;case 3:t.gl.vertexAttrib3fv(e,n);break;case 4:t.gl.vertexAttrib4fv(e,n);break}}function OW(t,e,n){t.gl.vertexAttribI4iv(e,n)}function DW(t,e,n){t.gl.vertexAttribI4uiv(e,n)}function FW(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}const LW={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},BW=t=>({drawBuffersWEBGL(e){return t.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),UW=t=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return t.createVertexArray()},deleteVertexArrayOES(e){return t.deleteVertexArray(e)},isVertexArrayOES(e){return t.isVertexArray(e)},bindVertexArrayOES(e){return t.bindVertexArray(e)}}),jW=t=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return t.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return t.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return t.vertexAttribDivisor(...e)}});function zW(t=!0){const e=HTMLCanvasElement.prototype;if(!t&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(n,r){if(n==="webgl"||n==="experimental-webgl"){const i=this.originalGetContext("webgl2",r);return i instanceof HTMLElement&&VW(i),i}return this.originalGetContext(n,r)}}function VW(t){t.getExtension("EXT_color_buffer_float");const e={...LW,WEBGL_disjoint_timer_query:t.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:BW(t),OES_vertex_array_object:UW(t),ANGLE_instanced_arrays:jW(t)},n=t.getExtension;t.getExtension=function(i){const s=n.call(t,i);return s||(i in e?e[i]:null)};const r=t.getSupportedExtensions;t.getSupportedExtensions=function(){return(r.apply(t)||[])?.concat(Object.keys(e))}}const Au=1;class $W extends iU{type="webgl";constructor(){super(),yi.defaultProps={...yi.defaultProps,...Q_},fo.adapter=this}isSupported(){return typeof WebGL2RenderingContext<"u"}enforceWebGL2(e){zW(e)}async attach(e){if(e instanceof fo)return e;if(e?.device instanceof yi)return e.device;if(!WW(e))throw new Error("Invalid WebGL2RenderingContext");return new fo({_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1}})}async create(e={}){he.groupCollapsed(Au,"WebGLDevice created")();const n=[];(e.debugWebGL||e.debug)&&n.push(R$()),e.debugSpectorJS&&n.push(E$(e));const r=await Promise.allSettled(n);for(const o of r)o.status==="rejected"&&he.error(`Failed to initialize debug libraries ${o.reason}`)();const i=new fo(e),s=`${i._reused?"Reusing":"Created"} device with WebGL2 ${i.debug?"debug ":""}context: ${i.info.vendor}, ${i.info.renderer} for canvas: ${i.canvasContext.id}`;return he.probe(Au,s)(),he.table(Au,i.info)(),he.groupEnd(Au)(),i}}function WW(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}const Vx=new $W;function hi(){}const HW=({isDragging:t})=>t?"grabbing":"grab",qE={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:hi,onWebGLInitialized:hi,onResize:hi,onViewStateChange:hi,onInteractionStateChange:hi,onBeforeRender:hi,onAfterRender:hi,onLoad:hi,onError:t=>Ve.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:HW,getTooltip:null,debug:!1,drawPickingColors:!1};class G_{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new rh({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=r=>{const{_pickRequest:i}=this;if(r.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(r.leftButton||r.rightButton)return;{const s=r.offsetCenter;if(!s)return;i.x=s.x,i.y=s.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=r},this._onEvent=r=>{const i=bm[r.type],s=r.offsetCenter;if(!i||!s||!this.layerManager)return;const o=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:s.x,y:s.y,layers:o,viewports:this.getViewports(s)},this._lastPointerDownInfo),{layer:u}=a,f=u&&(u[i]||u.props[i]),h=this.props[i];let p=!1;f&&(p=f.call(u,a,r)),p||(h?.(a,r),this.widgetManager.onEvent(a,r))},this._onPointerDown=r=>{if(this.device?.type==="webgpu")return;const i=r.offsetCenter,s=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=s.result[0]||s.emptyInfo},this.props={...qE,...e},e=this.props,e.viewState&&e.initialViewState&&Ve.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let n=this.device;!n&&e.gl&&(e.gl instanceof WebGLRenderingContext&&Ve.error("WebGL1 context not supported.")(),n=Vx.attach(e.gl)),n||(n=um.createDevice({type:"best-available",_reuseDevices:!0,adapters:[Vx],...e.deviceProps,createCanvasContext:{canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!1}})),this.animationLoop=this._createAnimationLoop(n,e),this.setProps(e),e._typedArrayManagerProps&&Rl.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Ve.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Ve.removed("onLayerClick","onClick")(),e.initialViewState&&!Kt(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop?.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n),this.widgetManager.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Lt(this.viewManager),this.viewManager.views}getViewports(e){return Lt(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,n,r){Lt(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Lt(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const i=Number.isFinite(n)?`${n}px`:n;this.canvas.style.width=i}if(r||r===0){const i=Number.isFinite(r)?`${r}px`:r;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=i}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const n=e.clientWidth??e.width,r=e.clientHeight??e.height;(n!==this.width||r!==this.height)&&(this.width=n,this.height=r,this.viewManager?.setProps({width:n,height:r}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:n,height:r}))}_createAnimationLoop(e,n){const{gl:r,onError:i,useDevicePixels:s}=n;return new Xz({device:e,useDevicePixels:s,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,onInitialize:o=>this._setDevice(o.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,n=Array.isArray(e)?e:e?[e]:[new ME({id:"default-view"})];return n.length&&this.props.controller&&(n[0].props.controller=this.props.controller),n}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if(this.device?.type==="webgpu")return;const{_pickRequest:e}=this;if(e.event){const{result:n,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=n.length>0;let i=r,s=!1;for(const o of n)i=o,s=o.layer?.onHover(o,e.event)||s;s||(this.props.onHover?.(i,e.event),this.widgetManager.onHover(i,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);const n=new EE;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new _7(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(lx).map(i=>{const[s,o,a,u]=lx[i],f=this.props.eventRecognizerOptions?.[i],h={...o,...f,event:i};return{recognizer:new s(h),recognizeWith:a,requestFailure:u}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in bm)this.eventManager.on(i,this._onEvent);this.viewManager=new yV({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new _V(this.device,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new OV({deck:this,device:this.device}),this.deckRenderer=new LV(this.device),this.deckPicker=new $V(this.device),this.widgetManager=new XV({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new qV),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{device:r,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:r,gl:i});const s={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n};this.deckRenderer?.renderLayers(s),s.pass==="screen"&&this.widgetManager.onRedraw({viewports:s.viewports,layers:s.layers}),this.props.onAfterRender({device:r,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Ve.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=um.stats.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}G_.defaultProps=qE;G_.VERSION=u8;function XW(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return TS(t)}}const YW=xS;function Cu(t,e,n){const r=n==="webgpu"&&e.type==="uint8"?"unorm8":e.type;return{attribute:t,format:e.size>1?`${r}x${e.size}`:e.type,byteOffset:e.offset||0}}function Qi(t){return t.stride||t.size*t.bytesPerElement}function qW(t,e){return t.type===e.type&&t.size===e.size&&Qi(t)===Qi(e)&&(t.offset||0)===(e.offset||0)}function km(t,e){e.offset&&Ve.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=Qi(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function KW(t,e){const n=km(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class ZW{constructor(e,n,r){this._buffer=null,this.device=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i==="float64";let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a="float32":!i&&n.isIndexed?a="uint32":a=i||"float32";let u=XW(i||a);this.doublePrecision=s,s&&n.fp64===!1&&(u=Float32Array),this.value=null,this.settings={...n,defaultType:u,defaultValue:o,logicalType:i,type:a,normalized:a.includes("norm"),size:this.size,bytesPerElement:u.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Qi(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Rl.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,n=null){const r={};if(this.state.constant){const i=this.value;if(n){const s=km(this.getAccessor(),n),o=s.offset/i.BYTES_PER_ELEMENT,a=s.size||this.size;r[e]=i.subarray(o,o+a)}else r[e]=i}else r[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?r[`${e}64Low`]=r[e]:r[`${e}64Low`]=new Float32Array(this.size)),r}_getBufferLayout(e=this.id,n=null){const r=this.getAccessor(),i=[],s={name:this.id,byteStride:Qi(r),attributes:i};if(this.doublePrecision){const o=KW(r,n||{});i.push(Cu(e,{...r,...o.high},this.device.type),Cu(`${e}64Low`,{...r,...o.low},this.device.type))}else if(n){const o=km(r,n);i.push(Cu(e,{...r,...o},this.device.type))}else i.push(Cu(e,r,this.device.type));return s}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let u=0;u<s;)for(let f=0;f<i;f++){const h=n[u++];h<o[f]&&(o[f]=h),h>a[f]&&(a[f]=h)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof Ke?r={buffer:e}:r=e;const i={...this.settings,...r};if(ArrayBuffer.isView(r.value)){if(!r.type)if(this.doublePrecision&&r.value instanceof Float64Array)i.type="float32";else{const o=YW(r.value);i.type=i.normalized?o.replace("int","norm"):o}i.bytesPerElement=r.value.BYTES_PER_ELEMENT,i.stride=Qi(i)}if(n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=ArrayBuffer.isView(s)?s:new Float32Array(s)}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s;let{buffer:o}=this;const a=Qi(i),u=(i.vertexOffset||0)*a;if(this.doublePrecision&&s instanceof Float64Array&&(s=Jp(s,i)),this.settings.isIndexed){const h=this.settings.defaultType;s.constructor!==h&&(s=new h(s))}const f=s.byteLength+u+a*2;(!o||o.byteLength<f)&&(o=this._createBuffer(f)),o.write(s,u)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&n instanceof Float64Array?Jp(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),r*n.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=Rl.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{byteOffset:o}=this;let{buffer:a}=this;return(!a||a.byteLength<s.byteLength+o)&&(a=this._createBuffer(s.byteLength+o),n&&i&&a.write(i instanceof Float64Array?Jp(i,this):i,o)),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error(`Attribute ${this.id} value is not TypedArray`);const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${n.constructor.name}`);!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&Ve.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(n=>(n+128)/255*2-1);case"snorm16":return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(n=>n/255);case"unorm16":return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let o=s;for(;--o>=0;)n[r+o]=i[o];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:n,type:r}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(n?Ke.INDEX:Ke.VERTEX)|Ke.COPY_DST,indexType:n?r:void 0,byteLength:e}),this._buffer}}const $x=[],Wx=[];function KE(t,e=0,n=1/0){let r=$x;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(Wx.length=t.length,r=Wx):r=$x,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function ZE(t){return t&&t[Symbol.asyncIterator]}function QW(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,u=r?r/a:n,f=i?i/a:0,h=Math.floor((t.length-f)/u);return(p,{index:g,target:_})=>{if(!s){const T=g*u+f;for(let A=0;A<n;A++)_[A]=t[T+A];return _}const v=s[g],w=s[g+1]||h;let x;if(o){x=new Array(w-v);for(let T=v;T<w;T++){const A=T*u+f;_=new Array(n);for(let E=0;E<n;E++)_[E]=t[A+E];x[T-v]=_}}else if(u===n)x=t.subarray(v*n+f,w*n+f);else{x=new t.constructor((w-v)*n);let T=0;for(let A=v;A<w;A++){const E=A*u+f;for(let R=0;R<n;R++)x[T++]=t[E+R]}}return x}}const JW=[],Wu=[[0,1/0]];function GW(t,e){if(t===Wu||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}const eH={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function QE(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...eH[n],...e,...t,type:n}}class JE extends ZW{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Wu}),this.constant=!1,this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var n;(n=this.state).layoutChanged||(n.layoutChanged=!qW(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return QE(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=GW(this.state.updateRanges,[r,i])}else this.state.updateRanges=Wu}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=JW}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==Wu),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let u=!0;if(o){for(const[f,h]of s)o.call(i,this,{data:n,startRow:f,endRow:h,props:r,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[f,h]of s){const p=Number.isFinite(f)?this.getVertexOffset(f):0,g=Number.isFinite(h)?this.getVertexOffset(h):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:p,endOffset:g})}this._checkAttributeArray()}else u=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),u}setConstantValue(e){return this.device.type==="webgpu"||e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;Lt(ArrayBuffer.isView(o.value),`invalid ${i.accessor}`);const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=QW(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,n=super.getValue();if(!e)return n;for(const r in e)Object.assign(n,super.getValue(r,e[r]));return n}getBufferLayout(e){this.state.layoutChanged=!1;const n=this.settings.shaderAttributes,r=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?r.stepMode=e?e.isInstanced?"instance":"vertex":"instance":r.stepMode=i??"vertex",!n)return r;for(const s in n){const o=super._getBufferLayout(s,n[s]);r.attributes.push(...o.attributes)}return r}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant&&this.context.device.type!=="webgpu")return;const{settings:a,state:u,value:f,size:h,startIndices:p}=e,{accessor:g,transform:_}=a;let v=u.binaryAccessor||(typeof g=="function"?g:s[g]);typeof v!="function"&&(v=()=>v),Lt(typeof v=="function",`accessor "${g}" is not a function`);let w=e.getVertexOffset(r);const{iterable:x,objectInfo:T}=KE(n,r,i);for(const A of x){T.index++;let E=v(A,T);if(_&&(E=_.call(this,E)),p){const R=(T.index<p.length-1?p[T.index+1]:o)-p[T.index];if(E&&Array.isArray(E[0])){let k=w;for(const M of E)e._normalizeValue(M,f,k),k+=h}else E&&E.length>h?f.set(E,w):(e._normalizeValue(E,T.target,0),hV({target:f,source:T.target,start:w,count:R}));w+=R*h}else e._normalizeValue(E,f,w),w+=h}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function lg(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,u=o-r;if(a>u){n.set(e.subarray(0,u),r);return}if(n.set(e,r),!s)return;let f=a;for(;f<u;){const h=s(f,e);for(let p=0;p<i;p++)n[r+f]=h[p]||0,f++}}function tH({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!i||!s)return lg({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const u=r&&((h,p)=>r(h+a,p)),f=Math.min(i.length,s.length);for(let h=1;h<f;h++){const p=i[h]*n,g=s[h]*n;lg({source:t.subarray(o,p),target:e,start:a,end:g,size:n,getData:u}),o=p,a=g}return a<e.length&&lg({source:[],target:e,start:a,size:n,getData:u}),e}function nH(t){const{device:e,settings:n,value:r}=t,i=new JE(e,n);return i.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),i}function GE(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function eA(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function tA(t){t.push(t.shift())}function rH(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;let a=0;const{shaderAttributes:u}=t.settings;if(u)for(const f of Object.values(u))a=Math.max(a,f.vertexOffset??0);return(r.noAlloc?i.length:(e+a)*s)*o}function nA({device:t,source:e,target:n}){return(!n||n.byteLength<e.byteLength)&&(n?.destroy(),n=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),n}function rA({device:t,buffer:e,attribute:n,fromLength:r,toLength:i,fromStartIndices:s,getData:o=a=>a}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,u=n.size*a,f=n.byteOffset,h=n.settings.bytesPerElement<4?f/n.settings.bytesPerElement*4:f,p=n.startIndices,g=s&&p,_=n.isConstant;if(!g&&e&&r>=i)return e;const v=n.value instanceof Float64Array?Float32Array:n.value.constructor,w=_?n.value:new v(n.getBuffer().readSyncWebGL(f,i*v.BYTES_PER_ELEMENT).buffer);if(n.settings.normalized&&!_){const E=o;o=(R,k)=>n.normalizeConstant(E(R,k))}const x=_?(E,R)=>o(w,R):(E,R)=>o(w.subarray(E+f,E+f+u),R),T=e?new Float32Array(e.readSyncWebGL(h,r*4).buffer):new Float32Array(0),A=new Float32Array(i);return tH({source:T,target:A,sourceStartIndices:s,targetStartIndices:p,size:u,getData:x}),(!e||e.byteLength<A.byteLength+h)&&(e?.destroy(),e=t.createBuffer({byteLength:A.byteLength+h,usage:35050})),e.write(A,h),e}class iA{constructor({device:e,attribute:n,timeline:r}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new hh(r),this.attribute=n,this.attributeInTransition=nH(n),this.currentStartIndices=n.startIndices}get inProgress(){return this.transition.inProgress}start(e,n,r=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=rH(this.attribute,n),this.transition.start({...e,duration:r})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class iH extends iA{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type="interpolation",this.transform=lH(e,n)}start(e,n){const r=this.currentLength,i=this.currentStartIndices;if(super.start(e,n,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:s,attribute:o}=this;tA(s),s[0]=rA({device:this.device,buffer:s[0],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),s[1]=nA({device:this.device,source:s[0],target:s[1]}),this.setBuffer(s[1]);const{transform:a}=this,u=a.model;let f=Math.floor(this.currentLength/o.size);sA(o)&&(f/=2),u.setVertexCount(f),o.isConstant?(u.setAttributes({aFrom:s[0]}),u.setConstantAttributes({aTo:o.value})):u.setAttributes({aFrom:s[0],aTo:o.getBuffer()}),a.transformFeedback.setBuffers({vCurrent:s[1]})}onUpdate(){const{duration:e,easing:n}=this.settings,{time:r}=this.transition;let i=r/e;n&&(i=n(i));const{model:s}=this.transform,o={time:i};s.shaderInputs.setProps({interpolation:o}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const sH=`uniform interpolationUniforms {
  float time;
} interpolation;
`,Hx={name:"interpolation",vs:sH,uniformTypes:{time:"f32"}},oH=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,aH=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function sA(t){return t.doublePrecision&&t.value instanceof Float64Array}function lH(t,e){const n=e.size,r=GE(n),i=eA(n),s=e.getBufferLayout();return sA(e)?new hs(t,{vs:aH,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*n}]}],modules:[u9,Hx],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new hs(t,{vs:oH,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:s.attributes[0].format}],modules:[Hx],defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"],disableWarnings:!0})}class cH extends iA{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type="spring",this.texture=gH(e),this.framebuffer=mH(e,this.texture),this.transform=pH(e,n)}start(e,n){const r=this.currentLength,i=this.currentStartIndices;super.start(e,n);const{buffers:s,attribute:o}=this;for(let u=0;u<2;u++)s[u]=rA({device:this.device,buffer:s[u],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});s[2]=nA({device:this.device,source:s[0],target:s[2]}),this.setBuffer(s[1]);const{model:a}=this.transform;a.setVertexCount(Math.floor(this.currentLength/o.size)),o.isConstant?a.setConstantAttributes({aTo:o.value}):a.setAttributes({aTo:o.getBuffer()})}onUpdate(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this,s=this.settings;n.model.setAttributes({aPrev:e[0],aCur:e[1]}),n.transformFeedback.setBuffers({vNext:e[2]});const o={stiffness:s.stiffness,damping:s.damping};n.model.shaderInputs.setProps({spring:o}),n.run({framebuffer:r,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),tA(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(r)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const uH=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,fH={name:"spring",vs:uH,uniformTypes:{damping:"f32",stiffness:"f32"}},hH=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,dH=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function pH(t,e){const n=GE(e.size),r=eA(e.size);return new hs(t,{vs:hH,fs:dH,bufferLayout:[{name:"aPrev",format:r},{name:"aCur",format:r},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[fH],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function gH(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function mH(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const _H={interpolation:iH,spring:cH};class yH{constructor(e,{id:n,timeline:r}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=n,this.device=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){i&&this._removeTransition(e);const o=_H[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,device:this.device}):(Ve.error(`unsupported transition type '${r.type}'`)(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const Xx="attributeManager.invalidate",vH="attributeManager.updateStart",bH="attributeManager.updateEnd",wH="attribute.updateStart",xH="attribute.allocate",TH="attribute.updateEnd";class dh{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){this.mergeBoundsMemoized=$l(Rz),this.id=n,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new yH(e,{id:`${n}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Ft(Xx,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Ft(Xx,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let u=!1;Ft(vH,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const f in this.attributes){const h=this.attributes[f],p=h.settings.accessor;h.startIndices=r,h.numInstances=n,s[f]&&Ve.removed(`props.${f}`,`data.attributes.${f}`)(),h.setExternalBuffer(o[f])||h.setBinaryValue(typeof p=="string"?o[p]:void 0,e.startIndices)||typeof p=="string"&&!o[p]&&h.setConstantValue(s[p])||h.needsUpdate()&&(u=!0,this._updateAttribute({attribute:h,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||h.needsRedraw()}u&&Ft(bH,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const n=e.map(r=>this.attributes[r]?.getBounds());return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(n=>n.getBufferLayout(e))}_add(e,n){for(const r in e){const i=e[r],s={...i,id:r,size:i.isIndexed&&1||i.size||1,...n};this.attributes[r]=new JE(this.device,s)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Ft(wH,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Ft(xH,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Ft(TH,n,r))}}class SH extends hh{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=Pf(n,r,o)}}const Yx=1e-5;function qx(t,e,n,r,i){const s=e-t,a=(n-e)*i,u=-s*r;return a+u+s+e}function EH(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=qx(t[o],e[o],n[o],r,i);return s}return qx(t,e,n,r,i)}function Kx(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class AH extends hh{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=EH(s,o,n,r,i);const u=Kx(a,n),f=Kx(a,o);u<Yx&&f<Yx&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const CH={interpolation:SH,spring:AH};class RH{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const u=s.get(e),{value:f=u.settings.fromValue}=u;n=f,this.remove(e)}if(i=QE(i),!i)return;const o=CH[i.type];if(!o){Ve.error(`unsupported transition type '${i.type}'`)();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function IH(t){const e=t[bi];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error(`Invalid prop ${n}: ${t[n]}`)}}function kH(t,e){const n=ey({newProps:t,oldProps:e,propTypes:t[bi],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=MH(t,e);let i=!1;return r||(i=NH(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:OH(t,e),transitionsChanged:PH(t,e)}}function PH(t,e){if(!t.transitions)return!1;const n={},r=t[bi];let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&Pm(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function ey({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return`${i}.${s} added`;const o=Pm(t[s],e[s],r[s]);if(o)return`${i}.${s} ${o}`}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return`${i}.${s} dropped`;if(!Object.hasOwnProperty.call(t,s)){const o=Pm(t[s],e[s],r[s]);if(o)return`${i}.${s} ${o}`}}return!1}function Pm(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function MH(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function NH(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&Zx(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&Zx(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function OH(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function Zx(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},ey({oldProps:i,newProps:r,triggerName:n})}const DH="count(): argument not an object",FH="count(): argument not a container";function LH(t){if(!UH(t))throw new Error(DH);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(BH(t))return Object.keys(t).length;throw new Error(FH)}function BH(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function UH(t){return t!==null&&typeof t=="object"}function Qx(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const jH={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},Mm={};function zH(t,e,n,r){if(n instanceof He)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const s=e.createTexture({...n,sampler:{...jH,...i,...r},mipmaps:!0});return Mm[s.id]=t,s}function VH(t,e){!e||!(e instanceof He)||Mm[e.id]===t&&(e.delete(),delete Mm[e.id])}const $H={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Nm(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Kt(t,e,1)}},accessor:{validate(t,e){const n=Uf(t);return n==="function"||n===Uf(e.value)},equal(t,e,n){return typeof e=="function"?!0:Kt(t,e,1)}},array:{validate(t,e){return e.optional&&!t||Nm(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Kt(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Kt(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{if(!t)return t;const{dataTransform:r}=n.props;return r?r(t):typeof t.shape=="string"&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.device?null:zH(n.id,r.device,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{VH(n.id,t)}}};function WH(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s?.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=HH(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function HH(t,e){switch(Uf(e)){case"object":return Ba(t,e);case"array":return Ba(t,{type:"array",value:e,compare:!1});case"boolean":return Ba(t,{type:"boolean",value:e});case"number":return Ba(t,{type:"number",value:e});case"function":return Ba(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Ba(t,e){return"type"in e?{name:t,...$H[e.type],...e}:"value"in e?{name:t,type:Uf(e.value),...e}:{name:t,type:"object",value:e}}function Nm(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Uf(t){return Nm(t)?"array":t===null?"null":typeof t}function XH(t,e){let n;for(let s=e.length-1;s>=0;s--){const o=e[s];"extensions"in o&&(n=o.extensions)}const r=Om(t.constructor,n),i=Object.create(r);i[Lf]=t,i[ds]={},i[_i]={};for(let s=0;s<e.length;++s){const o=e[s];for(const a in o)i[a]=o[a]}return Object.freeze(i),i}const YH="_mergedDefaultProps";function Om(t,e){if(!(t instanceof ph.constructor))return{};let n=YH;if(e)for(const i of e){const s=i.constructor;s&&(n+=`:${s.extensionName||s.name}`)}const r=oA(t,n);return r||(t[n]=qH(t,e||[]))}function qH(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=Om(r),s=oA(t,"defaultProps")||{},o=WH(s),a=Object.assign(Object.create(null),i,o.defaultProps),u=Object.assign(Object.create(null),i?.[bi],o.propTypes),f=Object.assign(Object.create(null),i?.[rg],o.deprecatedProps);for(const h of e){const p=Om(h.constructor);p&&(Object.assign(a,p),Object.assign(u,p[bi]),Object.assign(f,p[rg]))}return KH(a,t),QH(a,u),ZH(a,f),a[bi]=u,a[rg]=f,e.length===0&&!ty(t,"_propTypes")&&(t._propTypes=u),a}function KH(t,e){const n=GH(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function ZH(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i=`${this.id}: ${n}`;for(const s of e[n])ty(this,s)||(this[s]=r);Ve.deprecated(i,e[n].join("/"))()}})}function QH(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=JH(o))}t[yo]=n,t[ds]={},Object.defineProperties(t,r)}function JH(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||ZE(e)?this[ds][t]=e:this[_i][t]=e},get(){if(this[_i]){if(t in this[_i])return this[_i][t]||this[yo][t];if(t in this[ds]){const e=this[Lf]&&this[Lf].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[yo][t]}}return this[yo][t]}}}function ty(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function oA(t,e){return ty(t,e)&&t[e]}function GH(t){const e=t.componentName;return e||Ve.warn(`${t.name}.componentName not specified`)(),e||t.name}let eX=0;class ph{constructor(...e){this.props=XH(this,e),this.id=this.props.id,this.count=eX++}clone(e){const{props:n}=this,r={};for(const i in n[yo])i in n[_i]?r[i]=n[_i][i]:i in n[ds]&&(r[i]=n[ds][i]);return new this.constructor({...n,...r,...e})}}ph.componentName="Component";ph.defaultProps={};const tX=Object.freeze({});class nX{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||tX}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[Lf]||this.component;const n=e[_i]||{},r=e[ds]||e,i=e[yo]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(ZE(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){if(!this.component)return;const{dataTransform:u}=this.component.props;u?s=u(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[bi];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class rX extends nX{constructor({attributeManager:e,layer:n}){super(n),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r?.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,`loading ${e} of ${this.layer}`)}}const iX="layer.changeFlag",sX="layer.initialize",oX="layer.update",aX="layer.finalize",lX="layer.matched",Jx=2**24-1,cX=Object.freeze([]),uX=$l(({oldViewport:t,viewport:e})=>t.equals(e));let On=new Uint8ClampedArray(0);const fX={data:{type:"data",value:cX,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;i=i||n.getLoadOptions(),r=r||n.props.loaders,s&&(i={...i,fetch:{...i?.fetch,signal:s}});let a=o.contains(t);return!a&&!i&&(o.add({resourceId:t,data:wf(t,r),persistent:!1}),a=!0),a?o.subscribe({resourceId:t,onChange:u=>n.internalState?.reloadAsyncProp(e,u),consumerId:n.id,requestId:e}):wf(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Fe.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class $o extends ph{constructor(){super(...arguments),this.internalState=null,this.lifecycle=to.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){Lt(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=xE(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=yE(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return Lt(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Lt(this.internalState);const r=this.internalState.viewport||this.context.viewport;return TE(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const n of this.getModels())n.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Fe.DEFAULT||e===Fe.LNGLAT||e===Fe.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Lt(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:LH(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=Qx(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const n of this.props.extensions)e=Qx(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,o=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:u}=n.attributes,f=a||u;f&&(o&&f.constant&&(f.constant=!1,n.invalidate(f.id)),!f.value&&!o&&(f.constant=!0,f.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.destroy();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e.renderPass)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){n&&(e=new Error(`${n}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!uX({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){let n=!1;for(const r in e)e[r].layoutChanged()&&(n=!0);for(const r of this.getModels())this._setModelAttributes(r,e,n)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(On.length/4);if(this.internalState.usesPickingColorCache=!0,r<n){n>Jx&&Ve.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),On=Rl.allocate(On,n,{size:4,copy:!0,maxCount:Math.max(n,Jx)});const i=Math.floor(On.length/4),s=[0,0,0];for(let o=r;o<i;o++)this.encodePickingColor(o,s),On[o*4+0]=s[0],On[o*4+1]=s[1],On[o*4+2]=s[2],On[o*4+3]=0}e.value=On.subarray(0,n*4)}_setModelAttributes(e,n,r=!1){if(!Object.keys(n).length)return;if(r){const a=this.getAttributeManager();e.setBufferLayout(a.getBufferLayouts(e)),n=a.getAttributes()}const i=e.userData?.excludeAttributes||{},s={},o={};for(const a in n){if(i[a])continue;const u=n[a].getValue();for(const f in u){const h=u[f];h instanceof Ke?n[a].settings.isIndexed?e.setIndexBuffer(h):s[f]=h:h&&(o[f]=h)}}e.setAttributes(s),e.setConstantAttributes(o)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,o=s&&n.attributes&&n.attributes[s.id];if(o&&o.value){const a=o.value,u=this.encodePickingColor(e);for(let f=0;f<n.length;f++){const h=s.getVertexOffset(f);a[h]===u[0]&&a[h+1]===u[1]&&a[h+2]===u[2]&&this._disablePickingIndex(f)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(o-s),s)}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==On.buffer&&(r.value=On.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Lt(!this.internalState),Lt(Number.isFinite(this.props.coordinateSystem)),Ft(sX,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new rX({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Ve.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new RH(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Ft(lX,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Ft(oX,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),u=this.getModels();if(r.device)this.updateState(a);else try{this.updateState(a)}catch{}for(const h of this.props.extensions)h.updateState.call(this,a,h);this.setNeedsRedraw(),this._updateAttributes();const f=this.getModels()[0]!==u[0];this._postUpdate(a,f)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Ft(aX,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:n=null,uniforms:r={},parameters:i={}}){this._updateAttributeTransition();const s=this.props,o=this.context;this.props=this.internalState.propsInTransition||s;try{n&&this.setShaderModuleProps(n);const{getPolygonOffset:a}=this.props,u=a&&a(r)||[0,0];o.device instanceof fo&&o.device.setParametersWebGL({polygonOffset:u});for(const f of this.getModels())f.device.type==="webgpu"?f.setParameters({...f.parameters,...i}):f.setParameters(i);if(o.device instanceof fo)o.device.withParametersWebGL(i,()=>{const f={renderPass:e,shaderModuleProps:n,uniforms:r,parameters:i,context:o};for(const h of this.props.extensions)h.draw.call(this,f,h);this.draw(f)});else{const f={renderPass:e,shaderModuleProps:n,uniforms:r,parameters:i,context:o};for(const h of this.props.extensions)h.draw.call(this,f,h);this.draw(f)}}finally{this.props=s}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&Ft(iX,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=kH(e,n);if(r.updateTriggersChanged)for(const i in r.updateTriggersChanged)r.updateTriggersChanged[i]&&this.invalidateAttribute(i);if(r.transitionsChanged)for(const i in r.transitionsChanged)this.internalState.uniformTransitions.add(i,n[i],e[i],e.transitions?.[i]);return this.setChangeFlags(r)}validateProps(){IH(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={highlightedObjectColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.highlightColor=r(e)),this.setShaderModuleProps({picking:n}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new dh(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e,s=this.state.model;s?.isInstanced&&s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:u}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==u){const f={};Array.isArray(u)&&(f.highlightColor=u),(n||i.autoHighlight!==o||a!==i.highlightedObjectIndex)&&(f.highlightedObjectColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setShaderModuleProps({picking:f})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}$o.defaultProps=fX;$o.layerName="Layer";const hX="compositeLayer.renderLayers";class ny extends $o{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){const{opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:u,highlightColor:f,coordinateSystem:h,coordinateOrigin:p,wrapLongitude:g,positionFormat:_,modelMatrix:v,extensions:w,fetch:x,operation:T,_subLayerProps:A}=this.props,E={id:"",updateTriggers:{},opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:u,highlightColor:f,coordinateSystem:h,coordinateOrigin:p,wrapLongitude:g,positionFormat:_,modelMatrix:v,extensions:w,fetch:x,operation:T},R=A&&e.id&&A[e.id],k=R&&R.updateTriggers,M=e.id||"sublayer";if(R){const L=this.props[bi],W=e.type?e.type._propTypes:{};for(const H in R){const X=W[H]||L[H];X&&X.type==="accessor"&&(R[H]=this.getSubLayerAccessor(R[H]))}}Object.assign(E,e,R),E.id=`${this.props.id}-${M}`,E.updateTriggers={all:this.props.updateTriggers?.all,...e.updateTriggers,...k};for(const L of w){const W=L.getSubLayerProps.call(this,L);W&&Object.assign(E,W,{updateTriggers:Object.assign(E.updateTriggers,W.updateTriggers)})}return E}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=Y_(s,Boolean),this.internalState.subLayers=r}Ft(hX,this,i,r);for(const s of r)s.parent=this}}ny.layerName="CompositeLayer";function dX({pointCount:t,getBinId:e}){const n=new Map;for(let r=0;r<t;r++){const i=e(r);if(i===null)continue;let s=n.get(String(i));s?s.points.push(r):(s={id:i,index:n.size,points:[r]},n.set(String(i),s))}return Array.from(n.values())}function pX({bins:t,dimensions:e,target:n}){const r=t.length*e;(!n||n.length<r)&&(n=new Float32Array(r));for(let i=0;i<t.length;i++){const{id:s}=t[i];Array.isArray(s)?n.set(s,i*e):n[i]=s}return n}const gX=t=>t.length,aA=(t,e)=>{let n=0;for(const r of t)n+=e(r);return n},mX=(t,e)=>t.length===0?NaN:aA(t,e)/t.length,_X=(t,e)=>{let n=1/0;for(const r of t){const i=e(r);i<n&&(n=i)}return n},yX=(t,e)=>{let n=-1/0;for(const r of t){const i=e(r);i>n&&(n=i)}return n},vX={COUNT:gX,SUM:aA,MEAN:mX,MIN:_X,MAX:yX};function bX({bins:t,getValue:e,operation:n,target:r}){(!r||r.length<t.length)&&(r=new Float32Array(t.length));let i=1/0,s=-1/0;for(let o=0;o<t.length;o++){const{points:a}=t[o];r[o]=n(a,e),r[o]<i&&(i=r[o]),r[o]>s&&(s=r[o])}return{value:r,domain:[i,s]}}function Gx(t,e,n){const r={};for(const s of t.sources||[]){const o=e[s];if(o)r[s]=wX(o);else throw new Error(`Cannot find attribute ${s}`)}const i={};return s=>{for(const o in r)i[o]=r[o](s);return t.getValue(i,s,n)}}function wX(t){const e=t.value,{offset:n=0,stride:r,size:i}=t.getAccessor(),s=e.BYTES_PER_ELEMENT,o=n/s,a=r?r/s:i;if(i===1)return t.isConstant?()=>e[0]:f=>{const h=o+a*f;return e[h]};let u;return t.isConstant?(u=Array.from(e),()=>u):(u=new Array(i),f=>{const h=o+a*f;for(let p=0;p<i;p++)u[p]=e[h+p];return u})}class xX{constructor(e){this.bins=[],this.binIds=null,this.results=[],this.dimensions=e.dimensions,this.channelCount=e.getValue.length,this.props={...e,binOptions:{},pointCount:0,operations:[],customOperations:[],attributes:{}},this.needsUpdate=!0,this.setProps(e)}destroy(){}get binCount(){return this.bins.length}setProps(e){const n=this.props;if(e.binOptions&&(Kt(e.binOptions,n.binOptions,2)||this.setNeedsUpdate()),e.operations)for(let r=0;r<this.channelCount;r++)e.operations[r]!==n.operations[r]&&this.setNeedsUpdate(r);if(e.customOperations)for(let r=0;r<this.channelCount;r++)!!e.customOperations[r]!=!!n.customOperations[r]&&this.setNeedsUpdate(r);e.pointCount!==void 0&&e.pointCount!==n.pointCount&&this.setNeedsUpdate(),e.attributes&&(e.attributes={...n.attributes,...e.attributes}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate=!0:this.needsUpdate!==!0&&(this.needsUpdate=this.needsUpdate||[],this.needsUpdate[e]=!0)}update(){if(this.needsUpdate===!0){this.bins=dX({pointCount:this.props.pointCount,getBinId:Gx(this.props.getBin,this.props.attributes,this.props.binOptions)});const e=pX({bins:this.bins,dimensions:this.dimensions,target:this.binIds?.value});this.binIds={value:e,type:"float32",size:this.dimensions}}for(let e=0;e<this.channelCount;e++)if(this.needsUpdate===!0||this.needsUpdate[e]){const n=this.props.customOperations[e]||vX[this.props.operations[e]],{value:r,domain:i}=bX({bins:this.bins,getValue:Gx(this.props.getValue[e],this.props.attributes,void 0),operation:n,target:this.results[e]?.value});this.results[e]={value:r,domain:i,type:"float32",size:1},this.props.onUpdate?.({channel:e})}this.needsUpdate=!1}preDraw(){}getBins(){return this.binIds}getResult(e){return this.results[e]}getResultDomain(e){return this.results[e]?.domain??[1/0,-1/0]}getBin(e){const n=this.bins[e];if(!n)return null;const r=new Array(this.channelCount);for(let i=0;i<r.length;i++){const s=this.results[i];r[i]=s?.value[e]}return{id:n.id,value:r,count:n.points.length,pointIndices:n.points}}}function lA(t,e,n){return t.createFramebuffer({width:e,height:n,colorAttachments:[t.createTexture({width:e,height:n,format:"rgba32float",mipmaps:!1,sampler:{minFilter:"nearest",magFilter:"nearest"}})]})}const TX=`uniform binSorterUniforms {
  ivec4 binIdRange;
  ivec2 targetSize;
} binSorter;
`,SX={name:"binSorter",vs:TX,uniformTypes:{binIdRange:"vec4<i32>",targetSize:"vec2<i32>"}},cA=[1,2,4,8],e2=3e38,EX={SUM:0,MEAN:0,MIN:0,MAX:0,COUNT:0},Hu=1024;class AX{constructor(e,n){this.binsFBO=null,this.device=e,this.model=RX(e,n)}get texture(){return this.binsFBO?this.binsFBO.colorAttachments[0].texture:null}destroy(){this.model.destroy(),this.binsFBO?.colorAttachments[0].texture.destroy(),this.binsFBO?.destroy()}getBinValues(e){if(!this.binsFBO)return null;const n=e%Hu,r=Math.floor(e/Hu),i=this.device.readPixelsToArrayWebGL(this.binsFBO,{sourceX:n,sourceY:r,sourceWidth:1,sourceHeight:1}).buffer;return new Float32Array(i)}setDimensions(e,n){const r=Hu,i=Math.ceil(e/r);this.binsFBO?this.binsFBO.height<i&&this.binsFBO.resize({width:r,height:i}):this.binsFBO=lA(this.device,r,i);const s={binIdRange:[n[0][0],n[0][1],n[1]?.[0]||0,n[1]?.[1]||0],targetSize:[this.binsFBO.width,this.binsFBO.height]};this.model.shaderInputs.setProps({binSorter:s})}setModelProps(e){const n=this.model;e.attributes&&n.setAttributes(e.attributes),e.constantAttributes&&n.setConstantAttributes(e.constantAttributes),e.vertexCount!==void 0&&n.setVertexCount(e.vertexCount),e.shaderModuleProps&&n.shaderInputs.setProps(e.shaderModuleProps)}update(e){if(!this.binsFBO)return;const n=CX(e);this._updateBins("SUM",n.SUM+n.MEAN),this._updateBins("MIN",n.MIN),this._updateBins("MAX",n.MAX)}_updateBins(e,n){if(n===0)return;n|=cA[3];const r=this.model,i=this.binsFBO,s=e==="MAX"?-e2:e==="MIN"?e2:0,o=this.device.beginRenderPass({id:`gpu-aggregation-${e}`,framebuffer:i,parameters:{viewport:[0,0,i.width,i.height],colorMask:n},clearColor:[s,s,s,0],clearDepth:!1,clearStencil:!1});r.setParameters({blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendColorOperation:e==="MAX"?"max":e==="MIN"?"min":"add",blendAlphaOperation:"add"}),r.draw(o),o.end()}}function CX(t){const e={...EX};for(let n=0;n<t.length;n++){const r=t[n];r&&(e[r]+=cA[n])}return e}function RX(t,e){let n=e.vs;e.dimensions===2&&(n+=`
void getBin(out int binId) {
  ivec2 binId2;
  getBin(binId2);
  if (binId2.x < binSorter.binIdRange.x || binId2.x >= binSorter.binIdRange.y) {
    binId = -1;
  } else {
    binId = (binId2.y - binSorter.binIdRange.z) * (binSorter.binIdRange.y - binSorter.binIdRange.x) + binId2.x;
  }
}
`);const r=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-vertex

${n}

out vec3 v_Value;

void main() {
  int binIndex;
  getBin(binIndex);
  binIndex = binIndex - binSorter.binIdRange.x;
  if (binIndex < 0) {
    gl_Position = vec4(0.);
    return;
  }
  int row = binIndex / binSorter.targetSize.x;
  int col = binIndex - row * binSorter.targetSize.x;
  vec2 position = (vec2(col, row) + 0.5) / vec2(binSorter.targetSize) * 2.0 - 1.0;
  gl_Position = vec4(position, 0.0, 1.0);
  gl_PointSize = 1.0;

#if NUM_CHANNELS == 3
  getValue(v_Value);
#elif NUM_CHANNELS == 2
  getValue(v_Value.xy);
#else
  getValue(v_Value.x);
#endif
}
`,i=`#version 300 es
#define SHADER_NAME gpu-aggregation-sort-bins-fragment

precision highp float;

in vec3 v_Value;
out vec4 fragColor;

void main() {
  fragColor.xyz = v_Value;

  #ifdef MODULE_GEOMETRY
  geometry.uv = vec2(0.);
  DECKGL_FILTER_COLOR(fragColor, geometry);
  #endif

  fragColor.w = 1.0;
}
`;return new Lr(t,{bufferLayout:e.bufferLayout,modules:[...e.modules||[],SX],defines:{...e.defines,NON_INSTANCED_MODEL:1,NUM_CHANNELS:e.channelCount},isInstanced:!1,vs:r,fs:i,topology:"point-list",disableWarnings:!0})}const IX=`uniform aggregatorTransformUniforms {
  ivec4 binIdRange;
  bvec3 isCount;
  bvec3 isMean;
  float naN;
} aggregatorTransform;
`,kX={name:"aggregatorTransform",vs:IX,uniformTypes:{binIdRange:"vec4<i32>",isCount:"vec3<f32>",isMean:"vec3<f32>"}};class PX{constructor(e,n){this.binBuffer=null,this.valueBuffer=null,this._domains=null,this.device=e,this.channelCount=n.channelCount,this.transform=MX(e,n),this.domainFBO=lA(e,2,1)}destroy(){this.transform.destroy(),this.binBuffer?.destroy(),this.valueBuffer?.destroy(),this.domainFBO.colorAttachments[0].texture.destroy(),this.domainFBO.destroy()}get domains(){if(!this._domains){const e=this.device.readPixelsToArrayWebGL(this.domainFBO).buffer,n=new Float32Array(e);this._domains=[[-n[4],n[0]],[-n[5],n[1]],[-n[6],n[2]]].slice(0,this.channelCount)}return this._domains}setDimensions(e,n){const{model:r,transformFeedback:i}=this.transform;r.setVertexCount(e);const s={binIdRange:[n[0][0],n[0][1],n[1]?.[0]||0,n[1]?.[1]||0]};r.shaderInputs.setProps({aggregatorTransform:s});const o=e*n.length*4;(!this.binBuffer||this.binBuffer.byteLength<o)&&(this.binBuffer?.destroy(),this.binBuffer=this.device.createBuffer({byteLength:o}),i.setBuffer("binIds",this.binBuffer));const a=e*this.channelCount*4;(!this.valueBuffer||this.valueBuffer.byteLength<a)&&(this.valueBuffer?.destroy(),this.valueBuffer=this.device.createBuffer({byteLength:a}),i.setBuffer("values",this.valueBuffer))}update(e,n){if(!e)return;const r=this.transform,i=this.domainFBO,s=[0,1,2].map(u=>n[u]==="COUNT"?1:0),o=[0,1,2].map(u=>n[u]==="MEAN"?1:0),a={isCount:s,isMean:o,bins:e};r.model.shaderInputs.setProps({aggregatorTransform:a}),r.run({id:"gpu-aggregation-domain",framebuffer:i,parameters:{viewport:[0,0,2,1]},clearColor:[-3e38,-3e38,-3e38,0],clearDepth:!1,clearStencil:!1}),this._domains=null}}function MX(t,e){const n=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-vertex

uniform sampler2D bins;

#if NUM_DIMS == 1
out float binIds;
#else
out vec2 binIds;
#endif

#if NUM_CHANNELS == 1
flat out float values;
#elif NUM_CHANNELS == 2
flat out vec2 values;
#else
flat out vec3 values;
#endif

const float NAN = intBitsToFloat(-1);

void main() {
  int row = gl_VertexID / SAMPLER_WIDTH;
  int col = gl_VertexID - row * SAMPLER_WIDTH;
  vec4 weights = texelFetch(bins, ivec2(col, row), 0);
  vec3 value3 = mix(
    mix(weights.rgb, vec3(weights.a), aggregatorTransform.isCount),
    weights.rgb / max(weights.a, 1.0),
    aggregatorTransform.isMean
  );
  if (weights.a == 0.0) {
    value3 = vec3(NAN);
  }

#if NUM_DIMS == 1
  binIds = float(gl_VertexID + aggregatorTransform.binIdRange.x);
#else
  int y = gl_VertexID / (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  int x = gl_VertexID - y * (aggregatorTransform.binIdRange.y - aggregatorTransform.binIdRange.x);
  binIds.y = float(y + aggregatorTransform.binIdRange.z);
  binIds.x = float(x + aggregatorTransform.binIdRange.x);
#endif

#if NUM_CHANNELS == 3
  values = value3;
#elif NUM_CHANNELS == 2
  values = value3.xy;
#else
  values = value3.x;
#endif

  gl_Position = vec4(0., 0., 0., 1.);
  // This model renders into a 2x1 texture to obtain min and max simultaneously.
  // See comments in fragment shader
  gl_PointSize = 2.0;
}
`,r=`#version 300 es
#define SHADER_NAME gpu-aggregation-domain-fragment

precision highp float;

#if NUM_CHANNELS == 1
flat in float values;
#elif NUM_CHANNELS == 2
flat in vec2 values;
#else
flat in vec3 values;
#endif

out vec4 fragColor;

void main() {
  vec3 value3;
#if NUM_CHANNELS == 3
  value3 = values;
#elif NUM_CHANNELS == 2
  value3.xy = values;
#else
  value3.x = values;
#endif
  if (isnan(value3.x)) discard;
  // This shader renders into a 2x1 texture with blending=max
  // The left pixel yields the max value of each channel
  // The right pixel yields the min value of each channel
  if (gl_FragCoord.x < 1.0) {
    fragColor = vec4(value3, 1.0);
  } else {
    fragColor = vec4(-value3, 1.0);
  }
}
`;return new hs(t,{vs:n,fs:r,topology:"point-list",modules:[kX],parameters:{blend:!0,blendColorSrcFactor:"one",blendColorDstFactor:"one",blendColorOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one",blendAlphaOperation:"max"},defines:{NUM_DIMS:e.dimensions,NUM_CHANNELS:e.channelCount,SAMPLER_WIDTH:Hu},varyings:["binIds","values"],disableWarnings:!0})}class t2{static isSupported(e){return e.features.has("float32-renderable-webgl")&&e.features.has("texture-blend-float-webgl")}constructor(e,n){this.binCount=0,this.binIds=null,this.results=[],this.device=e,this.dimensions=n.dimensions,this.channelCount=n.channelCount,this.props={...n,pointCount:0,binIdRange:[[0,0]],operations:[],attributes:{},binOptions:{}},this.needsUpdate=new Array(this.channelCount).fill(!0),this.binSorter=new AX(e,n),this.aggregationTransform=new PX(e,n),this.setProps(n)}getBins(){const e=this.aggregationTransform.binBuffer;return e?(this.binIds?.buffer!==e&&(this.binIds={buffer:e,type:"float32",size:this.dimensions}),this.binIds):null}getResult(e){const n=this.aggregationTransform.valueBuffer;return!n||e>=this.channelCount?null:(this.results[e]?.buffer!==n&&(this.results[e]={buffer:n,type:"float32",size:1,stride:this.channelCount*4,offset:e*4}),this.results[e])}getResultDomain(e){return this.aggregationTransform.domains[e]}getBin(e){if(e<0||e>=this.binCount)return null;const{binIdRange:n}=this.props;let r;if(this.dimensions===1)r=[e+n[0][0]];else{const[[a,u],[f]]=n,h=u-a;r=[e%h+a,Math.floor(e/h)+f]}const i=this.binSorter.getBinValues(e);if(!i)return null;const s=i[3],o=[];for(let a=0;a<this.channelCount;a++){const u=this.props.operations[a];u==="COUNT"?o[a]=s:s===0?o[a]=NaN:o[a]=u==="MEAN"?i[a]/s:i[a]}return{id:r,value:o,count:s}}destroy(){this.binSorter.destroy(),this.aggregationTransform.destroy()}setProps(e){const n=this.props;if("binIdRange"in e&&!Kt(e.binIdRange,n.binIdRange,2)){const r=e.binIdRange;if(Ve.assert(r.length===this.dimensions),this.dimensions===1){const[[i,s]]=r;this.binCount=s-i}else{const[[i,s],[o,a]]=r;this.binCount=(s-i)*(a-o)}this.binSorter.setDimensions(this.binCount,r),this.aggregationTransform.setDimensions(this.binCount,r),this.setNeedsUpdate()}if(e.operations)for(let r=0;r<this.channelCount;r++)e.operations[r]!==n.operations[r]&&this.setNeedsUpdate(r);if(e.pointCount!==void 0&&e.pointCount!==n.pointCount&&(this.binSorter.setModelProps({vertexCount:e.pointCount}),this.setNeedsUpdate()),e.binOptions&&(Kt(e.binOptions,n.binOptions,2)||this.setNeedsUpdate(),this.binSorter.model.shaderInputs.setProps({binOptions:e.binOptions})),e.attributes){const r={},i={};for(const s of Object.values(e.attributes))for(const[o,a]of Object.entries(s.getValue()))ArrayBuffer.isView(a)?i[o]=a:a&&(r[o]=a);this.binSorter.setModelProps({attributes:r,constantAttributes:i})}e.shaderModuleProps&&this.binSorter.setModelProps({shaderModuleProps:e.shaderModuleProps}),Object.assign(this.props,e)}setNeedsUpdate(e){e===void 0?this.needsUpdate.fill(!0):this.needsUpdate[e]=!0}update(){}preDraw(){if(!this.needsUpdate.some(Boolean))return;const{operations:e}=this.props,n=this.needsUpdate.map((r,i)=>r?e[i]:null);this.binSorter.update(n),this.aggregationTransform.update(this.binSorter.texture,e);for(let r=0;r<this.channelCount;r++)this.needsUpdate[r]&&(this.needsUpdate[r]=!1,this.props.onUpdate?.({channel:r}))}}let uA=class extends ny{get isDrawable(){return!0}initializeState(){this.getAttributeManager().remove(["instancePickingColors"])}updateState(e){super.updateState(e);const n=this.getAggregatorType();if(e.changeFlags.extensionsChanged||this.state.aggregatorType!==n){this.state.aggregator?.destroy();const r=this.createAggregator(n);return r.setProps({attributes:this.getAttributeManager()?.attributes}),this.setState({aggregator:r,aggregatorType:n}),!0}return!1}finalizeState(e){super.finalizeState(e),this.state.aggregator.destroy()}updateAttributes(e){const{aggregator:n}=this.state;n.setProps({attributes:e});for(const r in e)this.onAttributeChange(r);n.update()}draw({shaderModuleProps:e}){const{aggregator:n}=this.state;n.setProps({shaderModuleProps:e}),n.preDraw()}_getAttributeManager(){return new dh(this.context.device,{id:this.props.id,stats:this.context.stats})}};uA.layerName="AggregationLayer";const fA=[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]];function hA(t,e=!1,n=Float32Array){let r;if(Number.isFinite(t[0]))r=new n(t);else{r=new n(t.length*4);let i=0;for(let s=0;s<t.length;s++){const o=t[s];r[i++]=o[0],r[i++]=o[1],r[i++]=o[2],r[i++]=Number.isFinite(o[3])?o[3]:255}}if(e)for(let i=0;i<r.length;i++)r[i]/=255;return r}const jf={linear:"linear",quantile:"nearest",quantize:"nearest",ordinal:"nearest"};function NX(t,e){t.setSampler({minFilter:jf[e],magFilter:jf[e]})}function OX(t,e,n="linear"){const r=hA(e,!1,Uint8Array);return t.createTexture({format:"rgba8unorm",mipmaps:!1,sampler:{minFilter:jf[n],magFilter:jf[n],addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},data:r,width:r.length/4,height:1})}class n2{constructor(e,n){this.props={scaleType:"linear",lowerPercentile:0,upperPercentile:100},this.domain=null,this.cutoff=null,this.input=e,this.inputLength=n,this.attribute=e}getScalePercentile(){if(!this._percentile){const e=r2(this.input,this.inputLength);this._percentile=FX(e)}return this._percentile}getScaleOrdinal(){if(!this._ordinal){const e=r2(this.input,this.inputLength);this._ordinal=DX(e)}return this._ordinal}getCutoff({scaleType:e,lowerPercentile:n,upperPercentile:r}){if(e==="quantile")return[n,r-1];if(n>0||r<100){const{domain:i}=this.getScalePercentile();let s=i[Math.floor(n)-1]??-1/0,o=i[Math.floor(r)-1]??1/0;if(e==="ordinal"){const{domain:a}=this.getScaleOrdinal();s=a.findIndex(u=>u>=s),o=a.findIndex(u=>u>o)-1,o===-2&&(o=a.length-1)}return[s,o]}return null}update(e){const n=this.props;if(e.scaleType!==n.scaleType)switch(e.scaleType){case"quantile":{const{attribute:r}=this.getScalePercentile();this.attribute=r,this.domain=[0,99];break}case"ordinal":{const{attribute:r,domain:i}=this.getScaleOrdinal();this.attribute=r,this.domain=[0,i.length-1];break}default:this.attribute=this.input,this.domain=null}return(e.scaleType!==n.scaleType||e.lowerPercentile!==n.lowerPercentile||e.upperPercentile!==n.upperPercentile)&&(this.cutoff=this.getCutoff(e)),this.props=e,this}}function DX(t){const e=new Set;for(const i of t)Number.isFinite(i)&&e.add(i);const n=Array.from(e).sort(),r=new Map;for(let i=0;i<n.length;i++)r.set(n[i],i);return{attribute:{value:t.map(i=>Number.isFinite(i)?r.get(i):NaN),type:"float32",size:1},domain:n}}function FX(t,e=100){const n=Array.from(t).filter(Number.isFinite).sort(LX);let r=0;const i=Math.max(1,e),s=new Array(i-1);for(;++r<i;)s[r-1]=BX(n,r/i);return{attribute:{value:t.map(o=>Number.isFinite(o)?UX(s,o):NaN),type:"float32",size:1},domain:s}}function r2(t,e){const n=(t.stride??4)/4,r=(t.offset??0)/4;let i=t.value;if(!i){const o=t.buffer?.readSyncWebGL(0,n*4*e);o&&(i=new Float32Array(o.buffer),t.value=i)}if(n===1)return i.subarray(0,e);const s=new Float32Array(e);for(let o=0;o<e;o++)s[o]=i[o*n+r];return s}function LX(t,e){return t-e}function BX(t,e){const n=t.length;if(e<=0||n<2)return t[0];if(e>=1)return t[n-1];const r=(n-1)*e,i=Math.floor(r),s=t[i],o=t[i+1];return s+(o-s)*(r-i)}function UX(t,e){let n=0,r=t.length;for(;n<r;){const i=n+r>>>1;t[i]>e?r=i:n=i+1}return n}function jX({dataBounds:t,getBinId:e,padding:n=0}){const r=[t[0],t[1],[t[0][0],t[1][1]],[t[1][0],t[0][1]]].map(u=>e(u)),i=Math.min(...r.map(u=>u[0]))-n,s=Math.min(...r.map(u=>u[1]))-n,o=Math.max(...r.map(u=>u[0]))+n+1,a=Math.max(...r.map(u=>u[1]))+n+1;return[[i,o],[s,a]]}const zX={COUNTER_CLOCKWISE:-1};function VX(t,e,n={}){return $X(t,n)!==e?(HX(t,n),!0):!1}function $X(t,e={}){return Math.sign(WX(t,e))}const i2={x:0,y:1,z:2};function WX(t,e={}){const{start:n=0,end:r=t.length,plane:i="xy"}=e,s=e.size||2;let o=0;const a=i2[i[0]],u=i2[i[1]];for(let f=n,h=r-s;f<r;f+=s)o+=(t[f+a]-t[h+a])*(t[f+u]+t[h+u]),h=f;return o/2}function HX(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const u=n+a*i,f=n+(s-1-a)*i;for(let h=0;h<i;++h){const p=t[u+h];t[u+h]=t[f+h],t[f+h]=p}}}class XX extends lV{constructor(e){const{indices:n,attributes:r}=YX(e);super({...e,indices:n,attributes:r})}}function YX(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(Ve.assert(i.length>=r),i=i.flatMap(_=>[_[0],_[1]]),VX(i,zX.COUNTER_CLOCKWISE));const s=n>0,o=r+1,a=s?o*3+1:r,u=Math.PI*2/r,f=new Uint16Array(s?r*3*2:0),h=new Float32Array(a*3),p=new Float32Array(a*3);let g=0;if(s){for(let _=0;_<o;_++){const v=_*u,w=_%r,x=Math.sin(v),T=Math.cos(v);for(let A=0;A<2;A++)h[g+0]=i?i[w*2]:T*e,h[g+1]=i?i[w*2+1]:x*e,h[g+2]=(1/2-A)*n,p[g+0]=i?i[w*2]:T,p[g+1]=i?i[w*2+1]:x,g+=3}h[g+0]=h[g-3],h[g+1]=h[g-2],h[g+2]=h[g-1],g+=3}for(let _=s?0:1;_<o;_++){const v=Math.floor(_/2)*Math.sign(.5-_%2),w=v*u,x=(v+r)%r,T=Math.sin(w),A=Math.cos(w);h[g+0]=i?i[x*2]:A*e,h[g+1]=i?i[x*2+1]:T*e,h[g+2]=n/2,p[g+2]=1,g+=3}if(s){let _=0;for(let v=0;v<r;v++)f[_++]=v*2+0,f[_++]=v*2+2,f[_++]=v*2+0,f[_++]=v*2+1,f[_++]=v*2+1,f[_++]=v*2+3}return{indices:f,attributes:{POSITION:{size:3,value:h},NORMAL:{size:3,value:p}}}}const s2=`uniform columnUniforms {
  float radius;
  float angle;
  vec2 offset;
  bool extruded;
  bool stroked;
  bool isStroke;
  float coverage;
  float elevationScale;
  float edgeDistance;
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  highp int radiusUnits;
  highp int widthUnits;
} column;
`,qX={name:"column",vs:s2,fs:s2,uniformTypes:{radius:"f32",angle:"f32",offset:"vec2<f32>",extruded:"f32",stroked:"f32",isStroke:"f32",coverage:"f32",elevationScale:"f32",edgeDistance:"f32",widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",radiusUnits:"i32",widthUnits:"i32"}},KX=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec3 cameraPosition;
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = column.isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(column.angle), sin(column.angle), -sin(column.angle), cos(column.angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (column.extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * column.elevationScale;
} else if (column.stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * column.widthScale, column.widthUnits),
column.widthMinPixels, column.widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(column.edgeDistance * column.coverage * column.radius);
if (column.isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = column.radius * column.coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + column.offset) * dotRadius;
if (column.radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (column.extruded && !column.isStroke) {
#ifdef FLAT_SHADING
cameraPosition = project.cameraPosition;
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * layer.opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * layer.opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,ZX=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec3 cameraPosition;
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (column.extruded && !column.isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, cameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,zf=[0,0,0,255],QX={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:zf},getLineColor:{type:"accessor",value:zf},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class ry extends $o{getShaders(){const e={},{flatShading:n}=this.props;return n&&(e.FLAT_SHADING=1),super.getShaders({vs:KX,fs:ZX,defines:e,modules:[uh,n?rE:nE,az,qX]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:zf},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:zf},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=i.extensionsChanged||n.flatShading!==r.flatShading;s&&(this.state.models?.forEach(a=>a.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());const o=this.getNumInstances();this.state.fillModel.setInstanceCount(o),this.state.wireframeModel.setInstanceCount(o),(s||n.diskResolution!==r.diskResolution||n.vertices!==r.vertices||(n.extruded||n.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(n)}getGeometry(e,n,r){const i=new XX({radius:1,height:r?2:0,vertices:n,nradial:e});let s=0;if(n)for(let o=0;o<e;o++){const a=n[o],u=Math.sqrt(a[0]*a[0]+a[1]*a[1]);s+=u/e}else s=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*s}),i}_getModels(){const e=this.getShaders(),n=this.getAttributeManager().getBufferLayouts(),r=new Lr(this.context.device,{...e,id:`${this.props.id}-fill`,bufferLayout:n,isInstanced:!0}),i=new Lr(this.context.device,{...e,id:`${this.props.id}-wireframe`,bufferLayout:n,isInstanced:!0});return{fillModel:r,wireframeModel:i,models:[i,r]}}_updateGeometry({diskResolution:e,vertices:n,extruded:r,stroked:i}){const s=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3});const o=this.state.fillModel,a=this.state.wireframeModel;o.setGeometry(s),o.setTopology("triangle-strip"),o.setIndexBuffer(null),a.setGeometry(s),a.setTopology("line-list")}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:s,radiusUnits:o,elevationScale:a,extruded:u,filled:f,stroked:h,wireframe:p,offset:g,coverage:_,radius:v,angle:w}=this.props,x=this.state.fillModel,T=this.state.wireframeModel,{fillVertexCount:A,edgeDistance:E}=this.state,R={radius:v,angle:w/180*Math.PI,offset:g,extruded:u,stroked:h,coverage:_,elevationScale:a,edgeDistance:E,radiusUnits:Mo[o],widthUnits:Mo[n],widthScale:r,widthMinPixels:i,widthMaxPixels:s};u&&p&&(T.shaderInputs.setProps({column:{...R,isStroke:!0}}),T.draw(this.context.renderPass)),f&&(x.setVertexCount(A),x.shaderInputs.setProps({column:{...R,isStroke:!1}}),x.draw(this.context.renderPass)),!u&&h&&(x.setVertexCount(A*2/3),x.shaderInputs.setProps({column:{...R,isStroke:!0}}),x.draw(this.context.renderPass))}}ry.layerName="ColumnLayer";ry.defaultProps=QX;const dA=Math.PI/3,gh=2*Math.sin(dA),mh=1.5,JX=Array.from({length:6},(t,e)=>{const n=e*dA;return[Math.sin(n),-Math.cos(n)]});function cg([t,e],n){let r=Math.round(e=e/n/mh),i=Math.round(t=t/n/gh-(r&1)/2);const s=e-r;if(Math.abs(s)*3>1){const o=t-i,a=i+(t<i?-1:1)/2,u=r+(e<r?-1:1),f=t-a,h=e-u;o*o+s*s>f*f+h*h&&(i=a+(r&1?1:-1)/2,r=u)}return[i,r]}const GX=`
const vec2 DIST = vec2(${gh}, ${mh});

ivec2 pointToHexbin(vec2 p, float radius) {
  p /= radius * DIST;
  float pj = round(p.y);
  float pjm2 = mod(pj, 2.0);
  p.x -= pjm2 * 0.5;
  float pi = round(p.x);
  vec2 d1 = p - vec2(pi, pj);

  if (abs(d1.y) * 3. > 1.) {
    vec2 v2 = step(0.0, d1) - 0.5;
    v2.y *= 2.0;
    vec2 d2 = d1 - v2;
    if (dot(d1, d1) > dot(d2, d2)) {
      pi += v2.x + pjm2 - 0.5;
      pj += v2.y;
    }
  }
  return ivec2(pi, pj);
}
`;function o2([t,e],n){return[(t+(e&1)/2)*n*gh,e*n*mh]}const eY=`
const vec2 DIST = vec2(${gh}, ${mh});

vec2 hexbinCentroid(vec2 binId, float radius) {
  binId.x += fract(binId.y * 0.5);
  return binId * DIST * radius;
}
`,tY=`#version 300 es
#define SHADER_NAME hexagon-cell-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec2 instancePositions;
in float instanceElevationValues;
in float instanceColorValues;
in vec3 instancePickingColors;
uniform sampler2D colorRange;
out vec4 vColor;
${eY}
float interp(float value, vec2 domain, vec2 range) {
float r = min(max((value - domain.x) / (domain.y - domain.x), 0.), 1.);
return mix(range.x, range.y, r);
}
vec4 interp(float value, vec2 domain, sampler2D range) {
float r = (value - domain.x) / (domain.y - domain.x);
return texture(range, vec2(r, 0.5));
}
void main(void) {
geometry.pickingColor = instancePickingColors;
if (isnan(instanceColorValues) ||
instanceColorValues < hexagon.colorDomain.z ||
instanceColorValues > hexagon.colorDomain.w ||
instanceElevationValues < hexagon.elevationDomain.z ||
instanceElevationValues > hexagon.elevationDomain.w
) {
gl_Position = vec4(0.);
return;
}
vec2 commonPosition = hexbinCentroid(instancePositions, column.radius) + (hexagon.originCommon - project.commonOrigin.xy);
commonPosition += positions.xy * column.radius * column.coverage;
geometry.position = vec4(commonPosition, 0.0, 1.0);
geometry.normal = project_normal(normals);
float elevation = 0.0;
if (column.extruded) {
elevation = interp(instanceElevationValues, hexagon.elevationDomain.xy, hexagon.elevationRange);
elevation = project_size(elevation);
geometry.position.z = (positions.z + 1.0) / 2.0 * elevation;
}
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vColor = interp(instanceColorValues, hexagon.colorDomain.xy, colorRange);
vColor.a *= layer.opacity;
if (column.extruded) {
vColor.rgb = lighting_getLightColor(vColor.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,nY=`uniform hexagonUniforms {
  vec4 colorDomain;
  vec4 elevationDomain;
  vec2 elevationRange;
  vec2 originCommon;
} hexagon;
`,rY={name:"hexagon",vs:nY,uniformTypes:{colorDomain:"vec4<f32>",elevationDomain:"vec4<f32>",elevationRange:"vec2<f32>",originCommon:"vec2<f32>"}};class pA extends ry{getShaders(){const e=super.getShaders();return e.modules.push(rY),{...e,vs:tY}}initializeState(){super.initializeState();const e=this.getAttributeManager();e.remove(["instanceElevations","instanceFillColors","instanceLineColors","instanceStrokeWidths"]),e.addInstanced({instancePositions:{size:2,type:"float32",accessor:"getBin"},instanceColorValues:{size:1,type:"float32",accessor:"getColorValue"},instanceElevationValues:{size:1,type:"float32",accessor:"getElevationValue"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e,i=this.state.fillModel;if(r.colorRange!==n.colorRange){this.state.colorTexture?.destroy(),this.state.colorTexture=OX(this.context.device,n.colorRange,n.colorScaleType);const s={colorRange:this.state.colorTexture};i.shaderInputs.setProps({hexagon:s})}else r.colorScaleType!==n.colorScaleType&&NX(this.state.colorTexture,n.colorScaleType)}finalizeState(e){super.finalizeState(e),this.state.colorTexture?.destroy()}draw({uniforms:e}){const{radius:n,hexOriginCommon:r,elevationRange:i,elevationScale:s,extruded:o,coverage:a,colorDomain:u,elevationDomain:f}=this.props,h=this.props.colorCutoff||[-1/0,1/0],p=this.props.elevationCutoff||[-1/0,1/0],g=this.state.fillModel;g.vertexArray.indexBuffer&&g.setIndexBuffer(null),g.setVertexCount(this.state.fillVertexCount);const _={colorDomain:[Math.max(u[0],h[0]),Math.min(u[1],h[1]),Math.max(u[0]-1,h[0]),Math.min(u[1]+1,h[1])],elevationDomain:[Math.max(f[0],p[0]),Math.min(f[1],p[1]),Math.max(f[0]-1,p[0]),Math.min(f[1]+1,p[1])],elevationRange:[i[0]*s,i[1]*s],originCommon:r};g.shaderInputs.setProps({column:{extruded:o,coverage:a,radius:n},hexagon:_}),g.draw(this.context.renderPass)}}pA.layerName="HexagonCellLayer";const iY=`uniform binOptionsUniforms {
  vec2 hexOriginCommon;
  float radiusCommon;
} binOptions;
`,sY={name:"binOptions",vs:iY,uniformTypes:{hexOriginCommon:"vec2<f32>",radiusCommon:"f32"}};function a2(){}const oY={gpuAggregation:!0,colorDomain:null,colorRange:fA,getColorValue:{type:"accessor",value:null},getColorWeight:{type:"accessor",value:1},colorAggregation:"SUM",lowerPercentile:{type:"number",min:0,max:100,value:0},upperPercentile:{type:"number",min:0,max:100,value:100},colorScaleType:"quantize",onSetColorDomain:a2,elevationDomain:null,elevationRange:[0,1e3],getElevationValue:{type:"accessor",value:null},getElevationWeight:{type:"accessor",value:1},elevationAggregation:"SUM",elevationScale:{type:"number",min:0,value:1},elevationLowerPercentile:{type:"number",min:0,max:100,value:0},elevationUpperPercentile:{type:"number",min:0,max:100,value:100},elevationScaleType:"linear",onSetElevationDomain:a2,radius:{type:"number",min:1,value:1e3},coverage:{type:"number",min:0,max:1,value:1},getPosition:{type:"accessor",value:t=>t.position},hexagonAggregator:{type:"function",optional:!0,value:null},extruded:!1,material:!0};class iy extends uA{getAggregatorType(){const{gpuAggregation:e,hexagonAggregator:n,getColorValue:r,getElevationValue:i}=this.props;return e&&(n||r||i)?(Ve.warn("Features not supported by GPU aggregation, falling back to CPU")(),"cpu"):e&&t2.isSupported(this.context.device)?"gpu":"cpu"}createAggregator(e){if(e==="cpu"){const{hexagonAggregator:n,radius:r}=this.props;return new xX({dimensions:2,getBin:{sources:["positions"],getValue:({positions:i},s,o)=>{if(n)return n(i,r);const u=this.state.aggregatorViewport.projectPosition(i),{radiusCommon:f,hexOriginCommon:h}=o;return cg([u[0]-h[0],u[1]-h[1]],f)}},getValue:[{sources:["colorWeights"],getValue:({colorWeights:i})=>i},{sources:["elevationWeights"],getValue:({elevationWeights:i})=>i}]})}return new t2(this.context.device,{dimensions:2,channelCount:2,bufferLayout:this.getAttributeManager().getBufferLayouts({isInstanced:!1}),...super.getShaders({modules:[uh,sY],vs:`
  in vec3 positions;
  in vec3 positions64Low;
  in float colorWeights;
  in float elevationWeights;
  
  ${GX}

  void getBin(out ivec2 binId) {
    vec3 positionCommon = project_position(positions, positions64Low);
    binId = pointToHexbin(positionCommon.xy, binOptions.radiusCommon);
  }
  void getValue(out vec2 value) {
    value = vec2(colorWeights, elevationWeights);
  }
  `})})}initializeState(){super.initializeState(),this.getAttributeManager().add({positions:{size:3,accessor:"getPosition",type:"float64",fp64:this.use64bitPositions()},colorWeights:{size:1,accessor:"getColorWeight"},elevationWeights:{size:1,accessor:"getElevationWeight"}})}updateState(e){const n=super.updateState(e),{props:r,oldProps:i,changeFlags:s}=e,{aggregator:o}=this.state;if((s.dataChanged||!this.state.dataAsArray)&&(r.getColorValue||r.getElevationValue)&&(this.state.dataAsArray=Array.from(KE(r.data).iterable)),n||s.dataChanged||r.radius!==i.radius||r.getColorValue!==i.getColorValue||r.getElevationValue!==i.getElevationValue||r.colorAggregation!==i.colorAggregation||r.elevationAggregation!==i.elevationAggregation){this._updateBinOptions();const{radiusCommon:a,hexOriginCommon:u,binIdRange:f,dataAsArray:h}=this.state;if(o.setProps({binIdRange:f,pointCount:this.getNumInstances(),operations:[r.colorAggregation,r.elevationAggregation],binOptions:{radiusCommon:a,hexOriginCommon:u},onUpdate:this._onAggregationUpdate.bind(this)}),h){const{getColorValue:p,getElevationValue:g}=this.props;o.setProps({customOperations:[p&&(_=>p(_.map(v=>h[v]),{indices:_,data:r.data})),g&&(_=>g(_.map(v=>h[v]),{indices:_,data:r.data}))]})}}return s.updateTriggersChanged&&s.updateTriggersChanged.getColorValue&&o.setNeedsUpdate(0),s.updateTriggersChanged&&s.updateTriggersChanged.getElevationValue&&o.setNeedsUpdate(1),n}_updateBinOptions(){const e=this.getBounds();let n=1,r=[0,0],i=[[0,1],[0,1]],s=this.context.viewport;if(e&&Number.isFinite(e[0][0])){let o=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2];const{radius:a}=this.props,{unitsPerMeter:u}=s.getDistanceScales(o);n=u[0]*a;const f=cg(s.projectFlat(o),n);o=s.unprojectFlat(o2(f,n));const h=s.constructor;s=s.isGeospatial?new h({longitude:o[0],latitude:o[1],zoom:12}):new zo({position:[o[0],o[1],0],zoom:12}),r=[Math.fround(s.center[0]),Math.fround(s.center[1])],i=jX({dataBounds:e,getBinId:p=>{const g=s.projectFlat(p);return g[0]-=r[0],g[1]-=r[1],cg(g,n)},padding:1})}this.setState({radiusCommon:n,hexOriginCommon:r,binIdRange:i,aggregatorViewport:s})}draw(e){e.shaderModuleProps.project&&(e.shaderModuleProps.project.viewport=this.state.aggregatorViewport),super.draw(e)}_onAggregationUpdate({channel:e}){const n=this.getCurrentLayer().props,{aggregator:r}=this.state;if(e===0){const i=r.getResult(0);this.setState({colors:new n2(i,r.binCount)}),n.onSetColorDomain(r.getResultDomain(0))}else if(e===1){const i=r.getResult(1);this.setState({elevations:new n2(i,r.binCount)}),n.onSetElevationDomain(r.getResultDomain(1))}}onAttributeChange(e){const{aggregator:n}=this.state;switch(e){case"positions":n.setNeedsUpdate(),this._updateBinOptions();const{radiusCommon:r,hexOriginCommon:i,binIdRange:s}=this.state;n.setProps({binIdRange:s,binOptions:{radiusCommon:r,hexOriginCommon:i}});break;case"colorWeights":n.setNeedsUpdate(0);break;case"elevationWeights":n.setNeedsUpdate(1);break}}renderLayers(){const{aggregator:e,radiusCommon:n,hexOriginCommon:r}=this.state,{elevationScale:i,colorRange:s,elevationRange:o,extruded:a,coverage:u,material:f,transitions:h,colorScaleType:p,lowerPercentile:g,upperPercentile:_,colorDomain:v,elevationScaleType:w,elevationLowerPercentile:x,elevationUpperPercentile:T,elevationDomain:A}=this.props,E=this.getSubLayerClass("cells",pA),R=e.getBins(),k=this.state.colors?.update({scaleType:p,lowerPercentile:g,upperPercentile:_}),M=this.state.elevations?.update({scaleType:w,lowerPercentile:x,upperPercentile:T});return!k||!M?null:new E(this.getSubLayerProps({id:"cells"}),{data:{length:e.binCount,attributes:{getBin:R,getColorValue:k.attribute,getElevationValue:M.attribute}},dataComparator:(L,W)=>L.length===W.length,updateTriggers:{getBin:[R],getColorValue:[k.attribute],getElevationValue:[M.attribute]},diskResolution:6,vertices:JX,radius:n,hexOriginCommon:r,elevationScale:i,colorRange:s,colorScaleType:p,elevationRange:o,extruded:a,coverage:u,material:f,colorDomain:k.domain||v||e.getResultDomain(0),elevationDomain:M.domain||A||e.getResultDomain(1),colorCutoff:k.cutoff,elevationCutoff:M.cutoff,transitions:h&&{getFillColor:h.getColorValue||h.getColorWeight,getElevation:h.getElevationValue||h.getElevationWeight},extensions:[]})}getPickingInfo(e){const n=e.info,{index:r}=n;if(r>=0){const i=this.state.aggregator.getBin(r);let s;if(i){const o=o2(i.id,this.state.radiusCommon),a=this.context.viewport.unprojectFlat(o);s={col:i.id[0],row:i.id[1],position:a,colorValue:i.value[0],elevationValue:i.value[1],count:i.count},i.pointIndices&&(s.pointIndices=i.pointIndices,s.points=Array.isArray(this.props.data)?i.pointIndices.map(u=>this.props.data[u]):[])}n.object=s}return n}}iy.layerName="HexagonLayer";iy.defaultProps=oY;function aY(t){const e=t.map(a=>a[0]),n=t.map(a=>a[1]),r=Math.min.apply(null,e),i=Math.max.apply(null,e),s=Math.min.apply(null,n),o=Math.max.apply(null,n);return[r,s,i,o]}function lY(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}const l2=new Float32Array(12);function c2(t,e=2){let n=0;for(const r of t)for(let i=0;i<e;i++)l2[n++]=r[i]||0;return l2}function cY(t,e,n){const[r,i,s,o]=t,a=s-r,u=o-i;let f=a,h=u;a/u<e/n?f=e/n*u:h=n/e*a,f<e&&(f=e,h=n);const p=(s+r)/2,g=(o+i)/2;return[p-f/2,g-h/2,p+f/2,g+h/2]}function uY(t,e){const[n,r,i,s]=e;return[(t[0]-n)/(i-n),(t[1]-r)/(s-r)]}const fY=`#version 300 es
#define SHADER_NAME heatp-map-layer-vertex-shader
uniform sampler2D maxTexture;
in vec3 positions;
in vec2 texCoords;
out vec2 vTexCoords;
out float vIntensityMin;
out float vIntensityMax;
void main(void) {
gl_Position = project_position_to_clipspace(positions, vec3(0.0), vec3(0.0));
vTexCoords = texCoords;
vec4 maxTexture = texture(maxTexture, vec2(0.5));
float maxValue = triangle.aggregationMode < 0.5 ? maxTexture.r : maxTexture.g;
float minValue = maxValue * triangle.threshold;
if (triangle.colorDomain[1] > 0.) {
maxValue = triangle.colorDomain[1];
minValue = triangle.colorDomain[0];
}
vIntensityMax = triangle.intensity / maxValue;
vIntensityMin = triangle.intensity / minValue;
}
`,hY=`#version 300 es
#define SHADER_NAME triangle-layer-fragment-shader
precision highp float;
uniform sampler2D weightsTexture;
uniform sampler2D colorTexture;
in vec2 vTexCoords;
in float vIntensityMin;
in float vIntensityMax;
out vec4 fragColor;
vec4 getLinearColor(float value) {
float factor = clamp(value * vIntensityMax, 0., 1.);
vec4 color = texture(colorTexture, vec2(factor, 0.5));
color.a *= min(value * vIntensityMin, 1.0);
return color;
}
void main(void) {
vec4 weights = texture(weightsTexture, vTexCoords);
float weight = weights.r;
if (triangle.aggregationMode > 0.5) {
weight /= max(1.0, weights.a);
}
if (weight <= 0.) {
discard;
}
vec4 linearColor = getLinearColor(weight);
linearColor.a *= layer.opacity;
fragColor = linearColor;
}
`,u2=`uniform triangleUniforms {
  float aggregationMode;
  vec2 colorDomain;
  float intensity;
  float threshold;
} triangle;
`,dY={name:"triangle",vs:u2,fs:u2,uniformTypes:{aggregationMode:"f32",colorDomain:"vec2<f32>",intensity:"f32",threshold:"f32"}};class gA extends $o{getShaders(){return super.getShaders({vs:fY,fs:hY,modules:[uh,dY]})}initializeState({device:e}){this.setState({model:this._getModel(e)})}_getModel(e){const{vertexCount:n,data:r}=this.props;return new Lr(e,{...this.getShaders(),id:this.props.id,attributes:r.attributes,bufferLayout:[{name:"positions",format:"float32x3"},{name:"texCoords",format:"float32x2"}],topology:"triangle-strip",vertexCount:n})}draw(){const{model:e}=this.state,{aggregationMode:n,colorDomain:r,intensity:i,threshold:s,colorTexture:o,maxTexture:a,weightsTexture:u}=this.props,f={aggregationMode:n,colorDomain:r,intensity:i,threshold:s,colorTexture:o,maxTexture:a,weightsTexture:u};e.shaderInputs.setProps({triangle:f}),e.draw(this.context.renderPass)}}gA.layerName="TriangleLayer";function pY(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}class mA extends ny{initializeAggregationLayer(e){super.initializeState(this.context),this.setState({ignoreProps:pY(this.constructor._propTypes,e.data.props),dimensions:e})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){const r=this.getShaders({});r&&r.defines&&(r.defines.NON_INSTANCED_MODEL=1),this.updateShaders(r)}this._updateAttributes()}updateAttributes(e){this.setState({changedAttributes:e})}getAttributes(){return this.getAttributeManager().getAttributes()}getModuleSettings(){const{viewport:e,mousePosition:n,device:r}=this.context;return Object.assign(Object.create(this.props),{viewport:e,mousePosition:n,picking:{isActive:0},devicePixelRatio:r.canvasContext.cssToDeviceRatio()})}updateShaders(e){}isAggregationDirty(e,n={}){const{props:r,oldProps:i,changeFlags:s}=e,{compareAll:o=!1,dimension:a}=n,{ignoreProps:u}=this.state,{props:f,accessors:h=[]}=a,{updateTriggersChanged:p}=s;if(s.dataChanged)return!0;if(p){if(p.all)return!0;for(const g of h)if(p[g])return!0}if(o)return s.extensionsChanged?!0:ey({oldProps:i,newProps:r,ignoreProps:u,propTypes:this.constructor._propTypes});for(const g of f)if(r[g]!==i[g])return!0;return!1}isAttributeChanged(e){const{changedAttributes:n}=this.state;return e?n&&n[e]!==void 0:!gY(n)}_getAttributeManager(){return new dh(this.context.device,{id:this.props.id,stats:this.context.stats})}}mA.layerName="AggregationLayer";function gY(t){let e=!0;for(const n in t){e=!1;break}return e}const f2=`#version 300 es
in vec3 positions;
in vec3 positions64Low;
in float weights;
out vec4 weightsTexture;
void main()
{
weightsTexture = vec4(weights * weight.weightsScale, 0., 0., 1.);
float radiusTexels = project_pixel_size(weight.radiusPixels) * weight.textureWidth / (weight.commonBounds.z - weight.commonBounds.x);
gl_PointSize = radiusTexels * 2.;
vec3 commonPosition = project_position(positions, positions64Low);
gl_Position.xy = (commonPosition.xy - weight.commonBounds.xy) / (weight.commonBounds.zw - weight.commonBounds.xy) ;
gl_Position.xy = (gl_Position.xy * 2.) - (1.);
gl_Position.w = 1.0;
}
`,h2=`#version 300 es
in vec4 weightsTexture;
out vec4 fragColor;
float gaussianKDE(float u){
return pow(2.71828, -u*u/0.05555)/(1.77245385*0.166666);
}
void main()
{
float dist = length(gl_PointCoord - vec2(0.5, 0.5));
if (dist > 0.5) {
discard;
}
fragColor = weightsTexture * gaussianKDE(2. * dist);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,mY=`#version 300 es
uniform sampler2D inTexture;
out vec4 outTexture;
void main()
{
int yIndex = gl_VertexID / int(maxWeight.textureSize);
int xIndex = gl_VertexID - (yIndex * int(maxWeight.textureSize));
vec2 uv = (0.5 + vec2(float(xIndex), float(yIndex))) / maxWeight.textureSize;
outTexture = texture(inTexture, uv);
gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
gl_PointSize = 1.0;
}
`,_Y=`#version 300 es
in vec4 outTexture;
out vec4 fragColor;
void main() {
fragColor = outTexture;
fragColor.g = outTexture.r / max(1.0, outTexture.a);
}
`,yY=`uniform weightUniforms {
  vec4 commonBounds;
  float radiusPixels;
  float textureWidth;
  float weightsScale;
} weight;
`,vY={name:"weight",vs:yY,uniformTypes:{commonBounds:"vec4<f32>",radiusPixels:"f32",textureWidth:"f32",weightsScale:"f32"}},bY={name:"maxWeight",vs:`uniform maxWeightUniforms {
  float textureSize;
} maxWeight;
`,uniformTypes:{textureSize:"f32"}},wY=2,ug={format:"rgba8unorm",mipmaps:!1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}},d2=[0,0],xY={SUM:0,MEAN:1},TY={getPosition:{type:"accessor",value:t=>t.position},getWeight:{type:"accessor",value:1},intensity:{type:"number",min:0,value:1},radiusPixels:{type:"number",min:1,max:100,value:50},colorRange:fA,threshold:{type:"number",min:0,max:1,value:.05},colorDomain:{type:"array",value:null,optional:!0},aggregation:"SUM",weightsTextureSize:{type:"number",min:128,max:2048,value:2048},debounceTimeout:{type:"number",min:0,max:1e3,value:500}},SY=["float32-renderable-webgl","texture-blend-float-webgl"],EY={data:{props:["radiusPixels"]}};class sy extends mA{getShaders(e){let n=[uh];return e.modules&&(n=[...n,...e.modules]),super.getShaders({...e,modules:n})}initializeState(){super.initializeAggregationLayer(EY),this.setState({colorDomain:d2}),this._setupTextureParams(),this._setupAttributes(),this._setupResources()}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState(e){super.updateState(e),this._updateHeatmapState(e)}_updateHeatmapState(e){const{props:n,oldProps:r}=e,i=this._getChangeFlags(e);(i.dataChanged||i.viewportChanged)&&(i.boundsChanged=this._updateBounds(i.dataChanged),this._updateTextureRenderingBounds()),i.dataChanged||i.boundsChanged?(clearTimeout(this.state.updateTimer),this.setState({isWeightMapDirty:!0})):i.viewportZoomChanged&&this._debouncedUpdateWeightmap(),n.colorRange!==r.colorRange&&this._updateColorTexture(e),this.state.isWeightMapDirty&&this._updateWeightmap(),this.setState({zoom:e.context.viewport.zoom})}renderLayers(){const{weightsTexture:e,triPositionBuffer:n,triTexCoordBuffer:r,maxWeightsTexture:i,colorTexture:s,colorDomain:o}=this.state,{updateTriggers:a,intensity:u,threshold:f,aggregation:h}=this.props,p=this.getSubLayerClass("triangle",gA);return new p(this.getSubLayerProps({id:"triangle-layer",updateTriggers:a}),{coordinateSystem:Fe.DEFAULT,data:{attributes:{positions:n,texCoords:r}},vertexCount:4,maxTexture:i,colorTexture:s,aggregationMode:xY[h]||0,weightsTexture:e,intensity:u,threshold:f,colorDomain:o})}finalizeState(e){super.finalizeState(e);const{weightsTransform:n,weightsTexture:r,maxWeightTransform:i,maxWeightsTexture:s,triPositionBuffer:o,triTexCoordBuffer:a,colorTexture:u,updateTimer:f}=this.state;n?.destroy(),r?.destroy(),i?.destroy(),s?.destroy(),o?.destroy(),a?.destroy(),u?.destroy(),f&&clearTimeout(f)}_getAttributeManager(){return new dh(this.context.device,{id:this.props.id,stats:this.context.stats})}_getChangeFlags(e){const n={},{dimensions:r}=this.state;n.dataChanged=this.isAttributeChanged()&&"attribute changed"||this.isAggregationDirty(e,{compareAll:!0,dimension:r.data})&&"aggregation is dirty",n.viewportChanged=e.changeFlags.viewportChanged;const{zoom:i}=this.state;return(!e.context.viewport||e.context.viewport.zoom!==i)&&(n.viewportZoomChanged=!0),n}_createTextures(){const{textureSize:e,format:n}=this.state;this.setState({weightsTexture:this.context.device.createTexture({...ug,width:e,height:e,format:n}),maxWeightsTexture:this.context.device.createTexture({...ug,width:1,height:1,format:n})})}_setupAttributes(){this.getAttributeManager().add({positions:{size:3,type:"float64",accessor:"getPosition"},weights:{size:1,accessor:"getWeight"}}),this.setState({positionAttributeName:"positions"})}_setupTextureParams(){const{device:e}=this.context,{weightsTextureSize:n}=this.props,r=Math.min(n,e.limits.maxTextureDimension2D),i=SY.every(a=>e.features.has(a)),s=i?"rgba32float":"rgba8unorm",o=i?1:1/255;this.setState({textureSize:r,format:s,weightsScale:o}),i||Ve.warn(`HeatmapLayer: ${this.id} rendering to float texture not supported, falling back to low precision format`)()}_createWeightsTransform(e){let{weightsTransform:n}=this.state;const{weightsTexture:r}=this.state,i=this.getAttributeManager();n?.destroy(),n=new xx(this.context.device,{id:`${this.id}-weights-transform`,bufferLayout:i.getBufferLayouts(),vertexCount:1,targetTexture:r,parameters:{depthWriteEnabled:!1,blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"},topology:"point-list",...e,modules:[...e.modules,vY]}),this.setState({weightsTransform:n})}_setupResources(){this._createTextures();const{device:e}=this.context,{textureSize:n,weightsTexture:r,maxWeightsTexture:i}=this.state,s=this.getShaders({vs:f2,fs:h2});this._createWeightsTransform(s);const o=this.getShaders({vs:mY,fs:_Y,modules:[bY]}),a=new xx(e,{id:`${this.id}-max-weights-transform`,targetTexture:i,...o,vertexCount:n*n,topology:"point-list",parameters:{depthWriteEnabled:!1,blendColorOperation:"max",blendAlphaOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}}),u={inTexture:r,textureSize:n};a.model.shaderInputs.setProps({maxWeight:u}),this.setState({weightsTexture:r,maxWeightsTexture:i,maxWeightTransform:a,zoom:null,triPositionBuffer:e.createBuffer({byteLength:48}),triTexCoordBuffer:e.createBuffer({byteLength:48})})}updateShaders(e){this._createWeightsTransform({vs:f2,fs:h2,...e})}_updateMaxWeightValue(){const{maxWeightTransform:e}=this.state;e.run({parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]})}_updateBounds(e=!1){const{viewport:n}=this.context,r=[n.unproject([0,0]),n.unproject([n.width,0]),n.unproject([0,n.height]),n.unproject([n.width,n.height])].map(a=>a.map(Math.fround)),i=aY(r),s={visibleWorldBounds:i,viewportCorners:r};let o=!1;if(e||!this.state.worldBounds||!lY(this.state.worldBounds,i)){const a=this._worldToCommonBounds(i),u=this._commonToWorldBounds(a);this.props.coordinateSystem===Fe.LNGLAT&&(u[1]=Math.max(u[1],-85.051129),u[3]=Math.min(u[3],85.051129),u[0]=Math.max(u[0],-360),u[2]=Math.min(u[2],360));const f=this._worldToCommonBounds(u);s.worldBounds=u,s.normalizedCommonBounds=f,o=!0}return this.setState(s),o}_updateTextureRenderingBounds(){const{triPositionBuffer:e,triTexCoordBuffer:n,normalizedCommonBounds:r,viewportCorners:i}=this.state,{viewport:s}=this.context;e.write(c2(i,3));const o=i.map(a=>uY(s.projectPosition(a),r));n.write(c2(o,2))}_updateColorTexture(e){const{colorRange:n}=e.props;let{colorTexture:r}=this.state;const i=hA(n,!1,Uint8Array);r&&r?.width===n.length?r.setTexture2DData({data:i}):(r?.destroy(),r=this.context.device.createTexture({...ug,data:i,width:n.length,height:1})),this.setState({colorTexture:r})}_updateWeightmap(){const{radiusPixels:e,colorDomain:n,aggregation:r}=this.props,{worldBounds:i,textureSize:s,weightsScale:o,weightsTexture:a}=this.state,u=this.state.weightsTransform;this.state.isWeightMapDirty=!1;const f=this._worldToCommonBounds(i,{useLayerCoordinateSystem:!0});if(n&&r==="SUM"){const{viewport:E}=this.context,R=E.distanceScales.metersPerUnit[2]*(f[2]-f[0])/s;this.state.colorDomain=n.map(k=>k*R*o)}else this.state.colorDomain=n||d2;const p=this.getAttributeManager().getAttributes(),g=this.getModuleSettings();this._setModelAttributes(u.model,p),u.model.setVertexCount(this.getNumInstances());const _={radiusPixels:e,commonBounds:f,textureWidth:s,weightsScale:o,weightsTexture:a},{viewport:v,devicePixelRatio:w,coordinateSystem:x,coordinateOrigin:T}=g,{modelMatrix:A}=this.props;u.model.shaderInputs.setProps({project:{viewport:v,devicePixelRatio:w,modelMatrix:A,coordinateSystem:x,coordinateOrigin:T},weight:_}),u.run({parameters:{viewport:[0,0,s,s]},clearColor:[0,0,0,0]}),this._updateMaxWeightValue()}_debouncedUpdateWeightmap(e=!1){let{updateTimer:n}=this.state;const{debounceTimeout:r}=this.props;e?(n=null,this._updateBounds(!0),this._updateTextureRenderingBounds(),this.setState({isWeightMapDirty:!0})):(this.setState({isWeightMapDirty:!1}),clearTimeout(n),n=setTimeout(this._debouncedUpdateWeightmap.bind(this,!0),r)),this.setState({updateTimer:n})}_worldToCommonBounds(e,n={}){const{useLayerCoordinateSystem:r=!1}=n,[i,s,o,a]=e,{viewport:u}=this.context,{textureSize:f}=this.state,{coordinateSystem:h}=this.props,p=r&&(h===Fe.LNGLAT_OFFSETS||h===Fe.METER_OFFSETS),g=p?u.projectPosition(this.props.coordinateOrigin):[0,0],_=f*wY/u.scale;let v,w;return r&&!p?(v=this.projectPosition([i,s,0]),w=this.projectPosition([o,a,0])):(v=u.projectPosition([i,s,0]),w=u.projectPosition([o,a,0])),cY([v[0]-g[0],v[1]-g[1],w[0]-g[0],w[1]-g[1]],_,_)}_commonToWorldBounds(e){const[n,r,i,s]=e,{viewport:o}=this.context,a=o.unprojectPosition([n,r]),u=o.unprojectPosition([i,s]);return a.slice(0,2).concat(u.slice(0,2))}}sy.layerName="HeatmapLayer";sy.defaultProps=TY;const AY=typeof window<"u"?P.useLayoutEffect:P.useEffect;function Vf(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const CY={position:"absolute",zIndex:-1};function _A(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>_A(n,e));if(_h(t)){if(RY(t))return e.style=CY,P.cloneElement(t,e);if(IY(t))return P.cloneElement(t,e)}return t}function _h(t){return t&&typeof t=="object"&&"type"in t||!1}function RY(t){return t.props?.mapStyle}function IY(t){const e=t.type;return e&&e.deckGLViewProps}function Dm(t){if(typeof t=="function")return P.createElement(Fo,{},t);if(Array.isArray(t))return t.map(Dm);if(_h(t)){if(t.type===P.Fragment)return Dm(t.props.children);if(Vf(t.type,Fo))return t}return t}function kY({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return P.Children.forEach(Dm(t),o=>{if(_h(o)){const a=o.type;if(Vf(a,$o)){const u=PY(a,o.props);i.push(u)}else r.push(o);if(Vf(a,Fo)&&a!==Fo&&o.props.id){const u=new a(o.props);s[u.id]=u}}else o&&r.push(o)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(o=>{s[o.id]=o}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function PY(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}const MY=P.createContext();function NY({children:t,deck:e,ContextProvider:n=MY.Provider}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const o of t){let a=s,u=o;_h(o)&&Vf(o.type,Fo)&&(a=o.props.id||s,u=o.props.children);const f=r.getViewport(a),h=r.getViewState(a);if(f){h.padding=f.padding;const{x:p,y:g,width:_,height:v}=f;u=_A(u,{x:p,y:g,width:_,height:v,viewport:f,viewState:h}),i[a]||(i[a]={viewport:f,children:[]}),i[a].children.push(u)}}return Object.keys(i).map(o=>{const{viewport:a,children:u}=i[o],{x:f,y:h,width:p,height:g}=a,_={position:"absolute",left:f,top:h,width:p,height:g},v=`view-${o}`,w=P.createElement("div",{key:v,id:v,style:_},...u),x={deck:e,viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:A=>{A.viewId=o,e._onViewStateChange(A)},widgets:[]},T=`view-${o}-context`;return P.createElement(n,{key:T,value:x},w)})}const OY={mixBlendMode:null};function DY({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in OY?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function FY(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function yA(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function LY(t,e,n){const r=new e({...n,_customRender:n.deviceProps?.adapters?.[0]?.type==="webgpu"?void 0:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():yA(t)}});return r}function BY(t,e){const[n,r]=P.useState(0),s=P.useRef({control:null,version:n,forceUpdate:()=>r(k=>k+1)}).current,o=P.useRef(null),a=P.useRef(null),u=P.useMemo(()=>kY(t),[t.layers,t.views,t.children]);let f=!0;const h=k=>f&&t.viewState?(s.viewStateUpdateRequested=k,null):(s.viewStateUpdateRequested=null,t.onViewStateChange?.(k)),p=k=>{f?s.interactionStateUpdateRequested=k:(s.interactionStateUpdateRequested=null,t.onInteractionStateChange?.(k))},g=P.useMemo(()=>{const k={widgets:[],...t,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:u.layers,views:u.views,onViewStateChange:h,onInteractionStateChange:p};return delete k._customRender,s.deck&&s.deck.setProps(k),k},[t]);P.useEffect(()=>{const k=t.Deck||G_;return s.deck=LY(s,k,{...g,parent:o.current,canvas:a.current}),()=>s.deck?.finalize()},[]),AY(()=>{yA(s);const{viewStateUpdateRequested:k,interactionStateUpdateRequested:M}=s;k&&h(k),M&&p(M)}),P.useImperativeHandle(e,()=>FY(s),[]);const _=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:v,width:w="100%",height:x="100%",id:T,style:A}=t,{containerStyle:E,canvasStyle:R}=P.useMemo(()=>DY({width:w,height:x,style:A}),[w,x,A]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===_||s.version!==n){s.lastRenderedViewports=_,s.version=n;const k=NY({children:u.children,deck:s.deck,ContextProvider:v}),M=P.createElement("canvas",{key:"canvas",id:T||"deckgl-overlay",ref:a,style:R});s.control=P.createElement("div",{id:`${T||"deckgl"}-wrapper`,ref:o,style:E},[M,k])}return f=!1,s.control}const vA=P.forwardRef(BY);/* @license
Papa Parse
v5.0.0-beta.0
https://github.com/mholt/PapaParse
License: MIT
*/const p2="\uFEFF";function UY(t,e={},n=zY){e=e||{};var r=e.dynamicTyping||!1;Un(r)&&(e.dynamicTypingFunction=r,r={}),e.dynamicTyping=r,e.transform=Un(e.transform)?e.transform:!1;var i=new n(e);return i.stream(t)}function jY(t,e){var n=!1,r=!0,i=",",s=`\r
`,o='"',a=o+o,u=!1,f=null;p();var h=new RegExp(Il(o),"g");if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return g(null,t,u);if(typeof t[0]=="object")return g(f||Object.keys(t[0]),t,u)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:Object.keys(t.data[0])),!Array.isArray(t.data[0])&&typeof t.data[0]!="object"&&(t.data=[t.data])),g(t.fields||[],t.data||[],u);throw new Error("Unable to serialize unrecognized input");function p(){if(typeof e=="object"){if(typeof e.delimiter=="string"&&!bn.BAD_DELIMITERS.filter(function(w){return e.delimiter.indexOf(w)!==-1}).length&&(i=e.delimiter),(typeof e.quotes=="boolean"||Array.isArray(e.quotes))&&(n=e.quotes),(typeof e.skipEmptyLines=="boolean"||typeof e.skipEmptyLines=="string")&&(u=e.skipEmptyLines),typeof e.newline=="string"&&(s=e.newline),typeof e.quoteChar=="string"&&(o=e.quoteChar),typeof e.header=="boolean"&&(r=e.header),Array.isArray(e.columns)){if(e.columns.length===0)throw new Error("Option columns is empty");f=e.columns}e.escapeChar!==void 0&&(a=e.escapeChar+o)}}function g(w,x,T){var A="";typeof w=="string"&&(w=JSON.parse(w)),typeof x=="string"&&(x=JSON.parse(x));var E=Array.isArray(w)&&w.length>0,R=!Array.isArray(x[0]);if(E&&r){for(var k=0;k<w.length;k++)k>0&&(A+=i),A+=_(w[k],k);x.length>0&&(A+=s)}for(var M=0;M<x.length;M++){var L=E?w.length:x[M].length,W=!1,H=E?Object.keys(x[M]).length===0:x[M].length===0;if(T&&!E&&(W=T==="greedy"?x[M].join("").trim()==="":x[M].length===1&&x[M][0].length===0),T==="greedy"&&E){for(var X=[],B=0;B<L;B++){var te=R?w[B]:B;X.push(x[M][te])}W=X.join("").trim()===""}if(!W){for(var ie=0;ie<L;ie++){ie>0&&!H&&(A+=i);var se=E&&R?w[ie]:ie;A+=_(x[M][se],ie)}M<x.length-1&&(!T||L>0&&!H)&&(A+=s)}}return A}function _(w,x){if(typeof w>"u"||w===null)return"";if(w.constructor===Date)return JSON.stringify(w).slice(1,25);w=w.toString().replace(h,a);var T=typeof n=="boolean"&&n||Array.isArray(n)&&n[x]||v(w,bn.BAD_DELIMITERS)||w.indexOf(i)>-1||w.charAt(0)===" "||w.charAt(w.length-1)===" ";return T?o+w+o:w}function v(w,x){for(var T=0;T<x.length;T++)if(w.indexOf(x[T])>-1)return!0;return!1}}let bA=class{_handle;_config;_finished=!1;_completed=!1;_input=null;_baseIndex=0;_partialLine="";_rowCount=0;_start=0;isFirstChunk=!0;_completeResults={data:[],errors:[],meta:{}};constructor(e){var n={...e};n.chunkSize=parseInt(n.chunkSize),!e.step&&!e.chunk&&(n.chunkSize=null),this._handle=new wA(n),this._handle.streamer=this,this._config=n}parseChunk(e,n){if(this.isFirstChunk&&Un(this._config.beforeFirstChunk)){var r=this._config.beforeFirstChunk(e);r!==void 0&&(e=r)}this.isFirstChunk=!1;var i=this._partialLine+e;this._partialLine="";var s=this._handle.parse(i,this._baseIndex,!this._finished);if(!(this._handle.paused()||this._handle.aborted())){var o=s.meta.cursor;this._finished||(this._partialLine=i.substring(o-this._baseIndex),this._baseIndex=o),s&&s.data&&(this._rowCount+=s.data.length);var a=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(Un(this._config.chunk)&&!n){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return;s=void 0,this._completeResults=void 0}return!this._config.step&&!this._config.chunk&&(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),!this._completed&&a&&Un(this._config.complete)&&(!s||!s.meta.aborted)&&(this._config.complete(this._completeResults,this._input),this._completed=!0),s}}_sendError(e){Un(this._config.error)&&this._config.error(e)}};class zY extends bA{remaining;constructor(e={}){super(e)}stream(e){return this.remaining=e,this._nextChunk()}_nextChunk(){if(!this._finished){var e=this._config.chunkSize,n=e?this.remaining.substr(0,e):this.remaining;return this.remaining=e?this.remaining.substr(e):"",this._finished=!this.remaining,this.parseChunk(n)}}}const VY=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,$Y=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/;class wA{_config;_stepCounter=0;_rowCounter=0;_input;_parser;_paused=!1;_aborted=!1;_delimiterError=!1;_fields=[];_results={data:[],errors:[],meta:{}};constructor(e){if(Un(e.step)){var n=e.step;e.step=r=>{if(this._results=r,this.needsHeaderRow())this.processResults();else{if(this.processResults(),!this._results.data||this._results.data.length===0)return;this._stepCounter+=r.data.length,e.preview&&this._stepCounter>e.preview?this._parser.abort():n(this._results,this)}}}this._config=e}parse(e,n,r){var i=this._config.quoteChar||'"';if(this._config.newline||(this._config.newline=WY(e,i)),this._delimiterError=!1,this._config.delimiter)Un(this._config.delimiter)&&(this._config.delimiter=this._config.delimiter(e),this._results.meta.delimiter=this._config.delimiter);else{var s=this.guessDelimiter(e,this._config.newline,this._config.skipEmptyLines,this._config.comments,this._config.delimitersToGuess);s.successful?this._config.delimiter=s.bestDelimiter:(this._delimiterError=!0,this._config.delimiter=bn.DefaultDelimiter),this._results.meta.delimiter=this._config.delimiter}var o=xA(this._config);return this._config.preview&&this._config.header&&o.preview++,this._input=e,this._parser=new Fm(o),this._results=this._parser.parse(this._input,n,r),this.processResults(),this._paused?{meta:{paused:!0}}:this._results||{meta:{paused:!1}}}paused(){return this._paused}pause(){this._paused=!0,this._parser.abort(),this._input=this._input.substr(this._parser.getCharIndex())}resume(){this._paused=!1,this.streamer.parseChunk(this._input,!0)}aborted(){return this._aborted}abort(){this._aborted=!0,this._parser.abort(),this._results.meta.aborted=!0,Un(this._config.complete)&&this._config.complete(this._results),this._input=""}testEmptyLine(e){return this._config.skipEmptyLines==="greedy"?e.join("").trim()==="":e.length===1&&e[0].length===0}processResults(){if(this._results&&this._delimiterError&&(this.addError("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+bn.DefaultDelimiter+"'"),this._delimiterError=!1),this._config.skipEmptyLines)for(var e=0;e<this._results.data.length;e++)this.testEmptyLine(this._results.data[e])&&this._results.data.splice(e--,1);return this.needsHeaderRow()&&this.fillHeaderFields(),this.applyHeaderAndDynamicTypingAndTransformation()}needsHeaderRow(){return this._config.header&&this._fields.length===0}fillHeaderFields(){if(!this._results)return;const e=r=>{Un(this._config.transformHeader)&&(r=this._config.transformHeader(r)),this._fields.push(r)};if(Array.isArray(this._results.data[0])){for(var n=0;this.needsHeaderRow()&&n<this._results.data.length;n++)this._results.data[n].forEach(e);this._results.data.splice(0,1)}else this._results.data.forEach(e)}shouldApplyDynamicTyping(e){return this._config.dynamicTypingFunction&&this._config.dynamicTyping[e]===void 0&&(this._config.dynamicTyping[e]=this._config.dynamicTypingFunction(e)),(this._config.dynamicTyping[e]||this._config.dynamicTyping)===!0}parseDynamic(e,n){return this.shouldApplyDynamicTyping(e)?n==="true"||n==="TRUE"?!0:n==="false"||n==="FALSE"?!1:VY.test(n)?parseFloat(n):$Y.test(n)?new Date(n):n===""?null:n:n}applyHeaderAndDynamicTypingAndTransformation(){if(!this._results||!this._results.data||!this._config.header&&!this._config.dynamicTyping&&!this._config.transform)return this._results;var e=1;return!this._results.data[0]||Array.isArray(this._results.data[0])?(this._results.data=this._results.data.map(this.processRow.bind(this)),e=this._results.data.length):this._results.data=this.processRow(this._results.data,0),this._config.header&&this._results.meta&&(this._results.meta.fields=this._fields),this._rowCounter+=e,this._results}processRow(e,n){var r=this._config.header?{}:[],i;for(i=0;i<e.length;i++){var s=i,o=e[i];this._config.header&&(s=i>=this._fields.length?"__parsed_extra":this._fields[i]),this._config.transform&&(o=this._config.transform(o,s)),o=this.parseDynamic(s,o),s==="__parsed_extra"?(r[s]=r[s]||[],r[s].push(o)):r[s]=o}return this._config.header&&(i>this._fields.length?this.addError("FieldMismatch","TooManyFields","Too many fields: expected "+this._fields.length+" fields but parsed "+i,this._rowCounter+n):i<this._fields.length&&this.addError("FieldMismatch","TooFewFields","Too few fields: expected "+this._fields.length+" fields but parsed "+i,this._rowCounter+n)),r}guessDelimiter(e,n,r,i,s){var o,a,u;s=s||[",","	","|",";",bn.RECORD_SEP,bn.UNIT_SEP];for(var f=0;f<s.length;f++){var h=s[f],p=0,g=0,_=0;u=void 0;for(var v=new Fm({comments:i,delimiter:h,newline:n,preview:10}).parse(e),w=0;w<v.data.length;w++){if(r&&this.testEmptyLine(v.data[w])){_++;continue}var x=v.data[w].length;if(g+=x,typeof u>"u"){u=0;continue}else x>1&&(p+=Math.abs(x-u),u=x)}v.data.length>0&&(g/=v.data.length-_),(typeof a>"u"||p>a)&&g>1.99&&(a=p,o=h)}return this._config.delimiter=o,{successful:!!o,bestDelimiter:o}}addError(e,n,r,i){this._results.errors.push({type:e,code:n,message:r,row:i})}}function WY(t,e){t=t.substr(0,1024*1024);var n=new RegExp(Il(e)+"([^]*?)"+Il(e),"gm");t=t.replace(n,"");var r=t.split("\r"),i=t.split(`
`),s=i.length>1&&i[0].length<r[0].length;if(r.length===1||s)return`
`;for(var o=0,a=0;a<r.length;a++)r[a][0]===`
`&&o++;return o>=r.length/2?`\r
`:"\r"}function Il(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Fm(t){t=t||{};var e=t.delimiter,n=t.newline,r=t.comments,i=t.step,s=t.preview,o=t.fastMode,a;t.quoteChar===void 0?a='"':a=t.quoteChar;var u=a;if(t.escapeChar!==void 0&&(u=t.escapeChar),(typeof e!="string"||bn.BAD_DELIMITERS.indexOf(e)>-1)&&(e=","),r===e)throw new Error("Comment character same as delimiter");r===!0?r="#":(typeof r!="string"||bn.BAD_DELIMITERS.indexOf(r)>-1)&&(r=!1),n!==`
`&&n!=="\r"&&n!==`\r
`&&(n=`
`);var f=0,h=!1;this.parse=function(p,g,_){if(typeof p!="string")throw new Error("Input must be a string");var v=p.length,w=e.length,x=n.length,T=r.length,A=Un(i);f=0;var E=[],R=[],k=[],M=0;if(!p)return D();if(o||o!==!1&&p.indexOf(a)===-1){for(var L=p.split(n),W=0;W<L.length;W++){const ge=L[W];if(f+=ge.length,W!==L.length-1)f+=n.length;else if(_)return D();if(!(r&&ge.substr(0,T)===r)){if(A){if(E=[],xe(ge.split(e)),Z(),h)return D()}else xe(ge.split(e));if(s&&W>=s)return E=E.slice(0,s),D(!0)}}return D()}for(var H=p.indexOf(e,f),X=p.indexOf(n,f),B=new RegExp(Il(u)+Il(a),"g"),te;;){if(p[f]===a){for(te=f,f++;;){if(te=p.indexOf(a,te+1),te===-1)return _||R.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:E.length,index:f}),ne();if(te===v-1){var ie=p.substring(f,te).replace(B,a);return ne(ie)}if(a===u&&p[te+1]===u){te++;continue}if(!(a!==u&&te!==0&&p[te-1]===u)){var se=X===-1?H:Math.min(H,X),G=oe(se);if(p[te+1+G]===e){if(k.push(p.substring(f,te).replace(B,a)),f=te+1+G+w,H=p.indexOf(e,f),X=p.indexOf(n,f),A&&(Z(),h))return D();if(s&&E.length>=s)return D(!0);break}var ce=oe(X);if(p.substr(te+1+ce,x)===n){if(k.push(p.substring(f,te).replace(B,a)),ee(te+1+ce+x),H=p.indexOf(e,f),A&&(Z(),h))return D();if(s&&E.length>=s)return D(!0);break}R.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:E.length,index:f}),te++}}if(A&&(Z(),h))return D();if(s&&E.length>=s)return D(!0);continue}if(r&&k.length===0&&p.substr(f,T)===r){if(X===-1)return D();f=X+x,X=p.indexOf(n,f),H=p.indexOf(e,f);continue}if(H!==-1&&(H<X||X===-1)){k.push(p.substring(f,H)),f=H+w,H=p.indexOf(e,f);continue}if(X!==-1){if(k.push(p.substring(f,X)),ee(X+x),A&&(Z(),h))return D();if(s&&E.length>=s)return D(!0);continue}break}return ne();function xe(ge){E.push(ge),M=f}function oe(ge){var Y=0;if(ge!==-1){var Re=p.substring(te+1,ge);Re&&Re.trim()===""&&(Y=Re.length)}return Y}function ne(ge){return _||(typeof ge>"u"&&(ge=p.substr(f)),k.push(ge),f=v,xe(k),A&&Z()),D()}function ee(ge){f=ge,xe(k),k=[],X=p.indexOf(n,f)}function D(ge,Y){var Re=Y||!1;return{data:Re?E[0]:E,errors:R,meta:{delimiter:e,linebreak:n,aborted:h,truncated:!!ge,cursor:M+(g||0)}}}function Z(){i(D(void 0,!0)),E=[],R=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return f}}function xA(t){if(typeof t!="object"||t===null)return t;var e=Array.isArray(t)?[]:{};for(var n in t)e[n]=xA(t[n]);return e}function Un(t){return typeof t=="function"}const bn={parse:UY,unparse:jY,RECORD_SEP:"",UNIT_SEP:"",BYTE_ORDER_MARK:p2,BAD_DELIMITERS:["\r",`
`,'"',p2],WORKERS_SUPPORTED:!1,NODE_STREAM_INPUT:1,LocalChunkSize:1024*1024*10,RemoteChunkSize:1024*1024*5,DefaultDelimiter:",",Parser:Fm,ParserHandle:wA,ChunkStreamer:bA},{ChunkStreamer:HY}=bn;class XY extends HY{textDecoder=new TextDecoder(this._config.encoding);constructor(e={}){super(e)}async stream(e){this._input=e;try{for await(const n of e)this.parseChunk(this.getStringChunk(n));this._finished=!0,this.parseChunk("")}catch(n){this._sendError(n)}}_nextChunk(){}getStringChunk(e){return typeof e=="string"?e:this.textDecoder.decode(e,{stream:!0})}}const YY="4.3.3",oy="object-row-table",ay={dataType:null,batchType:null,id:"csv",module:"csv",name:"CSV",version:YY,extensions:["csv","tsv","dsv"],mimeTypes:["text/csv","text/tab-separated-values","text/dsv"],category:"table",parse:async(t,e)=>g2(new TextDecoder().decode(t),e),parseText:(t,e)=>g2(t,e),parseInBatches:qY,options:{csv:{shape:oy,optimizeMemoryUsage:!1,header:"auto",columnPrefix:"column",quoteChar:'"',escapeChar:'"',dynamicTyping:!0,comments:!1,skipEmptyLines:!0,delimitersToGuess:[",","	","|",";"]}}};async function g2(t,e){const n={...ay.options.csv,...e?.csv},r=KY(t),s=n.header==="auto"?TA(r):!!n.header,o={...n,header:s,download:!1,transformHeader:s?SA():void 0,error:p=>{throw new Error(p)}},a=bn.parse(t,o),u=a.data,f=a.meta.fields||EA(n.columnPrefix,r.length),h=n.shape||oy;switch(h){case"object-row-table":return{shape:"object-row-table",data:u.map(p=>Array.isArray(p)?GT(p,f):p)};case"array-row-table":return{shape:"array-row-table",data:u.map(p=>Array.isArray(p)?p:eS(p,f))};default:throw new Error(h)}}function qY(t,e){e={...e},e.batchSize==="auto"&&(e.batchSize=4e3);const n={...ay.options.csv,...e?.csv},r=new EB;let i=!0,s=null,o=null,a=null;const u={...n,header:!1,download:!1,chunkSize:1024*1024*5,skipEmptyLines:!1,step(f){let h=f.data;if(n.skipEmptyLines&&h.flat().join("").trim()==="")return;const p=f.meta.cursor;if(i&&!s&&(n.header==="auto"?TA(h):!!n.header)){s=h.map(SA());return}i&&(i=!1,s||(s=EA(n.columnPrefix,h.length)),a=ZY(h,s)),n.optimizeMemoryUsage&&(h=JSON.parse(JSON.stringify(h)));const g=n.shape||oy;o=o||new bf(a,{shape:g,...e});try{o.addRow(h);const _=o&&o.getFullBatch({bytesUsed:p});_&&r.enqueue(_)}catch(_){r.enqueue(_)}},complete(f){try{const h=f.meta.cursor,p=o&&o.getFinalBatch({bytesUsed:h});p&&r.enqueue(p)}catch(h){r.enqueue(h)}r.close()}};return bn.parse(t,u,XY),r}function TA(t){return t&&t.every(e=>typeof e=="string")}function KY(t){return bn.parse(t,{dynamicTyping:!0,preview:1}).data[0]}function SA(){const t=new Set;return e=>{let n=e,r=1;for(;t.has(n);)n=`${e}.${r}`,r++;return t.add(n),n}}function EA(t,e=0){const n=[];for(let r=0;r<e;r++)n.push(`${t}${r+1}`);return n}function ZY(t,e){const n=e?{}:[];for(let r=0;r<t.length;r++){const i=e&&e[r]||r;switch(typeof t[r]){case"number":case"boolean":n[i]={name:String(i),index:r,type:Float32Array};break;case"string":default:n[i]={name:String(i),index:r,type:Array}}}return n}const QY="https://raw.githubusercontent.com/visgl/deck.gl-data/master/examples/3d-heatmap/heatmap-data.csv",JY=new bE({color:[255,255,255],intensity:1}),GY=new SE({color:[255,255,255],intensity:.8,position:[-.144528,49.739968,8e4]}),eq=new SE({color:[255,255,255],intensity:.8,position:[-3.807751,54.104682,8e3]}),tq=new W_({ambientLight:JY,pointLight1:GY,pointLight2:eq}),nq={longitude:-1.415727,latitude:52.232395,zoom:6,minZoom:5,maxZoom:15,pitch:40.5,bearing:-27},rq="https://basemaps.cartocdn.com/gl/dark-matter-nolabels-gl-style/style.json",iq=[[1,152,189],[73,227,206],[216,254,181],[254,237,177],[254,173,84],[209,55,78]];function sq({object:t}){if(!t)return null;const e=t.position[1],n=t.position[0],r=t.count;return`    latitude: ${Number.isFinite(e)?e.toFixed(6):""}
    longitude: ${Number.isFinite(n)?n.toFixed(6):""}
    ${r} Accidents`}function oq({data:t,mapStyle:e=rq,radius:n=1e3,upperPercentile:r=100,coverage:i=1}){const[s,o]=P.useState(!1),a=P.useRef(null);P.useEffect(()=>{const h=g=>{g.key==="Control"&&o(!0)},p=g=>{g.key==="Control"&&o(!1)};return window.addEventListener("keydown",h),window.addEventListener("keyup",p),()=>{window.removeEventListener("keydown",h),window.removeEventListener("keyup",p)}},[]);const u={scrollZoom:s,dragPan:{touchAction:"none",enableMultiTouch:!0,fingerIds:[0,1],required:2},dragRotate:{enableMultiTouch:!0,fingerIds:[0,1],required:2},doubleClickZoom:!1,touchZoom:{enableMultitouch:!0}},f=[new iy({id:"heatmap",gpuAggregation:!0,colorRange:iq,coverage:i,data:t,elevationRange:[0,3e3],elevationScale:t&&t.length?50:0,extruded:!0,getPosition:h=>h,pickable:!0,radius:n,upperPercentile:r,material:{ambient:.64,diffuse:.6,shininess:32,specularColor:[51,51,51]},transitions:{elevationScale:3e3}})];return C.jsx("div",{className:"map-wrapper",children:C.jsx(vA,{ref:a,layers:f,effects:[tq],initialViewState:nq,controller:u,getTooltip:sq,children:C.jsx(PT,{reuseMaps:!0,mapStyle:e})})})}function aq(){const[t,e]=P.useState(void 0),[n,r]=P.useState(!0),[i,s]=P.useState(null);return P.useEffect(()=>{async function o(){try{r(!0);const f=(await wf(QY,ay)).data.map(h=>Number.isFinite(h.lng)&&Number.isFinite(h.lat)?[h.lng,h.lat]:null).filter(h=>h!==null);e(f),r(!1)}catch(a){a instanceof Error?s(a.message):s("An unknown error occurred"),r(!1)}}o()},[]),n?C.jsx("div",{className:"hexagon-layer-loading",children:C.jsx("div",{className:"flex flex-col items-center",children:C.jsxs("svg",{className:"animate-spin h-10 w-10 mb-4 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[C.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),C.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})}):i?C.jsx("div",{className:"hexagon-layer-error",children:"Error loading data. Please try again."}):C.jsx("div",{className:"hexagon-layer-container",children:C.jsx(oq,{data:t})})}function lq(){return C.jsx(jr,{children:C.jsx(aq,{})})}const AA="https://raw.githubusercontent.com/visgl/deck.gl-data/master/examples/screen-grid/uber-pickup-locations.json",cq={longitude:-73.75,latitude:40.73,zoom:9,maxZoom:16,pitch:0,bearing:0},uq="https://basemaps.cartocdn.com/gl/dark-matter-nolabels-gl-style/style.json";function fq({data:t=AA,intensity:e=1,threshold:n=.03,radiusPixels:r=30,mapStyle:i=uq}){const[s,o]=P.useState(!1),a=P.useRef(null);P.useEffect(()=>{const h=g=>{g.key==="Control"&&o(!0)},p=g=>{g.key==="Control"&&o(!1)};return window.addEventListener("keydown",h),window.addEventListener("keyup",p),()=>{window.removeEventListener("keydown",h),window.removeEventListener("keyup",p)}},[]);const u={scrollZoom:s,dragPan:{touchAction:"none",enableMultiTouch:!0,fingerIds:[0,1],required:2},dragRotate:{enableMultiTouch:!0,fingerIds:[0,1],required:2},doubleClickZoom:!1,touchZoom:{enableMultitouch:!0}},f=[new sy({data:t,id:"heatmap-layer",pickable:!1,getPosition:h=>[h[0],h[1]],getWeight:h=>h[2],radiusPixels:r,intensity:e,threshold:n})];return C.jsx("div",{className:"map-wrapper",children:C.jsx(vA,{ref:a,initialViewState:cq,controller:u,layers:f,children:C.jsx(PT,{reuseMaps:!0,mapStyle:i})})})}function hq(){const[t,e]=P.useState(void 0),[n,r]=P.useState(!0),[i,s]=P.useState(null);return P.useEffect(()=>{async function o(){try{const a=await fetch(AA);if(!a.ok)throw new Error("Network response was not ok");const u=await a.json();e(u)}catch(a){a instanceof Error?s(a.message):s("An unknown error occurred")}finally{r(!1)}}o()},[]),n?C.jsx("div",{className:"heatmap-layer-loading",children:C.jsx("div",{className:"flex flex-col items-center",children:C.jsxs("svg",{className:"animate-spin h-10 w-10 mb-4 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[C.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),C.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})}):i?C.jsx("div",{className:"heatmap-layer-error",children:"Error loading data. Please try again."}):C.jsx("div",{className:"heatmap-layer-container",children:C.jsx(fq,{data:t})})}function dq(){return C.jsx(jr,{children:C.jsx(hq,{})})}const pq=({children:t})=>{const e=Ei();return P.useEffect(()=>{window.scrollTo(0,0)},[e.pathname]),C.jsx(C.Fragment,{children:t})};function gq(){return C.jsx(XI,{children:C.jsx(pq,{children:C.jsxs(xI,{children:[C.jsx(pn,{path:"/",element:C.jsx(PM,{})}),C.jsx(pn,{path:"/services",element:C.jsx(OM,{})}),C.jsx(pn,{path:"/about",element:C.jsx(FM,{})}),C.jsx(pn,{path:"/contact",element:C.jsx(UM,{})}),C.jsx(pn,{path:"/projects/markers-and-infowindows",element:C.jsx(k4,{})}),C.jsx(pn,{path:"/projects/earthquake-magnitude-heatmap",element:C.jsx(F4,{})}),C.jsx(pn,{path:"/projects/fifa-world-cup",element:C.jsx(uL,{})}),C.jsx(pn,{path:"/projects/health-adjusted-life-expectancy",element:C.jsx(lL,{})}),C.jsx(pn,{path:"/projects/personal-injury-road-accidents",element:C.jsx(lq,{})}),C.jsx(pn,{path:"/projects/uber-pickup-locations-in-new-york-city",element:C.jsx(dq,{})}),C.jsx(pn,{path:"*",element:C.jsx(L4,{})})]})})})}const mq=kR.createRoot(document.getElementById("root"));mq.render(C.jsx(ht.StrictMode,{children:C.jsx(gq,{})}));export{kl as g};
